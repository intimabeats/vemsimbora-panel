var ZR=Object.defineProperty;var eP=(t,e,n)=>e in t?ZR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var zn=(t,e,n)=>eP(t,typeof e!="symbol"?e+"":e,n);(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="bd05da65-faa9-421e-b498-2867dac49506",t._sentryDebugIdIdentifier="sentry-dbid-bd05da65-faa9-421e-b498-2867dac49506")}catch{}})();function tP(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var nP=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};nP.SENTRY_RELEASE={id:"vemsimbora@0.0.1"};(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Sx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var VT={exports:{}},Cp={},FT={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wu=Symbol.for("react.element"),rP=Symbol.for("react.portal"),sP=Symbol.for("react.fragment"),iP=Symbol.for("react.strict_mode"),oP=Symbol.for("react.profiler"),aP=Symbol.for("react.provider"),lP=Symbol.for("react.context"),cP=Symbol.for("react.forward_ref"),uP=Symbol.for("react.suspense"),dP=Symbol.for("react.memo"),hP=Symbol.for("react.lazy"),x_=Symbol.iterator;function fP(t){return t===null||typeof t!="object"?null:(t=x_&&t[x_]||t["@@iterator"],typeof t=="function"?t:null)}var UT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zT=Object.assign,BT={};function Nl(t,e,n){this.props=t,this.context=e,this.refs=BT,this.updater=n||UT}Nl.prototype.isReactComponent={};Nl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Nl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $T(){}$T.prototype=Nl.prototype;function Tx(t,e,n){this.props=t,this.context=e,this.refs=BT,this.updater=n||UT}var kx=Tx.prototype=new $T;kx.constructor=Tx;zT(kx,Nl.prototype);kx.isPureReactComponent=!0;var v_=Array.isArray,HT=Object.prototype.hasOwnProperty,Nx={current:null},qT={key:!0,ref:!0,__self:!0,__source:!0};function WT(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)HT.call(e,r)&&!qT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Wu,type:t,key:i,ref:o,props:s,_owner:Nx.current}}function pP(t,e){return{$$typeof:Wu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Cx(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wu}function mP(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var w_=/\/+/g;function og(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mP(""+t.key):e.toString(36)}function yh(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wu:case rP:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+og(o,0):r,v_(s)?(n="",t!=null&&(n=t.replace(w_,"$&/")+"/"),yh(s,e,n,"",function(u){return u})):s!=null&&(Cx(s)&&(s=pP(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(w_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",v_(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+og(i,a);o+=yh(i,e,n,l,s)}else if(l=fP(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+og(i,a++),o+=yh(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Pd(t,e,n){if(t==null)return t;var r=[],s=0;return yh(t,r,"","",function(i){return e.call(n,i,s++)}),r}function gP(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Cn={current:null},xh={transition:null},yP={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:xh,ReactCurrentOwner:Nx};function KT(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:Pd,forEach:function(t,e,n){Pd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Pd(t,function(){e++}),e},toArray:function(t){return Pd(t,function(e){return e})||[]},only:function(t){if(!Cx(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ee.Component=Nl;Ee.Fragment=sP;Ee.Profiler=oP;Ee.PureComponent=Tx;Ee.StrictMode=iP;Ee.Suspense=uP;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yP;Ee.act=KT;Ee.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=zT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Nx.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)HT.call(e,l)&&!qT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Wu,type:t.type,key:s,ref:i,props:r,_owner:o}};Ee.createContext=function(t){return t={$$typeof:lP,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:aP,_context:t},t.Consumer=t};Ee.createElement=WT;Ee.createFactory=function(t){var e=WT.bind(null,t);return e.type=t,e};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(t){return{$$typeof:cP,render:t}};Ee.isValidElement=Cx;Ee.lazy=function(t){return{$$typeof:hP,_payload:{_status:-1,_result:t},_init:gP}};Ee.memo=function(t,e){return{$$typeof:dP,type:t,compare:e===void 0?null:e}};Ee.startTransition=function(t){var e=xh.transition;xh.transition={};try{t()}finally{xh.transition=e}};Ee.unstable_act=KT;Ee.useCallback=function(t,e){return Cn.current.useCallback(t,e)};Ee.useContext=function(t){return Cn.current.useContext(t)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(t){return Cn.current.useDeferredValue(t)};Ee.useEffect=function(t,e){return Cn.current.useEffect(t,e)};Ee.useId=function(){return Cn.current.useId()};Ee.useImperativeHandle=function(t,e,n){return Cn.current.useImperativeHandle(t,e,n)};Ee.useInsertionEffect=function(t,e){return Cn.current.useInsertionEffect(t,e)};Ee.useLayoutEffect=function(t,e){return Cn.current.useLayoutEffect(t,e)};Ee.useMemo=function(t,e){return Cn.current.useMemo(t,e)};Ee.useReducer=function(t,e,n){return Cn.current.useReducer(t,e,n)};Ee.useRef=function(t){return Cn.current.useRef(t)};Ee.useState=function(t){return Cn.current.useState(t)};Ee.useSyncExternalStore=function(t,e,n){return Cn.current.useSyncExternalStore(t,e,n)};Ee.useTransition=function(){return Cn.current.useTransition()};Ee.version="18.3.1";FT.exports=Ee;var T=FT.exports;const pt=Sx(T),xP=tP({__proto__:null,default:pt},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vP=T,wP=Symbol.for("react.element"),bP=Symbol.for("react.fragment"),_P=Object.prototype.hasOwnProperty,EP=vP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SP={key:!0,ref:!0,__self:!0,__source:!0};function GT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_P.call(e,r)&&!SP.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:wP,type:t,key:i,ref:o,props:s,_owner:EP.current}}Cp.Fragment=bP;Cp.jsx=GT;Cp.jsxs=GT;VT.exports=Cp;var c=VT.exports,QT={exports:{}},tr={},JT={exports:{}},YT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,V){var $=B.length;B.push(V);e:for(;0<$;){var F=$-1>>>1,H=B[F];if(0<s(H,V))B[F]=V,B[$]=H,$=F;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var V=B[0],$=B.pop();if($!==V){B[0]=$;e:for(var F=0,H=B.length,X=H>>>1;F<X;){var ge=2*(F+1)-1,Ie=B[ge],ae=ge+1,oe=B[ae];if(0>s(Ie,$))ae<H&&0>s(oe,Ie)?(B[F]=oe,B[ae]=$,F=ae):(B[F]=Ie,B[ge]=$,F=ge);else if(ae<H&&0>s(oe,$))B[F]=oe,B[ae]=$,F=ae;else break e}}return V}function s(B,V){var $=B.sortIndex-V.sortIndex;return $!==0?$:B.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,m=!1,g=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(B){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=B)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function A(B){if(x=!1,E(B),!g)if(n(l)!==null)g=!0,W(P);else{var V=n(u);V!==null&&Z(A,V.startTime-B)}}function P(B,V){g=!1,x&&(x=!1,v(S),S=-1),m=!0;var $=p;try{for(E(V),f=n(l);f!==null&&(!(f.expirationTime>V)||B&&!D());){var F=f.callback;if(typeof F=="function"){f.callback=null,p=f.priorityLevel;var H=F(f.expirationTime<=V);V=t.unstable_now(),typeof H=="function"?f.callback=H:f===n(l)&&r(l),E(V)}else r(l);f=n(l)}if(f!==null)var X=!0;else{var ge=n(u);ge!==null&&Z(A,ge.startTime-V),X=!1}return X}finally{f=null,p=$,m=!1}}var M=!1,N=null,S=-1,C=5,j=-1;function D(){return!(t.unstable_now()-j<C)}function R(){if(N!==null){var B=t.unstable_now();j=B;var V=!0;try{V=N(!0,B)}finally{V?k():(M=!1,N=null)}}else M=!1}var k;if(typeof _=="function")k=function(){_(R)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,O=z.port2;z.port1.onmessage=R,k=function(){O.postMessage(null)}}else k=function(){w(R,0)};function W(B){N=B,M||(M=!0,k())}function Z(B,V){S=w(function(){B(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,W(P))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(B){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var $=p;p=V;try{return B()}finally{p=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,V){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var $=p;p=B;try{return V()}finally{p=$}},t.unstable_scheduleCallback=function(B,V,$){var F=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?F+$:F):$=F,B){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=$+H,B={id:d++,callback:V,priorityLevel:B,startTime:$,expirationTime:H,sortIndex:-1},$>F?(B.sortIndex=$,e(u,B),n(l)===null&&B===n(u)&&(x?(v(S),S=-1):x=!0,Z(A,$-F))):(B.sortIndex=H,e(l,B),g||m||(g=!0,W(P))),B},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(B){var V=p;return function(){var $=p;p=V;try{return B.apply(this,arguments)}finally{p=$}}}})(YT);JT.exports=YT;var TP=JT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kP=T,er=TP;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var XT=new Set,su={};function ta(t,e){tl(t,e),tl(t+"Capture",e)}function tl(t,e){for(su[t]=e,t=0;t<e.length;t++)XT.add(e[t])}var As=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ey=Object.prototype.hasOwnProperty,NP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b_={},__={};function CP(t){return Ey.call(__,t)?!0:Ey.call(b_,t)?!1:NP.test(t)?__[t]=!0:(b_[t]=!0,!1)}function IP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function AP(t,e,n,r){if(e===null||typeof e>"u"||IP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xt[t]=new In(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xt[e]=new In(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xt[t]=new In(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xt[t]=new In(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xt[t]=new In(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xt[t]=new In(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xt[t]=new In(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xt[t]=new In(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xt[t]=new In(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ix=/[\-:]([a-z])/g;function Ax(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ix,Ax);Xt[e]=new In(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ix,Ax);Xt[e]=new In(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ix,Ax);Xt[e]=new In(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xt[t]=new In(t,1,!1,t.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xt[t]=new In(t,1,!1,t.toLowerCase(),null,!0,!0)});function jx(t,e,n,r){var s=Xt.hasOwnProperty(e)?Xt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(AP(e,n,s,r)&&(n=null),r||s===null?CP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Us=kP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dd=Symbol.for("react.element"),Ta=Symbol.for("react.portal"),ka=Symbol.for("react.fragment"),Rx=Symbol.for("react.strict_mode"),Sy=Symbol.for("react.profiler"),ZT=Symbol.for("react.provider"),ek=Symbol.for("react.context"),Px=Symbol.for("react.forward_ref"),Ty=Symbol.for("react.suspense"),ky=Symbol.for("react.suspense_list"),Dx=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),tk=Symbol.for("react.offscreen"),E_=Symbol.iterator;function rc(t){return t===null||typeof t!="object"?null:(t=E_&&t[E_]||t["@@iterator"],typeof t=="function"?t:null)}var at=Object.assign,ag;function mc(t){if(ag===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ag=e&&e[1]||""}return`
`+ag+t}var lg=!1;function cg(t,e){if(!t||lg)return"";lg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{lg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?mc(t):""}function jP(t){switch(t.tag){case 5:return mc(t.type);case 16:return mc("Lazy");case 13:return mc("Suspense");case 19:return mc("SuspenseList");case 0:case 2:case 15:return t=cg(t.type,!1),t;case 11:return t=cg(t.type.render,!1),t;case 1:return t=cg(t.type,!0),t;default:return""}}function Ny(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ka:return"Fragment";case Ta:return"Portal";case Sy:return"Profiler";case Rx:return"StrictMode";case Ty:return"Suspense";case ky:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ek:return(t.displayName||"Context")+".Consumer";case ZT:return(t._context.displayName||"Context")+".Provider";case Px:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Dx:return e=t.displayName||null,e!==null?e:Ny(t.type)||"Memo";case Ys:e=t._payload,t=t._init;try{return Ny(t(e))}catch{}}return null}function RP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ny(e);case 8:return e===Rx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Li(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function nk(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function PP(t){var e=nk(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Md(t){t._valueTracker||(t._valueTracker=PP(t))}function rk(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=nk(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Wh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Cy(t,e){var n=e.checked;return at({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function S_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Li(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sk(t,e){e=e.checked,e!=null&&jx(t,"checked",e,!1)}function Iy(t,e){sk(t,e);var n=Li(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ay(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ay(t,e.type,Li(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function T_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ay(t,e,n){(e!=="number"||Wh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var gc=Array.isArray;function za(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Li(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function jy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return at({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function k_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(gc(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Li(n)}}function ik(t,e){var n=Li(e.value),r=Li(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function N_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ok(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ry(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ok(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Od,ak=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Od=Od||document.createElement("div"),Od.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Od.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function iu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},DP=["Webkit","ms","Moz","O"];Object.keys(Ic).forEach(function(t){DP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ic[e]=Ic[t]})});function lk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ic.hasOwnProperty(t)&&Ic[t]?(""+e).trim():e+"px"}function ck(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=lk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var MP=at({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Py(t,e){if(e){if(MP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function Dy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var My=null;function Mx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Oy=null,Ba=null,$a=null;function C_(t){if(t=Qu(t)){if(typeof Oy!="function")throw Error(J(280));var e=t.stateNode;e&&(e=Pp(e),Oy(t.stateNode,t.type,e))}}function uk(t){Ba?$a?$a.push(t):$a=[t]:Ba=t}function dk(){if(Ba){var t=Ba,e=$a;if($a=Ba=null,C_(t),e)for(t=0;t<e.length;t++)C_(e[t])}}function hk(t,e){return t(e)}function fk(){}var ug=!1;function pk(t,e,n){if(ug)return t(e,n);ug=!0;try{return hk(t,e,n)}finally{ug=!1,(Ba!==null||$a!==null)&&(fk(),dk())}}function ou(t,e){var n=t.stateNode;if(n===null)return null;var r=Pp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var Ly=!1;if(As)try{var sc={};Object.defineProperty(sc,"passive",{get:function(){Ly=!0}}),window.addEventListener("test",sc,sc),window.removeEventListener("test",sc,sc)}catch{Ly=!1}function OP(t,e,n,r,s,i,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Ac=!1,Kh=null,Gh=!1,Vy=null,LP={onError:function(t){Ac=!0,Kh=t}};function VP(t,e,n,r,s,i,o,a,l){Ac=!1,Kh=null,OP.apply(LP,arguments)}function FP(t,e,n,r,s,i,o,a,l){if(VP.apply(this,arguments),Ac){if(Ac){var u=Kh;Ac=!1,Kh=null}else throw Error(J(198));Gh||(Gh=!0,Vy=u)}}function na(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function I_(t){if(na(t)!==t)throw Error(J(188))}function UP(t){var e=t.alternate;if(!e){if(e=na(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return I_(s),t;if(i===r)return I_(s),e;i=i.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function gk(t){return t=UP(t),t!==null?yk(t):null}function yk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yk(t);if(e!==null)return e;t=t.sibling}return null}var xk=er.unstable_scheduleCallback,A_=er.unstable_cancelCallback,zP=er.unstable_shouldYield,BP=er.unstable_requestPaint,xt=er.unstable_now,$P=er.unstable_getCurrentPriorityLevel,Ox=er.unstable_ImmediatePriority,vk=er.unstable_UserBlockingPriority,Qh=er.unstable_NormalPriority,HP=er.unstable_LowPriority,wk=er.unstable_IdlePriority,Ip=null,Hr=null;function qP(t){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(Ip,t,void 0,(t.current.flags&128)===128)}catch{}}var kr=Math.clz32?Math.clz32:GP,WP=Math.log,KP=Math.LN2;function GP(t){return t>>>=0,t===0?32:31-(WP(t)/KP|0)|0}var Ld=64,Vd=4194304;function yc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Jh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=yc(a):(i&=o,i!==0&&(r=yc(i)))}else o=n&~s,o!==0?r=yc(o):i!==0&&(r=yc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-kr(e),s=1<<n,r|=t[n],e&=~s;return r}function QP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-kr(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=QP(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Fy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function bk(){var t=Ld;return Ld<<=1,!(Ld&4194240)&&(Ld=64),t}function dg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ku(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-kr(e),t[e]=n}function YP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-kr(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Lx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-kr(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Me=0;function _k(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ek,Vx,Sk,Tk,kk,Uy=!1,Fd=[],wi=null,bi=null,_i=null,au=new Map,lu=new Map,si=[],XP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j_(t,e){switch(t){case"focusin":case"focusout":wi=null;break;case"dragenter":case"dragleave":bi=null;break;case"mouseover":case"mouseout":_i=null;break;case"pointerover":case"pointerout":au.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":lu.delete(e.pointerId)}}function ic(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Qu(e),e!==null&&Vx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function ZP(t,e,n,r,s){switch(e){case"focusin":return wi=ic(wi,t,e,n,r,s),!0;case"dragenter":return bi=ic(bi,t,e,n,r,s),!0;case"mouseover":return _i=ic(_i,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return au.set(i,ic(au.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,lu.set(i,ic(lu.get(i)||null,t,e,n,r,s)),!0}return!1}function Nk(t){var e=po(t.target);if(e!==null){var n=na(e);if(n!==null){if(e=n.tag,e===13){if(e=mk(n),e!==null){t.blockedOn=e,kk(t.priority,function(){Sk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=zy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);My=r,n.target.dispatchEvent(r),My=null}else return e=Qu(n),e!==null&&Vx(e),t.blockedOn=n,!1;e.shift()}return!0}function R_(t,e,n){vh(t)&&n.delete(e)}function eD(){Uy=!1,wi!==null&&vh(wi)&&(wi=null),bi!==null&&vh(bi)&&(bi=null),_i!==null&&vh(_i)&&(_i=null),au.forEach(R_),lu.forEach(R_)}function oc(t,e){t.blockedOn===e&&(t.blockedOn=null,Uy||(Uy=!0,er.unstable_scheduleCallback(er.unstable_NormalPriority,eD)))}function cu(t){function e(s){return oc(s,t)}if(0<Fd.length){oc(Fd[0],t);for(var n=1;n<Fd.length;n++){var r=Fd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wi!==null&&oc(wi,t),bi!==null&&oc(bi,t),_i!==null&&oc(_i,t),au.forEach(e),lu.forEach(e),n=0;n<si.length;n++)r=si[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<si.length&&(n=si[0],n.blockedOn===null);)Nk(n),n.blockedOn===null&&si.shift()}var Ha=Us.ReactCurrentBatchConfig,Yh=!0;function tD(t,e,n,r){var s=Me,i=Ha.transition;Ha.transition=null;try{Me=1,Fx(t,e,n,r)}finally{Me=s,Ha.transition=i}}function nD(t,e,n,r){var s=Me,i=Ha.transition;Ha.transition=null;try{Me=4,Fx(t,e,n,r)}finally{Me=s,Ha.transition=i}}function Fx(t,e,n,r){if(Yh){var s=zy(t,e,n,r);if(s===null)bg(t,e,r,Xh,n),j_(t,r);else if(ZP(s,t,e,n,r))r.stopPropagation();else if(j_(t,r),e&4&&-1<XP.indexOf(t)){for(;s!==null;){var i=Qu(s);if(i!==null&&Ek(i),i=zy(t,e,n,r),i===null&&bg(t,e,r,Xh,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else bg(t,e,r,null,n)}}var Xh=null;function zy(t,e,n,r){if(Xh=null,t=Mx(r),t=po(t),t!==null)if(e=na(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xh=t,null}function Ck(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($P()){case Ox:return 1;case vk:return 4;case Qh:case HP:return 16;case wk:return 536870912;default:return 16}default:return 16}}var fi=null,Ux=null,wh=null;function Ik(){if(wh)return wh;var t,e=Ux,n=e.length,r,s="value"in fi?fi.value:fi.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return wh=s.slice(t,1<r?1-r:void 0)}function bh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ud(){return!0}function P_(){return!1}function nr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ud:P_,this.isPropagationStopped=P_,this}return at(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ud)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ud)},persist:function(){},isPersistent:Ud}),e}var Cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zx=nr(Cl),Gu=at({},Cl,{view:0,detail:0}),rD=nr(Gu),hg,fg,ac,Ap=at({},Gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ac&&(ac&&t.type==="mousemove"?(hg=t.screenX-ac.screenX,fg=t.screenY-ac.screenY):fg=hg=0,ac=t),hg)},movementY:function(t){return"movementY"in t?t.movementY:fg}}),D_=nr(Ap),sD=at({},Ap,{dataTransfer:0}),iD=nr(sD),oD=at({},Gu,{relatedTarget:0}),pg=nr(oD),aD=at({},Cl,{animationName:0,elapsedTime:0,pseudoElement:0}),lD=nr(aD),cD=at({},Cl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uD=nr(cD),dD=at({},Cl,{data:0}),M_=nr(dD),hD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mD(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pD[t])?!!e[t]:!1}function Bx(){return mD}var gD=at({},Gu,{key:function(t){if(t.key){var e=hD[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bx,charCode:function(t){return t.type==="keypress"?bh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yD=nr(gD),xD=at({},Ap,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O_=nr(xD),vD=at({},Gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bx}),wD=nr(vD),bD=at({},Cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),_D=nr(bD),ED=at({},Ap,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),SD=nr(ED),TD=[9,13,27,32],$x=As&&"CompositionEvent"in window,jc=null;As&&"documentMode"in document&&(jc=document.documentMode);var kD=As&&"TextEvent"in window&&!jc,Ak=As&&(!$x||jc&&8<jc&&11>=jc),L_=" ",V_=!1;function jk(t,e){switch(t){case"keyup":return TD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rk(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Na=!1;function ND(t,e){switch(t){case"compositionend":return Rk(e);case"keypress":return e.which!==32?null:(V_=!0,L_);case"textInput":return t=e.data,t===L_&&V_?null:t;default:return null}}function CD(t,e){if(Na)return t==="compositionend"||!$x&&jk(t,e)?(t=Ik(),wh=Ux=fi=null,Na=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ak&&e.locale!=="ko"?null:e.data;default:return null}}var ID={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ID[t.type]:e==="textarea"}function Pk(t,e,n,r){uk(r),e=Zh(e,"onChange"),0<e.length&&(n=new zx("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Rc=null,uu=null;function AD(t){Hk(t,0)}function jp(t){var e=Aa(t);if(rk(e))return t}function jD(t,e){if(t==="change")return e}var Dk=!1;if(As){var mg;if(As){var gg="oninput"in document;if(!gg){var U_=document.createElement("div");U_.setAttribute("oninput","return;"),gg=typeof U_.oninput=="function"}mg=gg}else mg=!1;Dk=mg&&(!document.documentMode||9<document.documentMode)}function z_(){Rc&&(Rc.detachEvent("onpropertychange",Mk),uu=Rc=null)}function Mk(t){if(t.propertyName==="value"&&jp(uu)){var e=[];Pk(e,uu,t,Mx(t)),pk(AD,e)}}function RD(t,e,n){t==="focusin"?(z_(),Rc=e,uu=n,Rc.attachEvent("onpropertychange",Mk)):t==="focusout"&&z_()}function PD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jp(uu)}function DD(t,e){if(t==="click")return jp(e)}function MD(t,e){if(t==="input"||t==="change")return jp(e)}function OD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ir=typeof Object.is=="function"?Object.is:OD;function du(t,e){if(Ir(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ey.call(e,s)||!Ir(t[s],e[s]))return!1}return!0}function B_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $_(t,e){var n=B_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=B_(n)}}function Ok(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ok(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Lk(){for(var t=window,e=Wh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wh(t.document)}return e}function Hx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function LD(t){var e=Lk(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ok(n.ownerDocument.documentElement,n)){if(r!==null&&Hx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=$_(n,i);var o=$_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var VD=As&&"documentMode"in document&&11>=document.documentMode,Ca=null,By=null,Pc=null,$y=!1;function H_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$y||Ca==null||Ca!==Wh(r)||(r=Ca,"selectionStart"in r&&Hx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Pc&&du(Pc,r)||(Pc=r,r=Zh(By,"onSelect"),0<r.length&&(e=new zx("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ca)))}function zd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ia={animationend:zd("Animation","AnimationEnd"),animationiteration:zd("Animation","AnimationIteration"),animationstart:zd("Animation","AnimationStart"),transitionend:zd("Transition","TransitionEnd")},yg={},Vk={};As&&(Vk=document.createElement("div").style,"AnimationEvent"in window||(delete Ia.animationend.animation,delete Ia.animationiteration.animation,delete Ia.animationstart.animation),"TransitionEvent"in window||delete Ia.transitionend.transition);function Rp(t){if(yg[t])return yg[t];if(!Ia[t])return t;var e=Ia[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Vk)return yg[t]=e[n];return t}var Fk=Rp("animationend"),Uk=Rp("animationiteration"),zk=Rp("animationstart"),Bk=Rp("transitionend"),$k=new Map,q_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qi(t,e){$k.set(t,e),ta(e,[t])}for(var xg=0;xg<q_.length;xg++){var vg=q_[xg],FD=vg.toLowerCase(),UD=vg[0].toUpperCase()+vg.slice(1);qi(FD,"on"+UD)}qi(Fk,"onAnimationEnd");qi(Uk,"onAnimationIteration");qi(zk,"onAnimationStart");qi("dblclick","onDoubleClick");qi("focusin","onFocus");qi("focusout","onBlur");qi(Bk,"onTransitionEnd");tl("onMouseEnter",["mouseout","mouseover"]);tl("onMouseLeave",["mouseout","mouseover"]);tl("onPointerEnter",["pointerout","pointerover"]);tl("onPointerLeave",["pointerout","pointerover"]);ta("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ta("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ta("onBeforeInput",["compositionend","keypress","textInput","paste"]);ta("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ta("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ta("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zD=new Set("cancel close invalid load scroll toggle".split(" ").concat(xc));function W_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,FP(r,e,void 0,t),t.currentTarget=null}function Hk(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;W_(s,a,u),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;W_(s,a,u),i=l}}}if(Gh)throw t=Vy,Gh=!1,Vy=null,t}function We(t,e){var n=e[Gy];n===void 0&&(n=e[Gy]=new Set);var r=t+"__bubble";n.has(r)||(qk(e,t,2,!1),n.add(r))}function wg(t,e,n){var r=0;e&&(r|=4),qk(n,t,r,e)}var Bd="_reactListening"+Math.random().toString(36).slice(2);function hu(t){if(!t[Bd]){t[Bd]=!0,XT.forEach(function(n){n!=="selectionchange"&&(zD.has(n)||wg(n,!1,t),wg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Bd]||(e[Bd]=!0,wg("selectionchange",!1,e))}}function qk(t,e,n,r){switch(Ck(e)){case 1:var s=tD;break;case 4:s=nD;break;default:s=Fx}n=s.bind(null,e,n,t),s=void 0,!Ly||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function bg(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=po(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}pk(function(){var u=i,d=Mx(n),f=[];e:{var p=$k.get(t);if(p!==void 0){var m=zx,g=t;switch(t){case"keypress":if(bh(n)===0)break e;case"keydown":case"keyup":m=yD;break;case"focusin":g="focus",m=pg;break;case"focusout":g="blur",m=pg;break;case"beforeblur":case"afterblur":m=pg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=D_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=iD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=wD;break;case Fk:case Uk:case zk:m=lD;break;case Bk:m=_D;break;case"scroll":m=rD;break;case"wheel":m=SD;break;case"copy":case"cut":case"paste":m=uD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=O_}var x=(e&4)!==0,w=!x&&t==="scroll",v=x?p!==null?p+"Capture":null:p;x=[];for(var _=u,E;_!==null;){E=_;var A=E.stateNode;if(E.tag===5&&A!==null&&(E=A,v!==null&&(A=ou(_,v),A!=null&&x.push(fu(_,A,E)))),w)break;_=_.return}0<x.length&&(p=new m(p,g,null,n,d),f.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&n!==My&&(g=n.relatedTarget||n.fromElement)&&(po(g)||g[js]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?po(g):null,g!==null&&(w=na(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=D_,A="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=O_,A="onPointerLeave",v="onPointerEnter",_="pointer"),w=m==null?p:Aa(m),E=g==null?p:Aa(g),p=new x(A,_+"leave",m,n,d),p.target=w,p.relatedTarget=E,A=null,po(d)===u&&(x=new x(v,_+"enter",g,n,d),x.target=E,x.relatedTarget=w,A=x),w=A,m&&g)t:{for(x=m,v=g,_=0,E=x;E;E=ga(E))_++;for(E=0,A=v;A;A=ga(A))E++;for(;0<_-E;)x=ga(x),_--;for(;0<E-_;)v=ga(v),E--;for(;_--;){if(x===v||v!==null&&x===v.alternate)break t;x=ga(x),v=ga(v)}x=null}else x=null;m!==null&&K_(f,p,m,x,!1),g!==null&&w!==null&&K_(f,w,g,x,!0)}}e:{if(p=u?Aa(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var P=jD;else if(F_(p))if(Dk)P=MD;else{P=PD;var M=RD}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=DD);if(P&&(P=P(t,u))){Pk(f,P,n,d);break e}M&&M(t,p,u),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&Ay(p,"number",p.value)}switch(M=u?Aa(u):window,t){case"focusin":(F_(M)||M.contentEditable==="true")&&(Ca=M,By=u,Pc=null);break;case"focusout":Pc=By=Ca=null;break;case"mousedown":$y=!0;break;case"contextmenu":case"mouseup":case"dragend":$y=!1,H_(f,n,d);break;case"selectionchange":if(VD)break;case"keydown":case"keyup":H_(f,n,d)}var N;if($x)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Na?jk(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(Ak&&n.locale!=="ko"&&(Na||S!=="onCompositionStart"?S==="onCompositionEnd"&&Na&&(N=Ik()):(fi=d,Ux="value"in fi?fi.value:fi.textContent,Na=!0)),M=Zh(u,S),0<M.length&&(S=new M_(S,t,null,n,d),f.push({event:S,listeners:M}),N?S.data=N:(N=Rk(n),N!==null&&(S.data=N)))),(N=kD?ND(t,n):CD(t,n))&&(u=Zh(u,"onBeforeInput"),0<u.length&&(d=new M_("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=N))}Hk(f,e)})}function fu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ou(t,n),i!=null&&r.unshift(fu(t,i,s)),i=ou(t,e),i!=null&&r.push(fu(t,i,s))),t=t.return}return r}function ga(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function K_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=ou(n,i),l!=null&&o.unshift(fu(n,l,a))):s||(l=ou(n,i),l!=null&&o.push(fu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var BD=/\r\n?/g,$D=/\u0000|\uFFFD/g;function G_(t){return(typeof t=="string"?t:""+t).replace(BD,`
`).replace($D,"")}function $d(t,e,n){if(e=G_(e),G_(t)!==e&&n)throw Error(J(425))}function ef(){}var Hy=null,qy=null;function Wy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ky=typeof setTimeout=="function"?setTimeout:void 0,HD=typeof clearTimeout=="function"?clearTimeout:void 0,Q_=typeof Promise=="function"?Promise:void 0,qD=typeof queueMicrotask=="function"?queueMicrotask:typeof Q_<"u"?function(t){return Q_.resolve(null).then(t).catch(WD)}:Ky;function WD(t){setTimeout(function(){throw t})}function _g(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),cu(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);cu(e)}function Ei(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function J_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Il=Math.random().toString(36).slice(2),Ur="__reactFiber$"+Il,pu="__reactProps$"+Il,js="__reactContainer$"+Il,Gy="__reactEvents$"+Il,KD="__reactListeners$"+Il,GD="__reactHandles$"+Il;function po(t){var e=t[Ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[js]||n[Ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=J_(t);t!==null;){if(n=t[Ur])return n;t=J_(t)}return e}t=n,n=t.parentNode}return null}function Qu(t){return t=t[Ur]||t[js],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Aa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function Pp(t){return t[pu]||null}var Qy=[],ja=-1;function Wi(t){return{current:t}}function Qe(t){0>ja||(t.current=Qy[ja],Qy[ja]=null,ja--)}function Be(t,e){ja++,Qy[ja]=t.current,t.current=e}var Vi={},fn=Wi(Vi),Mn=Wi(!1),Oo=Vi;function nl(t,e){var n=t.type.contextTypes;if(!n)return Vi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function On(t){return t=t.childContextTypes,t!=null}function tf(){Qe(Mn),Qe(fn)}function Y_(t,e,n){if(fn.current!==Vi)throw Error(J(168));Be(fn,e),Be(Mn,n)}function Wk(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(J(108,RP(t)||"Unknown",s));return at({},n,r)}function nf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vi,Oo=fn.current,Be(fn,t),Be(Mn,Mn.current),!0}function X_(t,e,n){var r=t.stateNode;if(!r)throw Error(J(169));n?(t=Wk(t,e,Oo),r.__reactInternalMemoizedMergedChildContext=t,Qe(Mn),Qe(fn),Be(fn,t)):Qe(Mn),Be(Mn,n)}var ps=null,Dp=!1,Eg=!1;function Kk(t){ps===null?ps=[t]:ps.push(t)}function QD(t){Dp=!0,Kk(t)}function Ki(){if(!Eg&&ps!==null){Eg=!0;var t=0,e=Me;try{var n=ps;for(Me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ps=null,Dp=!1}catch(s){throw ps!==null&&(ps=ps.slice(t+1)),xk(Ox,Ki),s}finally{Me=e,Eg=!1}}return null}var Ra=[],Pa=0,rf=null,sf=0,lr=[],cr=0,Lo=null,ms=1,gs="";function lo(t,e){Ra[Pa++]=sf,Ra[Pa++]=rf,rf=t,sf=e}function Gk(t,e,n){lr[cr++]=ms,lr[cr++]=gs,lr[cr++]=Lo,Lo=t;var r=ms;t=gs;var s=32-kr(r)-1;r&=~(1<<s),n+=1;var i=32-kr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ms=1<<32-kr(e)+s|n<<s|r,gs=i+t}else ms=1<<i|n<<s|r,gs=t}function qx(t){t.return!==null&&(lo(t,1),Gk(t,1,0))}function Wx(t){for(;t===rf;)rf=Ra[--Pa],Ra[Pa]=null,sf=Ra[--Pa],Ra[Pa]=null;for(;t===Lo;)Lo=lr[--cr],lr[cr]=null,gs=lr[--cr],lr[cr]=null,ms=lr[--cr],lr[cr]=null}var Xn=null,Gn=null,Ye=!1,Sr=null;function Qk(t,e){var n=hr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Z_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xn=t,Gn=Ei(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xn=t,Gn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Lo!==null?{id:ms,overflow:gs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xn=t,Gn=null,!0):!1;default:return!1}}function Jy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Yy(t){if(Ye){var e=Gn;if(e){var n=e;if(!Z_(t,e)){if(Jy(t))throw Error(J(418));e=Ei(n.nextSibling);var r=Xn;e&&Z_(t,e)?Qk(r,n):(t.flags=t.flags&-4097|2,Ye=!1,Xn=t)}}else{if(Jy(t))throw Error(J(418));t.flags=t.flags&-4097|2,Ye=!1,Xn=t}}}function e1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xn=t}function Hd(t){if(t!==Xn)return!1;if(!Ye)return e1(t),Ye=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wy(t.type,t.memoizedProps)),e&&(e=Gn)){if(Jy(t))throw Jk(),Error(J(418));for(;e;)Qk(t,e),e=Ei(e.nextSibling)}if(e1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Gn=Ei(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Gn=null}}else Gn=Xn?Ei(t.stateNode.nextSibling):null;return!0}function Jk(){for(var t=Gn;t;)t=Ei(t.nextSibling)}function rl(){Gn=Xn=null,Ye=!1}function Kx(t){Sr===null?Sr=[t]:Sr.push(t)}var JD=Us.ReactCurrentBatchConfig;function lc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function qd(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function t1(t){var e=t._init;return e(t._payload)}function Yk(t){function e(v,_){if(t){var E=v.deletions;E===null?(v.deletions=[_],v.flags|=16):E.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function r(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function s(v,_){return v=Ni(v,_),v.index=0,v.sibling=null,v}function i(v,_,E){return v.index=E,t?(E=v.alternate,E!==null?(E=E.index,E<_?(v.flags|=2,_):E):(v.flags|=2,_)):(v.flags|=1048576,_)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,_,E,A){return _===null||_.tag!==6?(_=Ag(E,v.mode,A),_.return=v,_):(_=s(_,E),_.return=v,_)}function l(v,_,E,A){var P=E.type;return P===ka?d(v,_,E.props.children,A,E.key):_!==null&&(_.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ys&&t1(P)===_.type)?(A=s(_,E.props),A.ref=lc(v,_,E),A.return=v,A):(A=Ch(E.type,E.key,E.props,null,v.mode,A),A.ref=lc(v,_,E),A.return=v,A)}function u(v,_,E,A){return _===null||_.tag!==4||_.stateNode.containerInfo!==E.containerInfo||_.stateNode.implementation!==E.implementation?(_=jg(E,v.mode,A),_.return=v,_):(_=s(_,E.children||[]),_.return=v,_)}function d(v,_,E,A,P){return _===null||_.tag!==7?(_=ko(E,v.mode,A,P),_.return=v,_):(_=s(_,E),_.return=v,_)}function f(v,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Ag(""+_,v.mode,E),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Dd:return E=Ch(_.type,_.key,_.props,null,v.mode,E),E.ref=lc(v,null,_),E.return=v,E;case Ta:return _=jg(_,v.mode,E),_.return=v,_;case Ys:var A=_._init;return f(v,A(_._payload),E)}if(gc(_)||rc(_))return _=ko(_,v.mode,E,null),_.return=v,_;qd(v,_)}return null}function p(v,_,E,A){var P=_!==null?_.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return P!==null?null:a(v,_,""+E,A);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Dd:return E.key===P?l(v,_,E,A):null;case Ta:return E.key===P?u(v,_,E,A):null;case Ys:return P=E._init,p(v,_,P(E._payload),A)}if(gc(E)||rc(E))return P!==null?null:d(v,_,E,A,null);qd(v,E)}return null}function m(v,_,E,A,P){if(typeof A=="string"&&A!==""||typeof A=="number")return v=v.get(E)||null,a(_,v,""+A,P);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Dd:return v=v.get(A.key===null?E:A.key)||null,l(_,v,A,P);case Ta:return v=v.get(A.key===null?E:A.key)||null,u(_,v,A,P);case Ys:var M=A._init;return m(v,_,E,M(A._payload),P)}if(gc(A)||rc(A))return v=v.get(E)||null,d(_,v,A,P,null);qd(_,A)}return null}function g(v,_,E,A){for(var P=null,M=null,N=_,S=_=0,C=null;N!==null&&S<E.length;S++){N.index>S?(C=N,N=null):C=N.sibling;var j=p(v,N,E[S],A);if(j===null){N===null&&(N=C);break}t&&N&&j.alternate===null&&e(v,N),_=i(j,_,S),M===null?P=j:M.sibling=j,M=j,N=C}if(S===E.length)return n(v,N),Ye&&lo(v,S),P;if(N===null){for(;S<E.length;S++)N=f(v,E[S],A),N!==null&&(_=i(N,_,S),M===null?P=N:M.sibling=N,M=N);return Ye&&lo(v,S),P}for(N=r(v,N);S<E.length;S++)C=m(N,v,S,E[S],A),C!==null&&(t&&C.alternate!==null&&N.delete(C.key===null?S:C.key),_=i(C,_,S),M===null?P=C:M.sibling=C,M=C);return t&&N.forEach(function(D){return e(v,D)}),Ye&&lo(v,S),P}function x(v,_,E,A){var P=rc(E);if(typeof P!="function")throw Error(J(150));if(E=P.call(E),E==null)throw Error(J(151));for(var M=P=null,N=_,S=_=0,C=null,j=E.next();N!==null&&!j.done;S++,j=E.next()){N.index>S?(C=N,N=null):C=N.sibling;var D=p(v,N,j.value,A);if(D===null){N===null&&(N=C);break}t&&N&&D.alternate===null&&e(v,N),_=i(D,_,S),M===null?P=D:M.sibling=D,M=D,N=C}if(j.done)return n(v,N),Ye&&lo(v,S),P;if(N===null){for(;!j.done;S++,j=E.next())j=f(v,j.value,A),j!==null&&(_=i(j,_,S),M===null?P=j:M.sibling=j,M=j);return Ye&&lo(v,S),P}for(N=r(v,N);!j.done;S++,j=E.next())j=m(N,v,S,j.value,A),j!==null&&(t&&j.alternate!==null&&N.delete(j.key===null?S:j.key),_=i(j,_,S),M===null?P=j:M.sibling=j,M=j);return t&&N.forEach(function(R){return e(v,R)}),Ye&&lo(v,S),P}function w(v,_,E,A){if(typeof E=="object"&&E!==null&&E.type===ka&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Dd:e:{for(var P=E.key,M=_;M!==null;){if(M.key===P){if(P=E.type,P===ka){if(M.tag===7){n(v,M.sibling),_=s(M,E.props.children),_.return=v,v=_;break e}}else if(M.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ys&&t1(P)===M.type){n(v,M.sibling),_=s(M,E.props),_.ref=lc(v,M,E),_.return=v,v=_;break e}n(v,M);break}else e(v,M);M=M.sibling}E.type===ka?(_=ko(E.props.children,v.mode,A,E.key),_.return=v,v=_):(A=Ch(E.type,E.key,E.props,null,v.mode,A),A.ref=lc(v,_,E),A.return=v,v=A)}return o(v);case Ta:e:{for(M=E.key;_!==null;){if(_.key===M)if(_.tag===4&&_.stateNode.containerInfo===E.containerInfo&&_.stateNode.implementation===E.implementation){n(v,_.sibling),_=s(_,E.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=jg(E,v.mode,A),_.return=v,v=_}return o(v);case Ys:return M=E._init,w(v,_,M(E._payload),A)}if(gc(E))return g(v,_,E,A);if(rc(E))return x(v,_,E,A);qd(v,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,_!==null&&_.tag===6?(n(v,_.sibling),_=s(_,E),_.return=v,v=_):(n(v,_),_=Ag(E,v.mode,A),_.return=v,v=_),o(v)):n(v,_)}return w}var sl=Yk(!0),Xk=Yk(!1),of=Wi(null),af=null,Da=null,Gx=null;function Qx(){Gx=Da=af=null}function Jx(t){var e=of.current;Qe(of),t._currentValue=e}function Xy(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function qa(t,e){af=t,Gx=Da=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Dn=!0),t.firstContext=null)}function yr(t){var e=t._currentValue;if(Gx!==t)if(t={context:t,memoizedValue:e,next:null},Da===null){if(af===null)throw Error(J(308));Da=t,af.dependencies={lanes:0,firstContext:t}}else Da=Da.next=t;return e}var mo=null;function Yx(t){mo===null?mo=[t]:mo.push(t)}function Zk(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Yx(e)):(n.next=s.next,s.next=n),e.interleaved=n,Rs(t,r)}function Rs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xs=!1;function Xx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eN(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _s(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Si(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ce&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Rs(t,n)}return s=r.interleaved,s===null?(e.next=e,Yx(r)):(e.next=s.next,s.next=e),r.interleaved=e,Rs(t,n)}function _h(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Lx(t,n)}}function n1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function lf(t,e,n,r){var s=t.updateQueue;Xs=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,d=u=l=null,a=i;do{var p=a.lane,m=a.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,x=a;switch(p=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){f=g.call(m,f,p);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,p=typeof g=="function"?g.call(m,f,p):g,p==null)break e;f=at({},f,p);break e;case 2:Xs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,l=f):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(l=f),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Fo|=o,t.lanes=o,t.memoizedState=f}}function r1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var Ju={},qr=Wi(Ju),mu=Wi(Ju),gu=Wi(Ju);function go(t){if(t===Ju)throw Error(J(174));return t}function Zx(t,e){switch(Be(gu,e),Be(mu,t),Be(qr,Ju),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ry(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ry(e,t)}Qe(qr),Be(qr,e)}function il(){Qe(qr),Qe(mu),Qe(gu)}function tN(t){go(gu.current);var e=go(qr.current),n=Ry(e,t.type);e!==n&&(Be(mu,t),Be(qr,n))}function ev(t){mu.current===t&&(Qe(qr),Qe(mu))}var rt=Wi(0);function cf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Sg=[];function tv(){for(var t=0;t<Sg.length;t++)Sg[t]._workInProgressVersionPrimary=null;Sg.length=0}var Eh=Us.ReactCurrentDispatcher,Tg=Us.ReactCurrentBatchConfig,Vo=0,ot=null,Nt=null,Rt=null,uf=!1,Dc=!1,yu=0,YD=0;function sn(){throw Error(J(321))}function nv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ir(t[n],e[n]))return!1;return!0}function rv(t,e,n,r,s,i){if(Vo=i,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Eh.current=t===null||t.memoizedState===null?tM:nM,t=n(r,s),Dc){i=0;do{if(Dc=!1,yu=0,25<=i)throw Error(J(301));i+=1,Rt=Nt=null,e.updateQueue=null,Eh.current=rM,t=n(r,s)}while(Dc)}if(Eh.current=df,e=Nt!==null&&Nt.next!==null,Vo=0,Rt=Nt=ot=null,uf=!1,e)throw Error(J(300));return t}function sv(){var t=yu!==0;return yu=0,t}function Or(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?ot.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function xr(){if(Nt===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=Nt.next;var e=Rt===null?ot.memoizedState:Rt.next;if(e!==null)Rt=e,Nt=t;else{if(t===null)throw Error(J(310));Nt=t,t={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Rt===null?ot.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function xu(t,e){return typeof e=="function"?e(t):e}function kg(t){var e=xr(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=Nt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,u=i;do{var d=u.lane;if((Vo&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ot.lanes|=d,Fo|=d}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=a,Ir(r,e.memoizedState)||(Dn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,ot.lanes|=i,Fo|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ng(t){var e=xr(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ir(i,e.memoizedState)||(Dn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function nN(){}function rN(t,e){var n=ot,r=xr(),s=e(),i=!Ir(r.memoizedState,s);if(i&&(r.memoizedState=s,Dn=!0),r=r.queue,iv(oN.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,vu(9,iN.bind(null,n,r,s,e),void 0,null),Dt===null)throw Error(J(349));Vo&30||sN(n,e,s)}return s}function sN(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function iN(t,e,n,r){e.value=n,e.getSnapshot=r,aN(e)&&lN(t)}function oN(t,e,n){return n(function(){aN(e)&&lN(t)})}function aN(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ir(t,n)}catch{return!0}}function lN(t){var e=Rs(t,1);e!==null&&Nr(e,t,1,-1)}function s1(t){var e=Or();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xu,lastRenderedState:t},e.queue=t,t=t.dispatch=eM.bind(null,ot,t),[e.memoizedState,t]}function vu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function cN(){return xr().memoizedState}function Sh(t,e,n,r){var s=Or();ot.flags|=t,s.memoizedState=vu(1|e,n,void 0,r===void 0?null:r)}function Mp(t,e,n,r){var s=xr();r=r===void 0?null:r;var i=void 0;if(Nt!==null){var o=Nt.memoizedState;if(i=o.destroy,r!==null&&nv(r,o.deps)){s.memoizedState=vu(e,n,i,r);return}}ot.flags|=t,s.memoizedState=vu(1|e,n,i,r)}function i1(t,e){return Sh(8390656,8,t,e)}function iv(t,e){return Mp(2048,8,t,e)}function uN(t,e){return Mp(4,2,t,e)}function dN(t,e){return Mp(4,4,t,e)}function hN(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fN(t,e,n){return n=n!=null?n.concat([t]):null,Mp(4,4,hN.bind(null,e,t),n)}function ov(){}function pN(t,e){var n=xr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&nv(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function mN(t,e){var n=xr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&nv(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function gN(t,e,n){return Vo&21?(Ir(n,e)||(n=bk(),ot.lanes|=n,Fo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Dn=!0),t.memoizedState=n)}function XD(t,e){var n=Me;Me=n!==0&&4>n?n:4,t(!0);var r=Tg.transition;Tg.transition={};try{t(!1),e()}finally{Me=n,Tg.transition=r}}function yN(){return xr().memoizedState}function ZD(t,e,n){var r=ki(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xN(t))vN(e,n);else if(n=Zk(t,e,n,r),n!==null){var s=bn();Nr(n,t,r,s),wN(n,e,r)}}function eM(t,e,n){var r=ki(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xN(t))vN(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ir(a,o)){var l=e.interleaved;l===null?(s.next=s,Yx(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=Zk(t,e,s,r),n!==null&&(s=bn(),Nr(n,t,r,s),wN(n,e,r))}}function xN(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function vN(t,e){Dc=uf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function wN(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Lx(t,n)}}var df={readContext:yr,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},tM={readContext:yr,useCallback:function(t,e){return Or().memoizedState=[t,e===void 0?null:e],t},useContext:yr,useEffect:i1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Sh(4194308,4,hN.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Sh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sh(4,2,t,e)},useMemo:function(t,e){var n=Or();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Or();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ZD.bind(null,ot,t),[r.memoizedState,t]},useRef:function(t){var e=Or();return t={current:t},e.memoizedState=t},useState:s1,useDebugValue:ov,useDeferredValue:function(t){return Or().memoizedState=t},useTransition:function(){var t=s1(!1),e=t[0];return t=XD.bind(null,t[1]),Or().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ot,s=Or();if(Ye){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),Dt===null)throw Error(J(349));Vo&30||sN(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,i1(oN.bind(null,r,i,t),[t]),r.flags|=2048,vu(9,iN.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Or(),e=Dt.identifierPrefix;if(Ye){var n=gs,r=ms;n=(r&~(1<<32-kr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=yu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=YD++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nM={readContext:yr,useCallback:pN,useContext:yr,useEffect:iv,useImperativeHandle:fN,useInsertionEffect:uN,useLayoutEffect:dN,useMemo:mN,useReducer:kg,useRef:cN,useState:function(){return kg(xu)},useDebugValue:ov,useDeferredValue:function(t){var e=xr();return gN(e,Nt.memoizedState,t)},useTransition:function(){var t=kg(xu)[0],e=xr().memoizedState;return[t,e]},useMutableSource:nN,useSyncExternalStore:rN,useId:yN,unstable_isNewReconciler:!1},rM={readContext:yr,useCallback:pN,useContext:yr,useEffect:iv,useImperativeHandle:fN,useInsertionEffect:uN,useLayoutEffect:dN,useMemo:mN,useReducer:Ng,useRef:cN,useState:function(){return Ng(xu)},useDebugValue:ov,useDeferredValue:function(t){var e=xr();return Nt===null?e.memoizedState=t:gN(e,Nt.memoizedState,t)},useTransition:function(){var t=Ng(xu)[0],e=xr().memoizedState;return[t,e]},useMutableSource:nN,useSyncExternalStore:rN,useId:yN,unstable_isNewReconciler:!1};function _r(t,e){if(t&&t.defaultProps){e=at({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Zy(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:at({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Op={isMounted:function(t){return(t=t._reactInternals)?na(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=bn(),s=ki(t),i=_s(r,s);i.payload=e,n!=null&&(i.callback=n),e=Si(t,i,s),e!==null&&(Nr(e,t,s,r),_h(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=bn(),s=ki(t),i=_s(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Si(t,i,s),e!==null&&(Nr(e,t,s,r),_h(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bn(),r=ki(t),s=_s(n,r);s.tag=2,e!=null&&(s.callback=e),e=Si(t,s,r),e!==null&&(Nr(e,t,r,n),_h(e,t,r))}};function o1(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!du(n,r)||!du(s,i):!0}function bN(t,e,n){var r=!1,s=Vi,i=e.contextType;return typeof i=="object"&&i!==null?i=yr(i):(s=On(e)?Oo:fn.current,r=e.contextTypes,i=(r=r!=null)?nl(t,s):Vi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Op,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function a1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Op.enqueueReplaceState(e,e.state,null)}function e0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Xx(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=yr(i):(i=On(e)?Oo:fn.current,s.context=nl(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Zy(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Op.enqueueReplaceState(s,s.state,null),lf(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ol(t,e){try{var n="",r=e;do n+=jP(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Cg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function t0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var sM=typeof WeakMap=="function"?WeakMap:Map;function _N(t,e,n){n=_s(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ff||(ff=!0,d0=r),t0(t,e)},n}function EN(t,e,n){n=_s(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){t0(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){t0(t,e),typeof r!="function"&&(Ti===null?Ti=new Set([this]):Ti.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function l1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new sM;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=xM.bind(null,t,e,n),e.then(t,t))}function c1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function u1(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=_s(-1,1),e.tag=2,Si(n,e,1))),n.lanes|=1),t)}var iM=Us.ReactCurrentOwner,Dn=!1;function vn(t,e,n,r){e.child=t===null?Xk(e,null,n,r):sl(e,t.child,n,r)}function d1(t,e,n,r,s){n=n.render;var i=e.ref;return qa(e,s),r=rv(t,e,n,r,i,s),n=sv(),t!==null&&!Dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ps(t,e,s)):(Ye&&n&&qx(e),e.flags|=1,vn(t,e,r,s),e.child)}function h1(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!pv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,SN(t,e,i,r,s)):(t=Ch(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:du,n(o,r)&&t.ref===e.ref)return Ps(t,e,s)}return e.flags|=1,t=Ni(i,r),t.ref=e.ref,t.return=e,e.child=t}function SN(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(du(i,r)&&t.ref===e.ref)if(Dn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Dn=!0);else return e.lanes=t.lanes,Ps(t,e,s)}return n0(t,e,n,r,s)}function TN(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(Oa,$n),$n|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Be(Oa,$n),$n|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Be(Oa,$n),$n|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Be(Oa,$n),$n|=r;return vn(t,e,s,n),e.child}function kN(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function n0(t,e,n,r,s){var i=On(n)?Oo:fn.current;return i=nl(e,i),qa(e,s),n=rv(t,e,n,r,i,s),r=sv(),t!==null&&!Dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ps(t,e,s)):(Ye&&r&&qx(e),e.flags|=1,vn(t,e,n,s),e.child)}function f1(t,e,n,r,s){if(On(n)){var i=!0;nf(e)}else i=!1;if(qa(e,s),e.stateNode===null)Th(t,e),bN(e,n,r),e0(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=yr(u):(u=On(n)?Oo:fn.current,u=nl(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&a1(e,o,r,u),Xs=!1;var p=e.memoizedState;o.state=p,lf(e,r,o,s),l=e.memoizedState,a!==r||p!==l||Mn.current||Xs?(typeof d=="function"&&(Zy(e,n,d,r),l=e.memoizedState),(a=Xs||o1(e,n,a,r,p,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,eN(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:_r(e.type,a),o.props=u,f=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=yr(l):(l=On(n)?Oo:fn.current,l=nl(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&a1(e,o,r,l),Xs=!1,p=e.memoizedState,o.state=p,lf(e,r,o,s);var g=e.memoizedState;a!==f||p!==g||Mn.current||Xs?(typeof m=="function"&&(Zy(e,n,m,r),g=e.memoizedState),(u=Xs||o1(e,n,u,r,p,g,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return r0(t,e,n,r,i,s)}function r0(t,e,n,r,s,i){kN(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&X_(e,n,!1),Ps(t,e,i);r=e.stateNode,iM.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=sl(e,t.child,null,i),e.child=sl(e,null,a,i)):vn(t,e,a,i),e.memoizedState=r.state,s&&X_(e,n,!0),e.child}function NN(t){var e=t.stateNode;e.pendingContext?Y_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Y_(t,e.context,!1),Zx(t,e.containerInfo)}function p1(t,e,n,r,s){return rl(),Kx(s),e.flags|=256,vn(t,e,n,r),e.child}var s0={dehydrated:null,treeContext:null,retryLane:0};function i0(t){return{baseLanes:t,cachePool:null,transitions:null}}function CN(t,e,n){var r=e.pendingProps,s=rt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Be(rt,s&1),t===null)return Yy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Fp(o,r,0,null),t=ko(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=i0(n),e.memoizedState=s0,t):av(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return oM(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ni(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ni(a,i):(i=ko(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?i0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=s0,r}return i=t.child,t=i.sibling,r=Ni(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function av(t,e){return e=Fp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wd(t,e,n,r){return r!==null&&Kx(r),sl(e,t.child,null,n),t=av(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function oM(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Cg(Error(J(422))),Wd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Fp({mode:"visible",children:r.children},s,0,null),i=ko(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&sl(e,t.child,null,o),e.child.memoizedState=i0(o),e.memoizedState=s0,i);if(!(e.mode&1))return Wd(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(J(419)),r=Cg(i,r,void 0),Wd(t,e,o,r)}if(a=(o&t.childLanes)!==0,Dn||a){if(r=Dt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Rs(t,s),Nr(r,t,s,-1))}return fv(),r=Cg(Error(J(421))),Wd(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=vM.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Gn=Ei(s.nextSibling),Xn=e,Ye=!0,Sr=null,t!==null&&(lr[cr++]=ms,lr[cr++]=gs,lr[cr++]=Lo,ms=t.id,gs=t.overflow,Lo=e),e=av(e,r.children),e.flags|=4096,e)}function m1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Xy(t.return,e,n)}function Ig(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function IN(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(vn(t,e,r.children,n),r=rt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&m1(t,n,e);else if(t.tag===19)m1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Be(rt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&cf(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ig(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&cf(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ig(e,!0,n,null,i);break;case"together":Ig(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Th(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ps(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=Ni(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ni(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function aM(t,e,n){switch(e.tag){case 3:NN(e),rl();break;case 5:tN(e);break;case 1:On(e.type)&&nf(e);break;case 4:Zx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Be(of,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Be(rt,rt.current&1),e.flags|=128,null):n&e.child.childLanes?CN(t,e,n):(Be(rt,rt.current&1),t=Ps(t,e,n),t!==null?t.sibling:null);Be(rt,rt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return IN(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Be(rt,rt.current),r)break;return null;case 22:case 23:return e.lanes=0,TN(t,e,n)}return Ps(t,e,n)}var AN,o0,jN,RN;AN=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};o0=function(){};jN=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,go(qr.current);var i=null;switch(n){case"input":s=Cy(t,s),r=Cy(t,r),i=[];break;case"select":s=at({},s,{value:void 0}),r=at({},r,{value:void 0}),i=[];break;case"textarea":s=jy(t,s),r=jy(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ef)}Py(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(su.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(su.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&We("scroll",t),i||a===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};RN=function(t,e,n,r){n!==r&&(e.flags|=4)};function cc(t,e){if(!Ye)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function on(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function lM(t,e,n){var r=e.pendingProps;switch(Wx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(e),null;case 1:return On(e.type)&&tf(),on(e),null;case 3:return r=e.stateNode,il(),Qe(Mn),Qe(fn),tv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Hd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sr!==null&&(p0(Sr),Sr=null))),o0(t,e),on(e),null;case 5:ev(e);var s=go(gu.current);if(n=e.type,t!==null&&e.stateNode!=null)jN(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(J(166));return on(e),null}if(t=go(qr.current),Hd(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ur]=e,r[pu]=i,t=(e.mode&1)!==0,n){case"dialog":We("cancel",r),We("close",r);break;case"iframe":case"object":case"embed":We("load",r);break;case"video":case"audio":for(s=0;s<xc.length;s++)We(xc[s],r);break;case"source":We("error",r);break;case"img":case"image":case"link":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"input":S_(r,i),We("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},We("invalid",r);break;case"textarea":k_(r,i),We("invalid",r)}Py(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&$d(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&$d(r.textContent,a,t),s=["children",""+a]):su.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&We("scroll",r)}switch(n){case"input":Md(r),T_(r,i,!0);break;case"textarea":Md(r),N_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ef)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ok(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ur]=e,t[pu]=r,AN(t,e,!1,!1),e.stateNode=t;e:{switch(o=Dy(n,r),n){case"dialog":We("cancel",t),We("close",t),s=r;break;case"iframe":case"object":case"embed":We("load",t),s=r;break;case"video":case"audio":for(s=0;s<xc.length;s++)We(xc[s],t);s=r;break;case"source":We("error",t),s=r;break;case"img":case"image":case"link":We("error",t),We("load",t),s=r;break;case"details":We("toggle",t),s=r;break;case"input":S_(t,r),s=Cy(t,r),We("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=at({},r,{value:void 0}),We("invalid",t);break;case"textarea":k_(t,r),s=jy(t,r),We("invalid",t);break;default:s=r}Py(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?ck(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ak(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&iu(t,l):typeof l=="number"&&iu(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(su.hasOwnProperty(i)?l!=null&&i==="onScroll"&&We("scroll",t):l!=null&&jx(t,i,l,o))}switch(n){case"input":Md(t),T_(t,r,!1);break;case"textarea":Md(t),N_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Li(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?za(t,!!r.multiple,i,!1):r.defaultValue!=null&&za(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ef)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return on(e),null;case 6:if(t&&e.stateNode!=null)RN(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(J(166));if(n=go(gu.current),go(qr.current),Hd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ur]=e,(i=r.nodeValue!==n)&&(t=Xn,t!==null))switch(t.tag){case 3:$d(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$d(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ur]=e,e.stateNode=r}return on(e),null;case 13:if(Qe(rt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ye&&Gn!==null&&e.mode&1&&!(e.flags&128))Jk(),rl(),e.flags|=98560,i=!1;else if(i=Hd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(J(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(J(317));i[Ur]=e}else rl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;on(e),i=!1}else Sr!==null&&(p0(Sr),Sr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||rt.current&1?Ct===0&&(Ct=3):fv())),e.updateQueue!==null&&(e.flags|=4),on(e),null);case 4:return il(),o0(t,e),t===null&&hu(e.stateNode.containerInfo),on(e),null;case 10:return Jx(e.type._context),on(e),null;case 17:return On(e.type)&&tf(),on(e),null;case 19:if(Qe(rt),i=e.memoizedState,i===null)return on(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)cc(i,!1);else{if(Ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=cf(t),o!==null){for(e.flags|=128,cc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Be(rt,rt.current&1|2),e.child}t=t.sibling}i.tail!==null&&xt()>al&&(e.flags|=128,r=!0,cc(i,!1),e.lanes=4194304)}else{if(!r)if(t=cf(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),cc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ye)return on(e),null}else 2*xt()-i.renderingStartTime>al&&n!==1073741824&&(e.flags|=128,r=!0,cc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=xt(),e.sibling=null,n=rt.current,Be(rt,r?n&1|2:n&1),e):(on(e),null);case 22:case 23:return hv(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?$n&1073741824&&(on(e),e.subtreeFlags&6&&(e.flags|=8192)):on(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function cM(t,e){switch(Wx(e),e.tag){case 1:return On(e.type)&&tf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return il(),Qe(Mn),Qe(fn),tv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ev(e),null;case 13:if(Qe(rt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));rl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qe(rt),null;case 4:return il(),null;case 10:return Jx(e.type._context),null;case 22:case 23:return hv(),null;case 24:return null;default:return null}}var Kd=!1,un=!1,uM=typeof WeakSet=="function"?WeakSet:Set,ne=null;function Ma(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(t,e,r)}else n.current=null}function a0(t,e,n){try{n()}catch(r){ht(t,e,r)}}var g1=!1;function dM(t,e){if(Hy=Yh,t=Lk(),Hx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=t,p=null;t:for(;;){for(var m;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===t)break t;if(p===n&&++u===s&&(a=o),p===i&&++d===r&&(l=o),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(qy={focusedElem:t,selectionRange:n},Yh=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,w=g.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:_r(e.type,x),w);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(A){ht(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return g=g1,g1=!1,g}function Mc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&a0(e,n,i)}s=s.next}while(s!==r)}}function Lp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function l0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function PN(t){var e=t.alternate;e!==null&&(t.alternate=null,PN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ur],delete e[pu],delete e[Gy],delete e[KD],delete e[GD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function DN(t){return t.tag===5||t.tag===3||t.tag===4}function y1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||DN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function c0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ef));else if(r!==4&&(t=t.child,t!==null))for(c0(t,e,n),t=t.sibling;t!==null;)c0(t,e,n),t=t.sibling}function u0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(u0(t,e,n),t=t.sibling;t!==null;)u0(t,e,n),t=t.sibling}var $t=null,Er=!1;function Ks(t,e,n){for(n=n.child;n!==null;)MN(t,e,n),n=n.sibling}function MN(t,e,n){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(Ip,n)}catch{}switch(n.tag){case 5:un||Ma(n,e);case 6:var r=$t,s=Er;$t=null,Ks(t,e,n),$t=r,Er=s,$t!==null&&(Er?(t=$t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$t.removeChild(n.stateNode));break;case 18:$t!==null&&(Er?(t=$t,n=n.stateNode,t.nodeType===8?_g(t.parentNode,n):t.nodeType===1&&_g(t,n),cu(t)):_g($t,n.stateNode));break;case 4:r=$t,s=Er,$t=n.stateNode.containerInfo,Er=!0,Ks(t,e,n),$t=r,Er=s;break;case 0:case 11:case 14:case 15:if(!un&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&a0(n,e,o),s=s.next}while(s!==r)}Ks(t,e,n);break;case 1:if(!un&&(Ma(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ht(n,e,a)}Ks(t,e,n);break;case 21:Ks(t,e,n);break;case 22:n.mode&1?(un=(r=un)||n.memoizedState!==null,Ks(t,e,n),un=r):Ks(t,e,n);break;default:Ks(t,e,n)}}function x1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new uM),e.forEach(function(r){var s=wM.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function br(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:$t=a.stateNode,Er=!1;break e;case 3:$t=a.stateNode.containerInfo,Er=!0;break e;case 4:$t=a.stateNode.containerInfo,Er=!0;break e}a=a.return}if($t===null)throw Error(J(160));MN(i,o,s),$t=null,Er=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){ht(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ON(e,t),e=e.sibling}function ON(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(br(e,t),Mr(t),r&4){try{Mc(3,t,t.return),Lp(3,t)}catch(x){ht(t,t.return,x)}try{Mc(5,t,t.return)}catch(x){ht(t,t.return,x)}}break;case 1:br(e,t),Mr(t),r&512&&n!==null&&Ma(n,n.return);break;case 5:if(br(e,t),Mr(t),r&512&&n!==null&&Ma(n,n.return),t.flags&32){var s=t.stateNode;try{iu(s,"")}catch(x){ht(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&sk(s,i),Dy(a,o);var u=Dy(a,i);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?ck(s,f):d==="dangerouslySetInnerHTML"?ak(s,f):d==="children"?iu(s,f):jx(s,d,f,u)}switch(a){case"input":Iy(s,i);break;case"textarea":ik(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?za(s,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?za(s,!!i.multiple,i.defaultValue,!0):za(s,!!i.multiple,i.multiple?[]:"",!1))}s[pu]=i}catch(x){ht(t,t.return,x)}}break;case 6:if(br(e,t),Mr(t),r&4){if(t.stateNode===null)throw Error(J(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){ht(t,t.return,x)}}break;case 3:if(br(e,t),Mr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{cu(e.containerInfo)}catch(x){ht(t,t.return,x)}break;case 4:br(e,t),Mr(t);break;case 13:br(e,t),Mr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uv=xt())),r&4&&x1(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(un=(u=un)||d,br(e,t),un=u):br(e,t),Mr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ne=t,d=t.child;d!==null;){for(f=ne=d;ne!==null;){switch(p=ne,m=p.child,p.tag){case 0:case 11:case 14:case 15:Mc(4,p,p.return);break;case 1:Ma(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){ht(r,n,x)}}break;case 5:Ma(p,p.return);break;case 22:if(p.memoizedState!==null){w1(f);continue}}m!==null?(m.return=p,ne=m):w1(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=lk("display",o))}catch(x){ht(t,t.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){ht(t,t.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:br(e,t),Mr(t),r&4&&x1(t);break;case 21:break;default:br(e,t),Mr(t)}}function Mr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(DN(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(iu(s,""),r.flags&=-33);var i=y1(t);u0(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=y1(t);c0(t,a,o);break;default:throw Error(J(161))}}catch(l){ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hM(t,e,n){ne=t,LN(t)}function LN(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Kd;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||un;a=Kd;var u=un;if(Kd=o,(un=l)&&!u)for(ne=s;ne!==null;)o=ne,l=o.child,o.tag===22&&o.memoizedState!==null?b1(s):l!==null?(l.return=o,ne=l):b1(s);for(;i!==null;)ne=i,LN(i),i=i.sibling;ne=s,Kd=a,un=u}v1(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):v1(t)}}function v1(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:un||Lp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!un)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:_r(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&r1(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}r1(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&cu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}un||e.flags&512&&l0(e)}catch(p){ht(e,e.return,p)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function w1(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function b1(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lp(4,e)}catch(l){ht(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){ht(e,s,l)}}var i=e.return;try{l0(e)}catch(l){ht(e,i,l)}break;case 5:var o=e.return;try{l0(e)}catch(l){ht(e,o,l)}}}catch(l){ht(e,e.return,l)}if(e===t){ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ne=a;break}ne=e.return}}var fM=Math.ceil,hf=Us.ReactCurrentDispatcher,lv=Us.ReactCurrentOwner,pr=Us.ReactCurrentBatchConfig,Ce=0,Dt=null,Et=null,Jt=0,$n=0,Oa=Wi(0),Ct=0,wu=null,Fo=0,Vp=0,cv=0,Oc=null,jn=null,uv=0,al=1/0,ds=null,ff=!1,d0=null,Ti=null,Gd=!1,pi=null,pf=0,Lc=0,h0=null,kh=-1,Nh=0;function bn(){return Ce&6?xt():kh!==-1?kh:kh=xt()}function ki(t){return t.mode&1?Ce&2&&Jt!==0?Jt&-Jt:JD.transition!==null?(Nh===0&&(Nh=bk()),Nh):(t=Me,t!==0||(t=window.event,t=t===void 0?16:Ck(t.type)),t):1}function Nr(t,e,n,r){if(50<Lc)throw Lc=0,h0=null,Error(J(185));Ku(t,n,r),(!(Ce&2)||t!==Dt)&&(t===Dt&&(!(Ce&2)&&(Vp|=n),Ct===4&&ii(t,Jt)),Ln(t,r),n===1&&Ce===0&&!(e.mode&1)&&(al=xt()+500,Dp&&Ki()))}function Ln(t,e){var n=t.callbackNode;JP(t,e);var r=Jh(t,t===Dt?Jt:0);if(r===0)n!==null&&A_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&A_(n),e===1)t.tag===0?QD(_1.bind(null,t)):Kk(_1.bind(null,t)),qD(function(){!(Ce&6)&&Ki()}),n=null;else{switch(_k(r)){case 1:n=Ox;break;case 4:n=vk;break;case 16:n=Qh;break;case 536870912:n=wk;break;default:n=Qh}n=qN(n,VN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function VN(t,e){if(kh=-1,Nh=0,Ce&6)throw Error(J(327));var n=t.callbackNode;if(Wa()&&t.callbackNode!==n)return null;var r=Jh(t,t===Dt?Jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=mf(t,r);else{e=r;var s=Ce;Ce|=2;var i=UN();(Dt!==t||Jt!==e)&&(ds=null,al=xt()+500,To(t,e));do try{gM();break}catch(a){FN(t,a)}while(!0);Qx(),hf.current=i,Ce=s,Et!==null?e=0:(Dt=null,Jt=0,e=Ct)}if(e!==0){if(e===2&&(s=Fy(t),s!==0&&(r=s,e=f0(t,s))),e===1)throw n=wu,To(t,0),ii(t,r),Ln(t,xt()),n;if(e===6)ii(t,r);else{if(s=t.current.alternate,!(r&30)&&!pM(s)&&(e=mf(t,r),e===2&&(i=Fy(t),i!==0&&(r=i,e=f0(t,i))),e===1))throw n=wu,To(t,0),ii(t,r),Ln(t,xt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(J(345));case 2:co(t,jn,ds);break;case 3:if(ii(t,r),(r&130023424)===r&&(e=uv+500-xt(),10<e)){if(Jh(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){bn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ky(co.bind(null,t,jn,ds),e);break}co(t,jn,ds);break;case 4:if(ii(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-kr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=xt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fM(r/1960))-r,10<r){t.timeoutHandle=Ky(co.bind(null,t,jn,ds),r);break}co(t,jn,ds);break;case 5:co(t,jn,ds);break;default:throw Error(J(329))}}}return Ln(t,xt()),t.callbackNode===n?VN.bind(null,t):null}function f0(t,e){var n=Oc;return t.current.memoizedState.isDehydrated&&(To(t,e).flags|=256),t=mf(t,e),t!==2&&(e=jn,jn=n,e!==null&&p0(e)),t}function p0(t){jn===null?jn=t:jn.push.apply(jn,t)}function pM(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ir(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ii(t,e){for(e&=~cv,e&=~Vp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-kr(e),r=1<<n;t[n]=-1,e&=~r}}function _1(t){if(Ce&6)throw Error(J(327));Wa();var e=Jh(t,0);if(!(e&1))return Ln(t,xt()),null;var n=mf(t,e);if(t.tag!==0&&n===2){var r=Fy(t);r!==0&&(e=r,n=f0(t,r))}if(n===1)throw n=wu,To(t,0),ii(t,e),Ln(t,xt()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,co(t,jn,ds),Ln(t,xt()),null}function dv(t,e){var n=Ce;Ce|=1;try{return t(e)}finally{Ce=n,Ce===0&&(al=xt()+500,Dp&&Ki())}}function Uo(t){pi!==null&&pi.tag===0&&!(Ce&6)&&Wa();var e=Ce;Ce|=1;var n=pr.transition,r=Me;try{if(pr.transition=null,Me=1,t)return t()}finally{Me=r,pr.transition=n,Ce=e,!(Ce&6)&&Ki()}}function hv(){$n=Oa.current,Qe(Oa)}function To(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,HD(n)),Et!==null)for(n=Et.return;n!==null;){var r=n;switch(Wx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&tf();break;case 3:il(),Qe(Mn),Qe(fn),tv();break;case 5:ev(r);break;case 4:il();break;case 13:Qe(rt);break;case 19:Qe(rt);break;case 10:Jx(r.type._context);break;case 22:case 23:hv()}n=n.return}if(Dt=t,Et=t=Ni(t.current,null),Jt=$n=e,Ct=0,wu=null,cv=Vp=Fo=0,jn=Oc=null,mo!==null){for(e=0;e<mo.length;e++)if(n=mo[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}mo=null}return t}function FN(t,e){do{var n=Et;try{if(Qx(),Eh.current=df,uf){for(var r=ot.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}uf=!1}if(Vo=0,Rt=Nt=ot=null,Dc=!1,yu=0,lv.current=null,n===null||n.return===null){Ct=1,wu=e,Et=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Jt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=c1(o);if(m!==null){m.flags&=-257,u1(m,o,a,i,e),m.mode&1&&l1(i,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(l),e.updateQueue=x}else g.add(l);break e}else{if(!(e&1)){l1(i,u,e),fv();break e}l=Error(J(426))}}else if(Ye&&a.mode&1){var w=c1(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),u1(w,o,a,i,e),Kx(ol(l,a));break e}}i=l=ol(l,a),Ct!==4&&(Ct=2),Oc===null?Oc=[i]:Oc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=_N(i,l,e);n1(i,v);break e;case 1:a=l;var _=i.type,E=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Ti===null||!Ti.has(E)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=EN(i,a,e);n1(i,A);break e}}i=i.return}while(i!==null)}BN(n)}catch(P){e=P,Et===n&&n!==null&&(Et=n=n.return);continue}break}while(!0)}function UN(){var t=hf.current;return hf.current=df,t===null?df:t}function fv(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Dt===null||!(Fo&268435455)&&!(Vp&268435455)||ii(Dt,Jt)}function mf(t,e){var n=Ce;Ce|=2;var r=UN();(Dt!==t||Jt!==e)&&(ds=null,To(t,e));do try{mM();break}catch(s){FN(t,s)}while(!0);if(Qx(),Ce=n,hf.current=r,Et!==null)throw Error(J(261));return Dt=null,Jt=0,Ct}function mM(){for(;Et!==null;)zN(Et)}function gM(){for(;Et!==null&&!zP();)zN(Et)}function zN(t){var e=HN(t.alternate,t,$n);t.memoizedProps=t.pendingProps,e===null?BN(t):Et=e,lv.current=null}function BN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=cM(n,e),n!==null){n.flags&=32767,Et=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ct=6,Et=null;return}}else if(n=lM(n,e,$n),n!==null){Et=n;return}if(e=e.sibling,e!==null){Et=e;return}Et=e=t}while(e!==null);Ct===0&&(Ct=5)}function co(t,e,n){var r=Me,s=pr.transition;try{pr.transition=null,Me=1,yM(t,e,n,r)}finally{pr.transition=s,Me=r}return null}function yM(t,e,n,r){do Wa();while(pi!==null);if(Ce&6)throw Error(J(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(YP(t,i),t===Dt&&(Et=Dt=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gd||(Gd=!0,qN(Qh,function(){return Wa(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var o=Me;Me=1;var a=Ce;Ce|=4,lv.current=null,dM(t,n),ON(n,t),LD(qy),Yh=!!Hy,qy=Hy=null,t.current=n,hM(n),BP(),Ce=a,Me=o,pr.transition=i}else t.current=n;if(Gd&&(Gd=!1,pi=t,pf=s),i=t.pendingLanes,i===0&&(Ti=null),qP(n.stateNode),Ln(t,xt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ff)throw ff=!1,t=d0,d0=null,t;return pf&1&&t.tag!==0&&Wa(),i=t.pendingLanes,i&1?t===h0?Lc++:(Lc=0,h0=t):Lc=0,Ki(),null}function Wa(){if(pi!==null){var t=_k(pf),e=pr.transition,n=Me;try{if(pr.transition=null,Me=16>t?16:t,pi===null)var r=!1;else{if(t=pi,pi=null,pf=0,Ce&6)throw Error(J(331));var s=Ce;for(Ce|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ne=u;ne!==null;){var d=ne;switch(d.tag){case 0:case 11:case 15:Mc(8,d,i)}var f=d.child;if(f!==null)f.return=d,ne=f;else for(;ne!==null;){d=ne;var p=d.sibling,m=d.return;if(PN(d),d===u){ne=null;break}if(p!==null){p.return=m,ne=p;break}ne=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Mc(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ne=v;break e}ne=i.return}}var _=t.current;for(ne=_;ne!==null;){o=ne;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,ne=E;else e:for(o=_;ne!==null;){if(a=ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lp(9,a)}}catch(P){ht(a,a.return,P)}if(a===o){ne=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,ne=A;break e}ne=a.return}}if(Ce=s,Ki(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(Ip,t)}catch{}r=!0}return r}finally{Me=n,pr.transition=e}}return!1}function E1(t,e,n){e=ol(n,e),e=_N(t,e,1),t=Si(t,e,1),e=bn(),t!==null&&(Ku(t,1,e),Ln(t,e))}function ht(t,e,n){if(t.tag===3)E1(t,t,n);else for(;e!==null;){if(e.tag===3){E1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ti===null||!Ti.has(r))){t=ol(n,t),t=EN(e,t,1),e=Si(e,t,1),t=bn(),e!==null&&(Ku(e,1,t),Ln(e,t));break}}e=e.return}}function xM(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=bn(),t.pingedLanes|=t.suspendedLanes&n,Dt===t&&(Jt&n)===n&&(Ct===4||Ct===3&&(Jt&130023424)===Jt&&500>xt()-uv?To(t,0):cv|=n),Ln(t,e)}function $N(t,e){e===0&&(t.mode&1?(e=Vd,Vd<<=1,!(Vd&130023424)&&(Vd=4194304)):e=1);var n=bn();t=Rs(t,e),t!==null&&(Ku(t,e,n),Ln(t,n))}function vM(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$N(t,n)}function wM(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(e),$N(t,n)}var HN;HN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mn.current)Dn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Dn=!1,aM(t,e,n);Dn=!!(t.flags&131072)}else Dn=!1,Ye&&e.flags&1048576&&Gk(e,sf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Th(t,e),t=e.pendingProps;var s=nl(e,fn.current);qa(e,n),s=rv(null,e,r,t,s,n);var i=sv();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,On(r)?(i=!0,nf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Xx(e),s.updater=Op,e.stateNode=s,s._reactInternals=e,e0(e,r,t,n),e=r0(null,e,r,!0,i,n)):(e.tag=0,Ye&&i&&qx(e),vn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Th(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=_M(r),t=_r(r,t),s){case 0:e=n0(null,e,r,t,n);break e;case 1:e=f1(null,e,r,t,n);break e;case 11:e=d1(null,e,r,t,n);break e;case 14:e=h1(null,e,r,_r(r.type,t),n);break e}throw Error(J(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_r(r,s),n0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_r(r,s),f1(t,e,r,s,n);case 3:e:{if(NN(e),t===null)throw Error(J(387));r=e.pendingProps,i=e.memoizedState,s=i.element,eN(t,e),lf(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ol(Error(J(423)),e),e=p1(t,e,r,n,s);break e}else if(r!==s){s=ol(Error(J(424)),e),e=p1(t,e,r,n,s);break e}else for(Gn=Ei(e.stateNode.containerInfo.firstChild),Xn=e,Ye=!0,Sr=null,n=Xk(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(rl(),r===s){e=Ps(t,e,n);break e}vn(t,e,r,n)}e=e.child}return e;case 5:return tN(e),t===null&&Yy(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Wy(r,s)?o=null:i!==null&&Wy(r,i)&&(e.flags|=32),kN(t,e),vn(t,e,o,n),e.child;case 6:return t===null&&Yy(e),null;case 13:return CN(t,e,n);case 4:return Zx(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=sl(e,null,r,n):vn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_r(r,s),d1(t,e,r,s,n);case 7:return vn(t,e,e.pendingProps,n),e.child;case 8:return vn(t,e,e.pendingProps.children,n),e.child;case 12:return vn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Be(of,r._currentValue),r._currentValue=o,i!==null)if(Ir(i.value,o)){if(i.children===s.children&&!Mn.current){e=Ps(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=_s(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Xy(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(J(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Xy(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}vn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,qa(e,n),s=yr(s),r=r(s),e.flags|=1,vn(t,e,r,n),e.child;case 14:return r=e.type,s=_r(r,e.pendingProps),s=_r(r.type,s),h1(t,e,r,s,n);case 15:return SN(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:_r(r,s),Th(t,e),e.tag=1,On(r)?(t=!0,nf(e)):t=!1,qa(e,n),bN(e,r,s),e0(e,r,s,n),r0(null,e,r,!0,t,n);case 19:return IN(t,e,n);case 22:return TN(t,e,n)}throw Error(J(156,e.tag))};function qN(t,e){return xk(t,e)}function bM(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(t,e,n,r){return new bM(t,e,n,r)}function pv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _M(t){if(typeof t=="function")return pv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Px)return 11;if(t===Dx)return 14}return 2}function Ni(t,e){var n=t.alternate;return n===null?(n=hr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ch(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")pv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ka:return ko(n.children,s,i,e);case Rx:o=8,s|=8;break;case Sy:return t=hr(12,n,e,s|2),t.elementType=Sy,t.lanes=i,t;case Ty:return t=hr(13,n,e,s),t.elementType=Ty,t.lanes=i,t;case ky:return t=hr(19,n,e,s),t.elementType=ky,t.lanes=i,t;case tk:return Fp(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ZT:o=10;break e;case ek:o=9;break e;case Px:o=11;break e;case Dx:o=14;break e;case Ys:o=16,r=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=hr(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ko(t,e,n,r){return t=hr(7,t,r,e),t.lanes=n,t}function Fp(t,e,n,r){return t=hr(22,t,r,e),t.elementType=tk,t.lanes=n,t.stateNode={isHidden:!1},t}function Ag(t,e,n){return t=hr(6,t,null,e),t.lanes=n,t}function jg(t,e,n){return e=hr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function EM(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dg(0),this.expirationTimes=dg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dg(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mv(t,e,n,r,s,i,o,a,l){return t=new EM(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xx(i),t}function SM(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ta,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function WN(t){if(!t)return Vi;t=t._reactInternals;e:{if(na(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(On(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if(On(n))return Wk(t,n,e)}return e}function KN(t,e,n,r,s,i,o,a,l){return t=mv(n,r,!0,t,s,i,o,a,l),t.context=WN(null),n=t.current,r=bn(),s=ki(n),i=_s(r,s),i.callback=e??null,Si(n,i,s),t.current.lanes=s,Ku(t,s,r),Ln(t,r),t}function Up(t,e,n,r){var s=e.current,i=bn(),o=ki(s);return n=WN(n),e.context===null?e.context=n:e.pendingContext=n,e=_s(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Si(s,e,o),t!==null&&(Nr(t,s,o,i),_h(t,s,o)),o}function gf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function S1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gv(t,e){S1(t,e),(t=t.alternate)&&S1(t,e)}function TM(){return null}var GN=typeof reportError=="function"?reportError:function(t){console.error(t)};function yv(t){this._internalRoot=t}zp.prototype.render=yv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));Up(t,e,null,null)};zp.prototype.unmount=yv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Uo(function(){Up(null,t,null,null)}),e[js]=null}};function zp(t){this._internalRoot=t}zp.prototype.unstable_scheduleHydration=function(t){if(t){var e=Tk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<si.length&&e!==0&&e<si[n].priority;n++);si.splice(n,0,t),n===0&&Nk(t)}};function xv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function T1(){}function kM(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=gf(o);i.call(u)}}var o=KN(e,r,t,0,null,!1,!1,"",T1);return t._reactRootContainer=o,t[js]=o.current,hu(t.nodeType===8?t.parentNode:t),Uo(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=gf(l);a.call(u)}}var l=mv(t,0,!1,null,null,!1,!1,"",T1);return t._reactRootContainer=l,t[js]=l.current,hu(t.nodeType===8?t.parentNode:t),Uo(function(){Up(e,l,n,r)}),l}function $p(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=gf(o);a.call(l)}}Up(e,o,t,s)}else o=kM(n,e,t,s,r);return gf(o)}Ek=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=yc(e.pendingLanes);n!==0&&(Lx(e,n|1),Ln(e,xt()),!(Ce&6)&&(al=xt()+500,Ki()))}break;case 13:Uo(function(){var r=Rs(t,1);if(r!==null){var s=bn();Nr(r,t,1,s)}}),gv(t,1)}};Vx=function(t){if(t.tag===13){var e=Rs(t,134217728);if(e!==null){var n=bn();Nr(e,t,134217728,n)}gv(t,134217728)}};Sk=function(t){if(t.tag===13){var e=ki(t),n=Rs(t,e);if(n!==null){var r=bn();Nr(n,t,e,r)}gv(t,e)}};Tk=function(){return Me};kk=function(t,e){var n=Me;try{return Me=t,e()}finally{Me=n}};Oy=function(t,e,n){switch(e){case"input":if(Iy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Pp(r);if(!s)throw Error(J(90));rk(r),Iy(r,s)}}}break;case"textarea":ik(t,n);break;case"select":e=n.value,e!=null&&za(t,!!n.multiple,e,!1)}};hk=dv;fk=Uo;var NM={usingClientEntryPoint:!1,Events:[Qu,Aa,Pp,uk,dk,dv]},uc={findFiberByHostInstance:po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CM={bundleType:uc.bundleType,version:uc.version,rendererPackageName:uc.rendererPackageName,rendererConfig:uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Us.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gk(t),t===null?null:t.stateNode},findFiberByHostInstance:uc.findFiberByHostInstance||TM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qd.isDisabled&&Qd.supportsFiber)try{Ip=Qd.inject(CM),Hr=Qd}catch{}}tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NM;tr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xv(e))throw Error(J(200));return SM(t,e,null,n)};tr.createRoot=function(t,e){if(!xv(t))throw Error(J(299));var n=!1,r="",s=GN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=mv(t,1,!1,null,null,n,!1,r,s),t[js]=e.current,hu(t.nodeType===8?t.parentNode:t),new yv(e)};tr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=gk(e),t=t===null?null:t.stateNode,t};tr.flushSync=function(t){return Uo(t)};tr.hydrate=function(t,e,n){if(!Bp(e))throw Error(J(200));return $p(null,t,e,!0,n)};tr.hydrateRoot=function(t,e,n){if(!xv(t))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=GN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=KN(e,null,t,1,n??null,s,!1,i,o),t[js]=e.current,hu(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new zp(e)};tr.render=function(t,e,n){if(!Bp(e))throw Error(J(200));return $p(null,t,e,!1,n)};tr.unmountComponentAtNode=function(t){if(!Bp(t))throw Error(J(40));return t._reactRootContainer?(Uo(function(){$p(null,null,t,!1,function(){t._reactRootContainer=null,t[js]=null})}),!0):!1};tr.unstable_batchedUpdates=dv;tr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Bp(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return $p(t,e,n,!1,r)};tr.version="18.3.1-next-f1338f8080-20240426";function QN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(QN)}catch(t){console.error(t)}}QN(),QT.exports=tr;var JN=QT.exports;const YN=Sx(JN);var XN,k1=JN;XN=k1.createRoot,k1.hydrateRoot;/**
 * @remix-run/router v1.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bu(){return bu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bu.apply(this,arguments)}var mi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(mi||(mi={}));const N1="popstate";function IM(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return m0("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:yf(s)}return jM(e,n,null,t)}function wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ZN(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function AM(){return Math.random().toString(36).substr(2,8)}function C1(t,e){return{usr:t.state,key:t.key,idx:e}}function m0(t,e,n,r){return n===void 0&&(n=null),bu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Al(e):e,{state:n,key:e&&e.key||r||AM()})}function yf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Al(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function jM(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=mi.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(bu({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){a=mi.Pop;let w=d(),v=w==null?null:w-u;u=w,l&&l({action:a,location:x.location,delta:v})}function p(w,v){a=mi.Push;let _=m0(x.location,w,v);u=d()+1;let E=C1(_,u),A=x.createHref(_);try{o.pushState(E,"",A)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(A)}i&&l&&l({action:a,location:x.location,delta:1})}function m(w,v){a=mi.Replace;let _=m0(x.location,w,v);u=d();let E=C1(_,u),A=x.createHref(_);o.replaceState(E,"",A),i&&l&&l({action:a,location:x.location,delta:0})}function g(w){let v=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof w=="string"?w:yf(w);return _=_.replace(/ $/,"%20"),wt(v,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,v)}let x={get action(){return a},get location(){return t(s,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(N1,f),l=w,()=>{s.removeEventListener(N1,f),l=null}},createHref(w){return e(s,w)},createURL:g,encodeLocation(w){let v=g(w);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:m,go(w){return o.go(w)}};return x}var I1;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(I1||(I1={}));function RM(t,e,n){return n===void 0&&(n="/"),PM(t,e,n)}function PM(t,e,n,r){let s=typeof e=="string"?Al(e):e,i=vv(s.pathname||"/",n);if(i==null)return null;let o=eC(t);DM(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=WM(i);a=$M(o[l],u)}return a}function eC(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(wt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Ci([r,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),eC(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:zM(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of tC(i.path))s(i,o,l)}),e}function tC(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=tC(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function DM(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:BM(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const MM=/^:[\w-]+$/,OM=3,LM=2,VM=1,FM=10,UM=-2,A1=t=>t==="*";function zM(t,e){let n=t.split("/"),r=n.length;return n.some(A1)&&(r+=UM),e&&(r+=LM),n.filter(s=>!A1(s)).reduce((s,i)=>s+(MM.test(i)?OM:i===""?VM:FM),r)}function BM(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function $M(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",f=HM({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),p=l.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:Ci([i,f.pathname]),pathnameBase:JM(Ci([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=Ci([i,f.pathnameBase]))}return o}function HM(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=qM(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,d,f)=>{let{paramName:p,isOptional:m}=d;if(p==="*"){let x=a[f]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=a[f];return m&&!g?u[p]=void 0:u[p]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function qM(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),ZN(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function WM(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ZN(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function vv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function KM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Al(t):t;return{pathname:n?n.startsWith("/")?n:GM(n,e):e,search:YM(r),hash:XM(s)}}function GM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Rg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QM(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function wv(t,e){let n=QM(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function bv(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Al(t):(s=bu({},t),wt(!s.pathname||!s.pathname.includes("?"),Rg("?","pathname","search",s)),wt(!s.pathname||!s.pathname.includes("#"),Rg("#","pathname","hash",s)),wt(!s.search||!s.search.includes("#"),Rg("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}a=f>=0?e[f]:"/"}let l=KM(s,a),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Ci=t=>t.join("/").replace(/\/\/+/g,"/"),JM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,XM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ZM(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const nC=["post","put","patch","delete"];new Set(nC);const eO=["get",...nC];new Set(eO);/**
 * React Router v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _u(){return _u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_u.apply(this,arguments)}const _v=T.createContext(null),tO=T.createContext(null),Gi=T.createContext(null),Hp=T.createContext(null),zs=T.createContext({outlet:null,matches:[],isDataRoute:!1}),rC=T.createContext(null);function nO(t,e){let{relative:n}=e===void 0?{}:e;jl()||wt(!1);let{basename:r,navigator:s}=T.useContext(Gi),{hash:i,pathname:o,search:a}=iC(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Ci([r,o])),s.createHref({pathname:l,search:a,hash:i})}function jl(){return T.useContext(Hp)!=null}function Rl(){return jl()||wt(!1),T.useContext(Hp).location}function sC(t){T.useContext(Gi).static||T.useLayoutEffect(t)}function mn(){let{isDataRoute:t}=T.useContext(zs);return t?mO():rO()}function rO(){jl()||wt(!1);let t=T.useContext(_v),{basename:e,future:n,navigator:r}=T.useContext(Gi),{matches:s}=T.useContext(zs),{pathname:i}=Rl(),o=JSON.stringify(wv(s,n.v7_relativeSplatPath)),a=T.useRef(!1);return sC(()=>{a.current=!0}),T.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let f=bv(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Ci([e,f.pathname])),(d.replace?r.replace:r.push)(f,d.state,d)},[e,r,o,i,t])}function Pl(){let{matches:t}=T.useContext(zs),e=t[t.length-1];return e?e.params:{}}function iC(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=T.useContext(Gi),{matches:s}=T.useContext(zs),{pathname:i}=Rl(),o=JSON.stringify(wv(s,r.v7_relativeSplatPath));return T.useMemo(()=>bv(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function sO(t,e){return iO(t,e)}function iO(t,e,n,r){jl()||wt(!1);let{navigator:s,static:i}=T.useContext(Gi),{matches:o}=T.useContext(zs),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=Rl(),f;if(e){var p;let v=typeof e=="string"?Al(e):e;u==="/"||(p=v.pathname)!=null&&p.startsWith(u)||wt(!1),f=v}else f=d;let m=f.pathname||"/",g=m;if(u!=="/"){let v=u.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(v.length).join("/")}let x=RM(t,{pathname:g}),w=uO(x&&x.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:Ci([u,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:Ci([u,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r);return e&&w?T.createElement(Hp.Provider,{value:{location:_u({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:mi.Pop}},w):w}function oO(){let t=pO(),e=ZM(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),n?T.createElement("pre",{style:s},n):null,null)}const aO=T.createElement(oO,null);class lO extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?T.createElement(zs.Provider,{value:this.props.routeContext},T.createElement(rC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cO(t){let{routeContext:e,match:n,children:r}=t,s=T.useContext(_v);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),T.createElement(zs.Provider,{value:e},r)}function uO(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let d=o.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);d>=0||wt(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:m}=n,g=f.route.loader&&p[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,p)=>{let m,g=!1,x=null,w=null;n&&(m=a&&f.route.id?a[f.route.id]:void 0,x=f.route.errorElement||aO,l&&(u<0&&p===0?(gO("route-fallback"),g=!0,w=null):u===p&&(g=!0,w=f.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,p+1)),_=()=>{let E;return m?E=x:g?E=w:f.route.Component?E=T.createElement(f.route.Component,null):f.route.element?E=f.route.element:E=d,T.createElement(cO,{match:f,routeContext:{outlet:d,matches:v,isDataRoute:n!=null},children:E})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?T.createElement(lO,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:_(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):_()},null)}var oC=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(oC||{}),aC=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(aC||{});function dO(t){let e=T.useContext(_v);return e||wt(!1),e}function hO(t){let e=T.useContext(tO);return e||wt(!1),e}function fO(t){let e=T.useContext(zs);return e||wt(!1),e}function lC(t){let e=fO(),n=e.matches[e.matches.length-1];return n.route.id||wt(!1),n.route.id}function pO(){var t;let e=T.useContext(rC),n=hO(),r=lC();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function mO(){let{router:t}=dO(oC.UseNavigateStable),e=lC(aC.UseNavigateStable),n=T.useRef(!1);return sC(()=>{n.current=!0}),T.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,_u({fromRouteId:e},i)))},[t,e])}const j1={};function gO(t,e,n){j1[t]||(j1[t]=!0)}function yO(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function g0(t){let{to:e,replace:n,state:r,relative:s}=t;jl()||wt(!1);let{future:i,static:o}=T.useContext(Gi),{matches:a}=T.useContext(zs),{pathname:l}=Rl(),u=mn(),d=bv(e,wv(a,i.v7_relativeSplatPath),l,s==="path"),f=JSON.stringify(d);return T.useEffect(()=>u(JSON.parse(f),{replace:n,state:r,relative:s}),[u,f,s,n,r]),null}function tt(t){wt(!1)}function xO(t){let{basename:e="/",children:n=null,location:r,navigationType:s=mi.Pop,navigator:i,static:o=!1,future:a}=t;jl()&&wt(!1);let l=e.replace(/^\/*/,"/"),u=T.useMemo(()=>({basename:l,navigator:i,static:o,future:_u({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=Al(r));let{pathname:d="/",search:f="",hash:p="",state:m=null,key:g="default"}=r,x=T.useMemo(()=>{let w=vv(d,l);return w==null?null:{location:{pathname:w,search:f,hash:p,state:m,key:g},navigationType:s}},[l,d,f,p,m,g,s]);return x==null?null:T.createElement(Gi.Provider,{value:u},T.createElement(Hp.Provider,{children:n,value:x}))}function vO(t){let{children:e,location:n}=t;return sO(y0(e),n)}new Promise(()=>{});function y0(t,e){e===void 0&&(e=[]);let n=[];return T.Children.forEach(t,(r,s)=>{if(!T.isValidElement(r))return;let i=[...e,s];if(r.type===T.Fragment){n.push.apply(n,y0(r.props.children,i));return}r.type!==tt&&wt(!1),!r.props.index||!r.props.children||wt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=y0(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.29.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function x0(){return x0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},x0.apply(this,arguments)}function wO(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function bO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function _O(t,e){return t.button===0&&(!e||e==="_self")&&!bO(t)}const EO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],SO="6";try{window.__reactRouterVersion=SO}catch{}const TO="startTransition",R1=xP[TO];function kO(t){let{basename:e,children:n,future:r,window:s}=t,i=T.useRef();i.current==null&&(i.current=IM({window:s,v5Compat:!0}));let o=i.current,[a,l]=T.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=T.useCallback(f=>{u&&R1?R1(()=>l(f)):l(f)},[l,u]);return T.useLayoutEffect(()=>o.listen(d),[o,d]),T.useEffect(()=>yO(r),[r]),T.createElement(xO,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const NO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",CO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,De=T.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:u,preventScrollReset:d,viewTransition:f}=e,p=wO(e,EO),{basename:m}=T.useContext(Gi),g,x=!1;if(typeof u=="string"&&CO.test(u)&&(g=u,NO))try{let E=new URL(window.location.href),A=u.startsWith("//")?new URL(E.protocol+u):new URL(u),P=vv(A.pathname,m);A.origin===E.origin&&P!=null?u=P+A.search+A.hash:x=!0}catch{}let w=nO(u,{relative:s}),v=IO(u,{replace:o,state:a,target:l,preventScrollReset:d,relative:s,viewTransition:f});function _(E){r&&r(E),E.defaultPrevented||v(E)}return T.createElement("a",x0({},p,{href:g||w,onClick:x||i?r:_,ref:n,target:l}))});var P1;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(P1||(P1={}));var D1;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(D1||(D1={}));function IO(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=mn(),u=Rl(),d=iC(t,{relative:o});return T.useCallback(f=>{if(_O(f,n)){f.preventDefault();let p=r!==void 0?r:yf(u)===yf(d);l(t,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[u,l,d,r,s,n,t,i,o,a])}const AO=Object.prototype.toString;function jO(t,e){return AO.call(t)===`[object ${e}]`}function cC(t){return jO(t,"Object")}function Ev(t){return!!(t&&t.then&&typeof t.then=="function")}function Jd(t){return t&&t.Math==Math?t:void 0}const Cr=typeof globalThis=="object"&&Jd(globalThis)||typeof window=="object"&&Jd(window)||typeof self=="object"&&Jd(self)||typeof global=="object"&&Jd(global)||function(){return this}()||{};function uC(t,e,n){const r=n||Cr,s=r.__SENTRY__=r.__SENTRY__||{};return s[t]||(s[t]=e())}const dC=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,RO="Sentry Logger ",M1=["debug","info","warn","error","log","assert","trace"],O1={};function hC(t){if(!("console"in Cr))return t();const e=Cr.console,n={},r=Object.keys(O1);r.forEach(s=>{const i=O1[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function PO(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return dC?M1.forEach(n=>{e[n]=(...r)=>{t&&hC(()=>{Cr.console[n](`${RO}[${n}]:`,...r)})}}):M1.forEach(n=>{e[n]=()=>{}}),e}const ys=PO();function L1(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{dC&&ys.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function yo(t){return v0(t,new Map)}function v0(t,e){if(DO(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const s of Object.keys(t))typeof t[s]<"u"&&(r[s]=v0(t[s],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(s=>{r.push(v0(s,e))}),r}return t}function DO(t){if(!cC(t))return!1;try{const e=Object.getPrototypeOf(t).constructor.name;return!e||e==="Object"}catch{return!0}}function Wr(){const t=Cr,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(n()&15)>>r/4).toString(16))}function MO(t){return Array.isArray(t)?t:[t]}var hs;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const r=2;t[t.REJECTED=r]="REJECTED"})(hs||(hs={}));class Zs{constructor(e){Zs.prototype.__init.call(this),Zs.prototype.__init2.call(this),Zs.prototype.__init3.call(this),Zs.prototype.__init4.call(this),this._state=hs.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new Zs((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Zs((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}__init(){this._resolve=e=>{this._setResult(hs.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(hs.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===hs.PENDING){if(Ev(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===hs.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===hs.RESOLVED&&n[1](this._value),this._state===hs.REJECTED&&n[2](this._value),n[0]=!0)})}}}const fC=1e3;function Sv(){return Date.now()/fC}function OO(){const{performance:t}=Cr;if(!t||!t.now)return Sv;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/fC}const Eu=OO();(()=>{const{performance:t}=Cr;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=t.timing&&t.timing.navigationStart,l=typeof o=="number"?Math.abs(o+n-r):e,u=l<e;return i||u?s<=l?t.timeOrigin:o:r})();const Ih=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,pC="production";function LO(){return uC("globalEventProcessors",()=>[])}function w0(t,e,n,r=0){return new Zs((s,i)=>{const o=t[r];if(e===null||typeof o!="function")s(e);else{const a=o({...e},n);Ih&&o.id&&a===null&&ys.log(`Event processor "${o.id}" dropped event`),Ev(a)?a.then(l=>w0(t,l,n,r+1).then(s)).then(null,i):w0(t,a,n,r+1).then(s).then(null,i)}})}function VO(t){const e=Eu(),n={sid:Wr(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>UO(n)};return t&&qp(n,t),n}function qp(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Eu(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Wr()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function FO(t,e){let n={};t.status==="ok"&&(n={status:"exited"}),qp(t,n)}function UO(t){return yo({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}const zO=1;function BO(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,tags:a,origin:l}=Su(t);return yo({data:r,op:s,parent_span_id:i,span_id:e,status:o,tags:a,trace_id:n,origin:l})}function $O(t){return typeof t=="number"?V1(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?V1(t.getTime()):Eu()}function V1(t){return t>9999999999?t/1e3:t}function Su(t){return HO(t)?t.getSpanJSON():typeof t.toJSON=="function"?t.toJSON():{}}function HO(t){return typeof t.getSpanJSON=="function"}function mC(t){const{traceFlags:e}=t.spanContext();return!!(e&zO)}function qO(t){if(t)return WO(t)?{captureContext:t}:GO(t)?{captureContext:t}:t}function WO(t){return t instanceof No||typeof t=="function"}const KO=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function GO(t){return Object.keys(t).some(e=>KO.includes(e))}function QO(t,e){return Dl().captureException(t,qO(e))}function JO(...t){const e=Dl();if(t.length===2){const[n,r]=t;return n?e.withScope(()=>(e.getStackTop().scope=n,r(n))):e.withScope(r)}return e.withScope(t[0])}function F1(t,e){return JO(n=>(n.setSpan(t),e(n)))}function gC(){return Dl().getClient()}function Tv(){return Dl().getScope()}function yC(t){return t.transaction}function YO(t,e,n){const r=e.getOptions(),{publicKey:s}=e.getDsn()||{},{segment:i}=n&&n.getUser()||{},o=yo({environment:r.environment||pC,release:r.release,user_segment:i,public_key:s,trace_id:t});return e.emit&&e.emit("createDsc",o),o}function xC(t){const e=gC();if(!e)return{};const n=YO(Su(t).trace_id||"",e,Tv()),r=yC(t);if(!r)return n;const s=r&&r._frozenDynamicSamplingContext;if(s)return s;const{sampleRate:i,source:o}=r.metadata;i!=null&&(n.sample_rate=`${i}`);const a=Su(r);return o&&o!=="url"&&(n.transaction=a.description),n.sampled=String(mC(r)),e.emit&&e.emit("createDsc",n),n}function XO(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;ZO(t,e),r&&nL(t,r),rL(t,n),eL(t,s),tL(t,i)}function ZO(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e,l=yo(n);l&&Object.keys(l).length&&(t.extra={...l,...t.extra});const u=yo(r);u&&Object.keys(u).length&&(t.tags={...u,...t.tags});const d=yo(s);d&&Object.keys(d).length&&(t.user={...d,...t.user});const f=yo(i);f&&Object.keys(f).length&&(t.contexts={...f,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function eL(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function tL(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function nL(t,e){t.contexts={trace:BO(e),...t.contexts};const n=yC(e);if(n){t.sdkProcessingMetadata={dynamicSamplingContext:xC(e),...t.sdkProcessingMetadata};const r=Su(n).description;r&&(t.tags={transaction:r,...t.tags})}}function rL(t,e){t.fingerprint=t.fingerprint?MO(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}const sL=100;class No{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=U1()}static clone(e){return e?e.clone():new No}clone(){const e=new No;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&qp(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e;if(n instanceof No){const r=n.getScopeData();this._tags={...this._tags,...r.tags},this._extra={...this._extra,...r.extra},this._contexts={...this._contexts,...r.contexts},r.user&&Object.keys(r.user).length&&(this._user=r.user),r.level&&(this._level=r.level),r.fingerprint.length&&(this._fingerprint=r.fingerprint),n.getRequestSession()&&(this._requestSession=n.getRequestSession()),r.propagationContext&&(this._propagationContext=r.propagationContext)}else if(cC(n)){const r=e;this._tags={...this._tags,...r.tags},this._extra={...this._extra,...r.extra},this._contexts={...this._contexts,...r.contexts},r.user&&(this._user=r.user),r.level&&(this._level=r.level),r.fingerprint&&(this._fingerprint=r.fingerprint),r.requestSession&&(this._requestSession=r.requestSession),r.propagationContext&&(this._propagationContext=r.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=U1(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:sL;if(r<=0)return this;const s={timestamp:Sv(),...e},i=this._breadcrumbs;return i.push(s),this._breadcrumbs=i.length>r?i.slice(-r):i,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:n,_contexts:r,_tags:s,_extra:i,_user:o,_level:a,_fingerprint:l,_eventProcessors:u,_propagationContext:d,_sdkProcessingMetadata:f,_transactionName:p,_span:m}=this;return{breadcrumbs:e,attachments:n,contexts:r,tags:s,extra:i,user:o,level:a,fingerprint:l||[],eventProcessors:u,propagationContext:d,sdkProcessingMetadata:f,transactionName:p,span:m}}applyToEvent(e,n={},r=[]){XO(e,this.getScopeData());const s=[...r,...LO(),...this._eventProcessors];return w0(s,e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=n&&n.event_id?n.event_id:Wr();if(!this._client)return ys.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=r&&r.event_id?r.event_id:Wr();if(!this._client)return ys.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Wr();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(ys.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function U1(){return{traceId:Wr(),spanId:Wr().substring(16)}}const iL="7.120.3",vC=parseFloat(iL),oL=100;class wC{constructor(e,n,r,s=vC){this._version=s;let i;n?i=n:(i=new No,i.setClient(e));let o;r?o=r:(o=new No,o.setClient(e)),this._stack=[{scope:i}],e&&this.bindClient(e),this._isolationScope=o}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,n.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();let r;try{r=e(n)}catch(s){throw this.popScope(),s}return Ev(r)?r.then(s=>(this.popScope(),s),s=>{throw this.popScope(),s}):(this.popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const r=this._lastEventId=n&&n.event_id?n.event_id:Wr(),s=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:s,...n,event_id:r}),r}captureMessage(e,n,r){const s=this._lastEventId=r&&r.event_id?r.event_id:Wr(),i=new Error(e);return this.getScope().captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s}),s}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Wr();return e.type||(this._lastEventId=r),this.getScope().captureEvent(e,{...n,event_id:r}),r}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:r,client:s}=this.getStackTop();if(!s)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:o=oL}=s.getOptions&&s.getOptions()||{};if(o<=0)return;const l={timestamp:Sv(),...e},u=i?hC(()=>i(l,n)):l;u!==null&&(s.emit&&s.emit("beforeAddBreadcrumb",u,n),r.addBreadcrumb(u,o))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n),this.getIsolationScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n),this.getIsolationScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n),this.getIsolationScope().setContext(e,n)}configureScope(e){const{scope:n,client:r}=this.getStackTop();r&&e(n)}run(e){const n=z1(this);try{e(this)}finally{z1(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return Ih&&ys.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const r=this._callExtensionMethod("startTransaction",e,n);return Ih&&!r&&(this.getClient()?ys.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):ys.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,r=n.getSession();r&&FO(r),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:r}=this.getStackTop(),{release:s,environment:i=pC}=r&&r.getOptions()||{},{userAgent:o}=Cr.navigator||{},a=VO({release:s,environment:i,user:n.getUser(),...o&&{userAgent:o},...e}),l=n.getSession&&n.getSession();return l&&l.status==="ok"&&qp(l,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),r=e.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_callExtensionMethod(e,...n){const s=Wp().__SENTRY__;if(s&&s.extensions&&typeof s.extensions[e]=="function")return s.extensions[e].apply(this,n);Ih&&ys.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Wp(){return Cr.__SENTRY__=Cr.__SENTRY__||{extensions:{},hub:void 0},Cr}function z1(t){const e=Wp(),n=b0(e);return bC(e,t),n}function Dl(){const t=Wp();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return lL(t)}function aL(){return Dl().getIsolationScope()}function lL(t=Wp()){return(!cL(t)||b0(t).isOlderThan(vC))&&bC(t,new wC),b0(t)}function cL(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function b0(t){return uC("hub",()=>new wC,t)}function bC(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function _C(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=gC(),n=e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function Pg(t){if(!_C())return;const e=hL(t),n=Dl(),r=t.scope?t.scope.getSpan():uL();if(t.onlyIfParent&&!r)return;const o=(t.scope||Tv()).clone();return dL(n,{parentSpan:r,spanContext:e,forceTransaction:t.forceTransaction,scope:o})}function uL(){return Tv().getSpan()}function dL(t,{parentSpan:e,spanContext:n,forceTransaction:r,scope:s}){if(!_C())return;const i=aL();let o;if(e&&!r)o=e.startChild(n);else if(e){const a=xC(e),{traceId:l,spanId:u}=e.spanContext(),d=mC(e);o=t.startTransaction({traceId:l,parentSpanId:u,parentSampled:d,...n,metadata:{dynamicSamplingContext:a,...n.metadata}})}else{const{traceId:a,dsc:l,parentSpanId:u,sampled:d}={...i.getPropagationContext(),...s.getPropagationContext()};o=t.startTransaction({traceId:a,parentSpanId:u,parentSampled:d,...n,metadata:{dynamicSamplingContext:l,...n.metadata}})}return s.setSpan(o),mL(o,s,i),o}function hL(t){if(t.startTime){const e={...t};return e.startTimestamp=$O(t.startTime),delete e.startTime,e}return t}const fL="_sentryScope",pL="_sentryIsolationScope";function mL(t,e,n){t&&(L1(t,pL,n),L1(t,fL,e))}var EC={exports:{}},Le={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vt=typeof Symbol=="function"&&Symbol.for,kv=Vt?Symbol.for("react.element"):60103,Nv=Vt?Symbol.for("react.portal"):60106,Kp=Vt?Symbol.for("react.fragment"):60107,Gp=Vt?Symbol.for("react.strict_mode"):60108,Qp=Vt?Symbol.for("react.profiler"):60114,Jp=Vt?Symbol.for("react.provider"):60109,Yp=Vt?Symbol.for("react.context"):60110,Cv=Vt?Symbol.for("react.async_mode"):60111,Xp=Vt?Symbol.for("react.concurrent_mode"):60111,Zp=Vt?Symbol.for("react.forward_ref"):60112,em=Vt?Symbol.for("react.suspense"):60113,gL=Vt?Symbol.for("react.suspense_list"):60120,tm=Vt?Symbol.for("react.memo"):60115,nm=Vt?Symbol.for("react.lazy"):60116,yL=Vt?Symbol.for("react.block"):60121,xL=Vt?Symbol.for("react.fundamental"):60117,vL=Vt?Symbol.for("react.responder"):60118,wL=Vt?Symbol.for("react.scope"):60119;function rr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case kv:switch(t=t.type,t){case Cv:case Xp:case Kp:case Qp:case Gp:case em:return t;default:switch(t=t&&t.$$typeof,t){case Yp:case Zp:case nm:case tm:case Jp:return t;default:return e}}case Nv:return e}}}function SC(t){return rr(t)===Xp}Le.AsyncMode=Cv;Le.ConcurrentMode=Xp;Le.ContextConsumer=Yp;Le.ContextProvider=Jp;Le.Element=kv;Le.ForwardRef=Zp;Le.Fragment=Kp;Le.Lazy=nm;Le.Memo=tm;Le.Portal=Nv;Le.Profiler=Qp;Le.StrictMode=Gp;Le.Suspense=em;Le.isAsyncMode=function(t){return SC(t)||rr(t)===Cv};Le.isConcurrentMode=SC;Le.isContextConsumer=function(t){return rr(t)===Yp};Le.isContextProvider=function(t){return rr(t)===Jp};Le.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===kv};Le.isForwardRef=function(t){return rr(t)===Zp};Le.isFragment=function(t){return rr(t)===Kp};Le.isLazy=function(t){return rr(t)===nm};Le.isMemo=function(t){return rr(t)===tm};Le.isPortal=function(t){return rr(t)===Nv};Le.isProfiler=function(t){return rr(t)===Qp};Le.isStrictMode=function(t){return rr(t)===Gp};Le.isSuspense=function(t){return rr(t)===em};Le.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Kp||t===Xp||t===Qp||t===Gp||t===em||t===gL||typeof t=="object"&&t!==null&&(t.$$typeof===nm||t.$$typeof===tm||t.$$typeof===Jp||t.$$typeof===Yp||t.$$typeof===Zp||t.$$typeof===xL||t.$$typeof===vL||t.$$typeof===wL||t.$$typeof===yL)};Le.typeOf=rr;EC.exports=Le;var bL=EC.exports,Iv=bL,_L={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},EL={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},SL={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},TC={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Av={};Av[Iv.ForwardRef]=SL;Av[Iv.Memo]=TC;function B1(t){return Iv.isMemo(t)?TC:Av[t.$$typeof]||_L}var TL=Object.defineProperty,kL=Object.getOwnPropertyNames,$1=Object.getOwnPropertySymbols,NL=Object.getOwnPropertyDescriptor,CL=Object.getPrototypeOf,H1=Object.prototype;function kC(t,e,n){if(typeof e!="string"){if(H1){var r=CL(e);r&&r!==H1&&kC(t,r,n)}var s=kL(e);$1&&(s=s.concat($1(e)));for(var i=B1(t),o=B1(e),a=0;a<s.length;++a){var l=s[a];if(!EL[l]&&!(n&&n[l])&&!(o&&o[l])&&!(i&&i[l])){var u=NL(e,l);try{TL(t,l,u)}catch{}}}}return t}var IL=kC;const AL=Sx(IL),jL="ui.react.render",RL="ui.react.update",PL="ui.react.mount",q1="/home/runner/work/sentry-javascript/sentry-javascript/packages/react/src/profiler.tsx",DL="unknown";class NC extends T.Component{static __initStatic(){this.defaultProps={disabled:!1,includeRender:!0,includeUpdates:!0}}constructor(e){super(e);const{name:n,disabled:r=!1}=this.props;r||(this._mountSpan=Pg({name:`<${n}>`,onlyIfParent:!0,op:PL,origin:"auto.ui.react.profiler",attributes:{"ui.component_name":n}}))}componentDidMount(){this._mountSpan&&this._mountSpan.end()}shouldComponentUpdate({updateProps:e,includeUpdates:n=!0}){if(n&&this._mountSpan&&e!==this.props.updateProps){const r=Object.keys(e).filter(s=>e[s]!==this.props.updateProps[s]);if(r.length>0){const s=Eu();this._updateSpan=F1(this._mountSpan,()=>Pg({name:`<${this.props.name}>`,onlyIfParent:!0,op:RL,origin:"auto.ui.react.profiler",startTimestamp:s,attributes:{"ui.component_name":this.props.name,"ui.react.changed_props":r}}))}}return!0}componentDidUpdate(){this._updateSpan&&(this._updateSpan.end(),this._updateSpan=void 0)}componentWillUnmount(){const e=Eu(),{name:n,includeRender:r=!0}=this.props;if(this._mountSpan&&r){const s=Su(this._mountSpan).timestamp;F1(this._mountSpan,()=>{const i=Pg({onlyIfParent:!0,name:`<${n}>`,op:jL,origin:"auto.ui.react.profiler",startTimestamp:s,attributes:{"ui.component_name":n}});i&&i.end(e)})}}render(){return this.props.children}}NC.__initStatic();function ML(t,e){const n=t.displayName||t.name||DL,r=s=>T.createElement(NC,{...e,name:n,updateProps:s,__self:this,__source:{fileName:q1,lineNumber:159}},T.createElement(t,{...s,__self:this,__source:{fileName:q1,lineNumber:160}}));return r.displayName=`profiler(${n})`,AL(r,t),r}var W1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},OL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},IC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let p=(a&15)<<2|u>>6,m=u&63;l||(m=64,o||(p=64)),r.push(n[d],n[f],n[p],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(CC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):OL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||u==null||f==null)throw new LL;const p=i<<2|a>>4;if(r.push(p),u!==64){const m=a<<4&240|u>>2;if(r.push(m),f!==64){const g=u<<6&192|f;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class LL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const VL=function(t){const e=CC(t);return IC.encodeByteArray(e,!0)},xf=function(t){return VL(t).replace(/\./g,"")},AC=function(t){try{return IC.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=()=>FL().__FIREBASE_DEFAULTS__,zL=()=>{if(typeof process>"u"||typeof W1>"u")return;const t=W1.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&AC(t[1]);return e&&JSON.parse(e)},rm=()=>{try{return UL()||zL()||BL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},jC=t=>{var e,n;return(n=(e=rm())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},RC=t=>{const e=jC(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},PC=()=>{var t;return(t=rm())===null||t===void 0?void 0:t.config},DC=t=>{var e;return(e=rm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[xf(JSON.stringify(n)),xf(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function qL(){var t;const e=(t=rm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WL(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KL(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function GL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function QL(){const t=pn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function JL(){return!qL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function YL(){try{return typeof indexedDB=="object"}catch{return!1}}function XL(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL="FirebaseError";class ts extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=ZL,Object.setPrototypeOf(this,ts.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yu.prototype.create)}}class Yu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?e4(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ts(s,a,r)}}function e4(t,e){return t.replace(t4,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const t4=/\{\$([^}]+)}/g;function n4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(K1(i)&&K1(o)){if(!vf(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function K1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function vc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function wc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function r4(t,e){const n=new s4(t,e);return n.subscribe.bind(n)}class s4{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");i4(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Dg),s.error===void 0&&(s.error=Dg),s.complete===void 0&&(s.complete=Dg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function i4(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Dg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t){return t&&t._delegate?t._delegate:t}class Fi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new $L;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(l4(e))try{this.getOrInitializeService({instanceIdentifier:uo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=uo){return this.instances.has(e)}getOptions(e=uo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:a4(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=uo){return this.component?this.component.multipleInstances?e:uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function a4(t){return t===uo?void 0:t}function l4(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new o4(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ke||(ke={}));const u4={debug:ke.DEBUG,verbose:ke.VERBOSE,info:ke.INFO,warn:ke.WARN,error:ke.ERROR,silent:ke.SILENT},d4=ke.INFO,h4={[ke.DEBUG]:"log",[ke.VERBOSE]:"log",[ke.INFO]:"info",[ke.WARN]:"warn",[ke.ERROR]:"error"},f4=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=h4[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jv{constructor(e){this.name=e,this._logLevel=d4,this._logHandler=f4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?u4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ke.DEBUG,...e),this._logHandler(this,ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ke.VERBOSE,...e),this._logHandler(this,ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ke.INFO,...e),this._logHandler(this,ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ke.WARN,...e),this._logHandler(this,ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ke.ERROR,...e),this._logHandler(this,ke.ERROR,...e)}}const p4=(t,e)=>e.some(n=>t instanceof n);let G1,Q1;function m4(){return G1||(G1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function g4(){return Q1||(Q1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OC=new WeakMap,_0=new WeakMap,LC=new WeakMap,Mg=new WeakMap,Rv=new WeakMap;function y4(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ii(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&OC.set(n,t)}).catch(()=>{}),Rv.set(e,t),e}function x4(t){if(_0.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});_0.set(t,e)}let E0={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _0.get(t);if(e==="objectStoreNames")return t.objectStoreNames||LC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ii(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function v4(t){E0=t(E0)}function w4(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Og(this),e,...n);return LC.set(r,e.sort?e.sort():[e]),Ii(r)}:g4().includes(t)?function(...e){return t.apply(Og(this),e),Ii(OC.get(this))}:function(...e){return Ii(t.apply(Og(this),e))}}function b4(t){return typeof t=="function"?w4(t):(t instanceof IDBTransaction&&x4(t),p4(t,m4())?new Proxy(t,E0):t)}function Ii(t){if(t instanceof IDBRequest)return y4(t);if(Mg.has(t))return Mg.get(t);const e=b4(t);return e!==t&&(Mg.set(t,e),Rv.set(e,t)),e}const Og=t=>Rv.get(t);function _4(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Ii(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Ii(o.result),l.oldVersion,l.newVersion,Ii(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const E4=["get","getKey","getAll","getAllKeys","count"],S4=["put","add","delete","clear"],Lg=new Map;function J1(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Lg.get(e))return Lg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=S4.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||E4.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&l.done]))[0]};return Lg.set(e,i),i}v4(t=>({...t,get:(e,n,r)=>J1(e,n)||t.get(e,n,r),has:(e,n)=>!!J1(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(k4(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function k4(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const S0="@firebase/app",Y1="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds=new jv("@firebase/app"),N4="@firebase/app-compat",C4="@firebase/analytics-compat",I4="@firebase/analytics",A4="@firebase/app-check-compat",j4="@firebase/app-check",R4="@firebase/auth",P4="@firebase/auth-compat",D4="@firebase/database",M4="@firebase/data-connect",O4="@firebase/database-compat",L4="@firebase/functions",V4="@firebase/functions-compat",F4="@firebase/installations",U4="@firebase/installations-compat",z4="@firebase/messaging",B4="@firebase/messaging-compat",$4="@firebase/performance",H4="@firebase/performance-compat",q4="@firebase/remote-config",W4="@firebase/remote-config-compat",K4="@firebase/storage",G4="@firebase/storage-compat",Q4="@firebase/firestore",J4="@firebase/vertexai-preview",Y4="@firebase/firestore-compat",X4="firebase",Z4="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0="[DEFAULT]",eV={[S0]:"fire-core",[N4]:"fire-core-compat",[I4]:"fire-analytics",[C4]:"fire-analytics-compat",[j4]:"fire-app-check",[A4]:"fire-app-check-compat",[R4]:"fire-auth",[P4]:"fire-auth-compat",[D4]:"fire-rtdb",[M4]:"fire-data-connect",[O4]:"fire-rtdb-compat",[L4]:"fire-fn",[V4]:"fire-fn-compat",[F4]:"fire-iid",[U4]:"fire-iid-compat",[z4]:"fire-fcm",[B4]:"fire-fcm-compat",[$4]:"fire-perf",[H4]:"fire-perf-compat",[q4]:"fire-rc",[W4]:"fire-rc-compat",[K4]:"fire-gcs",[G4]:"fire-gcs-compat",[Q4]:"fire-fst",[Y4]:"fire-fst-compat",[J4]:"fire-vertex","fire-js":"fire-js",[X4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wf=new Map,tV=new Map,k0=new Map;function X1(t,e){try{t.container.addComponent(e)}catch(n){Ds.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function zo(t){const e=t.name;if(k0.has(e))return Ds.debug(`There were multiple attempts to register component ${e}.`),!1;k0.set(e,t);for(const n of wf.values())X1(n,t);for(const n of tV.values())X1(n,t);return!0}function sm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ai=new Yu("app","Firebase",nV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Fi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ai.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=Z4;function VC(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:T0,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ai.create("bad-app-name",{appName:String(s)});if(n||(n=PC()),!n)throw Ai.create("no-options");const i=wf.get(s);if(i){if(vf(n,i.options)&&vf(r,i.config))return i;throw Ai.create("duplicate-app",{appName:s})}const o=new c4(s);for(const l of k0.values())o.addComponent(l);const a=new rV(n,r,o);return wf.set(s,a),a}function Pv(t=T0){const e=wf.get(t);if(!e&&t===T0&&PC())return VC();if(!e)throw Ai.create("no-app",{appName:t});return e}function Kr(t,e,n){var r;let s=(r=eV[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ds.warn(a.join(" "));return}zo(new Fi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sV="firebase-heartbeat-database",iV=1,Tu="firebase-heartbeat-store";let Vg=null;function FC(){return Vg||(Vg=_4(sV,iV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Tu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ai.create("idb-open",{originalErrorMessage:t.message})})),Vg}async function oV(t){try{const n=(await FC()).transaction(Tu),r=await n.objectStore(Tu).get(UC(t));return await n.done,r}catch(e){if(e instanceof ts)Ds.warn(e.message);else{const n=Ai.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ds.warn(n.message)}}}async function Z1(t,e){try{const r=(await FC()).transaction(Tu,"readwrite");await r.objectStore(Tu).put(e,UC(t)),await r.done}catch(n){if(n instanceof ts)Ds.warn(n.message);else{const r=Ai.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ds.warn(r.message)}}}function UC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=1024,lV=30*24*60*60*1e3;class cV{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new dV(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=eE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=lV}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ds.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=eE(),{heartbeatsToSend:r,unsentEntries:s}=uV(this._heartbeatsCache.heartbeats),i=xf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Ds.warn(n),""}}}function eE(){return new Date().toISOString().substring(0,10)}function uV(t,e=aV){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),tE(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),tE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class dV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YL()?XL().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await oV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Z1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Z1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function tE(t){return xf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hV(t){zo(new Fi("platform-logger",e=>new T4(e),"PRIVATE")),zo(new Fi("heartbeat",e=>new cV(e),"PRIVATE")),Kr(S0,Y1,t),Kr(S0,Y1,"esm2017"),Kr("fire-js","")}hV("");var fV="firebase",pV="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kr(fV,pV,"app");function Dv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function zC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mV=zC,BC=new Yu("auth","Firebase",zC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf=new jv("@firebase/auth");function gV(t,...e){bf.logLevel<=ke.WARN&&bf.warn(`Auth (${ra}): ${t}`,...e)}function Ah(t,...e){bf.logLevel<=ke.ERROR&&bf.error(`Auth (${ra}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t,...e){throw Mv(t,...e)}function Gr(t,...e){return Mv(t,...e)}function $C(t,e,n){const r=Object.assign(Object.assign({},mV()),{[e]:n});return new Yu("auth","Firebase",r).create(e,{appName:t.name})}function Es(t){return $C(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Mv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return BC.create(t,...e)}function de(t,e,...n){if(!t)throw Mv(e,...n)}function xs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ah(e),new Error(e)}function Ms(t,e){t||xs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function yV(){return nE()==="http:"||nE()==="https:"}function nE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yV()||KL()||"connection"in navigator)?navigator.onLine:!0}function vV(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ms(n>e,"Short delay should be less than long delay!"),this.isMobile=HL()||GL()}get(){return xV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(t,e){Ms(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV=new Zu(3e4,6e4);function Bs(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Dr(t,e,n,r,s={}){return qC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Xu(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},i);return WL()||(u.referrerPolicy="no-referrer"),HC.fetch()(WC(t,t.config.apiHost,n,a),u)})}async function qC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},wV),e);try{const s=new EV(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Yd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Yd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Yd(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw $C(t,d,u);Ar(t,d)}}catch(s){if(s instanceof ts)throw s;Ar(t,"network-request-failed",{message:String(s)})}}async function ed(t,e,n,r,s={}){const i=await Dr(t,e,n,r,s);return"mfaPendingCredential"in i&&Ar(t,"multi-factor-auth-required",{_serverResponse:i}),i}function WC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Ov(t.config,s):`${t.config.apiScheme}://${s}`}function _V(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class EV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Gr(this.auth,"network-request-failed")),bV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Gr(t,e,r);return s.customData._tokenResponse=n,s}function rE(t){return t!==void 0&&t.enterprise!==void 0}class SV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return _V(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function TV(t,e){return Dr(t,"GET","/v2/recaptchaConfig",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kV(t,e){return Dr(t,"POST","/v1/accounts:delete",e)}async function KC(t,e){return Dr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(t,e=!1){return Pe(t).getIdToken(e)}async function NV(t,e=!1){const n=Pe(t),r=await n.getIdToken(e),s=Lv(r);de(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Vc(Fg(s.auth_time)),issuedAtTime:Vc(Fg(s.iat)),expirationTime:Vc(Fg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Fg(t){return Number(t)*1e3}function Lv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ah("JWT malformed, contained fewer than 3 sections"),null;try{const s=AC(n);return s?JSON.parse(s):(Ah("Failed to decode base64 JWT payload"),null)}catch(s){return Ah("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function iE(t){const e=Lv(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ts&&CV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function CV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vc(this.lastLoginAt),this.creationTime=Vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _f(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Bo(t,KC(n,{idToken:r}));de(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?GC(i.providerUserInfo):[],a=jV(t.providerData,o),l=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new C0(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function AV(t){const e=Pe(t);await _f(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jV(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function GC(t){return t.map(e=>{var{providerId:n}=e,r=Dv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RV(t,e){const n=await qC(t,{},async()=>{const r=Xu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=WC(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",HC.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function PV(t,e){return Dr(t,"POST","/v2/accounts:revokeToken",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=iE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await RV(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ka;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ka,this.toJSON())}_performRefresh(){return xs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vs{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Dv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new IV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new C0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Bo(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return NV(this,e)}reload(){return AV(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new vs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await _f(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(Es(this.auth));const e=await this.getIdToken();return await Bo(this,kV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,u,d;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,w=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:E,emailVerified:A,isAnonymous:P,providerData:M,stsTokenManager:N}=n;de(E&&N,e,"internal-error");const S=Ka.fromJSON(this.name,N);de(typeof E=="string",e,"internal-error"),Gs(f,e.name),Gs(p,e.name),de(typeof A=="boolean",e,"internal-error"),de(typeof P=="boolean",e,"internal-error"),Gs(m,e.name),Gs(g,e.name),Gs(x,e.name),Gs(w,e.name),Gs(v,e.name),Gs(_,e.name);const C=new vs({uid:E,auth:e,email:p,emailVerified:A,displayName:f,isAnonymous:P,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:S,createdAt:v,lastLoginAt:_});return M&&Array.isArray(M)&&(C.providerData=M.map(j=>Object.assign({},j))),w&&(C._redirectEventId=w),C}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ka;s.updateFromServerResponse(n);const i=new vs({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await _f(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?GC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Ka;a.updateFromIdToken(r);const l=new vs({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new C0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=new Map;function ws(t){Ms(t instanceof Function,"Expected a class definition");let e=oE.get(t);return e?(Ms(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,oE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}QC.type="NONE";const aE=QC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(t,e,n){return`firebase:${t}:${e}:${n}`}class Ga{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=jh(this.userKey,s.apiKey,i),this.fullPersistenceKey=jh("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?vs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Ga(ws(aE),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||ws(aE);const o=jh(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const f=vs._fromJSON(e,d);u!==i&&(a=f),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ga(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Ga(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ZC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(JC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(tI(e))return"Blackberry";if(nI(e))return"Webos";if(YC(e))return"Safari";if((e.includes("chrome/")||XC(e))&&!e.includes("edge/"))return"Chrome";if(eI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function JC(t=pn()){return/firefox\//i.test(t)}function YC(t=pn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XC(t=pn()){return/crios\//i.test(t)}function ZC(t=pn()){return/iemobile/i.test(t)}function eI(t=pn()){return/android/i.test(t)}function tI(t=pn()){return/blackberry/i.test(t)}function nI(t=pn()){return/webos/i.test(t)}function Vv(t=pn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function DV(t=pn()){var e;return Vv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function MV(){return QL()&&document.documentMode===10}function rI(t=pn()){return Vv(t)||eI(t)||nI(t)||tI(t)||/windows phone/i.test(t)||ZC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(t,e=[]){let n;switch(t){case"Browser":n=lE(pn());break;case"Worker":n=`${lE(pn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ra}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LV(t,e={}){return Dr(t,"GET","/v2/passwordPolicy",Bs(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV=6;class FV{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:VV,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cE(this),this.idTokenSubscription=new cE(this),this.beforeStateQueue=new OV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ws(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Ga.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await KC(this,{idToken:e}),r=await vs._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(zr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await _f(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(Es(this));const n=e?Pe(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(Es(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(Es(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ws(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await LV(this),n=new FV(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Yu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await PV(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ws(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await Ga.create(this,[ws(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&gV(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Qi(t){return Pe(t)}class cE{constructor(e){this.auth=e,this.observer=null,this.addObserver=r4(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let im={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zV(t){im=t}function iI(t){return im.loadJS(t)}function BV(){return im.recaptchaEnterpriseScript}function $V(){return im.gapiScript}function HV(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const qV="recaptcha-enterprise",WV="NO_RECAPTCHA";class KV{constructor(e){this.type=qV,this.auth=Qi(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{TV(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new SV(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;rE(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(WV)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&rE(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=BV();l.length!==0&&(l+=a),iI(l).then(()=>{s(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function uE(t,e,n,r=!1){const s=new KV(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ef(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await uE(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await uE(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(t,e){const n=sm(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(vf(i,e??{}))return s;Ar(s,"already-initialized")}return n.initialize({options:e})}function QV(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ws);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function JV(t,e,n){const r=Qi(t);de(r._canInitEmulator,r,"emulator-config-failed"),de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=oI(e),{host:o,port:a}=YV(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),XV()}function oI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function YV(t){const e=oI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:dE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:dE(o)}}}function dE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function XV(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return xs("not implemented")}_getIdTokenResponse(e){return xs("not implemented")}_linkToIdToken(e,n){return xs("not implemented")}_getReauthenticationResolver(e){return xs("not implemented")}}async function ZV(t,e){return Dr(t,"POST","/v1/accounts:update",e)}async function e3(t,e){return Dr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t3(t,e){return ed(t,"POST","/v1/accounts:signInWithPassword",Bs(t,e))}async function n3(t,e){return Dr(t,"POST","/v1/accounts:sendOobCode",Bs(t,e))}async function r3(t,e){return n3(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s3(t,e){return ed(t,"POST","/v1/accounts:signInWithEmailLink",Bs(t,e))}async function i3(t,e){return ed(t,"POST","/v1/accounts:signInWithEmailLink",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends Fv{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ku(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ku(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ef(e,n,"signInWithPassword",t3);case"emailLink":return s3(e,{email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ef(e,r,"signUpPassword",e3);case"emailLink":return i3(e,{idToken:n,email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qa(t,e){return ed(t,"POST","/v1/accounts:signInWithIdp",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3="http://localhost";class $o extends Fv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $o(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ar("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Dv(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new $o(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Qa(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Qa(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Qa(e,n)}buildRequest(){const e={requestUri:o3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Xu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function l3(t){const e=vc(wc(t)).link,n=e?vc(wc(e)).deep_link_id:null,r=vc(wc(t)).deep_link_id;return(r?vc(wc(r)).link:null)||r||n||e||t}class Uv{constructor(e){var n,r,s,i,o,a;const l=vc(wc(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=a3((s=l.mode)!==null&&s!==void 0?s:null);de(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=l3(e);try{return new Uv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(){this.providerId=sa.PROVIDER_ID}static credential(e,n){return ku._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Uv.parseLink(n);return de(r,"argument-error"),ku._fromEmailAndCode(e,r.code,r.tenantId)}}sa.PROVIDER_ID="password";sa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";sa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends aI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends td{constructor(){super("facebook.com")}static credential(e){return $o._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.FACEBOOK_SIGN_IN_METHOD="facebook.com";oi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends td{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $o._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ai.credential(n,r)}catch{return null}}}ai.GOOGLE_SIGN_IN_METHOD="google.com";ai.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li extends td{constructor(){super("github.com")}static credential(e){return $o._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return li.credential(e.oauthAccessToken)}catch{return null}}}li.GITHUB_SIGN_IN_METHOD="github.com";li.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci extends td{constructor(){super("twitter.com")}static credential(e,n){return $o._fromParams({providerId:ci.PROVIDER_ID,signInMethod:ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ci.credentialFromTaggedObject(e)}static credentialFromError(e){return ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ci.credential(n,r)}catch{return null}}}ci.TWITTER_SIGN_IN_METHOD="twitter.com";ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c3(t,e){return ed(t,"POST","/v1/accounts:signUp",Bs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await vs._fromIdTokenResponse(e,r,s),o=hE(r);return new Ho({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=hE(r);return new Ho({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function hE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf extends ts{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Sf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Sf(e,n,r,s)}}function lI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Sf._fromErrorAndOperation(t,i,e,r):i})}async function u3(t,e,n=!1){const r=await Bo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ho._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cI(t,e,n=!1){const{auth:r}=t;if(zr(r.app))return Promise.reject(Es(r));const s="reauthenticate";try{const i=await Bo(t,lI(r,s,e,t),n);de(i.idToken,r,"internal-error");const o=Lv(i.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(t.uid===a,r,"user-mismatch"),Ho._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ar(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(t,e,n=!1){if(zr(t.app))return Promise.reject(Es(t));const r="signIn",s=await lI(t,r,e),i=await Ho._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function d3(t,e){return uI(Qi(t),e)}async function h3(t,e){return cI(Pe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dI(t){const e=Qi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function zv(t,e,n){const r=Qi(t);await Ef(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",r3)}async function Bv(t,e,n){if(zr(t.app))return Promise.reject(Es(t));const r=Qi(t),o=await Ef(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",c3).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&dI(t),l}),a=await Ho._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function f3(t,e,n){return zr(t.app)?Promise.reject(Es(t)):d3(Pe(t),sa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&dI(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p3(t,e){return Dr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tf(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Pe(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Bo(r,p3(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function m3(t,e){return g3(Pe(t),null,e)}async function g3(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await Bo(t,ZV(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y3(t,e){return Pe(t).setPersistence(e)}function x3(t,e,n,r){return Pe(t).onIdTokenChanged(e,n,r)}function v3(t,e,n){return Pe(t).beforeAuthStateChanged(e,n)}function w3(t,e,n,r){return Pe(t).onAuthStateChanged(e,n,r)}function b3(t){return Pe(t).signOut()}async function _3(t){return Pe(t).delete()}const kf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(kf,"1"),this.storage.removeItem(kf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=1e3,S3=10;class fI extends hI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);MV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,S3):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},E3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}fI.type="LOCAL";const pI=fI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI extends hI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}mI.type="SESSION";const gI=mI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new om(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(n.origin,i)),l=await T3(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}om.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=$v("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(){return window}function N3(t){Qr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(){return typeof Qr().WorkerGlobalScope<"u"&&typeof Qr().importScripts=="function"}async function C3(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function I3(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function A3(){return yI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI="firebaseLocalStorageDb",j3=1,Nf="firebaseLocalStorage",vI="fbase_key";class nd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function am(t,e){return t.transaction([Nf],e?"readwrite":"readonly").objectStore(Nf)}function R3(){const t=indexedDB.deleteDatabase(xI);return new nd(t).toPromise()}function I0(){const t=indexedDB.open(xI,j3);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Nf,{keyPath:vI})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Nf)?e(r):(r.close(),await R3(),e(await I0()))})})}async function fE(t,e,n){const r=am(t,!0).put({[vI]:e,value:n});return new nd(r).toPromise()}async function P3(t,e){const n=am(t,!1).get(e),r=await new nd(n).toPromise();return r===void 0?null:r.value}function pE(t,e){const n=am(t,!0).delete(e);return new nd(n).toPromise()}const D3=800,M3=3;class wI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await I0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>M3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=om._getInstance(A3()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await C3(),!this.activeServiceWorker)return;this.sender=new k3(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||I3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await I0();return await fE(e,kf,"1"),await pE(e,kf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>fE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>P3(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>pE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=am(s,!1).getAll();return new nd(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wI.type="LOCAL";const O3=wI;new Zu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L3(t,e){return e?ws(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv extends Fv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qa(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Qa(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Qa(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function V3(t){return uI(t.auth,new Hv(t),t.bypassAuthState)}function F3(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),cI(n,new Hv(t),t.bypassAuthState)}async function U3(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),u3(n,new Hv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return V3;case"linkViaPopup":case"linkViaRedirect":return U3;case"reauthViaPopup":case"reauthViaRedirect":return F3;default:Ar(this.auth,"internal-error")}}resolve(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=new Zu(2e3,1e4);class La extends bI{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,La.currentPopupAction&&La.currentPopupAction.cancel(),La.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){Ms(this.filter.length===1,"Popup operations only handle one event");const e=$v();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Gr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Gr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,La.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,z3.get())};e()}}La.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3="pendingRedirect",Rh=new Map;class $3 extends bI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Rh.get(this.auth._key());if(!e){try{const r=await H3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Rh.set(this.auth._key(),e)}return this.bypassAuthState||Rh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function H3(t,e){const n=K3(e),r=W3(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function q3(t,e){Rh.set(t._key(),e)}function W3(t){return ws(t._redirectPersistence)}function K3(t){return jh(B3,t.config.apiKey,t.name)}async function G3(t,e,n=!1){if(zr(t.app))return Promise.reject(Es(t));const r=Qi(t),s=L3(r,e),o=await new $3(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q3=10*60*1e3;class J3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Y3(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!_I(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Gr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Q3&&this.cachedEventUids.clear(),this.cachedEventUids.has(mE(e))}saveEventToCache(e){this.cachedEventUids.add(mE(e)),this.lastProcessedEventTime=Date.now()}}function mE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function _I({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Y3(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _I(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X3(t,e={}){return Dr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eF=/^https?/;async function tF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await X3(t);for(const n of e)try{if(nF(n))return}catch{}Ar(t,"unauthorized-domain")}function nF(t){const e=N0(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!eF.test(n))return!1;if(Z3.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rF=new Zu(3e4,6e4);function gE(){const t=Qr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function sF(t){return new Promise((e,n)=>{var r,s,i;function o(){gE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gE(),n(Gr(t,"network-request-failed"))},timeout:rF.get()})}if(!((s=(r=Qr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Qr().gapi)===null||i===void 0)&&i.load)o();else{const a=HV("iframefcb");return Qr()[a]=()=>{gapi.load?o():n(Gr(t,"network-request-failed"))},iI(`${$V()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ph=null,e})}let Ph=null;function iF(t){return Ph=Ph||sF(t),Ph}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=new Zu(5e3,15e3),aF="__/auth/iframe",lF="emulator/auth/iframe",cF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dF(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ov(e,lF):`https://${t.config.authDomain}/${aF}`,r={apiKey:e.apiKey,appName:t.name,v:ra},s=uF.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Xu(r).slice(1)}`}async function hF(t){const e=await iF(t),n=Qr().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:dF(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cF,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Gr(t,"network-request-failed"),a=Qr().setTimeout(()=>{i(o)},oF.get());function l(){Qr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pF=500,mF=600,gF="_blank",yF="http://localhost";class yE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xF(t,e,n,r=pF,s=mF){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},fF),{width:r.toString(),height:s.toString(),top:i,left:o}),u=pn().toLowerCase();n&&(a=XC(u)?gF:n),JC(u)&&(e=e||yF,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[m,g])=>`${p}${m}=${g},`,"");if(DV(u)&&a!=="_self")return vF(e||"",a),new yE(null);const f=window.open(e||"",a,d);de(f,t,"popup-blocked");try{f.focus()}catch{}return new yE(f)}function vF(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wF="__/auth/handler",bF="emulator/auth/handler",_F=encodeURIComponent("fac");async function xE(t,e,n,r,s,i){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ra,eventId:s};if(e instanceof aI){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",n4(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof td){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${_F}=${encodeURIComponent(l)}`:"";return`${EF(t)}?${Xu(a).slice(1)}${u}`}function EF({config:t}){return t.emulator?Ov(t,bF):`https://${t.authDomain}/${wF}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="webStorageSupport";class SF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gI,this._completeRedirectFn=G3,this._overrideRedirectResult=q3}async _openPopup(e,n,r,s){var i;Ms((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await xE(e,n,r,N0(),s);return xF(e,o,$v())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await xE(e,n,r,N0(),s);return N3(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ms(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await hF(e),r=new J3(e);return n.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ug,{type:Ug},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Ug];o!==void 0&&n(!!o),Ar(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=tF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return rI()||YC()||Vv()}}const TF=SF;var vE="@firebase/auth",wE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CF(t){zo(new Fi("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sI(t)},u=new UV(r,s,i,l);return QV(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),zo(new Fi("auth-internal",e=>{const n=Qi(e.getProvider("auth").getImmediate());return(r=>new kF(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Kr(vE,wE,NF(t)),Kr(vE,wE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=5*60,AF=DC("authIdTokenMaxAge")||IF;let bE=null;const jF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>AF)return;const s=n==null?void 0:n.token;bE!==s&&(bE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function EI(t=Pv()){const e=sm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=GV(t,{popupRedirectResolver:TF,persistence:[O3,pI,gI]}),r=DC("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=jF(i.toString());v3(n,o,()=>o(n.currentUser)),x3(n,a=>o(a))}}const s=jC("auth");return s&&JV(n,`http://${s}`),n}function RF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}zV({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Gr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",RF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CF("Browser");var _E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Co,SI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,S){function C(){}C.prototype=S.prototype,N.D=S.prototype,N.prototype=new C,N.prototype.constructor=N,N.C=function(j,D,R){for(var k=Array(arguments.length-2),z=2;z<arguments.length;z++)k[z-2]=arguments[z];return S.prototype[D].apply(j,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,S,C){C||(C=0);var j=Array(16);if(typeof S=="string")for(var D=0;16>D;++D)j[D]=S.charCodeAt(C++)|S.charCodeAt(C++)<<8|S.charCodeAt(C++)<<16|S.charCodeAt(C++)<<24;else for(D=0;16>D;++D)j[D]=S[C++]|S[C++]<<8|S[C++]<<16|S[C++]<<24;S=N.g[0],C=N.g[1],D=N.g[2];var R=N.g[3],k=S+(R^C&(D^R))+j[0]+3614090360&4294967295;S=C+(k<<7&4294967295|k>>>25),k=R+(D^S&(C^D))+j[1]+3905402710&4294967295,R=S+(k<<12&4294967295|k>>>20),k=D+(C^R&(S^C))+j[2]+606105819&4294967295,D=R+(k<<17&4294967295|k>>>15),k=C+(S^D&(R^S))+j[3]+3250441966&4294967295,C=D+(k<<22&4294967295|k>>>10),k=S+(R^C&(D^R))+j[4]+4118548399&4294967295,S=C+(k<<7&4294967295|k>>>25),k=R+(D^S&(C^D))+j[5]+1200080426&4294967295,R=S+(k<<12&4294967295|k>>>20),k=D+(C^R&(S^C))+j[6]+2821735955&4294967295,D=R+(k<<17&4294967295|k>>>15),k=C+(S^D&(R^S))+j[7]+4249261313&4294967295,C=D+(k<<22&4294967295|k>>>10),k=S+(R^C&(D^R))+j[8]+1770035416&4294967295,S=C+(k<<7&4294967295|k>>>25),k=R+(D^S&(C^D))+j[9]+2336552879&4294967295,R=S+(k<<12&4294967295|k>>>20),k=D+(C^R&(S^C))+j[10]+4294925233&4294967295,D=R+(k<<17&4294967295|k>>>15),k=C+(S^D&(R^S))+j[11]+2304563134&4294967295,C=D+(k<<22&4294967295|k>>>10),k=S+(R^C&(D^R))+j[12]+1804603682&4294967295,S=C+(k<<7&4294967295|k>>>25),k=R+(D^S&(C^D))+j[13]+4254626195&4294967295,R=S+(k<<12&4294967295|k>>>20),k=D+(C^R&(S^C))+j[14]+2792965006&4294967295,D=R+(k<<17&4294967295|k>>>15),k=C+(S^D&(R^S))+j[15]+1236535329&4294967295,C=D+(k<<22&4294967295|k>>>10),k=S+(D^R&(C^D))+j[1]+4129170786&4294967295,S=C+(k<<5&4294967295|k>>>27),k=R+(C^D&(S^C))+j[6]+3225465664&4294967295,R=S+(k<<9&4294967295|k>>>23),k=D+(S^C&(R^S))+j[11]+643717713&4294967295,D=R+(k<<14&4294967295|k>>>18),k=C+(R^S&(D^R))+j[0]+3921069994&4294967295,C=D+(k<<20&4294967295|k>>>12),k=S+(D^R&(C^D))+j[5]+3593408605&4294967295,S=C+(k<<5&4294967295|k>>>27),k=R+(C^D&(S^C))+j[10]+38016083&4294967295,R=S+(k<<9&4294967295|k>>>23),k=D+(S^C&(R^S))+j[15]+3634488961&4294967295,D=R+(k<<14&4294967295|k>>>18),k=C+(R^S&(D^R))+j[4]+3889429448&4294967295,C=D+(k<<20&4294967295|k>>>12),k=S+(D^R&(C^D))+j[9]+568446438&4294967295,S=C+(k<<5&4294967295|k>>>27),k=R+(C^D&(S^C))+j[14]+3275163606&4294967295,R=S+(k<<9&4294967295|k>>>23),k=D+(S^C&(R^S))+j[3]+4107603335&4294967295,D=R+(k<<14&4294967295|k>>>18),k=C+(R^S&(D^R))+j[8]+1163531501&4294967295,C=D+(k<<20&4294967295|k>>>12),k=S+(D^R&(C^D))+j[13]+2850285829&4294967295,S=C+(k<<5&4294967295|k>>>27),k=R+(C^D&(S^C))+j[2]+4243563512&4294967295,R=S+(k<<9&4294967295|k>>>23),k=D+(S^C&(R^S))+j[7]+1735328473&4294967295,D=R+(k<<14&4294967295|k>>>18),k=C+(R^S&(D^R))+j[12]+2368359562&4294967295,C=D+(k<<20&4294967295|k>>>12),k=S+(C^D^R)+j[5]+4294588738&4294967295,S=C+(k<<4&4294967295|k>>>28),k=R+(S^C^D)+j[8]+2272392833&4294967295,R=S+(k<<11&4294967295|k>>>21),k=D+(R^S^C)+j[11]+1839030562&4294967295,D=R+(k<<16&4294967295|k>>>16),k=C+(D^R^S)+j[14]+4259657740&4294967295,C=D+(k<<23&4294967295|k>>>9),k=S+(C^D^R)+j[1]+2763975236&4294967295,S=C+(k<<4&4294967295|k>>>28),k=R+(S^C^D)+j[4]+1272893353&4294967295,R=S+(k<<11&4294967295|k>>>21),k=D+(R^S^C)+j[7]+4139469664&4294967295,D=R+(k<<16&4294967295|k>>>16),k=C+(D^R^S)+j[10]+3200236656&4294967295,C=D+(k<<23&4294967295|k>>>9),k=S+(C^D^R)+j[13]+681279174&4294967295,S=C+(k<<4&4294967295|k>>>28),k=R+(S^C^D)+j[0]+3936430074&4294967295,R=S+(k<<11&4294967295|k>>>21),k=D+(R^S^C)+j[3]+3572445317&4294967295,D=R+(k<<16&4294967295|k>>>16),k=C+(D^R^S)+j[6]+76029189&4294967295,C=D+(k<<23&4294967295|k>>>9),k=S+(C^D^R)+j[9]+3654602809&4294967295,S=C+(k<<4&4294967295|k>>>28),k=R+(S^C^D)+j[12]+3873151461&4294967295,R=S+(k<<11&4294967295|k>>>21),k=D+(R^S^C)+j[15]+530742520&4294967295,D=R+(k<<16&4294967295|k>>>16),k=C+(D^R^S)+j[2]+3299628645&4294967295,C=D+(k<<23&4294967295|k>>>9),k=S+(D^(C|~R))+j[0]+4096336452&4294967295,S=C+(k<<6&4294967295|k>>>26),k=R+(C^(S|~D))+j[7]+1126891415&4294967295,R=S+(k<<10&4294967295|k>>>22),k=D+(S^(R|~C))+j[14]+2878612391&4294967295,D=R+(k<<15&4294967295|k>>>17),k=C+(R^(D|~S))+j[5]+4237533241&4294967295,C=D+(k<<21&4294967295|k>>>11),k=S+(D^(C|~R))+j[12]+1700485571&4294967295,S=C+(k<<6&4294967295|k>>>26),k=R+(C^(S|~D))+j[3]+2399980690&4294967295,R=S+(k<<10&4294967295|k>>>22),k=D+(S^(R|~C))+j[10]+4293915773&4294967295,D=R+(k<<15&4294967295|k>>>17),k=C+(R^(D|~S))+j[1]+2240044497&4294967295,C=D+(k<<21&4294967295|k>>>11),k=S+(D^(C|~R))+j[8]+1873313359&4294967295,S=C+(k<<6&4294967295|k>>>26),k=R+(C^(S|~D))+j[15]+4264355552&4294967295,R=S+(k<<10&4294967295|k>>>22),k=D+(S^(R|~C))+j[6]+2734768916&4294967295,D=R+(k<<15&4294967295|k>>>17),k=C+(R^(D|~S))+j[13]+1309151649&4294967295,C=D+(k<<21&4294967295|k>>>11),k=S+(D^(C|~R))+j[4]+4149444226&4294967295,S=C+(k<<6&4294967295|k>>>26),k=R+(C^(S|~D))+j[11]+3174756917&4294967295,R=S+(k<<10&4294967295|k>>>22),k=D+(S^(R|~C))+j[2]+718787259&4294967295,D=R+(k<<15&4294967295|k>>>17),k=C+(R^(D|~S))+j[9]+3951481745&4294967295,N.g[0]=N.g[0]+S&4294967295,N.g[1]=N.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,N.g[2]=N.g[2]+D&4294967295,N.g[3]=N.g[3]+R&4294967295}r.prototype.u=function(N,S){S===void 0&&(S=N.length);for(var C=S-this.blockSize,j=this.B,D=this.h,R=0;R<S;){if(D==0)for(;R<=C;)s(this,N,R),R+=this.blockSize;if(typeof N=="string"){for(;R<S;)if(j[D++]=N.charCodeAt(R++),D==this.blockSize){s(this,j),D=0;break}}else for(;R<S;)if(j[D++]=N[R++],D==this.blockSize){s(this,j),D=0;break}}this.h=D,this.o+=S},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var S=1;S<N.length-8;++S)N[S]=0;var C=8*this.o;for(S=N.length-8;S<N.length;++S)N[S]=C&255,C/=256;for(this.u(N),N=Array(16),S=C=0;4>S;++S)for(var j=0;32>j;j+=8)N[C++]=this.g[S]>>>j&255;return N};function i(N,S){var C=a;return Object.prototype.hasOwnProperty.call(C,N)?C[N]:C[N]=S(N)}function o(N,S){this.h=S;for(var C=[],j=!0,D=N.length-1;0<=D;D--){var R=N[D]|0;j&&R==S||(C[D]=R,j=!1)}this.g=C}var a={};function l(N){return-128<=N&&128>N?i(N,function(S){return new o([S|0],0>S?-1:0)}):new o([N|0],0>N?-1:0)}function u(N){if(isNaN(N)||!isFinite(N))return f;if(0>N)return w(u(-N));for(var S=[],C=1,j=0;N>=C;j++)S[j]=N/C|0,C*=4294967296;return new o(S,0)}function d(N,S){if(N.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(N.charAt(0)=="-")return w(d(N.substring(1),S));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=u(Math.pow(S,8)),j=f,D=0;D<N.length;D+=8){var R=Math.min(8,N.length-D),k=parseInt(N.substring(D,D+R),S);8>R?(R=u(Math.pow(S,R)),j=j.j(R).add(u(k))):(j=j.j(C),j=j.add(u(k)))}return j}var f=l(0),p=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-w(this).m();for(var N=0,S=1,C=0;C<this.g.length;C++){var j=this.i(C);N+=(0<=j?j:4294967296+j)*S,S*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(g(this))return"0";if(x(this))return"-"+w(this).toString(N);for(var S=u(Math.pow(N,6)),C=this,j="";;){var D=A(C,S).g;C=v(C,D.j(S));var R=((0<C.g.length?C.g[0]:C.h)>>>0).toString(N);if(C=D,g(C))return R+j;for(;6>R.length;)R="0"+R;j=R+j}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function g(N){if(N.h!=0)return!1;for(var S=0;S<N.g.length;S++)if(N.g[S]!=0)return!1;return!0}function x(N){return N.h==-1}t.l=function(N){return N=v(this,N),x(N)?-1:g(N)?0:1};function w(N){for(var S=N.g.length,C=[],j=0;j<S;j++)C[j]=~N.g[j];return new o(C,~N.h).add(p)}t.abs=function(){return x(this)?w(this):this},t.add=function(N){for(var S=Math.max(this.g.length,N.g.length),C=[],j=0,D=0;D<=S;D++){var R=j+(this.i(D)&65535)+(N.i(D)&65535),k=(R>>>16)+(this.i(D)>>>16)+(N.i(D)>>>16);j=k>>>16,R&=65535,k&=65535,C[D]=k<<16|R}return new o(C,C[C.length-1]&-2147483648?-1:0)};function v(N,S){return N.add(w(S))}t.j=function(N){if(g(this)||g(N))return f;if(x(this))return x(N)?w(this).j(w(N)):w(w(this).j(N));if(x(N))return w(this.j(w(N)));if(0>this.l(m)&&0>N.l(m))return u(this.m()*N.m());for(var S=this.g.length+N.g.length,C=[],j=0;j<2*S;j++)C[j]=0;for(j=0;j<this.g.length;j++)for(var D=0;D<N.g.length;D++){var R=this.i(j)>>>16,k=this.i(j)&65535,z=N.i(D)>>>16,O=N.i(D)&65535;C[2*j+2*D]+=k*O,_(C,2*j+2*D),C[2*j+2*D+1]+=R*O,_(C,2*j+2*D+1),C[2*j+2*D+1]+=k*z,_(C,2*j+2*D+1),C[2*j+2*D+2]+=R*z,_(C,2*j+2*D+2)}for(j=0;j<S;j++)C[j]=C[2*j+1]<<16|C[2*j];for(j=S;j<2*S;j++)C[j]=0;return new o(C,0)};function _(N,S){for(;(N[S]&65535)!=N[S];)N[S+1]+=N[S]>>>16,N[S]&=65535,S++}function E(N,S){this.g=N,this.h=S}function A(N,S){if(g(S))throw Error("division by zero");if(g(N))return new E(f,f);if(x(N))return S=A(w(N),S),new E(w(S.g),w(S.h));if(x(S))return S=A(N,w(S)),new E(w(S.g),S.h);if(30<N.g.length){if(x(N)||x(S))throw Error("slowDivide_ only works with positive integers.");for(var C=p,j=S;0>=j.l(N);)C=P(C),j=P(j);var D=M(C,1),R=M(j,1);for(j=M(j,2),C=M(C,2);!g(j);){var k=R.add(j);0>=k.l(N)&&(D=D.add(C),R=k),j=M(j,1),C=M(C,1)}return S=v(N,D.j(S)),new E(D,S)}for(D=f;0<=N.l(S);){for(C=Math.max(1,Math.floor(N.m()/S.m())),j=Math.ceil(Math.log(C)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),R=u(C),k=R.j(S);x(k)||0<k.l(N);)C-=j,R=u(C),k=R.j(S);g(R)&&(R=p),D=D.add(R),N=v(N,k)}return new E(D,N)}t.A=function(N){return A(this,N).h},t.and=function(N){for(var S=Math.max(this.g.length,N.g.length),C=[],j=0;j<S;j++)C[j]=this.i(j)&N.i(j);return new o(C,this.h&N.h)},t.or=function(N){for(var S=Math.max(this.g.length,N.g.length),C=[],j=0;j<S;j++)C[j]=this.i(j)|N.i(j);return new o(C,this.h|N.h)},t.xor=function(N){for(var S=Math.max(this.g.length,N.g.length),C=[],j=0;j<S;j++)C[j]=this.i(j)^N.i(j);return new o(C,this.h^N.h)};function P(N){for(var S=N.g.length+1,C=[],j=0;j<S;j++)C[j]=N.i(j)<<1|N.i(j-1)>>>31;return new o(C,N.h)}function M(N,S){var C=S>>5;S%=32;for(var j=N.g.length-C,D=[],R=0;R<j;R++)D[R]=0<S?N.i(R+C)>>>S|N.i(R+C+1)<<32-S:N.i(R+C);return new o(D,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,SI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Co=o}).apply(typeof _E<"u"?_E:typeof self<"u"?self:typeof window<"u"?window:{});var Xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var TI,bc,kI,Dh,A0,NI,CI,II;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,b){return h==Array.prototype||h==Object.prototype||(h[y]=b.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xd=="object"&&Xd];for(var y=0;y<h.length;++y){var b=h[y];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function s(h,y){if(y)e:{var b=r;h=h.split(".");for(var I=0;I<h.length-1;I++){var L=h[I];if(!(L in b))break e;b=b[L]}h=h[h.length-1],I=b[h],y=y(I),y!=I&&y!=null&&e(b,h,{configurable:!0,writable:!0,value:y})}}function i(h,y){h instanceof String&&(h+="");var b=0,I=!1,L={next:function(){if(!I&&b<h.length){var U=b++;return{value:y(U,h[U]),done:!1}}return I=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(h){return h||function(){return i(this,function(y,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function u(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function d(h,y,b){return h.call.apply(h.bind,arguments)}function f(h,y,b){if(!h)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,I),h.apply(y,L)}}return function(){return h.apply(y,arguments)}}function p(h,y,b){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function m(h,y){var b=Array.prototype.slice.call(arguments,1);return function(){var I=b.slice();return I.push.apply(I,arguments),h.apply(this,I)}}function g(h,y){function b(){}b.prototype=y.prototype,h.aa=y.prototype,h.prototype=new b,h.prototype.constructor=h,h.Qb=function(I,L,U){for(var Y=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)Y[Ve-2]=arguments[Ve];return y.prototype[L].apply(I,Y)}}function x(h){const y=h.length;if(0<y){const b=Array(y);for(let I=0;I<y;I++)b[I]=h[I];return b}return[]}function w(h,y){for(let b=1;b<arguments.length;b++){const I=arguments[b];if(l(I)){const L=h.length||0,U=I.length||0;h.length=L+U;for(let Y=0;Y<U;Y++)h[L+Y]=I[Y]}else h.push(I)}}class v{constructor(y,b){this.i=y,this.j=b,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function _(h){return/^[\s\xa0]*$/.test(h)}function E(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function A(h){return A[" "](h),h}A[" "]=function(){};var P=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function M(h,y,b){for(const I in h)y.call(b,h[I],I,h)}function N(h,y){for(const b in h)y.call(void 0,h[b],b,h)}function S(h){const y={};for(const b in h)y[b]=h[b];return y}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(h,y){let b,I;for(let L=1;L<arguments.length;L++){I=arguments[L];for(b in I)h[b]=I[b];for(let U=0;U<C.length;U++)b=C[U],Object.prototype.hasOwnProperty.call(I,b)&&(h[b]=I[b])}}function D(h){var y=1;h=h.split(":");const b=[];for(;0<y&&h.length;)b.push(h.shift()),y--;return h.length&&b.push(h.join(":")),b}function R(h){a.setTimeout(()=>{throw h},0)}function k(){var h=V;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class z{constructor(){this.h=this.g=null}add(y,b){const I=O.get();I.set(y,b),this.h?this.h.next=I:this.g=I,this.h=I}}var O=new v(()=>new W,h=>h.reset());class W{constructor(){this.next=this.g=this.h=null}set(y,b){this.h=y,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,B=!1,V=new z,$=()=>{const h=a.Promise.resolve(void 0);Z=()=>{h.then(F)}};var F=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(b){R(b)}var y=O;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}B=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var ge=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const b=()=>{};a.addEventListener("test",b,y),a.removeEventListener("test",b,y)}catch{}return h}();function Ie(h,y){if(X.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var b=this.type=h.type,I=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(P){e:{try{A(y.nodeName);var L=!0;break e}catch{}L=!1}L||(y=null)}}else b=="mouseover"?y=h.fromElement:b=="mouseout"&&(y=h.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ae[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Ie.aa.h.call(this)}}g(Ie,X);var ae={2:"touch",3:"pen",4:"mouse"};Ie.prototype.h=function(){Ie.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var oe="closure_listenable_"+(1e6*Math.random()|0),Te=0;function we(h,y,b,I,L){this.listener=h,this.proxy=null,this.src=y,this.type=b,this.capture=!!I,this.ha=L,this.key=++Te,this.da=this.fa=!1}function $e(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function He(h){this.src=h,this.g={},this.h=0}He.prototype.add=function(h,y,b,I,L){var U=h.toString();h=this.g[U],h||(h=this.g[U]=[],this.h++);var Y=Ut(h,y,I,L);return-1<Y?(y=h[Y],b||(y.fa=!1)):(y=new we(y,this.src,U,!!I,L),y.fa=b,h.push(y)),y};function ct(h,y){var b=y.type;if(b in h.g){var I=h.g[b],L=Array.prototype.indexOf.call(I,y,void 0),U;(U=0<=L)&&Array.prototype.splice.call(I,L,1),U&&($e(y),h.g[b].length==0&&(delete h.g[b],h.h--))}}function Ut(h,y,b,I){for(var L=0;L<h.length;++L){var U=h[L];if(!U.da&&U.listener==y&&U.capture==!!b&&U.ha==I)return L}return-1}var rs="closure_lm_"+(1e6*Math.random()|0),zl={};function Bl(h,y,b,I,L){if(Array.isArray(y)){for(var U=0;U<y.length;U++)Bl(h,y[U],b,I,L);return null}return b=sr(b),h&&h[oe]?h.K(y,b,u(I)?!!I.capture:!1,L):$m(h,y,b,!1,I,L)}function $m(h,y,b,I,L,U){if(!y)throw Error("Invalid event type");var Y=u(L)?!!L.capture:!!L,Ve=Ue(h);if(Ve||(h[rs]=Ve=new He(h)),b=Ve.add(y,b,I,Y,U),b.proxy)return b;if(I=yd(),b.proxy=I,I.src=h,I.listener=b,h.addEventListener)ge||(L=Y),L===void 0&&(L=!1),h.addEventListener(y.toString(),I,L);else if(h.attachEvent)h.attachEvent(le(y.toString()),I);else if(h.addListener&&h.removeListener)h.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return b}function yd(){function h(b){return y.call(h.src,h.listener,b)}const y=xe;return h}function $l(h,y,b,I,L){if(Array.isArray(y))for(var U=0;U<y.length;U++)$l(h,y[U],b,I,L);else I=u(I)?!!I.capture:!!I,b=sr(b),h&&h[oe]?(h=h.i,y=String(y).toString(),y in h.g&&(U=h.g[y],b=Ut(U,b,I,L),-1<b&&($e(U[b]),Array.prototype.splice.call(U,b,1),U.length==0&&(delete h.g[y],h.h--)))):h&&(h=Ue(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Ut(y,b,I,L)),(b=-1<h?y[h]:null)&&ua(b))}function ua(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[oe])ct(y.i,h);else{var b=h.type,I=h.proxy;y.removeEventListener?y.removeEventListener(b,I,h.capture):y.detachEvent?y.detachEvent(le(b),I):y.addListener&&y.removeListener&&y.removeListener(I),(b=Ue(y))?(ct(b,h),b.h==0&&(b.src=null,y[rs]=null)):$e(h)}}}function le(h){return h in zl?zl[h]:zl[h]="on"+h}function xe(h,y){if(h.da)h=!0;else{y=new Ie(y,this);var b=h.listener,I=h.ha||h.src;h.fa&&ua(h),h=b.call(I,y)}return h}function Ue(h){return h=h[rs],h instanceof He?h:null}var An="__closure_events_fn_"+(1e9*Math.random()>>>0);function sr(h){return typeof h=="function"?h:(h[An]||(h[An]=function(y){return h.handleEvent(y)}),h[An])}function Ze(){H.call(this),this.i=new He(this),this.M=this,this.F=null}g(Ze,H),Ze.prototype[oe]=!0,Ze.prototype.removeEventListener=function(h,y,b,I){$l(this,h,y,b,I)};function et(h,y){var b,I=h.F;if(I)for(b=[];I;I=I.F)b.push(I);if(h=h.M,I=y.type||y,typeof y=="string")y=new X(y,h);else if(y instanceof X)y.target=y.target||h;else{var L=y;y=new X(I,h),j(y,L)}if(L=!0,b)for(var U=b.length-1;0<=U;U--){var Y=y.g=b[U];L=da(Y,I,!0,y)&&L}if(Y=y.g=h,L=da(Y,I,!0,y)&&L,L=da(Y,I,!1,y)&&L,b)for(U=0;U<b.length;U++)Y=y.g=b[U],L=da(Y,I,!1,y)&&L}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var b=h.g[y],I=0;I<b.length;I++)$e(b[I]);delete h.g[y],h.h--}}this.F=null},Ze.prototype.K=function(h,y,b,I){return this.i.add(String(h),y,!1,b,I)},Ze.prototype.L=function(h,y,b,I){return this.i.add(String(h),y,!0,b,I)};function da(h,y,b,I){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var L=!0,U=0;U<y.length;++U){var Y=y[U];if(Y&&!Y.da&&Y.capture==b){var Ve=Y.listener,zt=Y.ha||Y.src;Y.fa&&ct(h.i,Y),L=Ve.call(zt,I)!==!1&&L}}return L&&!I.defaultPrevented}function $s(h,y,b){if(typeof h=="function")b&&(h=p(h,b));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:a.setTimeout(h,y||0)}function Sb(h){h.g=$s(()=>{h.g=null,h.i&&(h.i=!1,Sb(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class NR extends H{constructor(y,b){super(),this.m=y,this.l=b,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Sb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hl(h){H.call(this),this.h=h,this.g={}}g(Hl,H);var Tb=[];function kb(h){M(h.g,function(y,b){this.g.hasOwnProperty(b)&&ua(y)},h),h.g={}}Hl.prototype.N=function(){Hl.aa.N.call(this),kb(this)},Hl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hm=a.JSON.stringify,CR=a.JSON.parse,IR=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function qm(){}qm.prototype.h=null;function Nb(h){return h.h||(h.h=h.i())}function Cb(){}var ql={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Wm(){X.call(this,"d")}g(Wm,X);function Km(){X.call(this,"c")}g(Km,X);var ro={},Ib=null;function xd(){return Ib=Ib||new Ze}ro.La="serverreachability";function Ab(h){X.call(this,ro.La,h)}g(Ab,X);function Wl(h){const y=xd();et(y,new Ab(y))}ro.STAT_EVENT="statevent";function jb(h,y){X.call(this,ro.STAT_EVENT,h),this.stat=y}g(jb,X);function yn(h){const y=xd();et(y,new jb(y,h))}ro.Ma="timingevent";function Rb(h,y){X.call(this,ro.Ma,h),this.size=y}g(Rb,X);function Kl(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},y)}function Gl(){this.g=!0}Gl.prototype.xa=function(){this.g=!1};function AR(h,y,b,I,L,U){h.info(function(){if(h.g)if(U)for(var Y="",Ve=U.split("&"),zt=0;zt<Ve.length;zt++){var Ae=Ve[zt].split("=");if(1<Ae.length){var nn=Ae[0];Ae=Ae[1];var rn=nn.split("_");Y=2<=rn.length&&rn[1]=="type"?Y+(nn+"="+Ae+"&"):Y+(nn+"=redacted&")}}else Y=null;else Y=U;return"XMLHTTP REQ ("+I+") [attempt "+L+"]: "+y+`
`+b+`
`+Y})}function jR(h,y,b,I,L,U,Y){h.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+L+"]: "+y+`
`+b+`
`+U+" "+Y})}function ha(h,y,b,I){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+PR(h,b)+(I?" "+I:"")})}function RR(h,y){h.info(function(){return"TIMEOUT: "+y})}Gl.prototype.info=function(){};function PR(h,y){if(!h.g)return y;if(!y)return null;try{var b=JSON.parse(y);if(b){for(h=0;h<b.length;h++)if(Array.isArray(b[h])){var I=b[h];if(!(2>I.length)){var L=I[1];if(Array.isArray(L)&&!(1>L.length)){var U=L[0];if(U!="noop"&&U!="stop"&&U!="close")for(var Y=1;Y<L.length;Y++)L[Y]=""}}}}return Hm(b)}catch{return y}}var vd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pb={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Gm;function wd(){}g(wd,qm),wd.prototype.g=function(){return new XMLHttpRequest},wd.prototype.i=function(){return{}},Gm=new wd;function Hs(h,y,b,I){this.j=h,this.i=y,this.l=b,this.R=I||1,this.U=new Hl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Db}function Db(){this.i=null,this.g="",this.h=!1}var Mb={},Qm={};function Jm(h,y,b){h.L=1,h.v=Sd(ss(y)),h.m=b,h.P=!0,Ob(h,null)}function Ob(h,y){h.F=Date.now(),bd(h),h.A=ss(h.v);var b=h.A,I=h.R;Array.isArray(I)||(I=[String(I)]),Jb(b.i,"t",I),h.C=0,b=h.j.J,h.h=new Db,h.g=p_(h.j,b?y:null,!h.m),0<h.O&&(h.M=new NR(p(h.Y,h,h.g),h.O)),y=h.U,b=h.g,I=h.ca;var L="readystatechange";Array.isArray(L)||(L&&(Tb[0]=L.toString()),L=Tb);for(var U=0;U<L.length;U++){var Y=Bl(b,L[U],I||y.handleEvent,!1,y.h||y);if(!Y)break;y.g[Y.key]=Y}y=h.H?S(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),Wl(),AR(h.i,h.u,h.A,h.l,h.R,h.m)}Hs.prototype.ca=function(h){h=h.target;const y=this.M;y&&is(h)==3?y.j():this.Y(h)},Hs.prototype.Y=function(h){try{if(h==this.g)e:{const rn=is(this.g);var y=this.g.Ba();const ma=this.g.Z();if(!(3>rn)&&(rn!=3||this.g&&(this.h.h||this.g.oa()||r_(this.g)))){this.J||rn!=4||y==7||(y==8||0>=ma?Wl(3):Wl(2)),Ym(this);var b=this.g.Z();this.X=b;t:if(Lb(this)){var I=r_(this.g);h="";var L=I.length,U=is(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){so(this),Ql(this);var Y="";break t}this.h.i=new a.TextDecoder}for(y=0;y<L;y++)this.h.h=!0,h+=this.h.i.decode(I[y],{stream:!(U&&y==L-1)});I.length=0,this.h.g+=h,this.C=0,Y=this.h.g}else Y=this.g.oa();if(this.o=b==200,jR(this.i,this.u,this.A,this.l,this.R,rn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var Ve,zt=this.g;if((Ve=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Ve)){var Ae=Ve;break t}}Ae=null}if(b=Ae)ha(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xm(this,b);else{this.o=!1,this.s=3,yn(12),so(this),Ql(this);break e}}if(this.P){b=!0;let wr;for(;!this.J&&this.C<Y.length;)if(wr=DR(this,Y),wr==Qm){rn==4&&(this.s=4,yn(14),b=!1),ha(this.i,this.l,null,"[Incomplete Response]");break}else if(wr==Mb){this.s=4,yn(15),ha(this.i,this.l,Y,"[Invalid Chunk]"),b=!1;break}else ha(this.i,this.l,wr,null),Xm(this,wr);if(Lb(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rn!=4||Y.length!=0||this.h.h||(this.s=1,yn(16),b=!1),this.o=this.o&&b,!b)ha(this.i,this.l,Y,"[Invalid Chunked Response]"),so(this),Ql(this);else if(0<Y.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+Y.length),sg(nn),nn.M=!0,yn(11))}}else ha(this.i,this.l,Y,null),Xm(this,Y);rn==4&&so(this),this.o&&!this.J&&(rn==4?u_(this.j,this):(this.o=!1,bd(this)))}else YR(this.g),b==400&&0<Y.indexOf("Unknown SID")?(this.s=3,yn(12)):(this.s=0,yn(13)),so(this),Ql(this)}}}catch{}finally{}};function Lb(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function DR(h,y){var b=h.C,I=y.indexOf(`
`,b);return I==-1?Qm:(b=Number(y.substring(b,I)),isNaN(b)?Mb:(I+=1,I+b>y.length?Qm:(y=y.slice(I,I+b),h.C=I+b,y)))}Hs.prototype.cancel=function(){this.J=!0,so(this)};function bd(h){h.S=Date.now()+h.I,Vb(h,h.I)}function Vb(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Kl(p(h.ba,h),y)}function Ym(h){h.B&&(a.clearTimeout(h.B),h.B=null)}Hs.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(RR(this.i,this.A),this.L!=2&&(Wl(),yn(17)),so(this),this.s=2,Ql(this)):Vb(this,this.S-h)};function Ql(h){h.j.G==0||h.J||u_(h.j,h)}function so(h){Ym(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,kb(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Xm(h,y){try{var b=h.j;if(b.G!=0&&(b.g==h||Zm(b.h,h))){if(!h.K&&Zm(b.h,h)&&b.G==3){try{var I=b.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var L=I;if(L[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<h.F)Ad(b),Cd(b);else break e;rg(b),yn(18)}}else b.za=L[1],0<b.za-b.T&&37500>L[2]&&b.F&&b.v==0&&!b.C&&(b.C=Kl(p(b.Za,b),6e3));if(1>=zb(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else oo(b,11)}else if((h.K||b.g==h)&&Ad(b),!_(y))for(L=b.Da.g.parse(y),y=0;y<L.length;y++){let Ae=L[y];if(b.T=Ae[0],Ae=Ae[1],b.G==2)if(Ae[0]=="c"){b.K=Ae[1],b.ia=Ae[2];const nn=Ae[3];nn!=null&&(b.la=nn,b.j.info("VER="+b.la));const rn=Ae[4];rn!=null&&(b.Aa=rn,b.j.info("SVER="+b.Aa));const ma=Ae[5];ma!=null&&typeof ma=="number"&&0<ma&&(I=1.5*ma,b.L=I,b.j.info("backChannelRequestTimeoutMs_="+I)),I=b;const wr=h.g;if(wr){const Rd=wr.g?wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rd){var U=I.h;U.g||Rd.indexOf("spdy")==-1&&Rd.indexOf("quic")==-1&&Rd.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(eg(U,U.h),U.h=null))}if(I.D){const ig=wr.g?wr.g.getResponseHeader("X-HTTP-Session-Id"):null;ig&&(I.ya=ig,qe(I.I,I.D,ig))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-h.F,b.j.info("Handshake RTT: "+b.R+"ms")),I=b;var Y=h;if(I.qa=f_(I,I.J?I.ia:null,I.W),Y.K){Bb(I.h,Y);var Ve=Y,zt=I.L;zt&&(Ve.I=zt),Ve.B&&(Ym(Ve),bd(Ve)),I.g=Y}else l_(I);0<b.i.length&&Id(b)}else Ae[0]!="stop"&&Ae[0]!="close"||oo(b,7);else b.G==3&&(Ae[0]=="stop"||Ae[0]=="close"?Ae[0]=="stop"?oo(b,7):ng(b):Ae[0]!="noop"&&b.l&&b.l.ta(Ae),b.v=0)}}Wl(4)}catch{}}var MR=class{constructor(h,y){this.g=h,this.map=y}};function Fb(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ub(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function zb(h){return h.h?1:h.g?h.g.size:0}function Zm(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function eg(h,y){h.g?h.g.add(y):h.h=y}function Bb(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Fb.prototype.cancel=function(){if(this.i=$b(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function $b(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const b of h.g.values())y=y.concat(b.D);return y}return x(h.i)}function OR(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var y=[],b=h.length,I=0;I<b;I++)y.push(h[I]);return y}y=[],b=0;for(I in h)y[b++]=h[I];return y}function LR(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var y=[];h=h.length;for(var b=0;b<h;b++)y.push(b);return y}y=[],b=0;for(const I in h)y[b++]=I;return y}}}function Hb(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var b=LR(h),I=OR(h),L=I.length,U=0;U<L;U++)y.call(void 0,I[U],b&&b[U],h)}var qb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function VR(h,y){if(h){h=h.split("&");for(var b=0;b<h.length;b++){var I=h[b].indexOf("="),L=null;if(0<=I){var U=h[b].substring(0,I);L=h[b].substring(I+1)}else U=h[b];y(U,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function io(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof io){this.h=h.h,_d(this,h.j),this.o=h.o,this.g=h.g,Ed(this,h.s),this.l=h.l;var y=h.i,b=new Xl;b.i=y.i,y.g&&(b.g=new Map(y.g),b.h=y.h),Wb(this,b),this.m=h.m}else h&&(y=String(h).match(qb))?(this.h=!1,_d(this,y[1]||"",!0),this.o=Jl(y[2]||""),this.g=Jl(y[3]||"",!0),Ed(this,y[4]),this.l=Jl(y[5]||"",!0),Wb(this,y[6]||"",!0),this.m=Jl(y[7]||"")):(this.h=!1,this.i=new Xl(null,this.h))}io.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Yl(y,Kb,!0),":");var b=this.g;return(b||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Yl(y,Kb,!0),"@"),h.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&h.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&h.push("/"),h.push(Yl(b,b.charAt(0)=="/"?zR:UR,!0))),(b=this.i.toString())&&h.push("?",b),(b=this.m)&&h.push("#",Yl(b,$R)),h.join("")};function ss(h){return new io(h)}function _d(h,y,b){h.j=b?Jl(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ed(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function Wb(h,y,b){y instanceof Xl?(h.i=y,HR(h.i,h.h)):(b||(y=Yl(y,BR)),h.i=new Xl(y,h.h))}function qe(h,y,b){h.i.set(y,b)}function Sd(h){return qe(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Jl(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Yl(h,y,b){return typeof h=="string"?(h=encodeURI(h).replace(y,FR),b&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function FR(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Kb=/[#\/\?@]/g,UR=/[#\?:]/g,zR=/[#\?]/g,BR=/[#\?@]/g,$R=/#/g;function Xl(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function qs(h){h.g||(h.g=new Map,h.h=0,h.i&&VR(h.i,function(y,b){h.add(decodeURIComponent(y.replace(/\+/g," ")),b)}))}t=Xl.prototype,t.add=function(h,y){qs(this),this.i=null,h=fa(this,h);var b=this.g.get(h);return b||this.g.set(h,b=[]),b.push(y),this.h+=1,this};function Gb(h,y){qs(h),y=fa(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function Qb(h,y){return qs(h),y=fa(h,y),h.g.has(y)}t.forEach=function(h,y){qs(this),this.g.forEach(function(b,I){b.forEach(function(L){h.call(y,L,I,this)},this)},this)},t.na=function(){qs(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),b=[];for(let I=0;I<y.length;I++){const L=h[I];for(let U=0;U<L.length;U++)b.push(y[I])}return b},t.V=function(h){qs(this);let y=[];if(typeof h=="string")Qb(this,h)&&(y=y.concat(this.g.get(fa(this,h))));else{h=Array.from(this.g.values());for(let b=0;b<h.length;b++)y=y.concat(h[b])}return y},t.set=function(h,y){return qs(this),this.i=null,h=fa(this,h),Qb(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},t.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Jb(h,y,b){Gb(h,y),0<b.length&&(h.i=null,h.g.set(fa(h,y),x(b)),h.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var b=0;b<y.length;b++){var I=y[b];const U=encodeURIComponent(String(I)),Y=this.V(I);for(I=0;I<Y.length;I++){var L=U;Y[I]!==""&&(L+="="+encodeURIComponent(String(Y[I]))),h.push(L)}}return this.i=h.join("&")};function fa(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function HR(h,y){y&&!h.j&&(qs(h),h.i=null,h.g.forEach(function(b,I){var L=I.toLowerCase();I!=L&&(Gb(this,I),Jb(this,L,b))},h)),h.j=y}function qR(h,y){const b=new Gl;if(a.Image){const I=new Image;I.onload=m(Ws,b,"TestLoadImage: loaded",!0,y,I),I.onerror=m(Ws,b,"TestLoadImage: error",!1,y,I),I.onabort=m(Ws,b,"TestLoadImage: abort",!1,y,I),I.ontimeout=m(Ws,b,"TestLoadImage: timeout",!1,y,I),a.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=h}else y(!1)}function WR(h,y){const b=new Gl,I=new AbortController,L=setTimeout(()=>{I.abort(),Ws(b,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:I.signal}).then(U=>{clearTimeout(L),U.ok?Ws(b,"TestPingServer: ok",!0,y):Ws(b,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(L),Ws(b,"TestPingServer: error",!1,y)})}function Ws(h,y,b,I,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),I(b)}catch{}}function KR(){this.g=new IR}function GR(h,y,b){const I=b||"";try{Hb(h,function(L,U){let Y=L;u(L)&&(Y=Hm(L)),y.push(I+U+"="+encodeURIComponent(Y))})}catch(L){throw y.push(I+"type="+encodeURIComponent("_badmap")),L}}function Td(h){this.l=h.Ub||null,this.j=h.eb||!1}g(Td,qm),Td.prototype.g=function(){return new kd(this.l,this.j)},Td.prototype.i=function(h){return function(){return h}}({});function kd(h,y){Ze.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(kd,Ze),t=kd.prototype,t.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,ec(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||a).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zl(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ec(this)),this.g&&(this.readyState=3,ec(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Yb(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Yb(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Zl(this):ec(this),this.readyState==3&&Yb(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Zl(this))},t.Qa=function(h){this.g&&(this.response=h,Zl(this))},t.ga=function(){this.g&&Zl(this)};function Zl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ec(h)}t.setRequestHeader=function(h,y){this.u.append(h,y)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var b=y.next();!b.done;)b=b.value,h.push(b[0]+": "+b[1]),b=y.next();return h.join(`\r
`)};function ec(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(kd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Xb(h){let y="";return M(h,function(b,I){y+=I,y+=":",y+=b,y+=`\r
`}),y}function tg(h,y,b){e:{for(I in b){var I=!1;break e}I=!0}I||(b=Xb(b),typeof h=="string"?b!=null&&encodeURIComponent(String(b)):qe(h,y,b))}function ut(h){Ze.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(ut,Ze);var QR=/^https?$/i,JR=["POST","PUT"];t=ut.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,y,b,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Gm.g(),this.v=this.o?Nb(this.o):Nb(Gm),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(U){Zb(this,U);return}if(h=b||"",b=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var L in I)b.set(L,I[L]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const U of I.keys())b.set(U,I.get(U));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(b.keys()).find(U=>U.toLowerCase()=="content-type"),L=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(JR,y,void 0))||I||L||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,Y]of b)this.g.setRequestHeader(U,Y);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{n_(this),this.u=!0,this.g.send(h),this.u=!1}catch(U){Zb(this,U)}};function Zb(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,e_(h),Nd(h)}function e_(h){h.A||(h.A=!0,et(h,"complete"),et(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,et(this,"complete"),et(this,"abort"),Nd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nd(this,!0)),ut.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?t_(this):this.bb())},t.bb=function(){t_(this)};function t_(h){if(h.h&&typeof o<"u"&&(!h.v[1]||is(h)!=4||h.Z()!=2)){if(h.u&&is(h)==4)$s(h.Ea,0,h);else if(et(h,"readystatechange"),is(h)==4){h.h=!1;try{const Y=h.Z();e:switch(Y){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var b;if(!(b=y)){var I;if(I=Y===0){var L=String(h.D).match(qb)[1]||null;!L&&a.self&&a.self.location&&(L=a.self.location.protocol.slice(0,-1)),I=!QR.test(L?L.toLowerCase():"")}b=I}if(b)et(h,"complete"),et(h,"success");else{h.m=6;try{var U=2<is(h)?h.g.statusText:""}catch{U=""}h.l=U+" ["+h.Z()+"]",e_(h)}}finally{Nd(h)}}}}function Nd(h,y){if(h.g){n_(h);const b=h.g,I=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||et(h,"ready");try{b.onreadystatechange=I}catch{}}}function n_(h){h.I&&(a.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function is(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<is(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),CR(y)}};function r_(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function YR(h){const y={};h=(h.g&&2<=is(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<h.length;I++){if(_(h[I]))continue;var b=D(h[I]);const L=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const U=y[L]||[];y[L]=U,U.push(b)}N(y,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function tc(h,y,b){return b&&b.internalChannelParams&&b.internalChannelParams[h]||y}function s_(h){this.Aa=0,this.i=[],this.j=new Gl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=tc("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=tc("baseRetryDelayMs",5e3,h),this.cb=tc("retryDelaySeedMs",1e4,h),this.Wa=tc("forwardChannelMaxRetries",2,h),this.wa=tc("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Fb(h&&h.concurrentRequestLimit),this.Da=new KR,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=s_.prototype,t.la=8,t.G=1,t.connect=function(h,y,b,I){yn(0),this.W=h,this.H=y||{},b&&I!==void 0&&(this.H.OSID=b,this.H.OAID=I),this.F=this.X,this.I=f_(this,null,this.W),Id(this)};function ng(h){if(i_(h),h.G==3){var y=h.U++,b=ss(h.I);if(qe(b,"SID",h.K),qe(b,"RID",y),qe(b,"TYPE","terminate"),nc(h,b),y=new Hs(h,h.j,y),y.L=2,y.v=Sd(ss(b)),b=!1,a.navigator&&a.navigator.sendBeacon)try{b=a.navigator.sendBeacon(y.v.toString(),"")}catch{}!b&&a.Image&&(new Image().src=y.v,b=!0),b||(y.g=p_(y.j,null),y.g.ea(y.v)),y.F=Date.now(),bd(y)}h_(h)}function Cd(h){h.g&&(sg(h),h.g.cancel(),h.g=null)}function i_(h){Cd(h),h.u&&(a.clearTimeout(h.u),h.u=null),Ad(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function Id(h){if(!Ub(h.h)&&!h.s){h.s=!0;var y=h.Ga;Z||$(),B||(Z(),B=!0),V.add(y,h),h.B=0}}function XR(h,y){return zb(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Kl(p(h.Ga,h,y),d_(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const L=new Hs(this,this.j,h);let U=this.o;if(this.S&&(U?(U=S(U),j(U,this.S)):U=this.S),this.m!==null||this.O||(L.H=U,U=null),this.P)e:{for(var y=0,b=0;b<this.i.length;b++){t:{var I=this.i[b];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=b;break e}if(y===4096||b===this.i.length-1){y=b+1;break e}}y=1e3}else y=1e3;y=a_(this,L,y),b=ss(this.I),qe(b,"RID",h),qe(b,"CVER",22),this.D&&qe(b,"X-HTTP-Session-Id",this.D),nc(this,b),U&&(this.O?y="headers="+encodeURIComponent(String(Xb(U)))+"&"+y:this.m&&tg(b,this.m,U)),eg(this.h,L),this.Ua&&qe(b,"TYPE","init"),this.P?(qe(b,"$req",y),qe(b,"SID","null"),L.T=!0,Jm(L,b,null)):Jm(L,b,y),this.G=2}}else this.G==3&&(h?o_(this,h):this.i.length==0||Ub(this.h)||o_(this))};function o_(h,y){var b;y?b=y.l:b=h.U++;const I=ss(h.I);qe(I,"SID",h.K),qe(I,"RID",b),qe(I,"AID",h.T),nc(h,I),h.m&&h.o&&tg(I,h.m,h.o),b=new Hs(h,h.j,b,h.B+1),h.m===null&&(b.H=h.o),y&&(h.i=y.D.concat(h.i)),y=a_(h,b,1e3),b.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),eg(h.h,b),Jm(b,I,y)}function nc(h,y){h.H&&M(h.H,function(b,I){qe(y,I,b)}),h.l&&Hb({},function(b,I){qe(y,I,b)})}function a_(h,y,b){b=Math.min(h.i.length,b);var I=h.l?p(h.l.Na,h.l,h):null;e:{var L=h.i;let U=-1;for(;;){const Y=["count="+b];U==-1?0<b?(U=L[0].g,Y.push("ofs="+U)):U=0:Y.push("ofs="+U);let Ve=!0;for(let zt=0;zt<b;zt++){let Ae=L[zt].g;const nn=L[zt].map;if(Ae-=U,0>Ae)U=Math.max(0,L[zt].g-100),Ve=!1;else try{GR(nn,Y,"req"+Ae+"_")}catch{I&&I(nn)}}if(Ve){I=Y.join("&");break e}}}return h=h.i.splice(0,b),y.D=h,I}function l_(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;Z||$(),B||(Z(),B=!0),V.add(y,h),h.v=0}}function rg(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Kl(p(h.Fa,h),d_(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,c_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Kl(p(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yn(10),Cd(this),c_(this))};function sg(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function c_(h){h.g=new Hs(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=ss(h.qa);qe(y,"RID","rpc"),qe(y,"SID",h.K),qe(y,"AID",h.T),qe(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&qe(y,"TO",h.ja),qe(y,"TYPE","xmlhttp"),nc(h,y),h.m&&h.o&&tg(y,h.m,h.o),h.L&&(h.g.I=h.L);var b=h.g;h=h.ia,b.L=1,b.v=Sd(ss(y)),b.m=null,b.P=!0,Ob(b,h)}t.Za=function(){this.C!=null&&(this.C=null,Cd(this),rg(this),yn(19))};function Ad(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function u_(h,y){var b=null;if(h.g==y){Ad(h),sg(h),h.g=null;var I=2}else if(Zm(h.h,y))b=y.D,Bb(h.h,y),I=1;else return;if(h.G!=0){if(y.o)if(I==1){b=y.m?y.m.length:0,y=Date.now()-y.F;var L=h.B;I=xd(),et(I,new Rb(I,b)),Id(h)}else l_(h);else if(L=y.s,L==3||L==0&&0<y.X||!(I==1&&XR(h,y)||I==2&&rg(h)))switch(b&&0<b.length&&(y=h.h,y.i=y.i.concat(b)),L){case 1:oo(h,5);break;case 4:oo(h,10);break;case 3:oo(h,6);break;default:oo(h,2)}}}function d_(h,y){let b=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(b*=2),b*y}function oo(h,y){if(h.j.info("Error code "+y),y==2){var b=p(h.fb,h),I=h.Xa;const L=!I;I=new io(I||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||_d(I,"https"),Sd(I),L?qR(I.toString(),b):WR(I.toString(),b)}else yn(2);h.G=0,h.l&&h.l.sa(y),h_(h),i_(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),yn(2)):(this.j.info("Failed to ping google.com"),yn(1))};function h_(h){if(h.G=0,h.ka=[],h.l){const y=$b(h.h);(y.length!=0||h.i.length!=0)&&(w(h.ka,y),w(h.ka,h.i),h.h.i.length=0,x(h.i),h.i.length=0),h.l.ra()}}function f_(h,y,b){var I=b instanceof io?ss(b):new io(b);if(I.g!="")y&&(I.g=y+"."+I.g),Ed(I,I.s);else{var L=a.location;I=L.protocol,y=y?y+"."+L.hostname:L.hostname,L=+L.port;var U=new io(null);I&&_d(U,I),y&&(U.g=y),L&&Ed(U,L),b&&(U.l=b),I=U}return b=h.D,y=h.ya,b&&y&&qe(I,b,y),qe(I,"VER",h.la),nc(h,I),I}function p_(h,y,b){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new ut(new Td({eb:b})):new ut(h.pa),y.Ha(h.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function m_(){}t=m_.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function jd(){}jd.prototype.g=function(h,y){return new Un(h,y)};function Un(h,y){Ze.call(this),this.g=new s_(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!_(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!_(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new pa(this)}g(Un,Ze),Un.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Un.prototype.close=function(){ng(this.g)},Un.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var b={};b.__data__=h,h=b}else this.u&&(b={},b.__data__=Hm(h),h=b);y.i.push(new MR(y.Ya++,h)),y.G==3&&Id(y)},Un.prototype.N=function(){this.g.l=null,delete this.j,ng(this.g),delete this.g,Un.aa.N.call(this)};function g_(h){Wm.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const b in y){h=b;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}g(g_,Wm);function y_(){Km.call(this),this.status=1}g(y_,Km);function pa(h){this.g=h}g(pa,m_),pa.prototype.ua=function(){et(this.g,"a")},pa.prototype.ta=function(h){et(this.g,new g_(h))},pa.prototype.sa=function(h){et(this.g,new y_)},pa.prototype.ra=function(){et(this.g,"b")},jd.prototype.createWebChannel=jd.prototype.g,Un.prototype.send=Un.prototype.o,Un.prototype.open=Un.prototype.m,Un.prototype.close=Un.prototype.close,II=function(){return new jd},CI=function(){return xd()},NI=ro,A0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},vd.NO_ERROR=0,vd.TIMEOUT=8,vd.HTTP_ERROR=6,Dh=vd,Pb.COMPLETE="complete",kI=Pb,Cb.EventType=ql,ql.OPEN="a",ql.CLOSE="b",ql.ERROR="c",ql.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,bc=Cb,ut.prototype.listenOnce=ut.prototype.L,ut.prototype.getLastError=ut.prototype.Ka,ut.prototype.getLastErrorCode=ut.prototype.Ba,ut.prototype.getStatus=ut.prototype.Z,ut.prototype.getResponseJson=ut.prototype.Oa,ut.prototype.getResponseText=ut.prototype.oa,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Ha,TI=ut}).apply(typeof Xd<"u"?Xd:typeof self<"u"?self:typeof window<"u"?window:{});const EE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};cn.UNAUTHENTICATED=new cn(null),cn.GOOGLE_CREDENTIALS=new cn("google-credentials-uid"),cn.FIRST_PARTY=new cn("first-party-uid"),cn.MOCK_USER=new cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ml="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new jv("@firebase/firestore");function dc(){return qo.logLevel}function ie(t,...e){if(qo.logLevel<=ke.DEBUG){const n=e.map(qv);qo.debug(`Firestore (${Ml}): ${t}`,...n)}}function Os(t,...e){if(qo.logLevel<=ke.ERROR){const n=e.map(qv);qo.error(`Firestore (${Ml}): ${t}`,...n)}}function ll(t,...e){if(qo.logLevel<=ke.WARN){const n=e.map(qv);qo.warn(`Firestore (${Ml}): ${t}`,...n)}}function qv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t="Unexpected state"){const e=`FIRESTORE (${Ml}) INTERNAL ASSERTION FAILED: `+t;throw Os(e),new Error(e)}function Oe(t,e){t||he()}function me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends ts{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(cn.UNAUTHENTICATED))}shutdown(){}}class DF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class MF{constructor(e){this.t=e,this.currentUser=cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Oe(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Ss;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ss,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ss)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Oe(typeof r.accessToken=="string"),new AI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string"),new cn(e)}}class OF{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=cn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class LF{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new OF(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class VF{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class FF{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Oe(this.o===void 0);const r=i=>{i.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Oe(typeof n.token=="string"),this.R=n.token,new VF(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=UF(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function je(t,e){return t<e?-1:t>e?1:0}function cl(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return It.fromMillis(Date.now())}static fromDate(e){return It.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new It(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new It(0,0))}static max(){return new pe(new It(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(),r===void 0?r=e.length-n:r>e.length-n&&he(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Nu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Nu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ge extends Nu{construct(e,n,r){return new Ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ge(n)}static emptyPath(){return new Ge([])}}const zF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qt extends Nu{construct(e,n,r){return new Qt(e,n,r)}static isValidIdentifier(e){return zF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Qt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new te(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new te(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new te(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qt(n)}static emptyPath(){return new Qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.path=e}static fromPath(e){return new ce(Ge.fromString(e))}static fromName(e){return new ce(Ge.fromString(e).popFirst(5))}static empty(){return new ce(Ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new Ge(e.slice()))}}function BF(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new It(n+1,0):new It(n,r));return new Ui(s,ce.empty(),e)}function $F(t){return new Ui(t.readTime,t.key,-1)}class Ui{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ui(pe.min(),ce.empty(),-1)}static max(){return new Ui(pe.max(),ce.empty(),-1)}}function HF(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ce.comparator(t.documentKey,e.documentKey),n!==0?n:je(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WF{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rd(t){if(t.code!==q.FAILED_PRECONDITION||t.message!==qF)throw t;ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new G((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof G?n:G.resolve(n)}catch(n){return G.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):G.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):G.reject(n)}static resolve(e){return new G((n,r)=>{n(e)})}static reject(e){return new G((n,r)=>{r(e)})}static waitFor(e){return new G((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=G.resolve(!1);for(const r of e)n=n.next(s=>s?G.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new G((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new G((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function KF(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function sd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wv.oe=-1;function lm(t){return t==null}function Cf(t){return t===0&&1/t==-1/0}function GF(t){return typeof t=="number"&&Number.isInteger(t)&&!Cf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ia(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function RI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){this.comparator=e,this.root=n||qt.EMPTY}insert(e,n){return new lt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,qt.BLACK,null,null))}remove(e){return new lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??qt.RED,this.left=s??qt.EMPTY,this.right=i??qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new qt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return qt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return qt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw he();const e=this.left.check();if(e!==this.right.check())throw he();return e+(this.isRed()?0:1)}}qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1;qt.EMPTY=new class{constructor(){this.size=0}get key(){throw he()}get value(){throw he()}get color(){throw he()}get left(){throw he()}get right(){throw he()}copy(e,n,r,s,i){return this}insert(e,n,r){return new qt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.comparator=e,this.data=new lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new TE(this.data.getIterator())}getIteratorFrom(e){return new TE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Yt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Yt(this.comparator);return n.data=e,n}}class TE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.fields=e,e.sort(Qt.comparator)}static empty(){return new Qn([])}unionWith(e){let n=new Yt(Qt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return cl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new PI("Invalid base64 string: "+i):i}}(e);return new Zt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Zt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zt.EMPTY_BYTE_STRING=new Zt("");const QF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(t){if(Oe(!!t),typeof t=="string"){let e=0;const n=QF.exec(t);if(Oe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yt(t.seconds),nanos:yt(t.nanos)}}function yt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wo(t){return typeof t=="string"?Zt.fromBase64String(t):Zt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Gv(t){const e=t.mapValue.fields.__previous_value__;return Kv(e)?Gv(e):e}function Cu(t){const e=zi(t.mapValue.fields.__local_write_time__.timestampValue);return new It(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(e,n,r,s,i,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Iu{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Iu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Iu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh={mapValue:{}};function Ko(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Kv(t)?4:XF(t)?9007199254740991:YF(t)?10:11:he()}function Xr(t,e){if(t===e)return!0;const n=Ko(t);if(n!==Ko(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cu(t).isEqual(Cu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=zi(s.timestampValue),a=zi(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Wo(s.bytesValue).isEqual(Wo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return yt(s.geoPointValue.latitude)===yt(i.geoPointValue.latitude)&&yt(s.geoPointValue.longitude)===yt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return yt(s.integerValue)===yt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=yt(s.doubleValue),a=yt(i.doubleValue);return o===a?Cf(o)===Cf(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return cl(t.arrayValue.values||[],e.arrayValue.values||[],Xr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(SE(o)!==SE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Xr(o[l],a[l])))return!1;return!0}(t,e);default:return he()}}function Au(t,e){return(t.values||[]).find(n=>Xr(n,e))!==void 0}function ul(t,e){if(t===e)return 0;const n=Ko(t),r=Ko(e);if(n!==r)return je(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return je(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=yt(i.integerValue||i.doubleValue),l=yt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return kE(t.timestampValue,e.timestampValue);case 4:return kE(Cu(t),Cu(e));case 5:return je(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Wo(i),l=Wo(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=je(a[u],l[u]);if(d!==0)return d}return je(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=je(yt(i.latitude),yt(o.latitude));return a!==0?a:je(yt(i.longitude),yt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return NE(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,u,d;const f=i.fields||{},p=o.fields||{},m=(a=f.value)===null||a===void 0?void 0:a.arrayValue,g=(l=p.value)===null||l===void 0?void 0:l.arrayValue,x=je(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:NE(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===eh.mapValue&&o===eh.mapValue)return 0;if(i===eh.mapValue)return 1;if(o===eh.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=je(l[f],d[f]);if(p!==0)return p;const m=ul(a[l[f]],u[d[f]]);if(m!==0)return m}return je(l.length,d.length)}(t.mapValue,e.mapValue);default:throw he()}}function kE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return je(t,e);const n=zi(t),r=zi(e),s=je(n.seconds,r.seconds);return s!==0?s:je(n.nanos,r.nanos)}function NE(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ul(n[s],r[s]);if(i)return i}return je(n.length,r.length)}function dl(t){return j0(t)}function j0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=zi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Wo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ce.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=j0(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${j0(n.fields[o])}`;return s+"}"}(t.mapValue):he()}function CE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function R0(t){return!!t&&"integerValue"in t}function Qv(t){return!!t&&"arrayValue"in t}function IE(t){return!!t&&"nullValue"in t}function AE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Mh(t){return!!t&&"mapValue"in t}function YF(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Fc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ia(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function XF(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Mh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fc(n)}setAll(e){let n=Qt.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Fc(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Mh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Xr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Mh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ia(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Pn(Fc(this.value))}}function DI(t){const e=[];return ia(t.fields,(n,r)=>{const s=new Qt([n]);if(Mh(r)){const i=DI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new dn(e,0,pe.min(),pe.min(),pe.min(),Pn.empty(),0)}static newFoundDocument(e,n,r,s){return new dn(e,1,n,pe.min(),r,s,0)}static newNoDocument(e,n){return new dn(e,2,n,pe.min(),pe.min(),Pn.empty(),0)}static newUnknownDocument(e,n){return new dn(e,3,n,pe.min(),pe.min(),Pn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,n){this.position=e,this.inclusive=n}}function jE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ce.comparator(ce.fromName(o.referenceValue),n.key):r=ul(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function RE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Xr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n="asc"){this.field=e,this.dir=n}}function ZF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MI=class{};class St extends MI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new t5(e,n,r):n==="array-contains"?new s5(e,r):n==="in"?new i5(e,r):n==="not-in"?new o5(e,r):n==="array-contains-any"?new a5(e,r):new St(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new n5(e,r):new r5(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ul(n,this.value)):n!==null&&Ko(this.value)===Ko(n)&&this.matchesComparison(ul(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class jr extends MI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new jr(e,n)}matches(e){return OI(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function OI(t){return t.op==="and"}function LI(t){return e5(t)&&OI(t)}function e5(t){for(const e of t.filters)if(e instanceof jr)return!1;return!0}function P0(t){if(t instanceof St)return t.field.canonicalString()+t.op.toString()+dl(t.value);if(LI(t))return t.filters.map(e=>P0(e)).join(",");{const e=t.filters.map(n=>P0(n)).join(",");return`${t.op}(${e})`}}function VI(t,e){return t instanceof St?function(r,s){return s instanceof St&&r.op===s.op&&r.field.isEqual(s.field)&&Xr(r.value,s.value)}(t,e):t instanceof jr?function(r,s){return s instanceof jr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&VI(o,s.filters[a]),!0):!1}(t,e):void he()}function FI(t){return t instanceof St?function(n){return`${n.field.canonicalString()} ${n.op} ${dl(n.value)}`}(t):t instanceof jr?function(n){return n.op.toString()+" {"+n.getFilters().map(FI).join(" ,")+"}"}(t):"Filter"}class t5 extends St{constructor(e,n,r){super(e,n,r),this.key=ce.fromName(r.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class n5 extends St{constructor(e,n){super(e,"in",n),this.keys=UI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class r5 extends St{constructor(e,n){super(e,"not-in",n),this.keys=UI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function UI(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ce.fromName(r.referenceValue))}class s5 extends St{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Qv(n)&&Au(n.arrayValue,this.value)}}class i5 extends St{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Au(this.value.arrayValue,n)}}class o5 extends St{constructor(e,n){super(e,"not-in",n)}matches(e){if(Au(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Au(this.value.arrayValue,n)}}class a5 extends St{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Qv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Au(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function PE(t,e=null,n=[],r=[],s=null,i=null,o=null){return new l5(t,e,n,r,s,i,o)}function Jv(t){const e=me(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>P0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),lm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>dl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>dl(r)).join(",")),e.ue=n}return e.ue}function Yv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!ZF(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!VI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!RE(t.startAt,e.startAt)&&RE(t.endAt,e.endAt)}function D0(t){return ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function c5(t,e,n,r,s,i,o,a){return new Ol(t,e,n,r,s,i,o,a)}function Xv(t){return new Ol(t)}function DE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function zI(t){return t.collectionGroup!==null}function Uc(t){const e=me(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Yt(Qt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ju(i,r))}),n.has(Qt.keyField().canonicalString())||e.ce.push(new ju(Qt.keyField(),r))}return e.ce}function Jr(t){const e=me(t);return e.le||(e.le=u5(e,Uc(t))),e.le}function u5(t,e){if(t.limitType==="F")return PE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ju(s.field,i)});const n=t.endAt?new If(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new If(t.startAt.position,t.startAt.inclusive):null;return PE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function M0(t,e){const n=t.filters.concat([e]);return new Ol(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Af(t,e,n){return new Ol(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cm(t,e){return Yv(Jr(t),Jr(e))&&t.limitType===e.limitType}function BI(t){return`${Jv(Jr(t))}|lt:${t.limitType}`}function va(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>FI(s)).join(", ")}]`),lm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>dl(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>dl(s)).join(",")),`Target(${r})`}(Jr(t))}; limitType=${t.limitType})`}function um(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ce.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Uc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const u=jE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Uc(r),s)||r.endAt&&!function(o,a,l){const u=jE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Uc(r),s))}(t,e)}function d5(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function $I(t){return(e,n)=>{let r=!1;for(const s of Uc(t)){const i=h5(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function h5(t,e,n){const r=t.field.isKeyField()?ce.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),u=a.data.field(i);return l!==null&&u!==null?ul(l,u):he()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ia(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return RI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5=new lt(ce.comparator);function Ls(){return f5}const HI=new lt(ce.comparator);function _c(...t){let e=HI;for(const n of t)e=e.insert(n.key,n);return e}function qI(t){let e=HI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xo(){return zc()}function WI(){return zc()}function zc(){return new Ll(t=>t.toString(),(t,e)=>t.isEqual(e))}const p5=new lt(ce.comparator),m5=new Yt(ce.comparator);function Se(...t){let e=m5;for(const n of t)e=e.add(n);return e}const g5=new Yt(je);function y5(){return g5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cf(e)?"-0":e}}function KI(t){return{integerValue:""+t}}function x5(t,e){return GF(e)?KI(e):Zv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(){this._=void 0}}function v5(t,e,n){return t instanceof jf?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Kv(i)&&(i=Gv(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Ru?QI(t,e):t instanceof Pu?JI(t,e):function(s,i){const o=GI(s,i),a=ME(o)+ME(s.Pe);return R0(o)&&R0(s.Pe)?KI(a):Zv(s.serializer,a)}(t,e)}function w5(t,e,n){return t instanceof Ru?QI(t,e):t instanceof Pu?JI(t,e):n}function GI(t,e){return t instanceof Rf?function(r){return R0(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class jf extends dm{}class Ru extends dm{constructor(e){super(),this.elements=e}}function QI(t,e){const n=YI(e);for(const r of t.elements)n.some(s=>Xr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Pu extends dm{constructor(e){super(),this.elements=e}}function JI(t,e){let n=YI(e);for(const r of t.elements)n=n.filter(s=>!Xr(s,r));return{arrayValue:{values:n}}}class Rf extends dm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function ME(t){return yt(t.integerValue||t.doubleValue)}function YI(t){return Qv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function b5(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ru&&s instanceof Ru||r instanceof Pu&&s instanceof Pu?cl(r.elements,s.elements,Xr):r instanceof Rf&&s instanceof Rf?Xr(r.Pe,s.Pe):r instanceof jf&&s instanceof jf}(t.transform,e.transform)}class _5{constructor(e,n){this.version=e,this.transformResults=n}}class _n{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new _n}static exists(e){return new _n(void 0,e)}static updateTime(e){return new _n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Oh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hm{}function XI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new fm(t.key,_n.none()):new id(t.key,t.data,_n.none());{const n=t.data,r=Pn.empty();let s=new Yt(Qt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ji(t.key,r,new Qn(s.toArray()),_n.none())}}function E5(t,e,n){t instanceof id?function(s,i,o){const a=s.value.clone(),l=LE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ji?function(s,i,o){if(!Oh(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=LE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(ZI(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Bc(t,e,n,r){return t instanceof id?function(i,o,a,l){if(!Oh(i.precondition,o))return a;const u=i.value.clone(),d=VE(i.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ji?function(i,o,a,l){if(!Oh(i.precondition,o))return a;const u=VE(i.fieldTransforms,l,o),d=o.data;return d.setAll(ZI(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return Oh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function S5(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=GI(r.transform,s||null);i!=null&&(n===null&&(n=Pn.empty()),n.set(r.field,i))}return n||null}function OE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&cl(r,s,(i,o)=>b5(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class id extends hm{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ji extends hm{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ZI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function LE(t,e,n){const r=new Map;Oe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,w5(o,a,n[s]))}return r}function VE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,v5(i,o,e))}return r}class fm extends hm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class T5 extends hm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&E5(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Bc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Bc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=WI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=XI(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Se())}isEqual(e){return this.batchId===e.batchId&&cl(this.mutations,e.mutations,(n,r)=>OE(n,r))&&cl(this.baseMutations,e.baseMutations,(n,r)=>OE(n,r))}}class ew{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Oe(e.mutations.length===r.length);let s=function(){return p5}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ew(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt,Ne;function I5(t){switch(t){default:return he();case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0}}function e2(t){if(t===void 0)return Os("GRPC error has no .code"),q.UNKNOWN;switch(t){case bt.OK:return q.OK;case bt.CANCELLED:return q.CANCELLED;case bt.UNKNOWN:return q.UNKNOWN;case bt.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case bt.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case bt.INTERNAL:return q.INTERNAL;case bt.UNAVAILABLE:return q.UNAVAILABLE;case bt.UNAUTHENTICATED:return q.UNAUTHENTICATED;case bt.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case bt.NOT_FOUND:return q.NOT_FOUND;case bt.ALREADY_EXISTS:return q.ALREADY_EXISTS;case bt.PERMISSION_DENIED:return q.PERMISSION_DENIED;case bt.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case bt.ABORTED:return q.ABORTED;case bt.OUT_OF_RANGE:return q.OUT_OF_RANGE;case bt.UNIMPLEMENTED:return q.UNIMPLEMENTED;case bt.DATA_LOSS:return q.DATA_LOSS;default:return he()}}(Ne=bt||(bt={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=new Co([4294967295,4294967295],0);function FE(t){const e=A5().encode(t),n=new SI;return n.update(e),new Uint8Array(n.digest())}function UE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Co([n,r],0),new Co([s,i],0)]}class tw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ec(`Invalid padding: ${n}`);if(r<0)throw new Ec(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ec(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ec(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Co.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Co.fromNumber(r)));return s.compare(j5)===1&&(s=new Co([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=FE(e),[r,s]=UE(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new tw(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=FE(e),[r,s]=UE(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ec extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,od.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new pm(pe.min(),s,new lt(je),Ls(),Se())}}class od{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new od(r,n,Se(),Se(),Se())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class t2{constructor(e,n){this.targetId=e,this.me=n}}class n2{constructor(e,n,r=Zt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class zE{constructor(){this.fe=0,this.ge=$E(),this.pe=Zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Se(),n=Se(),r=Se();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:he()}}),new od(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=$E()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Oe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class R5{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ls(),this.qe=BE(),this.Qe=new lt(je)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:he()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(D0(i))if(r===0){const o=new ce(i.path);this.Ue(n,o,dn.newNoDocument(o,pe.min()))}else Oe(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Wo(r).toUint8Array()}catch(l){if(l instanceof PI)return ll("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new tw(o,s,i)}catch(l){return ll(l instanceof Ec?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&D0(a.target)){const l=new ce(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,dn.newNoDocument(l,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Se();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new pm(e,n,this.Qe,this.ke,r);return this.ke=Ls(),this.qe=BE(),this.Qe=new lt(je),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new zE,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Yt(je),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ie("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new zE),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function BE(){return new lt(ce.comparator)}function $E(){return new lt(ce.comparator)}const P5={asc:"ASCENDING",desc:"DESCENDING"},D5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},M5={and:"AND",or:"OR"};class O5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function O0(t,e){return t.useProto3Json||lm(e)?e:{value:e}}function Pf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function r2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function L5(t,e){return Pf(t,e.toTimestamp())}function Yr(t){return Oe(!!t),pe.fromTimestamp(function(n){const r=zi(n);return new It(r.seconds,r.nanos)}(t))}function nw(t,e){return L0(t,e).canonicalString()}function L0(t,e){const n=function(s){return new Ge(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function s2(t){const e=Ge.fromString(t);return Oe(c2(e)),e}function V0(t,e){return nw(t.databaseId,e.path)}function zg(t,e){const n=s2(e);if(n.get(1)!==t.databaseId.projectId)throw new te(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(o2(n))}function i2(t,e){return nw(t.databaseId,e)}function V5(t){const e=s2(t);return e.length===4?Ge.emptyPath():o2(e)}function F0(t){return new Ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function o2(t){return Oe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function HE(t,e,n){return{name:V0(t,e),fields:n.value.mapValue.fields}}function F5(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:he()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(Oe(d===void 0||typeof d=="string"),Zt.fromBase64String(d||"")):(Oe(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Zt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?q.UNKNOWN:e2(u.code);return new te(d,u.message||"")}(o);n=new n2(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=zg(t,r.document.name),i=Yr(r.document.updateTime),o=r.document.createTime?Yr(r.document.createTime):pe.min(),a=new Pn({mapValue:{fields:r.document.fields}}),l=dn.newFoundDocument(s,i,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Lh(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=zg(t,r.document),i=r.readTime?Yr(r.readTime):pe.min(),o=dn.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Lh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=zg(t,r.document),i=r.removedTargetIds||[];n=new Lh([],i,s,null)}else{if(!("filter"in e))return he();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new C5(s,i),a=r.targetId;n=new t2(a,o)}}return n}function U5(t,e){let n;if(e instanceof id)n={update:HE(t,e.key,e.value)};else if(e instanceof fm)n={delete:V0(t,e.key)};else if(e instanceof Ji)n={update:HE(t,e.key,e.data),updateMask:Q5(e.fieldMask)};else{if(!(e instanceof T5))return he();n={verify:V0(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof jf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ru)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Pu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Rf)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw he()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:L5(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:he()}(t,e.precondition)),n}function z5(t,e){return t&&t.length>0?(Oe(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?Yr(s.updateTime):Yr(i);return o.isEqual(pe.min())&&(o=Yr(i)),new _5(o,s.transformResults||[])}(n,e))):[]}function B5(t,e){return{documents:[i2(t,e.path)]}}function $5(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=i2(t,s);const i=function(u){if(u.length!==0)return l2(jr.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:wa(p.field),direction:W5(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=O0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:s}}function H5(t){let e=V5(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Oe(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(f){const p=a2(f);return p instanceof jr&&LI(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(g){return new ju(ba(g.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,lm(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(f){const p=!!f.before,m=f.values||[];return new If(m,p)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const p=!f.before,m=f.values||[];return new If(m,p)}(n.endAt)),c5(e,s,o,i,a,"F",l,u)}function q5(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function a2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ba(n.unaryFilter.field);return St.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ba(n.unaryFilter.field);return St.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ba(n.unaryFilter.field);return St.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ba(n.unaryFilter.field);return St.create(o,"!=",{nullValue:"NULL_VALUE"});default:return he()}}(t):t.fieldFilter!==void 0?function(n){return St.create(ba(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return he()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return jr.create(n.compositeFilter.filters.map(r=>a2(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return he()}}(n.compositeFilter.op))}(t):he()}function W5(t){return P5[t]}function K5(t){return D5[t]}function G5(t){return M5[t]}function wa(t){return{fieldPath:t.canonicalString()}}function ba(t){return Qt.fromServerFormat(t.fieldPath)}function l2(t){return t instanceof St?function(n){if(n.op==="=="){if(AE(n.value))return{unaryFilter:{field:wa(n.field),op:"IS_NAN"}};if(IE(n.value))return{unaryFilter:{field:wa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(AE(n.value))return{unaryFilter:{field:wa(n.field),op:"IS_NOT_NAN"}};if(IE(n.value))return{unaryFilter:{field:wa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wa(n.field),op:K5(n.op),value:n.value}}}(t):t instanceof jr?function(n){const r=n.getFilters().map(s=>l2(s));return r.length===1?r[0]:{compositeFilter:{op:G5(n.op),filters:r}}}(t):he()}function Q5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function c2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,n,r,s,i=pe.min(),o=pe.min(),a=Zt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{constructor(e){this.ct=e}}function Y5(t){const e=H5({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Af(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(){this.un=new Z5}addToCollectionParentIndex(e,n){return this.un.add(n),G.resolve()}getCollectionParents(e,n){return G.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return G.resolve()}deleteFieldIndex(e,n){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,n){return G.resolve()}getDocumentsMatchingTarget(e,n){return G.resolve(null)}getIndexType(e,n){return G.resolve(0)}getFieldIndexes(e,n){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,n){return G.resolve(Ui.min())}getMinOffsetFromCollectionGroup(e,n){return G.resolve(Ui.min())}updateCollectionGroup(e,n,r){return G.resolve()}updateIndexEntries(e,n){return G.resolve()}}class Z5{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Yt(Ge.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Yt(Ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new hl(0)}static kn(){return new hl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this.changes=new Ll(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?G.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Bc(r.mutation,s,Qn.empty(),It.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Se()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Se()){const s=xo();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=_c();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=xo();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Se()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Ls();const o=zc(),a=function(){return zc()}();return n.forEach((l,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Ji)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Bc(d.mutation,u,d.mutation.getFieldMask(),It.now())):o.set(u.key,Qn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var f;return a.set(u,new t6(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=zc();let s=new lt((o,a)=>o-a),i=Se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||Qn.empty();d=a.applyToLocalView(u,d),r.set(l,d);const f=(s.get(a.batchId)||Se()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=WI();d.forEach(p=>{if(!i.has(p)){const m=XI(n.get(p),r.get(p));m!==null&&f.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return G.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ce.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):zI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):G.resolve(xo());let a=-1,l=i;return o.next(u=>G.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?G.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,Se())).next(d=>({batchId:a,changes:qI(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(r=>{let s=_c();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=_c();return this.indexManager.getCollectionParents(e,i).next(a=>G.forEach(a,l=>{const u=function(f,p){return new Ol(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,dn.newInvalidDocument(d)))});let a=_c();return o.forEach((l,u)=>{const d=i.get(l);d!==void 0&&Bc(d.mutation,u,Qn.empty(),It.now()),um(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return G.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Yr(s.createTime)}}(n)),G.resolve()}getNamedQuery(e,n){return G.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:Y5(s.bundledQuery),readTime:Yr(s.readTime)}}(n)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(){this.overlays=new lt(ce.comparator),this.Ir=new Map}getOverlay(e,n){return G.resolve(this.overlays.get(n))}getOverlays(e,n){const r=xo();return G.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),G.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),G.resolve()}getOverlaysForCollection(e,n,r){const s=xo(),i=n.length+1,o=new ce(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return G.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new lt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=xo(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=xo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=s)););return G.resolve(a)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new N5(n,r));let i=this.Ir.get(n);i===void 0&&(i=Se(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(){this.Tr=new Yt(jt.Er),this.dr=new Yt(jt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new jt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new jt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ce(new Ge([])),r=new jt(n,e),s=new jt(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ce(new Ge([])),r=new jt(n,e),s=new jt(n,e+1);let i=Se();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new jt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class jt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ce.comparator(e.key,n.key)||je(e.wr,n.wr)}static Ar(e,n){return je(e.wr,n.wr)||ce.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Yt(jt.Er)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new k5(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new jt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return G.resolve(o)}lookupMutationBatch(e,n){return G.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return G.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new jt(n,0),s=new jt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),G.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Yt(je);return n.forEach(s=>{const i=new jt(s,0),o=new jt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),G.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ce.isDocumentKey(i)||(i=i.child(""));const o=new jt(new ce(i),0);let a=new Yt(je);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(l.wr)),!0)},o),G.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Oe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return G.forEach(n.mutations,s=>{const i=new jt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new jt(n,0),s=this.br.firstAfterOrEqual(r);return G.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(e){this.Mr=e,this.docs=function(){return new lt(ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return G.resolve(r?r.document.mutableCopy():dn.newInvalidDocument(n))}getEntries(e,n){let r=Ls();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():dn.newInvalidDocument(s))}),G.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ls();const o=n.path,a=new ce(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||HF($F(d),r)<=0||(s.has(d.key)||um(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return G.resolve(i)}getAllFromCollectionGroup(e,n,r,s){he()}Or(e,n){return G.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new l6(this)}getSize(e){return G.resolve(this.size)}}class l6 extends e6{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),G.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e){this.persistence=e,this.Nr=new Ll(n=>Jv(n),Yv),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new rw,this.targetCount=0,this.kr=hl.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),G.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new hl(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,G.resolve()}updateTargetData(e,n){return this.Kn(n),G.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),G.waitFor(i).next(()=>s)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return G.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),G.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),G.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),G.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return G.resolve(r)}containsKey(e,n){return G.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Wv(0),this.Kr=!1,this.Kr=!0,this.$r=new i6,this.referenceDelegate=e(this),this.Ur=new c6(this),this.indexManager=new X5,this.remoteDocumentCache=function(s){return new a6(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new J5(n),this.Gr=new r6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new s6,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new o6(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ie("MemoryPersistence","Starting transaction:",e);const s=new d6(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return G.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class d6 extends WF{constructor(e){super(),this.currentSequenceNumber=e}}class sw{constructor(e){this.persistence=e,this.Jr=new rw,this.Yr=null}static Zr(e){return new sw(e)}get Xr(){if(this.Yr)return this.Yr;throw he()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),G.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),G.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.Xr,r=>{const s=ce.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,pe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return G.or([()=>G.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Se(),s=Se();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new iw(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return JL()?8:KF(pn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new h6;return this.Xi(e,n,o).next(a=>{if(i.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(dc()<=ke.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",va(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),G.resolve()):(dc()<=ke.DEBUG&&ie("QueryEngine","Query:",va(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(dc()<=ke.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",va(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jr(n))):G.resolve())}Yi(e,n){if(DE(n))return G.resolve(null);let r=Jr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Af(n,null,"F"),r=Jr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Se(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(n,a);return this.ns(n,u,o,l.readTime)?this.Yi(e,Af(n,null,"F")):this.rs(e,u,n,l)}))})))}Zi(e,n,r,s){return DE(n)||s.isEqual(pe.min())?G.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?G.resolve(null):(dc()<=ke.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),va(n)),this.rs(e,o,n,BF(s,-1)).next(a=>a))})}ts(e,n){let r=new Yt($I(e));return n.forEach((s,i)=>{um(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return dc()<=ke.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",va(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ui.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new lt(je),this._s=new Ll(i=>Jv(i),Yv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new n6(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function m6(t,e,n,r){return new p6(t,e,n,r)}async function u2(t,e){const n=me(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Se();for(const u of s){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of i){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function g6(t,e){const n=me(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,p=f.keys();let m=G.resolve();return p.forEach(g=>{m=m.next(()=>d.getEntry(l,g)).next(x=>{const w=u.docVersions.get(g);Oe(w!==null),x.version.compareTo(w)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Se();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function d2(t){const e=me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function y6(t,e){const n=me(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const a=[];e.targetChanges.forEach((d,f)=>{const p=s.get(f);if(!p)return;a.push(n.Ur.removeMatchingKeys(i,d.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,d.addedDocuments,f)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(Zt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(f,m),function(x,w,v){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,m,d)&&a.push(n.Ur.updateTargetData(i,m))});let l=Ls(),u=Se();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(x6(i,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!r.isEqual(pe.min())){const d=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return G.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(n.os=s,i))}function x6(t,e,n){let r=Se(),s=Se();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Ls();return n.forEach((a,l)=>{const u=i.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ie("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function v6(t,e){const n=me(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function w6(t,e){const n=me(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,G.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new gi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function U0(t,e,n){const r=me(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!sd(o))throw o;ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function qE(t,e,n){const r=me(t);let s=pe.min(),i=Se();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=me(l),p=f._s.get(d);return p!==void 0?G.resolve(f.os.get(p)):f.Ur.getTargetData(u,d)}(r,o,Jr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:pe.min(),n?i:Se())).next(a=>(b6(r,d5(e),a),{documents:a,Ts:i})))}function b6(t,e,n){let r=t.us.get(e)||pe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class WE{constructor(){this.activeTargetIds=y5()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _6{constructor(){this.so=new WE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new WE,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let th=null;function Bg(){return th===null?th=function(){return 268435456+Math.round(2147483648*Math.random())}():th++,"0x"+th.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="WebChannelConnection";class k6 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const a=Bg(),l=this.xo(n,r.toUriEncodedString());ie("RestConnection",`Sending RPC '${n}' ${a}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,l,u,s).then(d=>(ie("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw ll("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",s),d})}Lo(n,r,s,i,o,a){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ml}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=S6[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Bg();return new Promise((o,a)=>{const l=new TI;l.setWithCredentials(!0),l.listenOnce(kI.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Dh.NO_ERROR:const d=l.getResponseJson();ie(an,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case Dh.TIMEOUT:ie(an,`RPC '${e}' ${i} timed out`),a(new te(q.DEADLINE_EXCEEDED,"Request time out"));break;case Dh.HTTP_ERROR:const f=l.getStatus();if(ie(an,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const g=function(w){const v=w.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(v)>=0?v:q.UNKNOWN}(m.status);a(new te(g,m.message))}else a(new te(q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new te(q.UNAVAILABLE,"Connection failed."));break;default:he()}}finally{ie(an,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);ie(an,`RPC '${e}' ${i} sending request:`,s),l.send(n,"POST",u,r,15)})}Bo(e,n,r){const s=Bg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=II(),a=CI(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=i.join("");ie(an,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let p=!1,m=!1;const g=new T6({Io:w=>{m?ie(an,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(p||(ie(an,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),ie(an,`RPC '${e}' stream ${s} sending:`,w),f.send(w))},To:()=>f.close()}),x=(w,v,_)=>{w.listen(v,E=>{try{_(E)}catch(A){setTimeout(()=>{throw A},0)}})};return x(f,bc.EventType.OPEN,()=>{m||(ie(an,`RPC '${e}' stream ${s} transport opened.`),g.yo())}),x(f,bc.EventType.CLOSE,()=>{m||(m=!0,ie(an,`RPC '${e}' stream ${s} transport closed`),g.So())}),x(f,bc.EventType.ERROR,w=>{m||(m=!0,ll(an,`RPC '${e}' stream ${s} transport errored:`,w),g.So(new te(q.UNAVAILABLE,"The operation could not be completed")))}),x(f,bc.EventType.MESSAGE,w=>{var v;if(!m){const _=w.data[0];Oe(!!_);const E=_,A=E.error||((v=E[0])===null||v===void 0?void 0:v.error);if(A){ie(an,`RPC '${e}' stream ${s} received error:`,A);const P=A.status;let M=function(C){const j=bt[C];if(j!==void 0)return e2(j)}(P),N=A.message;M===void 0&&(M=q.INTERNAL,N="Unknown error status: "+P+" with message "+A.message),m=!0,g.So(new te(M,N)),f.close()}else ie(an,`RPC '${e}' stream ${s} received:`,_),g.bo(_)}}),x(a,NI.STAT_EVENT,w=>{w.stat===A0.PROXY?ie(an,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===A0.NOPROXY&&ie(an,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function $g(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mm(t){return new O5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,n,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new h2(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===q.RESOURCE_EXHAUSTED?(Os(n.toString()),Os("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new te(q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class N6 extends f2{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=F5(this.serializer,e),r=function(i){if(!("targetChange"in i))return pe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?Yr(o.readTime):pe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=F0(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=D0(l)?{documents:B5(i,l)}:{query:$5(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=r2(i,o.resumeToken);const u=O0(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=Pf(i,o.snapshotVersion.toTimestamp());const u=O0(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=q5(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=F0(this.serializer),n.removeTarget=e,this.a_(n)}}class C6 extends f2{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Oe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=z5(e.writeResults,e.commitTime),r=Yr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=F0(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>U5(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te(q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,L0(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(q.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,L0(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(q.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class A6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Os(n),this.D_=!1):ie("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{oa(this)&&(ie("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=me(l);u.L_.add(4),await ad(u),u.q_.set("Unknown"),u.L_.delete(4),await gm(u)}(this))})}),this.q_=new A6(r,s)}}async function gm(t){if(oa(t))for(const e of t.B_)await e(!0)}async function ad(t){for(const e of t.B_)await e(!1)}function p2(t,e){const n=me(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),cw(n)?lw(n):Vl(n).r_()&&aw(n,e))}function ow(t,e){const n=me(t),r=Vl(n);n.N_.delete(e),r.r_()&&m2(n,e),n.N_.size===0&&(r.r_()?r.o_():oa(n)&&n.q_.set("Unknown"))}function aw(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Vl(t).A_(e)}function m2(t,e){t.Q_.xe(e),Vl(t).R_(e)}function lw(t){t.Q_=new R5({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Vl(t).start(),t.q_.v_()}function cw(t){return oa(t)&&!Vl(t).n_()&&t.N_.size>0}function oa(t){return me(t).L_.size===0}function g2(t){t.Q_=void 0}async function R6(t){t.q_.set("Online")}async function P6(t){t.N_.forEach((e,n)=>{aw(t,e)})}async function D6(t,e){g2(t),cw(t)?(t.q_.M_(e),lw(t)):t.q_.set("Unknown")}async function M6(t,e,n){if(t.q_.set("Online"),e instanceof n2&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(t,e)}catch(r){ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Df(t,r)}else if(e instanceof Lh?t.Q_.Ke(e):e instanceof t2?t.Q_.He(e):t.Q_.We(e),!n.isEqual(pe.min()))try{const r=await d2(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.N_.get(u);d&&i.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=i.N_.get(l);if(!d)return;i.N_.set(l,d.withResumeToken(Zt.EMPTY_BYTE_STRING,d.snapshotVersion)),m2(i,l);const f=new gi(d.target,l,u,d.sequenceNumber);aw(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ie("RemoteStore","Failed to raise snapshot:",r),await Df(t,r)}}async function Df(t,e,n){if(!sd(e))throw e;t.L_.add(1),await ad(t),t.q_.set("Offline"),n||(n=()=>d2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ie("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await gm(t)})}function y2(t,e){return e().catch(n=>Df(t,n,e))}async function ym(t){const e=me(t),n=Bi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;O6(e);)try{const s=await v6(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,L6(e,s)}catch(s){await Df(e,s)}x2(e)&&v2(e)}function O6(t){return oa(t)&&t.O_.length<10}function L6(t,e){t.O_.push(e);const n=Bi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function x2(t){return oa(t)&&!Bi(t).n_()&&t.O_.length>0}function v2(t){Bi(t).start()}async function V6(t){Bi(t).p_()}async function F6(t){const e=Bi(t);for(const n of t.O_)e.m_(n.mutations)}async function U6(t,e,n){const r=t.O_.shift(),s=ew.from(r,e,n);await y2(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ym(t)}async function z6(t,e){e&&Bi(t).V_&&await async function(r,s){if(function(o){return I5(o)&&o!==q.ABORTED}(s.code)){const i=r.O_.shift();Bi(r).s_(),await y2(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ym(r)}}(t,e),x2(t)&&v2(t)}async function GE(t,e){const n=me(t);n.asyncQueue.verifyOperationInProgress(),ie("RemoteStore","RemoteStore received new credentials");const r=oa(n);n.L_.add(3),await ad(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await gm(n)}async function B6(t,e){const n=me(t);e?(n.L_.delete(2),await gm(n)):e||(n.L_.add(2),await ad(n),n.q_.set("Unknown"))}function Vl(t){return t.K_||(t.K_=function(n,r,s){const i=me(n);return i.w_(),new N6(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:R6.bind(null,t),Ro:P6.bind(null,t),mo:D6.bind(null,t),d_:M6.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),cw(t)?lw(t):t.q_.set("Unknown")):(await t.K_.stop(),g2(t))})),t.K_}function Bi(t){return t.U_||(t.U_=function(n,r,s){const i=me(n);return i.w_(),new C6(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:V6.bind(null,t),mo:z6.bind(null,t),f_:F6.bind(null,t),g_:U6.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ym(t)):(await t.U_.stop(),t.O_.length>0&&(ie("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ss,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new uw(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dw(t,e){if(Os("AsyncQueue",`${e}: ${t}`),sd(t))return new te(q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ce.comparator(n.key,r.key):(n,r)=>ce.comparator(n.key,r.key),this.keyedMap=_c(),this.sortedSet=new lt(this.comparator)}static emptySet(e){return new Ja(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ja)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ja;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(){this.W_=new lt(ce.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):he():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class fl{constructor(e,n,r,s,i,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new fl(e,n,Ja.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class H6{constructor(){this.queries=JE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=me(n),i=s.queries;s.queries=JE(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new te(q.ABORTED,"Firestore shutting down"))}}function JE(){return new Ll(t=>BI(t),cm)}async function w2(t,e){const n=me(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new $6,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=dw(o,`Initialization of query '${va(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&hw(n)}async function b2(t,e){const n=me(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function q6(t,e){const n=me(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&hw(n)}function W6(t,e,n){const r=me(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function hw(t){t.Y_.forEach(e=>{e.next()})}var z0,YE;(YE=z0||(z0={})).ea="default",YE.Cache="cache";class _2{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new fl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=fl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==z0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e){this.key=e}}class S2{constructor(e){this.key=e}}class K6{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Se(),this.mutatedKeys=Se(),this.Aa=$I(e),this.Ra=new Ja(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new QE,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const p=s.get(d),m=um(this.query,f)?f:null,g=!!p&&this.mutatedKeys.has(p.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;p&&m?p.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),w=!0):this.ga(p,m)||(r.track({type:2,doc:m}),w=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(a=!0)):!p&&m?(r.track({type:0,doc:m}),w=!0):p&&!m&&(r.track({type:1,doc:p}),w=!0,(l||u)&&(a=!0)),w&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(m,g){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he()}};return x(m)-x(g)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),s=s!=null&&s;const a=n&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new fl(this.query,e.Ra,i,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new QE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Se(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new S2(r))}),this.da.forEach(r=>{e.has(r)||n.push(new E2(r))}),n}ba(e){this.Ta=e.Ts,this.da=Se();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return fl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class G6{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Q6{constructor(e){this.key=e,this.va=!1}}class J6{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ll(a=>BI(a),cm),this.Ma=new Map,this.xa=new Set,this.Oa=new lt(ce.comparator),this.Na=new Map,this.La=new rw,this.Ba={},this.ka=new Map,this.qa=hl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Y6(t,e,n=!0){const r=A2(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await T2(r,e,n,!0),s}async function X6(t,e){const n=A2(t);await T2(n,e,!0,!1)}async function T2(t,e,n,r){const s=await w6(t.localStore,Jr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await Z6(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&p2(t.remoteStore,s),a}async function Z6(t,e,n,r,s){t.Ka=(f,p,m)=>async function(x,w,v,_){let E=w.view.ma(v);E.ns&&(E=await qE(x.localStore,w.query,!1).then(({documents:N})=>w.view.ma(N,E)));const A=_&&_.targetChanges.get(w.targetId),P=_&&_.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(E,x.isPrimaryClient,A,P);return ZE(x,w.targetId,M.wa),M.snapshot}(t,f,p,m);const i=await qE(t.localStore,e,!0),o=new K6(e,i.Ts),a=o.ma(i.documents),l=od.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(a,t.isPrimaryClient,l);ZE(t,n,u.wa);const d=new G6(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function eU(t,e,n){const r=me(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!cm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await U0(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&ow(r.remoteStore,s.targetId),B0(r,s.targetId)}).catch(rd)):(B0(r,s.targetId),await U0(r.localStore,s.targetId,!0))}async function tU(t,e){const n=me(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ow(n.remoteStore,r.targetId))}async function nU(t,e,n){const r=cU(t);try{const s=await function(o,a){const l=me(o),u=It.now(),d=a.reduce((m,g)=>m.add(g.key),Se());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Ls(),x=Se();return l.cs.getEntries(m,d).next(w=>{g=w,g.forEach((v,_)=>{_.isValidDocument()||(x=x.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,g)).next(w=>{f=w;const v=[];for(const _ of a){const E=S5(_,f.get(_.key).overlayedDocument);E!=null&&v.push(new Ji(_.key,E,DI(E.value.mapValue),_n.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,v,a)}).next(w=>{p=w;const v=w.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(m,w.batchId,v)})}).then(()=>({batchId:p.batchId,changes:qI(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new lt(je)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,s.batchId,n),await ld(r,s.changes),await ym(r.remoteStore)}catch(s){const i=dw(s,"Failed to persist write");n.reject(i)}}async function k2(t,e){const n=me(t);try{const r=await y6(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Oe(o.va):s.removedDocuments.size>0&&(Oe(o.va),o.va=!1))}),await ld(n,r,e)}catch(r){await rd(r)}}function XE(t,e,n){const r=me(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=me(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const p of f.j_)p.Z_(a)&&(u=!0)}),u&&hw(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function rU(t,e,n){const r=me(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new lt(ce.comparator);o=o.insert(i,dn.newNoDocument(i,pe.min()));const a=Se().add(i),l=new pm(pe.min(),new Map,new lt(je),o,a);await k2(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),fw(r)}else await U0(r.localStore,e,!1).then(()=>B0(r,e,n)).catch(rd)}async function sU(t,e){const n=me(t),r=e.batch.batchId;try{const s=await g6(n.localStore,e);C2(n,r,null),N2(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ld(n,s)}catch(s){await rd(s)}}async function iU(t,e,n){const r=me(t);try{const s=await function(o,a){const l=me(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(Oe(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);C2(r,e,n),N2(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ld(r,s)}catch(s){await rd(s)}}function N2(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function C2(t,e,n){const r=me(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function B0(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||I2(t,r)})}function I2(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(ow(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),fw(t))}function ZE(t,e,n){for(const r of n)r instanceof E2?(t.La.addReference(r.key,e),oU(t,r)):r instanceof S2?(ie("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||I2(t,r.key)):he()}function oU(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ie("SyncEngine","New document in limbo: "+n),t.xa.add(r),fw(t))}function fw(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ce(Ge.fromString(e)),r=t.qa.next();t.Na.set(r,new Q6(n)),t.Oa=t.Oa.insert(n,r),p2(t.remoteStore,new gi(Jr(Xv(n.path)),r,"TargetPurposeLimboResolution",Wv.oe))}}async function ld(t,e,n){const r=me(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const f=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){s.push(u);const f=iw.Wi(l.targetId,u);i.push(f)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,u){const d=me(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>G.forEach(u,p=>G.forEach(p.$i,m=>d.persistence.referenceDelegate.addReference(f,p.targetId,m)).next(()=>G.forEach(p.Ui,m=>d.persistence.referenceDelegate.removeReference(f,p.targetId,m)))))}catch(f){if(!sd(f))throw f;ie("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const m=d.os.get(p),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.os=d.os.insert(p,x)}}}(r.localStore,i))}async function aU(t,e){const n=me(t);if(!n.currentUser.isEqual(e)){ie("SyncEngine","User change. New user:",e.toKey());const r=await u2(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new te(q.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ld(n,r.hs)}}function lU(t,e){const n=me(t),r=n.Na.get(e);if(r&&r.va)return Se().add(r.key);{let s=Se();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const a=n.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}function A2(t){const e=me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=k2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rU.bind(null,e),e.Ca.d_=q6.bind(null,e.eventManager),e.Ca.$a=W6.bind(null,e.eventManager),e}function cU(t){const e=me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iU.bind(null,e),e}class Mf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return m6(this.persistence,new f6,e.initialUser,this.serializer)}Ga(e){return new u6(sw.Zr,this.serializer)}Wa(e){return new _6}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mf.provider={build:()=>new Mf};class $0{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>XE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=aU.bind(null,this.syncEngine),await B6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new H6}()}createDatastore(e){const n=mm(e.databaseInfo.databaseId),r=function(i){return new k6(i)}(e.databaseInfo);return function(i,o,a,l){return new I6(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new j6(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>XE(this.syncEngine,n,0),function(){return KE.D()?new KE:new E6}())}createSyncEngine(e,n){return function(s,i,o,a,l,u,d){const f=new J6(s,i,o,a,l,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=me(s);ie("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ad(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}$0.provider={build:()=>new $0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Os("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=cn.UNAUTHENTICATED,this.clientId=jI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ie("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ie("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ss;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=dw(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Hg(t,e){t.asyncQueue.verifyOperationInProgress(),ie("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await u2(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function eS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await dU(t);ie("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>GE(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>GE(e.remoteStore,s)),t._onlineComponents=e}async function dU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await Hg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===q.FAILED_PRECONDITION||s.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ll("Error using user provided cache. Falling back to memory cache: "+n),await Hg(t,new Mf)}}else ie("FirestoreClient","Using default OfflineComponentProvider"),await Hg(t,new Mf);return t._offlineComponents}async function R2(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ie("FirestoreClient","Using user provided OnlineComponentProvider"),await eS(t,t._uninitializedComponentsProvider._online)):(ie("FirestoreClient","Using default OnlineComponentProvider"),await eS(t,new $0))),t._onlineComponents}function hU(t){return R2(t).then(e=>e.syncEngine)}async function P2(t){const e=await R2(t),n=e.eventManager;return n.onListen=Y6.bind(null,e.syncEngine),n.onUnlisten=eU.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=X6.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=tU.bind(null,e.syncEngine),n}function fU(t,e,n={}){const r=new Ss;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const d=new j2({next:p=>{d.Za(),o.enqueueAndForget(()=>b2(i,f));const m=p.docs.has(a);!m&&p.fromCache?u.reject(new te(q.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?u.reject(new te(q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new _2(Xv(a.path),d,{includeMetadataChanges:!0,_a:!0});return w2(i,f)}(await P2(t),t.asyncQueue,e,n,r)),r.promise}function pU(t,e,n={}){const r=new Ss;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,u){const d=new j2({next:p=>{d.Za(),o.enqueueAndForget(()=>b2(i,f)),p.fromCache&&l.source==="server"?u.reject(new te(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new _2(a,d,{includeMetadataChanges:!0,_a:!0});return w2(i,f)}(await P2(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t,e,n){if(!n)throw new te(q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function mU(t,e,n,r){if(e===!0&&r===!0)throw new te(q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nS(t){if(!ce.isDocumentKey(t))throw new te(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rS(t){if(ce.isDocumentKey(t))throw new te(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function xm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he()}function vr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xm(t);throw new te(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function gU(t,e){if(e<=0)throw new te(q.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=D2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(q.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vm{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sS({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sS(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PF;switch(r.type){case"firstParty":return new LF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=tS.get(n);r&&(ie("ComponentProvider","Removing Datastore"),tS.delete(n),r.terminate())}(this),Promise.resolve()}}function yU(t,e,n,r={}){var s;const i=(t=vr(t,vm))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&ll("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=cn.MOCK_USER;else{a=MC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new te(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new cn(u)}t._authCredentials=new DF(new AI(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Yi(this.firestore,e,this._query)}}class En{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new En(this.firestore,e,this._key)}}class ji extends Yi{constructor(e,n,r){super(e,n,Xv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new En(this.firestore,null,new ce(e))}withConverter(e){return new ji(this.firestore,e,this._path)}}function wn(t,e,...n){if(t=Pe(t),M2("collection","path",e),t instanceof vm){const r=Ge.fromString(e,...n);return rS(r),new ji(t,null,r)}{if(!(t instanceof En||t instanceof ji))throw new te(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return rS(r),new ji(t.firestore,null,r)}}function ye(t,e,...n){if(t=Pe(t),arguments.length===1&&(e=jI.newId()),M2("doc","path",e),t instanceof vm){const r=Ge.fromString(e,...n);return nS(r),new En(t,null,new ce(r))}{if(!(t instanceof En||t instanceof ji))throw new te(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ge.fromString(e,...n));return nS(r),new En(t.firestore,t instanceof ji?t.converter:null,new ce(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new h2(this,"async_queue_retry"),this.Vu=()=>{const r=$g();r&&ie("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=$g();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=$g();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Ss;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!sd(e))throw e;ie("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Os("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=uw.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&he()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Xi extends vm{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new iS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new iS(e),this._firestoreClient=void 0,await e}}}function Zi(t,e){const n=typeof t=="object"?t:Pv(),r=typeof t=="string"?t:"(default)",s=sm(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=RC("firestore");i&&yU(s,...i)}return s}function wm(t){if(t._terminated)throw new te(q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xU(t),t._firestoreClient}function xU(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,u,d){return new JF(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,D2(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new uU(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pl(Zt.fromBase64String(e))}catch(n){throw new te(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new pl(Zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vU=/^__.*__$/;class wU{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ji(e,this.data,this.fieldMask,n,this.fieldTransforms):new id(e,this.data,n,this.fieldTransforms)}}class O2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ji(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function L2(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he()}}class yw{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new yw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Of(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(L2(this.Cu)&&vU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class bU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||mm(e)}Qu(e,n,r,s=!1){return new yw({Cu:e,methodName:n,qu:r,path:Qt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ud(t){const e=t._freezeSettings(),n=mm(t._databaseId);return new bU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function xw(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);vw("Data must be an object, but it was:",o,r);const a=U2(r,o);let l,u;if(i.merge)l=new Qn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=H0(e,f,n);if(!o.contains(p))throw new te(q.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);B2(d,p)||d.push(p)}l=new Qn(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new wU(new Pn(a),l,u)}class bm extends pw{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bm}}function V2(t,e,n,r){const s=t.Qu(1,e,n);vw("Data must be an object, but it was:",s,r);const i=[],o=Pn.empty();ia(r,(l,u)=>{const d=ww(e,l,n);u=Pe(u);const f=s.Nu(d);if(u instanceof bm)i.push(d);else{const p=dd(u,f);p!=null&&(i.push(d),o.set(d,p))}});const a=new Qn(i);return new O2(o,a,s.fieldTransforms)}function F2(t,e,n,r,s,i){const o=t.Qu(1,e,n),a=[H0(e,r,n)],l=[s];if(i.length%2!=0)throw new te(q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(H0(e,i[p])),l.push(i[p+1]);const u=[],d=Pn.empty();for(let p=a.length-1;p>=0;--p)if(!B2(u,a[p])){const m=a[p];let g=l[p];g=Pe(g);const x=o.Nu(m);if(g instanceof bm)u.push(m);else{const w=dd(g,x);w!=null&&(u.push(m),d.set(m,w))}}const f=new Qn(u);return new O2(d,f,o.fieldTransforms)}function _U(t,e,n,r=!1){return dd(n,t.Qu(r?4:3,e))}function dd(t,e){if(z2(t=Pe(t)))return vw("Unsupported field value:",e,t),U2(t,e);if(t instanceof pw)return function(r,s){if(!L2(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=dd(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return x5(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=It.fromDate(r);return{timestampValue:Pf(s.serializer,i)}}if(r instanceof It){const i=new It(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Pf(s.serializer,i)}}if(r instanceof mw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pl)return{bytesValue:r2(s.serializer,r._byteString)};if(r instanceof En){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:nw(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof gw)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Zv(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${xm(r)}`)}(t,e)}function U2(t,e){const n={};return RI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ia(t,(r,s)=>{const i=dd(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function z2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof It||t instanceof mw||t instanceof pl||t instanceof En||t instanceof pw||t instanceof gw)}function vw(t,e,n){if(!z2(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=xm(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function H0(t,e,n){if((e=Pe(e))instanceof cd)return e._internalPath;if(typeof e=="string")return ww(t,e);throw Of("Field path arguments must be of type string or ",t,!1,void 0,n)}const EU=new RegExp("[~\\*/\\[\\]]");function ww(t,e,n){if(e.search(EU)>=0)throw Of(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new cd(...e.split("."))._internalPath}catch{throw Of(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Of(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new te(q.INVALID_ARGUMENT,a+t+l)}function B2(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new En(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(_m("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SU extends $2{data(){return super.data()}}function _m(t,e){return typeof e=="string"?ww(t,e):e instanceof cd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bw{}class _w extends bw{}function it(t,e,...n){let r=[];e instanceof bw&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Ew).length,a=i.filter(l=>l instanceof Em).length;if(o>1||o>0&&a>0)throw new te(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Em extends _w{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Em(e,n,r)}_apply(e){const n=this._parse(e);return q2(e._query,n),new Yi(e.firestore,e.converter,M0(e._query,n))}_parse(e){const n=ud(e.firestore);return function(i,o,a,l,u,d,f){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new te(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){aS(f,d);const m=[];for(const g of f)m.push(oS(l,i,g));p={arrayValue:{values:m}}}else p=oS(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||aS(f,d),p=_U(a,o,f,d==="in"||d==="not-in");return St.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function fr(t,e,n){const r=e,s=_m("where",t);return Em._create(s,r,n)}class Ew extends bw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ew(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:jr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)q2(o,l),o=M0(o,l)}(e._query,n),new Yi(e.firestore,e.converter,M0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Sw extends _w{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Sw(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new te(q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new te(q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ju(i,o)}(e._query,this._field,this._direction);return new Yi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Ol(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Fl(t,e="asc"){const n=e,r=_m("orderBy",t);return Sw._create(r,n)}class Tw extends _w{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Tw(e,n,r)}_apply(e){return new Yi(e.firestore,e.converter,Af(e._query,this._limit,this._limitType))}}function H2(t){return gU("limit",t),Tw._create("limit",t,"F")}function oS(t,e,n){if(typeof(n=Pe(n))=="string"){if(n==="")throw new te(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zI(e)&&n.indexOf("/")!==-1)throw new te(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ge.fromString(n));if(!ce.isDocumentKey(r))throw new te(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return CE(t,new ce(r))}if(n instanceof En)return CE(t,n._key);throw new te(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xm(n)}.`)}function aS(t,e){if(!Array.isArray(t)||t.length===0)throw new te(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function q2(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class kU{convertValue(e,n="none"){switch(Ko(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Wo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ia(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>yt(o.doubleValue));return new gw(i)}convertGeoPoint(e){return new mw(yt(e.latitude),yt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Gv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Cu(e));default:return null}}convertTimestamp(e){const n=zi(e);return new It(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ge.fromString(e);Oe(c2(r));const s=new Iu(r.get(1),r.get(3)),i=new ce(r.popFirst(5));return s.isEqual(n)||Os(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class W2 extends $2{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Vh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(_m("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Vh extends W2{data(e={}){return super.data(e)}}class NU{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Sc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Vh(this._firestore,this._userDataWriter,r.key,r,new Sc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Vh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Sc(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Vh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Sc(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:CU(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function CU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(t){t=vr(t,En);const e=vr(t.firestore,Xi);return fU(wm(e),t._key).then(n=>IU(e,t,n))}class K2 extends kU{constructor(e){super(),this.firestore=e}convertBytes(e){return new pl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new En(this.firestore,null,n)}}function Ts(t){t=vr(t,Yi);const e=vr(t.firestore,Xi),n=wm(e),r=new K2(e);return TU(t._query),pU(n,t._query).then(s=>new NU(e,r,t,s))}function Vs(t,e,n){t=vr(t,En);const r=vr(t.firestore,Xi),s=kw(t.converter,e,n);return hd(r,[xw(ud(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,_n.none())])}function Wt(t,e,n,...r){t=vr(t,En);const s=vr(t.firestore,Xi),i=ud(s);let o;return o=typeof(e=Pe(e))=="string"||e instanceof cd?F2(i,"updateDoc",t._key,e,n,r):V2(i,"updateDoc",t._key,e),hd(s,[o.toMutation(t._key,_n.exists(!0))])}function Sm(t){return hd(vr(t.firestore,Xi),[new fm(t._key,_n.none())])}function G2(t,e){const n=vr(t.firestore,Xi),r=ye(t),s=kw(t.converter,e);return hd(n,[xw(ud(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,_n.exists(!1))]).then(()=>r)}function hd(t,e){return function(r,s){const i=new Ss;return r.asyncQueue.enqueueAndForget(async()=>nU(await hU(r),s,i)),i.promise}(wm(t),e)}function IU(t,e,n){const r=n.docs.get(e._key),s=new K2(t);return new W2(t,s,e._key,r,new Sc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ud(e)}set(e,n,r){this._verifyNotCommitted();const s=qg(e,this._firestore),i=kw(s.converter,n,r),o=xw(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,_n.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=qg(e,this._firestore);let o;return o=typeof(n=Pe(n))=="string"||n instanceof cd?F2(this._dataReader,"WriteBatch.update",i._key,n,r,s):V2(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,_n.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=qg(e,this._firestore);return this._mutations=this._mutations.concat(new fm(n._key,_n.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new te(q.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qg(t,e){if((t=Pe(t)).firestore!==e)throw new te(q.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(t){return wm(t=vr(t,Xi)),new AU(t,e=>hd(t,e))}(function(e,n=!0){(function(s){Ml=s})(ra),zo(new Fi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Xi(new MF(r.getProvider("auth-internal")),new FF(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new te(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Iu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Kr(EE,"4.7.3",e),Kr(EE,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2="firebasestorage.googleapis.com",J2="storageBucket",jU=2*60*1e3,RU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt extends ts{constructor(e,n,r=0){super(Wg(e),`Firebase Storage: ${n} (${Wg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Wg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var mt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(mt||(mt={}));function Wg(t){return"storage/"+t}function Nw(){const t="An unknown error occurred, please check the error payload for server response.";return new gt(mt.UNKNOWN,t)}function PU(t){return new gt(mt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function DU(t){return new gt(mt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function MU(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gt(mt.UNAUTHENTICATED,t)}function OU(){return new gt(mt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function LU(t){return new gt(mt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function VU(){return new gt(mt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function FU(){return new gt(mt.CANCELED,"User canceled the upload/download.")}function UU(t){return new gt(mt.INVALID_URL,"Invalid URL '"+t+"'.")}function zU(t){return new gt(mt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function BU(){return new gt(mt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+J2+"' property when initializing the app?")}function $U(){return new gt(mt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function HU(){return new gt(mt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qU(t){return new gt(mt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function W0(t){return new gt(mt.INVALID_ARGUMENT,t)}function Y2(){return new gt(mt.APP_DELETED,"The Firebase app was deleted.")}function WU(t){return new gt(mt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $c(t,e){return new gt(mt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function hc(t){throw new gt(mt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Jn.makeFromUrl(e,n)}catch{return new Jn(e,"")}if(r.path==="")return r;throw zU(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function u(A){A.path_=decodeURIComponent(A.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${f}/${d}/b/${s}/o${p}`,"i"),g={bucket:1,path:3},x=n===Q2?"(?:storage.googleapis.com|storage.cloud.google.com)":n,w="([^?#]*)",v=new RegExp(`^https?://${x}/${s}/${w}`,"i"),E=[{regex:a,indices:l,postModify:i},{regex:m,indices:g,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let A=0;A<E.length;A++){const P=E[A],M=P.regex.exec(e);if(M){const N=M[P.indices.bucket];let S=M[P.indices.path];S||(S=""),r=new Jn(N,S),P.postModify(r);break}}if(r==null)throw UU(e);return r}}class KU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let u=!1;function d(...w){u||(u=!0,e.apply(null,w))}function f(w){s=setTimeout(()=>{s=null,t(m,l())},w)}function p(){i&&clearTimeout(i)}function m(w,...v){if(u){p();return}if(w){p(),d.call(null,w,...v);return}if(l()||o){p(),d.call(null,w,...v);return}r<64&&(r*=2);let E;a===1?(a=2,E=0):E=(r+Math.random())*1e3,f(E)}let g=!1;function x(w){g||(g=!0,p(),!u&&(s!==null?(w||(a=2),clearTimeout(s),f(0)):w||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function QU(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JU(t){return t!==void 0}function YU(t){return typeof t=="object"&&!Array.isArray(t)}function Cw(t){return typeof t=="string"||t instanceof String}function lS(t){return Iw()&&t instanceof Blob}function Iw(){return typeof Blob<"u"}function cS(t,e,n,r){if(r<e)throw W0(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw W0(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aw(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function X2(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Io;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Io||(Io={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XU(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e,n,r,s,i,o,a,l,u,d,f,p=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,g)=>{this.resolve_=m,this.reject_=g,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new nh(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Io.NO_ERROR,l=i.getStatus();if(!a||XU(l,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Io.ABORT;r(!1,new nh(!1,null,d));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new nh(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());JU(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=Nw();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?Y2():FU();o(l)}else{const l=VU();o(l)}};this.canceled_?n(!1,new nh(!1,null,!0)):this.backoffId_=GU(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&QU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function ez(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function tz(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function rz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function sz(t,e,n,r,s,i,o=!0){const a=X2(t.urlParams),l=t.url+a,u=Object.assign({},t.headers);return nz(u,e),ez(u,n),tz(u,i),rz(u,r),new ZU(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oz(...t){const e=iz();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Iw())return new Blob(t);throw new gt(mt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function az(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t){if(typeof atob>"u")throw qU("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Kg{constructor(e,n){this.data=e,this.contentType=n||null}}function cz(t,e){switch(t){case Br.RAW:return new Kg(Z2(e));case Br.BASE64:case Br.BASE64URL:return new Kg(eA(t,e));case Br.DATA_URL:return new Kg(dz(e),hz(e))}throw Nw()}function Z2(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function uz(t){let e;try{e=decodeURIComponent(t)}catch{throw $c(Br.DATA_URL,"Malformed data URL.")}return Z2(e)}function eA(t,e){switch(t){case Br.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw $c(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Br.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw $c(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=lz(e)}catch(s){throw s.message.includes("polyfill")?s:$c(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class tA{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw $c(Br.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=fz(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function dz(t){const e=new tA(t);return e.base64?eA(Br.BASE64,e.rest):uz(e.rest)}function hz(t){return new tA(t).contentType}function fz(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n){let r=0,s="";lS(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(lS(this.data_)){const r=this.data_,s=az(r,e,n);return s===null?null:new ui(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ui(r,!0)}}static getBlob(...e){if(Iw()){const n=e.map(r=>r instanceof ui?r.data_:r);return new ui(oz.apply(null,n))}else{const n=e.map(o=>Cw(o)?cz(Br.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new ui(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(t){let e;try{e=JSON.parse(t)}catch{return null}return YU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function mz(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function rA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gz(t,e){return e}let xn=class{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||gz}},rh=null;function yz(t){return!Cw(t)||t.length<2?t:rA(t)}function sA(){if(rh)return rh;const t=[];t.push(new xn("bucket")),t.push(new xn("generation")),t.push(new xn("metageneration")),t.push(new xn("name","fullPath",!0));function e(i,o){return yz(o)}const n=new xn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new xn("size");return s.xform=r,t.push(s),t.push(new xn("timeCreated")),t.push(new xn("updated")),t.push(new xn("md5Hash",null,!0)),t.push(new xn("cacheControl",null,!0)),t.push(new xn("contentDisposition",null,!0)),t.push(new xn("contentEncoding",null,!0)),t.push(new xn("contentLanguage",null,!0)),t.push(new xn("contentType",null,!0)),t.push(new xn("metadata","customMetadata",!0)),rh=t,rh}function xz(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Jn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function vz(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return xz(r,t),r}function iA(t,e,n){const r=nA(e);return r===null?null:vz(t,r,n)}function wz(t,e,n,r){const s=nA(e);if(s===null||!Cw(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,f=t.fullPath,p="/b/"+o(d)+"/o/"+o(f),m=Aw(p,n,r),g=X2({alt:"media",token:u});return m+g})[0]}function bz(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class oA{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(t){if(!t)throw Nw()}function _z(t,e){function n(r,s){const i=iA(t,s,e);return aA(i!==null),i}return n}function Ez(t,e){function n(r,s){const i=iA(t,s,e);return aA(i!==null),wz(i,s,t.host,t._protocol)}return n}function lA(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=OU():s=MU():n.getStatus()===402?s=DU(t.bucket):n.getStatus()===403?s=LU(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Sz(t){const e=lA(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=PU(t.path)),i.serverResponse=s.serverResponse,i}return n}function Tz(t,e,n){const r=e.fullServerUrl(),s=Aw(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new oA(s,i,Ez(t,n),o);return a.errorHandler=Sz(e),a}function kz(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Nz(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=kz(null,e)),r}function Cz(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let A=0;A<2;A++)E=E+Math.random().toString().slice(2);return E}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=Nz(e,r,s),d=bz(u,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+l+"--",m=ui.getBlob(f,r,p);if(m===null)throw $U();const g={name:u.fullPath},x=Aw(i,t.host,t._protocol),w="POST",v=t.maxUploadRetryTime,_=new oA(x,w,_z(t,n),v);return _.urlParams=g,_.headers=o,_.body=m.uploadData(),_.errorHandler=lA(e),_}class Iz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Io.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Io.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Io.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw hc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw hc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw hc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw hc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw hc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Az extends Iz{initXhr(){this.xhr_.responseType="text"}}function cA(){return new Az}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n){this._service=e,n instanceof Jn?this._location=n:this._location=Jn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Go(e,n)}get root(){const e=new Jn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rA(this._location.path)}get storage(){return this._service}get parent(){const e=pz(this._location.path);if(e===null)return null;const n=new Jn(this._location.bucket,e);return new Go(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw WU(e)}}function jz(t,e,n){t._throwIfRoot("uploadBytes");const r=Cz(t.storage,t._location,sA(),new ui(e,!0),n);return t.storage.makeRequestWithTokens(r,cA).then(s=>({metadata:s,ref:t}))}function Rz(t){t._throwIfRoot("getDownloadURL");const e=Tz(t.storage,t._location,sA());return t.storage.makeRequestWithTokens(e,cA).then(n=>{if(n===null)throw HU();return n})}function Pz(t,e){const n=mz(t._location.path,e),r=new Jn(t._location.bucket,n);return new Go(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dz(t){return/^[A-Za-z]+:\/\//.test(t)}function Mz(t,e){return new Go(t,e)}function uA(t,e){if(t instanceof jw){const n=t;if(n._bucket==null)throw BU();const r=new Go(n,n._bucket);return e!=null?uA(r,e):r}else return e!==void 0?Pz(t,e):t}function Oz(t,e){if(e&&Dz(e)){if(t instanceof jw)return Mz(t,e);throw W0("To use ref(service, url), the first argument must be a Storage instance.")}else return uA(t,e)}function uS(t,e){const n=e==null?void 0:e[J2];return n==null?null:Jn.makeFromBucketSpec(n,t)}function Lz(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:MC(s,t.app.options.projectId))}class jw{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=Q2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=jU,this._maxUploadRetryTime=RU,this._requests=new Set,s!=null?this._bucket=Jn.makeFromBucketSpec(s,this._host):this._bucket=uS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Jn.makeFromBucketSpec(this._url,e):this._bucket=uS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Go(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new KU(Y2());{const o=sz(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const dS="@firebase/storage",hS="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="storage";function ml(t,e,n){return t=Pe(t),jz(t,e,n)}function gl(t){return t=Pe(t),Rz(t)}function yl(t,e){return t=Pe(t),Oz(t,e)}function Vz(t=Pv(),e){t=Pe(t);const r=sm(t,dA).getImmediate({identifier:e}),s=RC("storage");return s&&Fz(r,...s),r}function Fz(t,e,n,r={}){Lz(t,e,n,r)}function Uz(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new jw(n,r,s,e,ra)}function zz(){zo(new Fi(dA,Uz,"PUBLIC").setMultipleInstances(!0)),Kr(dS,hS,""),Kr(dS,hS,"esm2017")}zz();const Bz={apiKey:"AIzaSyAU0TCTTobySafDi-9Y68C5eyOD-gmU7nw",authDomain:"vem-simbora.firebaseapp.com",projectId:"vem-simbora",storageBucket:"vem-simbora.firebasestorage.app",messagingSenderId:"403932059706",appId:"1:403932059706:web:5a7e01eebf7be71769bd03",measurementId:"G-31XN454YCP"},Rw=VC(Bz),ze=EI(Rw),vo=Zi(Rw),xl=Vz(Rw);y3(ze,pI).catch(t=>{console.error("Error setting persistence:",t)});const Hc={login:async(t,e)=>{var n;try{if(!e){const o=await st(ye(vo,"users",((n=ze.currentUser)==null?void 0:n.uid)||""));if(!o.exists())throw new Error("User data not found");const a=o.data();return{...ze.currentUser,role:a.role,coins:a.coins}}const s=(await f3(ze,t,e)).user,i=await st(ye(vo,"users",s.uid));if(i.exists()){const o=i.data();return{...s,role:o.role,coins:o.coins}}throw new Error("User data not found")}catch(r){throw console.error("Login error:",r),r}},register:async(t,e,n,r)=>{try{const i=(await Bv(ze,e,n)).user;await Tf(i,{displayName:t});const o={id:i.uid,name:t,email:e,role:r,coins:0,status:"active",createdAt:Date.now(),updatedAt:Date.now()};return await Vs(ye(vo,"users",i.uid),o),{...i,...o}}catch(s){throw console.error("Registration error:",s),s}},logout:async()=>{try{await b3(ze)}catch(t){throw console.error("Logout error:",t),t}},resetPassword:async t=>{try{await zv(ze,t)}catch(e){throw console.error("Password reset error:",e),e}},updateProfile:async(t,e)=>{try{const n=ye(vo,"users",t);if(await Wt(n,{...e,updatedAt:Date.now()}),ze.currentUser){const r={};e.name&&(r.displayName=e.name),e.photoURL&&(r.photoURL=e.photoURL),Object.keys(r).length>0&&(console.log("firebase.ts - Updating auth profile with:",r),await Tf(ze.currentUser,r),console.log("firebase.ts - Auth profile updated successfully"))}}catch(n){throw console.error("Profile update error:",n),n}},reauthenticate:async(t,e)=>{try{const n=ze.currentUser;if(!n)throw new Error("No authenticated user");const r=sa.credential(t,e);return await h3(n,r),!0}catch(n){return console.error("Reauthentication error:",n),!1}}},fS={refreshToken:async t=>{try{return await t.getIdToken(!0)}catch(e){throw console.error("Token refresh error:",e),e}},checkTokenClaims:async t=>{try{const e=await t.getIdTokenResult();return{admin:e.claims.admin===!0,manager:e.claims.manager===!0,employee:e.claims.employee===!0}}catch(e){return console.error("Token claims check error:",e),{admin:!1,manager:!1,employee:!1}}}},hA=T.createContext({currentUser:null,login:async()=>({}),logout:async()=>{},refreshToken:async()=>"",checkTokenClaims:async()=>({admin:!1,manager:!1,employee:!1}),resetPassword:async()=>{},updateUserPassword:async()=>{},setCurrentUser:()=>{},register:async()=>({})}),$z=({children:t})=>{const[e,n]=T.useState(null),[r,s]=T.useState(!0),i=T.useCallback(async g=>{if(console.log("AuthContext updateUser - user:",g),g)try{const x=localStorage.getItem("user");if(x){const w=JSON.parse(x);console.log("AuthContext updateUser - storedUser:",w),await sE(g,!0);const v=await st(ye(vo,"users",g.uid));if(v.exists()){const _=v.data(),E={...g,role:_.role,coins:_.coins,bio:_.bio};n(E),localStorage.setItem("user",JSON.stringify({role:_.role,coins:_.coins,bio:_.bio}))}else{const _={...g,role:w.role,coins:w.coins,bio:w.bio};n(_)}}else{const w=await st(ye(vo,"users",g.uid));if(w.exists()){const v=w.data(),_={...g,role:v.role,coins:v.coins,bio:v.bio};n(_),localStorage.setItem("user",JSON.stringify({role:v.role,coins:v.coins,bio:v.bio}))}else n(g)}}catch(x){console.error("Error restoring session:",x),n(null)}else n(null)},[]);T.useEffect(()=>{const g=w3(ze,async w=>{await i(w),s(!1)},w=>{console.error("Authentication listener error:",w),n(null),s(!1)}),x=setInterval(async()=>{if(e)try{await sE(e,!0)}catch(w){console.error("Token expired:",w),await a()}},30*60*1e3);return()=>{g(),clearInterval(x)}},[i]);const o=async(g,x)=>{try{const w=await Hc.login(g,x);console.log("AuthContext login - user after AuthService.login:",w);const v={...w,role:w.role,coins:w.coins};return localStorage.setItem("user",JSON.stringify({role:w.role,coins:w.coins})),n(v),v}catch(w){throw console.error("Login error:",w),w}},a=async()=>{try{await Hc.logout(),localStorage.removeItem("user"),n(null)}catch(g){throw console.error("Logout error:",g),g}},m={currentUser:e,login:o,logout:a,refreshToken:async()=>{if(!e)throw new Error("No authenticated user");return fS.refreshToken(e)},checkTokenClaims:async()=>{if(!e)throw new Error("No authenticated user");return fS.checkTokenClaims(e)},resetPassword:async g=>{try{await zv(ze,g)}catch(x){throw console.error("Error sending password reset email:",x),x}},updateUserPassword:async g=>{try{if(!e)throw new Error("No authenticated user");await m3(e,g)}catch(x){throw console.error("Error updating password:",x),x}},setCurrentUser:n,register:async(g,x,w,v)=>{try{const E=(await Bv(ze,x,w)).user;await Tf(E,{displayName:g});const A={id:E.uid,name:g,email:x,role:v,coins:0,status:"active",createdAt:Date.now(),updatedAt:Date.now()};await Vs(ye(vo,"users",E.uid),A);const P={...E,role:v,coins:0};return localStorage.setItem("user",JSON.stringify({role:v,coins:0})),n(P),P}catch(_){throw console.error("Registration error:",_),_}}};return c.jsx(hA.Provider,{value:m,children:!r&&t})},tn=()=>T.useContext(hA),Bt=({children:t,allowedRoles:e})=>{const{currentUser:n}=tn();return n?e&&!e.includes(n.role)?c.jsx(g0,{to:"/unauthorized",replace:!0}):c.jsx(c.Fragment,{children:t}):c.jsx(g0,{to:"/login",replace:!0})};class Hz extends pt.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,n){const r={componentStack:n.componentStack};QO(e,{extra:r})}render(){return this.state.hasError?this.props.fallback||c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Algo deu errado"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Desculpe, ocorreu um erro inesperado. Por favor, tente novamente ou entre em contato com o suporte."}),c.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Recarregar Página"})]})}):this.props.children}}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),re=(t,e)=>{const n=T.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:l,...u},d)=>T.createElement("svg",{ref:d,...qz,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Wz(t)}`,a].join(" "),...u},[...e.map(([f,p])=>T.createElement(f,p)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=re("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=re("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=re("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=re("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=re("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=re("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=re("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=re("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=re("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=re("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=re("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=re("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=re("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=re("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=re("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=re("CornerDownLeft",[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=re("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=re("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=re("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=re("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=re("FilePen",[["path",{d:"M12 22h6a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v10",key:"x7tsz2"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10.4 12.6a2 2 0 1 1 3 3L8 21l-4 1 1-4Z",key:"o3xyfb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=re("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=re("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=re("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=re("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=re("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mA=re("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=re("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=re("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=re("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=re("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=re("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=re("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=re("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=re("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yA=re("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=re("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=re("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=re("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=re("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=re("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=re("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=re("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=re("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=re("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=re("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=re("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=re("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=re("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=re("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=re("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=re("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=re("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),gB=T.forwardRef(({role:t},e)=>{const n=mn(),{currentUser:r}=tn(),[s,i]=T.useState("dashboard"),a=(u=>{const d=[{icon:Mw,label:"Dashboard",route:`/${u}/dashboard`,key:"dashboard"},{icon:wo,label:"Notificações",route:"/notifications",key:"notifications"}],f={admin:[{icon:Jo,label:"Usuários",route:"/admin/user-management",key:"users"},{icon:$i,label:"Projetos",route:"/admin/projects",key:"projects"},{icon:Xe,label:"Tarefas",route:"/admin/tasks",key:"tasks"},{icon:Ns,label:"Configurações",route:"/admin/settings",key:"settings"}],manager:[{icon:$i,label:"Projetos",route:"/manager/projects",key:"projects"},{icon:Xe,label:"Tarefas",route:"/manager/tasks",key:"tasks"},{icon:Ns,label:"Configurações",route:"/manager/settings",key:"settings"}],employee:[{icon:Xe,label:"Tarefas",route:"/employee/tasks",key:"tasks"},{icon:Ns,label:"Configurações",route:"/employee/settings",key:"settings"}]};return u?[...d,...f[u]||[]]:[...d]})(t),l=(u,d)=>{i(d),n(u)};return c.jsx("nav",{ref:e,className:"fixed bottom-0 left-0 right-0 bg-white shadow-2xl border-t z-50 md:hidden h-14",children:c.jsx("div",{className:"grid grid-cols-5 py-2",children:a.map(u=>c.jsxs("button",{onClick:()=>l(u.route,u.key),className:`flex flex-col items-center justify-center ${s===u.key?"text-blue-600":"text-gray-500"}`,children:[c.jsx(u.icon,{size:24,strokeWidth:s===u.key?2.5:1.5}),c.jsx("span",{className:"text-xs mt-1",children:u.label})]},u.key))})})}),yB=()=>c.jsx("div",{className:"fixed inset-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-50",children:c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx(qc,{className:"animate-spin text-blue-600 w-12 h-12 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"Carregando..."})]})}),mr=t=>{const n=`
    <svg width="40" height="40" xmlns="http://www.w3.org/2000/svg">
      <rect width="100%" height="100%" fill="#3b82f6" />
      <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="20" fill="#ffffff">
        ${t?t.charAt(0).toUpperCase():"?"}
      </text>
    </svg>
  `,r=`data:image/svg+xml;base64,${btoa(n)}`;return console.log("getDefaultProfileImage - dataURL:",r),r},xB=({role:t,isSidebarHidden:e,toggleSidebar:n})=>{const{logout:r,currentUser:s}=tn(),i=mn(),o=[{icon:Mw,label:"Dashboard",href:`/${t}/dashboard`}],a={admin:[{icon:$i,label:"Projetos",href:"/admin/projects"},{icon:Xe,label:"Tarefas",href:"/admin/tasks"},{icon:Jo,label:"Usuários",href:"/admin/user-management"},{icon:Ns,label:"Configurações",href:"/admin/settings"}],manager:[{icon:$i,label:"Projetos",href:"/manager/projects"},{icon:Xe,label:"Tarefas",href:"/manager/tasks"},{icon:Ns,label:"Configurações",href:"/manager/settings"}],employee:[{icon:Xe,label:"Tarefas",href:"/employee/tasks"},{icon:Ns,label:"Configurações",href:"/employee/settings"}]},l=[...o,...a[t]||[]],u=async()=>{try{await r(),i("/login")}catch(d){console.error("Erro ao fazer logout:",d)}};return c.jsx(c.Fragment,{children:c.jsxs("div",{className:`hidden md:flex flex-col bg-white border-r shadow-md h-screen fixed left-0 top-0  transition-all duration-300 ${e?"w-16":"w-[calc(64*4px-30px)]"} overflow-hidden`,children:[c.jsx("button",{onClick:n,className:"p-4 text-gray-600 hover:text-gray-900 flex justify-center items-center",children:e?c.jsx(la,{size:24}):c.jsx(aa,{size:24})}),c.jsx("div",{className:"p-4 flex-shrink-0",children:c.jsx(De,{to:`/profile/${s==null?void 0:s.uid}`,children:c.jsxs("div",{className:`flex items-center mb-8 ${e?"justify-center":"justify-start"}`,children:[c.jsx("img",{src:(s==null?void 0:s.photoURL)||mr((s==null?void 0:s.displayName)||""),alt:"Vem Simbora Logo",className:"w-12 h-12 rounded-full object-cover"}),!e&&c.jsx(c.Fragment,{children:c.jsxs("div",{className:"ml-3",children:[c.jsx("h2",{className:"text-base font-bold text-gray-800",children:(s==null?void 0:s.displayName)||"Usuário"}),c.jsx("p",{className:"text-sm text-gray-500 capitalize",children:t})]})})]})})}),c.jsxs("nav",{className:"flex-1 overflow-y-auto",children:[c.jsxs(De,{to:"/notifications",className:`flex items-center py-3 hover:bg-gray-100 rounded-lg transition ${e?"justify-center px-0":"px-4"}`,children:[c.jsx(wo,{className:`text-gray-500 ${e?"":"mr-3"}`,size:20}),!e&&c.jsx("span",{className:"text-gray-500",children:"Notificações"})]}),c.jsx("div",{className:"py-4"}),c.jsxs(De,{to:`/profile/${s==null?void 0:s.uid}`,className:`flex items-center py-3  hover:bg-gray-100 rounded-lg transition  ${e?"justify-center px-0":"px-4"}`,children:[c.jsx(Du,{className:" text-gray-600",size:20}),!e&&c.jsx("span",{className:"ml-3 text-gray-700",children:"Meu Perfil"})]}),l.map((d,f)=>c.jsxs(De,{to:d.href,className:`flex items-center py-3  hover:bg-gray-100 rounded-lg transition  ${e?"justify-center px-0":"px-4"}`,children:[c.jsx(d.icon,{className:" text-gray-600",size:20}),!e&&c.jsx("span",{className:"ml-3 text-gray-700",children:d.label})]},f))]}),c.jsx("div",{className:"p-4 flex-shrink-0",children:c.jsxs("button",{onClick:u,className:"w-full flex items-center  py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition justify-center",children:[c.jsx(aB,{size:20})," ",!e&&c.jsx("span",{className:"ml-2",children:"Sair"})]})})]})})},Re=({children:t,role:e="employee",isLoading:n=!1,hideNavigation:r=!1})=>{const s=T.useRef(null),i=Rl(),[o,a]=T.useState(!0);T.useEffect(()=>{const f=localStorage.getItem("isSidebarHidden");a(f?f==="true":!0)},[]),T.useEffect(()=>{localStorage.setItem("isSidebarHidden",o.toString())},[o]);const l=()=>{a(f=>!f)},u=i.pathname.startsWith("/admin/projects/")&&i.pathname.endsWith("/chat"),d=window.innerWidth<768;return c.jsxs("div",{className:"flex",children:[!r&&c.jsx(xB,{role:e,isSidebarHidden:o,toggleSidebar:l})," ",c.jsx("main",{className:`
        w-full bg-gray-50 min-h-screen
        ${r?"":o?"md:ml-16":"md:ml-[calc(64*4px-30px)]"}
        transition-all duration-300
        ${!r&&!u&&d?"pb-16":""}
      `,children:n?c.jsx(yB,{}):t}),!r&&!u&&d&&c.jsx(gB,{ref:s,role:e})]})},vB=()=>{const[t,e]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState(!1),[l,u]=T.useState(!1),[d,f]=T.useState(!1),[p,m]=T.useState(!1),{login:g}=tn(),x=mn();T.useEffect(()=>{m(!0)},[]);const w=async _=>{_.preventDefault(),i(""),a(!0);try{switch((await g(t,n)).role){case"admin":x("/admin/dashboard");break;case"manager":x("/manager/dashboard");break;case"employee":x("/employee/dashboard");break;default:x("/login")}}catch(E){i(v(E.code)),a(!1)}},v=_=>{const E={"auth/user-not-found":"Usuário não encontrado","auth/wrong-password":"Senha incorreta","auth/invalid-email":"Email inválido","auth/user-disabled":"Conta desativada","auth/too-many-requests":"Muitas tentativas. Tente novamente mais tarde.",default:"Erro de autenticação. Tente novamente."};return E[_]||E.default};return c.jsx(Re,{hideNavigation:!0,isLoading:!1,children:c.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4 py-12",children:c.jsxs("div",{className:`w-full max-w-md transition-all duration-700 transform ${p?"translate-y-0 opacity-100":"translate-y-8 opacity-0"}`,children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 shadow-lg mb-4",children:c.jsx(pS,{className:"text-white",size:32})}),c.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-1",children:"Vem Simbora"}),c.jsx("p",{className:"text-gray-600",children:"Gestão de Tarefas Simplificada"})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-4 text-white",children:c.jsx("h2",{className:"text-xl font-semibold text-center",children:"Acesse sua conta"})}),s&&c.jsxs("div",{className:"mx-4 mt-4 bg-red-50 border-l-4 border-red-500 p-4 flex items-start",children:[c.jsx(Pw,{className:"text-red-500 mr-3 flex-shrink-0 mt-0.5",size:18}),c.jsx("p",{className:"text-red-700 text-sm",children:s})]}),c.jsxs("form",{onSubmit:w,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Nm,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"email",type:"email",value:t,onChange:_=>e(_.target.value),placeholder:"seu@email.com",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",required:!0,autoComplete:"email"})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Senha"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Ow,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"password",type:l?"text":"password",value:n,onChange:_=>r(_.target.value),placeholder:"••••••••",className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",required:!0,autoComplete:"current-password"}),c.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",children:l?c.jsx(fA,{size:20}):c.jsx(Va,{size:20})})]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{id:"remember-me",type:"checkbox",checked:d,onChange:_=>f(_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Lembrar-me"})]}),c.jsx(De,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Esqueceu a senha?"})]}),c.jsx("button",{type:"submit",disabled:o,className:"w-full flex items-center justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?c.jsxs("div",{className:"flex items-center",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Entrando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(pS,{className:"mr-2",size:20})," Entrar"]})})]}),c.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 text-center",children:c.jsx("p",{className:"text-sm text-gray-600",children:"Não tem uma conta? Fale com o administrador do sistema."})})]}),c.jsx("div",{className:"text-center mt-6",children:c.jsx("p",{className:"text-xs text-gray-500",children:"Vem Simbora v1.0.0 © 2023"})})]})})})},wB=()=>{const[t,e]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState(!1),[l,u]=T.useState(!1),[d,f]=T.useState(0),{resetPassword:p}=tn(),m=mn();T.useEffect(()=>{u(!0)},[]),T.useEffect(()=>{if(d>0){const w=setTimeout(()=>f(d-1),1e3);return()=>clearTimeout(w)}else d===0&&s&&m("/login")},[d,s,m]);const g=async w=>{w.preventDefault(),r(""),i(""),a(!0);try{await p(t),i("Link de redefinição de senha enviado. Verifique seu email."),f(5)}catch(v){r(x(v.code))}finally{a(!1)}},x=w=>{switch(w){case"auth/user-not-found":return"Nenhum usuário encontrado com este email.";case"auth/invalid-email":return"O email fornecido é inválido.";case"auth/missing-email":return"Por favor, insira um endereço de email.";case"auth/too-many-requests":return"Muitas tentativas. Tente novamente mais tarde.";default:return console.error("Unhandled Firebase error code:",w),"Erro ao redefinir senha. Tente novamente. Se o problema persistir, entre em contato com o suporte."}};return c.jsx(Re,{hideNavigation:!0,isLoading:!1,children:c.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 px-4 py-12",children:c.jsxs("div",{className:`w-full max-w-md transition-all duration-700 transform ${l?"translate-y-0 opacity-100":"translate-y-8 opacity-0"}`,children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 shadow-lg mb-4",children:c.jsx(Ow,{className:"text-white",size:32})}),c.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-1",children:"Redefinir Senha"}),c.jsx("p",{className:"text-gray-600",children:"Vem Simbora - Gestão de Tarefas"})]}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-4 text-white",children:c.jsx("h2",{className:"text-xl font-semibold text-center",children:"Recuperação de Conta"})}),s&&c.jsxs("div",{className:"mx-4 mt-4 bg-green-50 border-l-4 border-green-500 p-4 flex items-start",children:[c.jsx(Xe,{className:"text-green-500 mr-3 flex-shrink-0 mt-0.5",size:18}),c.jsxs("div",{children:[c.jsx("p",{className:"text-green-700 text-sm",children:s}),d>0&&c.jsxs("p",{className:"text-green-600 text-xs mt-1",children:["Redirecionando para o login em ",d," segundos..."]})]})]}),n&&c.jsxs("div",{className:"mx-4 mt-4 bg-red-50 border-l-4 border-red-500 p-4 flex items-start",children:[c.jsx(Pw,{className:"text-red-500 mr-3 flex-shrink-0 mt-0.5",size:18}),c.jsx("p",{className:"text-red-700 text-sm",children:n})]}),c.jsxs("form",{onSubmit:g,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Nm,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"email",type:"email",value:t,onChange:w=>e(w.target.value),placeholder:"Digite seu email",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",required:!0,autoComplete:"email"})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Enviaremos um link para redefinir sua senha."})]}),c.jsx("button",{type:"submit",disabled:o||!!s,className:"w-full flex items-center justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-white bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?c.jsxs("div",{className:"flex items-center",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enviando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(xA,{className:"mr-2",size:20})," Enviar Link de Recuperação"]})})]}),c.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:c.jsxs(De,{to:"/login",className:"flex items-center justify-center text-sm text-blue-600 hover:text-blue-800 transition-colors",children:[c.jsx(ks,{size:16,className:"mr-1"})," Voltar para Login"]})})]}),c.jsx("div",{className:"text-center mt-6",children:c.jsx("p",{className:"text-xs text-gray-500",children:"Vem Simbora v1.0.0 © 2023"})})]})})})},qn={isValidEmail:t=>/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t),isStrongPassword:t=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(t),isValidName:t=>/^[A-Za-zÀ-ÿ]+\s[A-Za-zÀ-ÿ]+(\s[A-Za-zÀ-ÿ]+)*$/.test(t),isValidCPF:t=>{if(t=t.replace(/[^\d]/g,""),t.length!==11||/^(\d)\1+$/.test(t))return!1;let e=0;for(let r=0;r<9;r++)e+=parseInt(t.charAt(r))*(10-r);let n=11-e%11;if((n===10||n===11)&&(n=0),n!==parseInt(t.charAt(9)))return!1;e=0;for(let r=0;r<10;r++)e+=parseInt(t.charAt(r))*(11-r);return n=11-e%11,(n===10||n===11)&&(n=0),n===parseInt(t.charAt(10))},isValidCNPJ:t=>{if(t=t.replace(/[^\d]/g,""),t.length!==14||/^(\d)\1+$/.test(t))return!1;let e=0,n=2;for(let o=11;o>=0;o--)e+=parseInt(t.charAt(o))*n,n=n===9?2:n+1;let r=e%11,s=r<2?0:11-r;e=0,n=2;for(let o=12;o>=0;o--)e+=parseInt(t.charAt(o))*n,n=n===9?2:n+1;r=e%11;let i=r<2?0:11-r;return parseInt(t.charAt(12))===s&&parseInt(t.charAt(13))===i},isValidPhoneNumber:t=>/^(\+?55\s?)?(\(?[1-9]{2}\)?)\s?([9]{1}[6-9]{1}[0-9]{3}[-]?[0-9]{4})$/.test(t),isValidURL:t=>/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(t),isValidDate:t=>{if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;const n=new Date(t);return n instanceof Date&&!isNaN(n.getTime())},isMinimumAge:(t,e)=>{const n=new Date(t),r=new Date;let s=r.getFullYear()-n.getFullYear();const i=r.getMonth()-n.getMonth();return(i<0||i===0&&r.getDate()<n.getDate())&&s--,s>=e},sanitizeInput:t=>t.trim().replace(/</g,"<").replace(/>/g,">").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),isValidFileType:(t,e)=>e.includes(t.type),isValidFileSize:(t,e)=>{const n=e*1024*1024;return t.size<=n}};class bB{constructor(){zn(this,"db",Zi());zn(this,"auth",EI())}async createUser(e,n){try{if(!n)throw new Error("Password is required");const s=(await Bv(this.auth,e.email,n)).user;await Tf(s,{displayName:e.name});const i={id:s.uid,...e,coins:0,status:"active",createdAt:Date.now(),updatedAt:Date.now()};return await Vs(ye(this.db,"users",s.uid),i),i}catch(r){throw console.error("Erro ao criar usuário:",r),r}}async updateUser(e,n,r){try{const s=ye(this.db,"users",e),i={...n,updatedAt:Date.now()};if(r){const a=yl(xl,`users/${e}/profile_image`);await ml(a,r);const l=await gl(a);i.profileImage=l}await Wt(s,i);const o=await st(s);if(!o.exists())throw new Error("Failed to fetch updated user data.");return{id:o.id,...o.data()}}catch(s){throw console.error("Erro ao atualizar usuário:",s),s}}async deleteUser(e){try{await Sm(ye(this.db,"users",e));const n=this.auth.currentUser;n&&n.uid===e&&await _3(n)}catch(n){throw console.error("Erro ao excluir usuário:",n),n}}async fetchUsers(e){try{let n=it(wn(this.db,"users"));e!=null&&e.role&&(n=it(n,fr("role","==",e.role))),e!=null&&e.status&&(n=it(n,fr("status","==",e.status))),e!=null&&e.userIds&&e.userIds.length>0&&(n=it(n,fr("id","in",e.userIds))),n=it(n,Fl("name"));let s=(await Ts(n)).docs.map(f=>({id:f.id,...f.data()}));if(e!=null&&e.searchTerm){const f=e.searchTerm.toLowerCase();s=s.filter(p=>p.name.toLowerCase().includes(f)||p.email.toLowerCase().includes(f))}const i=(e==null?void 0:e.limit)||10,a=(((e==null?void 0:e.page)||1)-1)*i,l=a+i,u=s.slice(a,l),d=Math.ceil(s.length/i);return{data:u,totalPages:d,totalUsers:s.length}}catch(n){throw console.error("Erro ao buscar usuários:",n),console.error("Error Code:",n.code),console.error("Error Message:",n.message),n.code==="permission-denied"?new Error("You don't have permission to access this data."):n.code==="not-found"?new Error("The requested data was not found."):n.code==="failed-precondition"?new Error("The operation failed because of a missing index. Check the Firebase console for details."):new Error("An error occurred while fetching users.")}}async getUserById(e){try{const n=ye(this.db,"users",e),r=await st(n);if(r.exists())return{id:r.id,...r.data()};throw new Error("Usuário não encontrado")}catch(n){throw console.error("Erro ao buscar usuário por ID:",n),n}}async sendPasswordResetEmail(e){try{await zv(this.auth,e)}catch(n){throw console.error("Erro ao enviar email de redefinição:",n),n}}async updateUserCoins(e,n){try{const r=ye(this.db,"users",e),s=await st(r);if(!s.exists())throw new Error("Usuário não encontrado");const o=(s.data().coins||0)+n;return await Wt(r,{coins:o,updatedAt:Date.now()}),o}catch(r){throw console.error("Erro ao atualizar moedas:",r),r}}async logCoinTransaction(e,n,r){try{const s=ye(wn(this.db,"users",e,"coin_transactions"));await Vs(s,{amount:n,description:r,timestamp:Date.now()})}catch(s){throw console.error("Erro ao registrar transação de moedas:",s),s}}}const vt=new bB,_B=()=>{const{currentUser:t,logout:e,setCurrentUser:n,updateUserPassword:r}=tn(),s=mn(),i=T.useRef(null),o=T.useRef(null),[a,l]=T.useState(""),[u,d]=T.useState(""),[f,p]=T.useState(""),[m,g]=T.useState(""),[x,w]=T.useState(""),[v,_]=T.useState(null),[E,A]=T.useState(!1),[P,M]=T.useState(""),[N,S]=T.useState(!1),[C,j]=T.useState(null),[D,R]=T.useState(""),[k,z]=T.useState(""),[O,W]=T.useState(""),[Z,B]=T.useState(!0),[V,$]=T.useState(!1),[F,H]=T.useState(null);T.useEffect(()=>{(async()=>{B(!0),z("");try{if(t){l(t.displayName||""),d(t.email||""),_(t.photoURL||null);const we=await vt.getUserById(t.uid);we&&(M(we.coverImage||"linear-gradient(to right, #4c51bf, #6a82fb)"),we.bio&&R(we.bio))}}catch(we){z(we.message||"Failed to load profile data."),console.error("Error fetching user data:",we)}finally{B(!1)}})()},[t==null?void 0:t.uid]),T.useEffect(()=>{if(!m){H(null);return}const Te=/[a-z]/.test(m),we=/[A-Z]/.test(m),$e=/\d/.test(m),He=/[!@#$%^&*(),.?":{}|<>]/.test(m),ct=m.length>=8,Ut=[Te,we,$e,He,ct].filter(Boolean).length;Ut<=2?H("weak"):Ut<=4?H("medium"):H("strong")},[m]);const X=async Te=>{var $e;const we=($e=Te.target.files)==null?void 0:$e[0];if(we){if(!qn.isValidFileType(we,["image/jpeg","image/png"])){z("Formato de imagem inválido. Use JPEG ou PNG.");return}if(!qn.isValidFileSize(we,5)){z("Imagem muito grande. O tamanho máximo é 5MB.");return}A(!0),z("");try{const He=yl(xl,`users/${t.uid}/profileImage`);await ml(He,we);const ct=await gl(He);if(_(ct),await Hc.updateProfile(t.uid,{photoURL:ct}),await vt.updateUser(t.uid,{profileImage:ct}),t){const Ut={...t,photoURL:ct};n(Ut)}W("Imagem de perfil atualizada!"),setTimeout(()=>W(""),3e3)}catch(He){z(He.message||"Erro ao fazer upload da imagem")}finally{A(!1)}}},ge=async Te=>{var $e;const we=($e=Te.target.files)==null?void 0:$e[0];if(we){if(!qn.isValidFileType(we,["image/jpeg","image/png"])){j("Formato de imagem inválido. Use JPEG ou PNG.");return}if(!qn.isValidFileSize(we,5)){j("Imagem muito grande. O tamanho máximo é 5MB.");return}S(!0),j(null);try{const He=yl(xl,`users/${t.uid}/coverImage`);await ml(He,we);const ct=await gl(He);if(M(ct),await vt.updateUser(t.uid,{coverImage:ct}),t){const Ut={...t,coverImage:ct};n(Ut)}W("Imagem de capa atualizada!"),setTimeout(()=>W(""),3e3)}catch(He){j(He.message||"Erro ao fazer upload da imagem de capa.")}finally{S(!1)}}},Ie=()=>m!==x?(z("Novas senhas não coincidem"),!1):m&&!qn.isStrongPassword(m)?(z("Nova senha não atende aos requisitos de segurança."),!1):!0,ae=async Te=>{Te.preventDefault(),z(""),W(""),$(!0);try{if(!qn.isValidName(a)){z("Nome inválido. Use nome e sobrenome."),$(!1);return}if(m){if(!Ie()){$(!1);return}if(t&&f){if(!await Hc.reauthenticate(t.email,f)){z("Senha atual incorreta. Reautenticação falhou."),$(!1);return}await r(m),p(""),g(""),w(""),H(null)}}const we={};if(a!==(t==null?void 0:t.displayName)&&(we.name=a),D!==(t==null?void 0:t.bio)&&(we.bio=D),Object.keys(we).length>0&&(await Hc.updateProfile(t.uid,we),await vt.updateUser(t.uid,we),t)){const $e={...t,displayName:we.name||t.displayName,bio:we.bio||t.bio};n($e)}W("Perfil atualizado com sucesso!"),setTimeout(()=>W(""),3e3)}catch(we){z(we.message||"Erro ao atualizar perfil")}finally{$(!1)}},oe=()=>{const Te=(t==null?void 0:t.role)==="admin"?"/admin/settings":(t==null?void 0:t.role)==="manager"?"/manager/settings":"/employee/settings";s(Te)};return c.jsx(Re,{role:(t==null?void 0:t.role)||"employee",isLoading:Z,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Meu Perfil"}),c.jsx("button",{onClick:oe,className:"text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Fechar",children:c.jsx(Wn,{size:24})})]}),c.jsxs("div",{className:"relative w-full h-48 bg-gray-200 rounded-xl overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:P.startsWith("linear-gradient")?P:`url(${P})`},children:!P.startsWith("linear-gradient")&&c.jsx("div",{className:"absolute inset-0 bg-black opacity-30"})}),c.jsx("input",{type:"file",accept:"image/*",ref:o,onChange:ge,className:"hidden"}),c.jsx("button",{onClick:()=>{var Te;return(Te=o.current)==null?void 0:Te.click()},className:"absolute top-4 right-4 bg-white bg-opacity-75 text-gray-700 p-2 rounded-full hover:bg-opacity-100 transition-colors",title:"Alterar Imagem de Capa",children:c.jsx(Lf,{size:20})}),N&&c.jsx("div",{className:"absolute top-1/2 right-4 transform -translate-y-1/2",children:c.jsx(qc,{className:"animate-spin text-white",size:20})}),C&&c.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-red-500 text-white px-4 py-2 rounded",children:C})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[c.jsx("div",{className:"md:col-span-2 bg-white p-8 rounded-xl shadow-md",children:c.jsxs("form",{onSubmit:ae,className:"space-y-6",children:[k&&c.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg mb-4 flex items-center",children:[c.jsx(en,{className:"mr-2 flex-shrink-0"}),c.jsx("p",{children:k})]}),O&&c.jsxs("div",{className:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-lg mb-4 flex items-center",children:[c.jsx(Xe,{className:"mr-2 flex-shrink-0"}),c.jsx("p",{children:O})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"name",className:"block text-gray-700 mb-2 flex items-center",children:[c.jsx(Du,{className:"mr-2 text-gray-500",size:20})," Nome"]}),c.jsx("input",{type:"text",id:"name",value:a,onChange:Te=>l(Te.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"email",className:"block text-gray-700 mb-2 flex items-center",children:[c.jsx(Nm,{className:"mr-2 text-gray-500",size:20})," Email"]}),c.jsx("input",{type:"email",id:"email",value:u,readOnly:!0,className:"w-full px-4 py-2 border rounded-lg bg-gray-100 text-gray-700 cursor-not-allowed"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"bio",className:"block text-gray-700 mb-2 flex items-center",children:[c.jsx(pA,{className:"mr-2 text-gray-500",size:20})," Bio"]}),c.jsx("textarea",{id:"bio",value:D,onChange:Te=>R(Te.target.value),placeholder:"Conte um pouco sobre você...",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 h-24 resize-none"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"currentPassword",className:"block text-gray-700 mb-2 flex items-center",children:[c.jsx(Ow,{className:"mr-2 text-gray-500",size:20})," Senha Atual"]}),c.jsx("input",{type:"password",id:"currentPassword",value:f,onChange:Te=>p(Te.target.value),placeholder:"Necessário para alterar senha",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"newPassword",className:"block text-gray-700 mb-2 flex items-center",children:[c.jsx(Ff,{className:"mr-2 text-gray-500",size:20})," Nova Senha"]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"password",id:"newPassword",value:m,onChange:Te=>g(Te.target.value),placeholder:"Mínimo 8 caracteres",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),F&&c.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center",children:[c.jsx("div",{className:`h-2 w-16 rounded-full ${F==="weak"?"bg-red-500":F==="medium"?"bg-yellow-500":"bg-green-500"}`}),c.jsx("span",{className:"ml-2 text-xs text-gray-500",children:F==="weak"?"Fraca":F==="medium"?"Média":"Forte"})]})]})]})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"confirmPassword",className:"block text-gray-700 mb-2 flex items-center",children:[c.jsx(Ff,{className:"mr-2 text-gray-500",size:20})," Confirmar Nova Senha"]}),c.jsx("input",{type:"password",id:"confirmPassword",value:x,onChange:Te=>w(Te.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsx("button",{type:"submit",disabled:V,className:"w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition flex items-center justify-center disabled:opacity-50",children:V?c.jsxs(c.Fragment,{children:[c.jsx(qc,{className:"animate-spin mr-2"}),"Salvando..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Wc,{className:"mr-2"})," Salvar Alterações"]})})]})}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md flex flex-col items-center",children:[c.jsxs("div",{className:"relative mb-6",children:[c.jsx("img",{src:v||"https://via.placeholder.com/150",alt:"Foto de Perfil",className:"w-48 h-48 rounded-full object-cover border-4 border-blue-100"}),c.jsxs("label",{htmlFor:"profile-upload",className:"absolute bottom-0 right-0 bg-blue-600 text-white p-2 rounded-full cursor-pointer hover:bg-blue-700 transition",children:[c.jsx(Lf,{size:20}),c.jsx("input",{ref:i,type:"file",id:"profile-upload",accept:"image/*",className:"hidden",onChange:X})]}),E&&c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-full",children:c.jsx(qc,{className:"animate-spin h-10 w-10 text-white"})})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:a}),c.jsx("p",{className:"text-gray-600 capitalize",children:t==null?void 0:t.role}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:u})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:[c.jsx(vl,{className:"mr-2 text-yellow-500"})," Estatísticas"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600",children:"Moedas"}),c.jsxs("span",{className:"font-semibold text-yellow-600 flex items-center",children:[(t==null?void 0:t.coins)||0," ",c.jsx(vl,{className:"ml-1",size:16})]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600",children:"Tarefas Concluídas"}),c.jsx("span",{className:"font-semibold text-green-600",children:"15"})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600",children:"Projetos Ativos"}),c.jsx("span",{className:"font-semibold text-blue-600",children:"3"})]})]})]})]})]})]})})})},EB=()=>{const t=mn(),{currentUser:e,logout:n}=tn(),r=()=>{switch(e==null?void 0:e.role){case"admin":t("/admin/dashboard");break;case"manager":t("/manager/dashboard");break;case"employee":t("/employee/dashboard");break;default:t("/login")}},s=async()=>{await n(),t("/login")};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:c.jsxs("div",{className:"bg-white p-10 rounded-xl shadow-2xl text-center max-w-md w-full",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx(Ff,{className:"text-red-500",size:64,strokeWidth:1.5})}),c.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Acesso Não Autorizado"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Você não tem permissão para acessar esta página. Verifique suas credenciais ou entre em contato com o administrador."}),e&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("p",{className:"text-gray-700",children:["Usuário Atual: ",c.jsx("span",{className:"font-semibold",children:e.displayName})]}),c.jsxs("p",{className:"text-gray-700",children:["Função: ",c.jsx("span",{className:"font-semibold capitalize",children:e.role})]})]}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsxs("button",{onClick:r,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition flex items-center",children:[c.jsx(Mw,{className:"mr-2",size:20}),"Voltar para Dashboard"]}),c.jsx("button",{onClick:s,className:"bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition",children:"Fazer Logout"})]})]})})};class SB{constructor(){zn(this,"db",Zi())}async createNotification(e,n){try{const r={userId:e,...n,read:!1,timestamp:Date.now()},s=await G2(wn(this.db,"users",e,"notifications"),r);return{...r,id:s.id}}catch(r){throw console.error("Erro ao criar notificação:",r),r}}async getUserNotifications(e,n){try{let r=it(wn(this.db,"users",e,"notifications"),Fl("timestamp","desc"));return n!=null&&n.unreadOnly&&(r=it(r,fr("read","==",!1))),n!=null&&n.type&&(r=it(r,fr("type","==",n.type))),n!=null&&n.limit&&(r=it(r,H2(n.limit))),(await Ts(r)).docs.map(i=>({id:i.id,...i.data()}))}catch(r){throw console.error("Erro ao buscar notificações:",r),r}}async markNotificationAsRead(e,n){try{const r=ye(this.db,"users",e,"notifications",n);await Wt(r,{read:!0})}catch(r){throw console.error("Erro ao marcar notificação como lida:",r),r}}async markAllNotificationsAsRead(e){try{const n=it(wn(this.db,"users",e,"notifications"),fr("read","==",!1)),r=await Ts(n),s=q0(this.db);r.docs.forEach(i=>{const o=ye(this.db,"users",e,"notifications",i.id);s.update(o,{read:!0})}),await s.commit()}catch(n){throw console.error("Erro ao marcar todas as notificações como lidas:",n),n}}async clearOldNotifications(e,n=30){try{const r=Date.now()-n*24*60*60*1e3,s=it(wn(this.db,"users",e,"notifications"),fr("timestamp","<",r)),i=await Ts(s),o=q0(this.db);i.docs.forEach(a=>{const l=ye(this.db,"users",e,"notifications",a.id);o.delete(l)}),await o.commit()}catch(r){throw console.error("Erro ao limpar notificações antigas:",r),r}}async createBulkNotifications(e,n){try{const r=e.map(s=>this.createNotification(s,n));await Promise.all(r)}catch(r){throw console.error("Erro ao criar notificações em massa:",r),r}}createTaskNotification(e,n,r){return{userId:e,type:"task_created",title:"Nova Tarefa",message:`Uma nova tarefa "${n}" foi criada`,relatedEntityId:r}}createTaskAssignmentNotification(e,n,r){return{userId:e,type:"task_assigned",title:"Tarefa Atribuída",message:`Você foi atribuído à tarefa "${n}"`,relatedEntityId:r}}createRewardNotification(e,n){return{userId:e,type:"reward_earned",title:"Recompensa Recebida",message:`Você ganhou ${n} moedas!`}}}const Kc=new SB,TB=()=>{const[t,e]=T.useState([]),[n,r]=T.useState([]),[s,i]=T.useState(!0),[o,a]=T.useState(null),[l,u]=T.useState(""),[d,f]=T.useState("all"),{currentUser:p}=tn();T.useEffect(()=>{(async()=>{i(!0),a(null);try{if(p){const A=await Kc.getUserNotifications(p.uid);e(A),r(A)}}catch(A){console.error("Erro ao buscar notificações:",A),a("Não foi possível carregar as notificações. Por favor, tente novamente mais tarde.")}finally{i(!1)}})()},[p]),T.useEffect(()=>{if(!t.length)return;let E=[...t];if(d!=="all"&&(E=E.filter(A=>A.type===d)),l){const A=l.toLowerCase();E=E.filter(P=>P.title.toLowerCase().includes(A)||P.message.toLowerCase().includes(A))}r(E)},[t,d,l]);const m=async()=>{try{if(p){i(!0),await Kc.markAllNotificationsAsRead(p.uid);const E=t.map(A=>({...A,read:!0}));e(E),r(E),i(!1)}}catch(E){console.error("Erro ao marcar todas as notificações como lidas:",E),a("Não foi possível marcar as notificações como lidas."),i(!1)}},g=async E=>{try{if(p){await Kc.markNotificationAsRead(p.uid,E);const A=t.map(P=>P.id===E?{...P,read:!0}:P);e(A),r(n.map(P=>P.id===E?{...P,read:!0}:P))}}catch(A){console.error("Erro ao marcar notificação como lida:",A)}},x=async E=>{try{p&&(e(A=>A.filter(P=>P.id!==E)),r(A=>A.filter(P=>P.id!==E)))}catch(A){console.error("Erro ao excluir notificação:",A)}},w=E=>{switch(E){case"task_created":case"task_completed":return c.jsx(Xe,{className:"text-green-500"});case"task_assigned":case"task_updated":return c.jsx(Qo,{className:"text-blue-500"});case"system_alert":return c.jsx(en,{className:"text-red-500"});case"reward_earned":return c.jsx(Xe,{className:"text-yellow-500"});case"project_update":return c.jsx(wo,{className:"text-purple-500"});default:return c.jsx(wo,{className:"text-gray-500"})}},v=E=>new Date(E).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),_=E=>{switch(E){case"task_created":return"Tarefa Criada";case"task_assigned":return"Tarefa Atribuída";case"task_completed":return"Tarefa Concluída";case"task_updated":return"Tarefa Atualizada";case"project_update":return"Atualização de Projeto";case"reward_earned":return"Recompensa Recebida";case"system_alert":return"Alerta do Sistema";default:return"Notificação"}};return c.jsx(Re,{role:p==null?void 0:p.role,isLoading:s,children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[c.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:[c.jsx(wo,{className:"mr-3 text-blue-600"}),"Notificações"]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(wl,{className:"text-gray-400",size:18})}),c.jsx("input",{type:"text",placeholder:"Buscar notificações...",value:l,onChange:E=>u(E.target.value),className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-full"})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:d,onChange:E=>f(E.target.value),className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none w-full",children:[c.jsx("option",{value:"all",children:"Todos os tipos"}),c.jsx("option",{value:"task_created",children:"Tarefas Criadas"}),c.jsx("option",{value:"task_assigned",children:"Tarefas Atribuídas"}),c.jsx("option",{value:"task_completed",children:"Tarefas Concluídas"}),c.jsx("option",{value:"task_updated",children:"Tarefas Atualizadas"}),c.jsx("option",{value:"project_update",children:"Atualizações de Projeto"}),c.jsx("option",{value:"reward_earned",children:"Recompensas"}),c.jsx("option",{value:"system_alert",children:"Alertas do Sistema"})]}),c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(nB,{className:"text-gray-400",size:18})})]}),c.jsxs("button",{onClick:m,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition flex items-center justify-center whitespace-nowrap",disabled:t.every(E=>E.read)||s,children:[c.jsx(Xe,{className:"mr-2",size:18}),"Marcar Todas como Lidas"]})]})]}),o&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6 flex items-center",children:[c.jsx(en,{className:"mr-2"}),o]}),n.length===0?c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-12 text-center",children:[c.jsx(wo,{className:"mx-auto h-16 w-16 text-gray-300 mb-4"}),c.jsx("p",{className:"text-gray-500 text-lg",children:l||d!=="all"?"Nenhuma notificação encontrada com os filtros atuais.":"Você não tem notificações."}),(l||d!=="all")&&c.jsx("button",{onClick:()=>{u(""),f("all")},className:"mt-4 text-blue-600 hover:text-blue-800 transition",children:"Limpar filtros"})]}):c.jsx("div",{className:"space-y-4",children:n.map(E=>{const A=w(E.type),P=_(E.type);return c.jsxs("div",{className:`flex items-start p-5 rounded-lg shadow-md transition-all ${E.read?"bg-gray-50":"bg-white border-l-4 border-blue-500"}`,children:[c.jsx("div",{className:"mr-4 mt-1",children:A}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h2",{className:`text-lg font-semibold ${E.read?"text-gray-700":"text-gray-800"}`,children:E.title}),c.jsx("span",{className:"inline-block px-2 py-1 bg-gray-100 text-xs rounded-full text-gray-600 mb-2",children:P})]}),c.jsxs("div",{className:"flex space-x-2",children:[!E.read&&c.jsx("button",{onClick:()=>g(E.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded-full hover:bg-blue-50 transition",title:"Marcar como lida",children:c.jsx(Xe,{size:18})}),c.jsx("button",{onClick:()=>x(E.id),className:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-50 transition",title:"Excluir notificação",children:c.jsx(ns,{size:18})})]})]}),c.jsx("p",{className:`text-gray-600 mb-2 ${E.read?"text-gray-500":"text-gray-700"}`,children:E.message}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-xs text-gray-500",children:v(E.timestamp)}),E.relatedEntityId&&c.jsx(De,{to:`/tasks/${E.relatedEntityId}`,className:"text-blue-600 hover:text-blue-800 text-sm hover:underline flex items-center",children:"Ver Tarefa"})]})]})]},E.id)})})]})})};class kB{constructor(){zn(this,"db",Zi());zn(this,"settingsDocRef",ye(wn(this.db,"system"),"global_settings"));zn(this,"defaultSettings",{taskCompletionBase:10,complexityMultiplier:1.5,monthlyBonus:50,twoFactorAuth:!1,passwordResetFrequency:90,emailNotifications:!0,pushNotifications:!1,weeklyReports:!0})}async getSettings(){try{const e=await st(this.settingsDocRef);return e.exists()?e.data():(await this.initializeSettings(this.defaultSettings),this.defaultSettings)}catch(e){return console.error("Erro ao buscar configurações do sistema:",e),this.defaultSettings}}async initializeSettings(e){try{await Vs(this.settingsDocRef,e)}catch(n){throw console.error("Erro ao inicializar configurações:",n),n}}async updateSettings(e){try{const r={...await this.getSettings(),...e};return await Wt(this.settingsDocRef,r),r}catch(n){throw console.error("Erro ao atualizar configurações:",n),n}}async validateRewardSettings(e,n){try{if(e<=0)throw new Error("Recompensa base deve ser positiva");if(n<1)throw new Error("Multiplicador de complexidade deve ser maior ou igual a 1");return await this.updateSettings({taskCompletionBase:e,complexityMultiplier:n}),!0}catch(r){throw console.error("Erro na validação de configurações de recompensa:",r),r}}async calculateTaskReward(e){try{const n=await this.getSettings();return Math.round(n.taskCompletionBase*e*n.complexityMultiplier)}catch(n){throw console.error("Erro ao calcular recompensa da tarefa:",n),n}}async getSettingsChangeHistory(){try{const e=wn(this.db,"system","global_settings","change_log"),n=it(e);return(await Ts(n)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Erro ao buscar histórico de configurações:",e),e}}async logSettingsChange(e,n){try{const r=ye(wn(this.db,"system","global_settings","change_log"));await Vs(r,{userId:e,changes:n,timestamp:Date.now()})}catch(r){throw console.error("Erro ao registrar alteração de configuração:",r),r}}}const Uf=new kB;class NB{constructor(){zn(this,"db",Zi());zn(this,"activityLogCollection",wn(this.db,"activityLog"))}async logActivity(e){try{const n=await G2(this.activityLogCollection,{...e,timestamp:Date.now()});console.log("Activity logged with ID: ",n.id)}catch(n){throw console.error("Error logging activity:",n),n}}async getRecentActivities(e=9){try{const n=it(this.activityLogCollection,Fl("timestamp","desc"),H2(e));return(await Ts(n)).docs.map(s=>({id:s.id,...s.data()}))}catch(n){throw console.error("Error fetching recent activities:",n),n}}}const Ya=new NB;class CB{constructor(){zn(this,"db",Zi())}async createProject(e){var n,r,s;try{const i=ye(wn(this.db,"projects")),o={id:i.id,...e,createdBy:((n=ze.currentUser)==null?void 0:n.uid)||"",createdAt:Date.now(),updatedAt:Date.now(),commentTabs:[{id:"general",name:"Geral",comments:[]}],messages:[]};return await Vs(i,o),await Ya.logActivity({userId:((r=ze.currentUser)==null?void 0:r.uid)||"",userName:((s=ze.currentUser)==null?void 0:s.displayName)||"Unknown User",type:"project_created",projectId:o.id,projectName:o.name}),o}catch(i){throw console.error("Erro ao criar projeto:",i),i}}async addProjectMessage(e,n){try{const r=ye(this.db,"projects",e),s=await st(r);if(!s.exists())throw new Error("Projeto não encontrado");const o=s.data().messages||[];return await Wt(r,{messages:[...o,n],updatedAt:Date.now()}),n}catch(r){throw console.error("Erro ao adicionar mensagem:",r),r}}async addSystemMessageToProjectChat(e,n){try{const r=ye(this.db,"projects",e),s=await st(r);if(!s.exists())throw new Error("Project not found");let o=s.data().messages||[];n.originalMessageId?o=o.map(a=>a.id===n.originalMessageId?{...a,content:n.content,timestamp:n.timestamp}:a):o=[...o,{...n,id:Date.now().toString()}],await Wt(r,{messages:o,updatedAt:Date.now()})}catch(r){throw console.error("Error adding system message:",r),r}}async getProjectMessages(e){try{const n=ye(this.db,"projects",e),r=await st(n);if(!r.exists())throw new Error("Projeto não encontrado");return r.data().messages||[]}catch(n){throw console.error("Erro ao buscar mensagens:",n),n}}async updateProject(e,n){var r,s;try{const i=ye(this.db,"projects",e);await Wt(i,{...n,updatedAt:Date.now()});const o=await st(i),a={id:o.id,...o.data()};return await Ya.logActivity({userId:((r=ze.currentUser)==null?void 0:r.uid)||"",userName:((s=ze.currentUser)==null?void 0:s.displayName)||"Unknown User",type:"project_updated",projectId:e,projectName:a.name,details:"Project updated."}),a}catch(i){throw console.error("Erro ao atualizar projeto:",i),i}}async deleteProject(e){try{const n=ye(this.db,"projects",e);await Sm(n)}catch(n){throw console.error("Erro ao excluir projeto:",n),n}}async fetchProjects(e){try{let n=it(wn(this.db,"projects"));e!=null&&e.status&&(n=it(n,fr("status","==",e.status))),e!=null&&e.excludeStatus&&(n=it(n,fr("status","!=",e.excludeStatus))),n=it(n,Fl("createdAt","desc"));const s=(await Ts(n)).docs.map(f=>({id:f.id,...f.data()})),i=(e==null?void 0:e.limit)||10,a=(((e==null?void 0:e.page)||1)-1)*i,l=a+i,u=s.slice(a,l),d=Math.ceil(s.length/i);return{data:u,totalPages:d,totalProjects:s.length}}catch(n){throw console.error("Erro ao buscar projetos:",n),n}}async getProjectById(e){try{const n=ye(this.db,"projects",e),r=await st(n);if(r.exists())return{id:r.id,...r.data()};throw new Error("Projeto não encontrado")}catch(n){throw console.error("Erro ao buscar projeto por ID:",n),n}}async addProjectComment(e,n,r){try{const s=ye(this.db,"projects",e),i=await st(s);if(!i.exists())throw new Error("Projeto não encontrado");const l=(i.data().commentTabs||[]).map(u=>u.id===n?{...u,comments:[...u.comments||[],r]}:u);return await Wt(s,{commentTabs:l,updatedAt:Date.now()}),l}catch(s){throw console.error("Erro ao adicionar comentário:",s),s}}async archiveProject(e){try{const n=ye(this.db,"projects",e);await Wt(n,{status:"archived",updatedAt:Date.now()})}catch(n){throw console.error("Error archiving project:",n),n}}async unarchiveProject(e){try{const n=ye(this.db,"projects",e);await Wt(n,{status:"planning",updatedAt:Date.now()})}catch(n){throw console.error("Error unarchiving project:",n),n}}}const Je=new CB;class IB{constructor(){zn(this,"db",Zi())}async createTask(e){var n,r,s;try{const i=ye(wn(this.db,"tasks")),o=await Uf.getSettings(),a=Math.round(e.difficultyLevel*o.taskCompletionBase*o.complexityMultiplier),l={id:i.id,...e,createdBy:((n=ze.currentUser)==null?void 0:n.uid)||"",status:"pending",createdAt:Date.now(),updatedAt:Date.now(),coinsReward:a,subtasks:e.subtasks||[],comments:e.comments||[],attachments:e.attachments||[],actions:e.actions||[]};await Vs(i,l);const u=await Je.getProjectById(l.projectId);return await Ya.logActivity({userId:((r=ze.currentUser)==null?void 0:r.uid)||"",userName:((s=ze.currentUser)==null?void 0:s.displayName)||"Unknown User",type:"task_created",projectId:l.projectId,projectName:u.name,taskId:l.id,taskName:l.title}),l}catch(i){throw console.error("Erro ao criar tarefa:",i),i}}async updateTask(e,n){var r,s,i,o;try{const a=ye(this.db,"tasks",e),l=await st(a);if(!l.exists())throw new Error("Task not found");const u=l.data(),d=await Uf.getSettings(),f=n.difficultyLevel?Math.round(n.difficultyLevel*d.taskCompletionBase*d.complexityMultiplier):void 0,p={...n,...f?{coinsReward:f}:{},updatedAt:Date.now()};await Wt(a,p);const m=await st(a),g={id:m.id,...m.data()};if(u.status!==g.status){const x=await Je.getProjectById(g.projectId);if(g.assignedTo&&await Kc.createNotification(g.assignedTo,{type:"task_updated",title:"Task Status Updated",message:`Task '${g.title}' in project '${x.name}' has been updated to ${g.status}`,relatedEntityId:e}),x&&x.managers)for(const w of x.managers)await Kc.createNotification(w,{type:"task_updated",title:"Task Status Updated",message:`Task '${g.title}' in project '${x.name}' has been updated to ${g.status}`,relatedEntityId:e});await Ya.logActivity({userId:((r=ze.currentUser)==null?void 0:r.uid)||"",userName:((s=ze.currentUser)==null?void 0:s.displayName)||"Unknown User",type:"task_status_update",projectId:g.projectId,projectName:x.name,taskId:e,taskName:g.title,newStatus:g.status,details:`Task status changed from ${u.status} to ${g.status}`})}else{const x=await Je.getProjectById(g.projectId);await Ya.logActivity({userId:((i=ze.currentUser)==null?void 0:i.uid)||"",userName:((o=ze.currentUser)==null?void 0:o.displayName)||"Unknown User",type:"task_updated",projectId:g.projectId,projectName:x.name,taskId:e,taskName:g.title,details:"Task updated."})}return g}catch(a){throw console.error("Erro ao atualizar tarefa:",a),a}}async deleteTask(e){try{const n=ye(this.db,"tasks",e);await Sm(n)}catch(n){throw console.error("Erro ao excluir tarefa:",n),n}}async fetchTasks(e){try{let n=it(wn(this.db,"tasks"));e!=null&&e.projectId&&(n=it(n,fr("projectId","==",e.projectId))),e!=null&&e.status&&(n=it(n,fr("status","==",e.status))),e!=null&&e.assignedTo&&(n=it(n,fr("assignedTo","==",e.assignedTo))),n=it(n,Fl("createdAt","desc"));const s=(await Ts(n)).docs.map(f=>({id:f.id,...f.data()})),i=(e==null?void 0:e.limit)||10,a=(((e==null?void 0:e.page)||1)-1)*i,l=a+i,u=s.slice(a,l),d=Math.ceil(s.length/i);return{data:u,totalPages:d,totalTasks:s.length}}catch(n){throw console.error("Erro ao buscar tarefas:",n),n}}async getTaskById(e){try{const n=ye(this.db,"tasks",e),r=await st(n);if(r.exists())return{id:r.id,...r.data()};throw new Error("Tarefa não encontrada")}catch(n){throw console.error("Erro ao buscar tarefa:",n),n}}async uploadTaskAttachment(e,n){try{const s=`${Date.now()}_${n.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,i=yl(xl,`tasks/${e}/attachments/${s}`),o=await ml(i,n);console.log("File uploaded successfully:",o);const a=await gl(i);console.log("Download URL obtained:",a);const l=ye(this.db,"tasks",e),u=await st(l);if(u.exists()){const f=u.data().attachments||[];await Wt(l,{attachments:[...f,a],updatedAt:Date.now()})}return a}catch(r){throw console.error("Error uploading attachment:",r),new Error("Failed to upload file. Please try again.")}}async getTaskAttachments(e){try{const n=ye(this.db,"tasks",e),r=await st(n);return r.exists()?r.data().attachments||[]:[]}catch(n){throw console.error("Erro ao buscar anexos:",n),n}}async addTaskComment(e,n){try{const r=ye(this.db,"tasks",e),s=await st(r);if(!s.exists())throw new Error("Tarefa não encontrada");const i=s.data(),o={id:Date.now().toString(),userId:n.userId,text:n.text,createdAt:Date.now(),attachments:n.attachments||[]};return await Wt(r,{comments:[...i.comments||[],o],updatedAt:Date.now()}),o}catch(r){throw console.error("Erro ao adicionar comentário:",r),r}}async completeTaskAction(e,n,r){try{const s=ye(this.db,"tasks",e),i=await st(s);if(!i.exists())throw new Error("Task not found");const a=i.data().actions.map(l=>{var u,d,f;if(l.id===n){let p={...l,completed:!0,completedAt:Date.now(),completedBy:(u=ze.currentUser)==null?void 0:u.uid};return l.type==="info"&&l.hasAttachments&&r&&r.attachments?p={...p,data:{...p.data,fileURLs:r.attachments}}:l.type==="document"&&r&&(p={...p,data:{...p.data,steps:((d=p.data)==null?void 0:d.steps)||[],fileURLs:((f=p.data)==null?void 0:f.fileURLs)||[]}}),p}return l});await Wt(s,{actions:a,updatedAt:Date.now()}),console.log("Task action completed successfully")}catch(s){throw console.error("Error completing task action:",s),s}}async uncompleteTaskAction(e,n){try{const r=ye(this.db,"tasks",e),s=await st(r);if(!s.exists())throw new Error("Task not found");const o=s.data().actions.map(a=>a.id===n?{...a,completed:!1,completedAt:null,completedBy:null,attachments:a.type==="info"&&a.hasAttachments?[]:a.attachments}:a);await Wt(r,{actions:o,updatedAt:Date.now()})}catch(r){throw console.error("Error uncompleting task action:",r),r}}}const nt=new IB;function Ht(t){this.content=t}Ht.prototype={constructor:Ht,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,s=r.find(t),i=r.content.slice();return s==-1?i.push(n||t,e):(i[s+1]=e,n&&(i[s]=n)),new Ht(i)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new Ht(n)},addToStart:function(t,e){return new Ht([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new Ht(n)},addBefore:function(t,e,n){var r=this.remove(e),s=r.content.slice(),i=r.find(t);return s.splice(i==-1?s.length:i,0,e,n),new Ht(s)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Ht.from(t),t.size?new Ht(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Ht.from(t),t.size?new Ht(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Ht.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};Ht.from=function(t){if(t instanceof Ht)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new Ht(e)};function vA(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let s=t.child(r),i=e.child(r);if(s==i){n+=s.nodeSize;continue}if(!s.sameMarkup(i))return n;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)n++;return n}if(s.content.size||i.content.size){let o=vA(s.content,i.content,n+1);if(o!=null)return o}n+=s.nodeSize}}function wA(t,e,n,r){for(let s=t.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:n,b:r};let o=t.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){n-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:n,b:r};if(o.isText&&o.text!=a.text){let u=0,d=Math.min(o.text.length,a.text.length);for(;u<d&&o.text[o.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(o.content.size||a.content.size){let u=wA(o.content,a.content,n-1,r-1);if(u)return u}n-=l,r-=l}}class K{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,s=0,i){for(let o=0,a=0;a<n;o++){let l=this.content[o],u=a+l.nodeSize;if(u>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let d=a+1;l.nodesBetween(Math.max(0,e-d),Math.min(l.content.size,n-d),r,s+d)}a=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,s){let i="",o=!0;return this.nodesBetween(e,n,(a,l)=>{let u=a.isText?a.text.slice(Math.max(e,l)-l,n-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&u||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=u},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(n.isText&&n.sameMarkup(r)&&(s[s.length-1]=n.withText(n.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new K(s,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],s=0;if(n>e)for(let i=0,o=0;o<n;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,n-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,n-o-1))),r.push(a),s+=a.nodeSize),o=l}return new K(r,s)}cutByIndex(e,n){return e==n?K.empty:e==0&&n==this.content.length?this:new K(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let s=this.content.slice(),i=this.size+n.nodeSize-r.nodeSize;return s[e]=n,new K(s,i)}addToStart(e){return new K([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new K(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let s=this.content[n];e(s,r,n),r+=s.nodeSize}}findDiffStart(e,n=0){return vA(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return wA(this,e,n,r)}findIndex(e,n=-1){if(e==0)return sh(0,e);if(e==this.size)return sh(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=e)return o==e||n>0?sh(r+1,o):sh(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return K.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new K(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return K.empty;let n,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(n||(n=e.slice(0,s)),n[n.length-1]=i.withText(n[n.length-1].text+i.text)):n&&n.push(i)}return new K(n||e,r)}static from(e){if(!e)return K.empty;if(e instanceof K)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new K([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}K.empty=new K([],0);const Gg={index:0,offset:0};function sh(t,e){return Gg.index=t,Gg.offset=e,Gg}function zf(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!zf(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!zf(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Fe=class G0{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))n||(n=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(n||(n=e.slice(0,s)),n.push(this),r=!0),n&&n.push(i)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&zf(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let s=r.create(n.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return G0.none;if(e instanceof G0)return[e];let n=e.slice();return n.sort((r,s)=>r.type.rank-s.type.rank),n}};Fe.none=[];class Bf extends Error{}class ee{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=_A(this.content,e+this.openStart,n);return r&&new ee(r,this.openStart,this.openEnd)}removeBetween(e,n){return new ee(bA(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return ee.empty;let r=n.openStart||0,s=n.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ee(K.fromJSON(e,n.content),r,s)}static maxOpen(e,n=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(n||!i.type.spec.isolating);i=i.lastChild)s++;return new ee(e,r,s)}}ee.empty=new ee(K.empty,0,0);function bA(t,e,n){let{index:r,offset:s}=t.findIndex(e),i=t.maybeChild(r),{index:o,offset:a}=t.findIndex(n);if(s==e||i.isText){if(a!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,i.copy(bA(i.content,e-s-1,n-s-1)))}function _A(t,e,n,r){let{index:s,offset:i}=t.findIndex(e),o=t.maybeChild(s);if(i==e||o.isText)return t.cut(0,e).append(n).append(t.cut(e));let a=_A(o.content,e-i-1,n);return a&&t.replaceChild(s,o.copy(a))}function AB(t,e,n){if(n.openStart>t.depth)throw new Bf("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Bf("Inconsistent open depths");return EA(t,e,n,0)}function EA(t,e,n,r){let s=t.index(r),i=t.node(r);if(s==e.index(r)&&r<t.depth-n.openStart){let o=EA(t,e,n,r+1);return i.copy(i.content.replaceChild(s,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,a=o.content;return Ro(o,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=jB(n,t);return Ro(i,TA(t,o,a,e,r))}else return Ro(i,$f(t,e,r))}function SA(t,e){if(!e.type.compatibleContent(t.type))throw new Bf("Cannot join "+e.type.name+" onto "+t.type.name)}function Q0(t,e,n){let r=t.node(n);return SA(r,e.node(n)),r}function jo(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Gc(t,e,n,r){let s=(e||t).node(n),i=0,o=e?e.index(n):s.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(jo(t.nodeAfter,r),i++));for(let a=i;a<o;a++)jo(s.child(a),r);e&&e.depth==n&&e.textOffset&&jo(e.nodeBefore,r)}function Ro(t,e){return t.type.checkContent(e),t.copy(e)}function TA(t,e,n,r,s){let i=t.depth>s&&Q0(t,e,s+1),o=r.depth>s&&Q0(n,r,s+1),a=[];return Gc(null,t,s,a),i&&o&&e.index(s)==n.index(s)?(SA(i,o),jo(Ro(i,TA(t,e,n,r,s+1)),a)):(i&&jo(Ro(i,$f(t,e,s+1)),a),Gc(e,n,s,a),o&&jo(Ro(o,$f(n,r,s+1)),a)),Gc(r,null,s,a),new K(a)}function $f(t,e,n){let r=[];if(Gc(null,t,n,r),t.depth>n){let s=Q0(t,e,n+1);jo(Ro(s,$f(t,e,n+1)),r)}return Gc(e,null,n,r),new K(r)}function jB(t,e){let n=e.depth-t.openStart,s=e.node(n).copy(t.content);for(let i=n-1;i>=0;i--)s=e.node(i).copy(K.from(s));return{start:s.resolveNoCache(t.openStart+n),end:s.resolveNoCache(s.content.size-t.openEnd-n)}}class Mu{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(n);return r?e.child(n).cut(r):s}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],s=n==0?0:this.path[n*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Fe.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),s=e.maybeChild(n);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Hf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],s=0,i=n;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),u=i-l;if(r.push(o,a,s+l),!u||(o=o.child(a),o.isText))break;i=u-1,s+=l+1}return new Mu(n,r,i)}static resolveCached(e,n){let r=gS.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==n)return o}else gS.set(e,r=new RB);let s=r.elts[r.i]=Mu.resolve(e,n);return r.i=(r.i+1)%PB,s}}class RB{constructor(){this.elts=[],this.i=0}}const PB=12,gS=new WeakMap;class Hf{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const DB=Object.create(null);let Ri=class J0{constructor(e,n,r,s=Fe.none){this.type=e,this.attrs=n,this.marks=s,this.content=r||K.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,s=0){this.content.nodesBetween(e,n,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,s){return this.content.textBetween(e,n,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&zf(this.attrs,n||e.defaultAttrs||DB)&&Fe.sameSet(this.marks,r||Fe.none)}copy(e=null){return e==this.content?this:new J0(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new J0(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return ee.empty;let s=this.resolve(e),i=this.resolve(n),o=r?0:s.sharedDepth(n),a=s.start(o),u=s.node(o).content.cut(s.pos-a,i.pos-a);return new ee(u,s.depth-o,i.depth-o)}replace(e,n,r){return AB(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:s}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(s==e||n.isText)return n;e-=s+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let s=this.content.child(n-1);return{node:s,index:n-1,offset:r-s.nodeSize}}resolve(e){return Mu.resolveCached(this,e)}resolveNoCache(e){return Mu.resolve(this,e)}rangeHasMark(e,n,r){let s=!1;return n>e&&this.nodesBetween(e,n,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),kA(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=K.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Fe.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Fe.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let s=K.fromJSON(e,n.content),i=e.nodeType(n.type).create(n.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};Ri.prototype.text=void 0;class qf extends Ri{constructor(e,n,r,s){if(super(e,n,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):kA(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new qf(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new qf(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function kA(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Yo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new MB(e,n);if(r.next==null)return Yo.empty;let s=NA(r);r.next&&r.err("Unexpected trailing text");let i=BB(zB(s));return $B(i,r),i}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let s=this;for(let i=n;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!n||l.validEnd))return K.from(a.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:d,next:f}=o.next[u];if(!(d.isText||d.hasRequiredAttrs())&&s.indexOf(f)==-1){s.push(f);let p=i(f,a.concat(d));if(p)return p}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&n(r.next[s].next)}return n(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Yo.empty=new Yo(!0);class MB{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function NA(t){let e=[];do e.push(OB(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function OB(t){let e=[];do e.push(LB(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function LB(t){let e=UB(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=VB(t,e);else break;return e}function yS(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function VB(t,e){let n=yS(t),r=n;return t.eat(",")&&(t.next!="}"?r=yS(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function FB(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let s=[];for(let i in n){let o=n[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&t.err("No node type or group '"+e+"' found"),s}function UB(t){if(t.eat("(")){let e=NA(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=FB(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function zB(t){let e=[[]];return s(i(t,0),n()),e;function n(){return e.push([])-1}function r(o,a,l){let u={term:l,to:a};return e[o].push(u),u}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,u)=>l.concat(i(u,a)),[]);if(o.type=="seq")for(let l=0;;l++){let u=i(o.exprs[l],a);if(l==o.exprs.length-1)return u;s(u,a=n())}else if(o.type=="star"){let l=n();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=n();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let u=0;u<o.min;u++){let d=n();s(i(o.expr,l),d),l=d}if(o.max==-1)s(i(o.expr,l),l);else for(let u=o.min;u<o.max;u++){let d=n();r(l,d),s(i(o.expr,l),d),l=d}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function CA(t,e){return e-t}function xS(t,e){let n=[];return r(e),n.sort(CA);function r(s){let i=t[s];if(i.length==1&&!i[0].term)return r(i[0].to);n.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&n.indexOf(l)==-1&&r(l)}}}function BB(t){let e=Object.create(null);return n(xS(t,0));function n(r){let s=[];r.forEach(o=>{t[o].forEach(({term:a,to:l})=>{if(!a)return;let u;for(let d=0;d<s.length;d++)s[d][0]==a&&(u=s[d][1]);xS(t,l).forEach(d=>{u||s.push([a,u=[]]),u.indexOf(d)==-1&&u.push(d)})})});let i=e[r.join(",")]=new Yo(r.indexOf(t.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(CA);i.next.push({type:s[o][0],next:e[a.join(",")]||n(a)})}return i}}function $B(t,e){for(let n=0,r=[t];n<r.length;n++){let s=r[n],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:u}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(u)==-1&&r.push(u)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function IA(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function AA(t,e){let n=Object.create(null);for(let r in t){let s=e&&e[r];if(s===void 0){let i=t[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=s}return n}function jA(t,e,n,r){for(let s in e)if(!(s in t))throw new RangeError(`Unsupported attribute ${s} for ${n} of type ${s}`);for(let s in t){let i=t[s];i.validate&&i.validate(e[s])}}function RA(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new qB(t,r,e[r]);return n}let vS=class PA{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=RA(e,r.attrs),this.defaultAttrs=IA(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Yo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:AA(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ri(this,this.computeAttrs(e),K.from(n),Fe.setFrom(r))}createChecked(e=null,n,r){return n=K.from(n),this.checkContent(n),new Ri(this,this.computeAttrs(e),n,Fe.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=K.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let s=this.contentMatch.matchFragment(n),i=s&&s.fillBefore(K.empty,!0);return i?new Ri(this,e,n.append(i),Fe.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){jA(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Fe.none:e}static compile(e,n){let r=Object.create(null);e.forEach((i,o)=>r[i]=new PA(i,n,o));let s=n.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function HB(t,e,n){let r=n.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${i}`)}}class qB{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?HB(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Cm{constructor(e,n,r,s){this.name=e,this.rank=n,this.schema=r,this.spec=s,this.attrs=RA(e,s.attrs),this.excluded=null;let i=IA(this.attrs);this.instance=i?new Fe(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Fe(this,AA(this.attrs,e))}static compile(e,n){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new Cm(i,s++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){jA(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class DA{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let s in e)n[s]=e[s];n.nodes=Ht.from(e.nodes),n.marks=Ht.from(e.marks||{}),this.nodes=vS.compile(this.spec.nodes,this),this.marks=Cm.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Yo.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?wS(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:wS(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof vS){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,s)}text(e,n){let r=this.nodes.text;return new qf(r,r.defaultAttrs,e,Fe.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return Ri.fromJSON(this,e)}markFromJSON(e){return Fe.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function wS(t,e){let n=[];for(let r=0;r<e.length;r++){let s=e[r],i=t.marks[s],o=i;if(i)n.push(i);else for(let a in t.marks){let l=t.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function WB(t){return t.tag!=null}function KB(t){return t.style!=null}class Pi{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(s=>{if(WB(s))this.tags.push(s);else if(KB(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new _S(this,n,!1);return r.addAll(e,Fe.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new _S(this,n,!0);return r.addAll(e,Fe.none,n.from,n.to),ee.maxOpen(r.finish())}matchTag(e,n,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(JB(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||n.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,n,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(o.getAttrs){let l=o.getAttrs(n);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let n=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<n.length;o++){let a=n[o];if((a.priority==null?50:a.priority)<i)break}n.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=ES(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=ES(o)),o.node||o.ignore||o.mark||(o.node=s)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Pi(e,Pi.schemaRules(e)))}}const MA={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},GB={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},OA={ol:!0,ul:!0},Ou=1,Y0=2,Fh=4;function bS(t,e,n){return e!=null?(e?Ou:0)|(e==="full"?Y0:0):t&&t.whitespace=="pre"?Ou|Y0:n&-5}class ih{constructor(e,n,r,s,i,o){this.type=e,this.attrs=n,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=Fe.none,this.match=i||(o&Fh?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(K.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ou)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let n=K.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(K.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!MA.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class _S{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=n.topNode,i,o=bS(null,n.preserveWhitespace,0)|(r?Fh:0);s?i=new ih(s.type,s.attrs,Fe.none,!0,n.topMatch||s.type.contentMatch,o):r?i=new ih(null,null,Fe.none,!0,null,o):i=new ih(e.schema.topNodeType,null,Fe.none,!0,null,o),this.nodes=[i],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,s=this.top,i=s.options&Y0?"full":this.localPreserveWS||(s.options&Ou)>0;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=s.content[s.content.length-1],a=e.previousSibling;(!o||a&&a.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;OA.hasOwnProperty(o)&&this.parser.normalizeLists&&QB(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:GB.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,d=this.needsBlock;if(MA.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),u=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let f=l&&l.skip?n:this.readStyles(e,n);f&&this.addAll(e,f),u&&this.sync(i),this.needsBlock=d}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,l,u,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?n=n.filter(u=>!l.clearMark(u)):n=n.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return n}addElementByRule(e,n,r,s){let i,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(o,n.attrs||null,r,n.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[n.mark];r=r.concat(l.create(n.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,n,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,n);this.findAtPoint(e,i)}findPlace(e,n){let r,s;for(let i=this.open;i>=0;i--){let o=this.nodes[i],a=o.findWrapping(e);if(a&&(!r||r.length>a.length)&&(r=a,s=o,!a.length)||o.solid)break}if(!r)return null;this.sync(s);for(let i=0;i<r.length;i++)n=this.enterInner(r[i],null,n,!1);return n}insertNode(e,n){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let r=this.findPlace(e,n);if(r){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let i=Fe.none;for(let o of r.concat(e.marks))(s.type?s.type.allowsMarkType(o.type):SS(o.type,e.type))&&(i=o.addToSet(i));return s.content.push(e.mark(i)),!0}return!1}enter(e,n,r,s){let i=this.findPlace(e.create(n),r);return i&&(i=this.enterInner(e,n,r,!0,s)),i}enterInner(e,n,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=bS(e,i,o.options);o.options&Fh&&o.content.length==0&&(a|=Fh);let l=Fe.none;return r=r.filter(u=>(o.type?o.type.allowsMarkType(u.type):SS(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new ih(e,n,l,s,null,a)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Ou)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&n.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let u=n[a];if(u==""){if(a==n.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let d=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!d||d.name!=u&&!d.isInGroup(u))return!1;l--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function QB(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&OA.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function JB(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ES(t){let e={};for(let n in t)e[n]=t[n];return e}function SS(t,e){let n=e.schema.nodes;for(let r in n){let s=n[r];if(!s.allowsMarkType(t))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:u,next:d}=a.edge(l);if(u==e||i.indexOf(d)<0&&o(d))return!0}};if(o(s.contentMatch))return!0}}class ca{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=Qg(n).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let u=o.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(i[a][0])||u.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let u=o.marks[l++],d=this.serializeMark(u,o.isInline,n);d&&(i.push([u,s]),s.appendChild(d.dom),s=d.contentDOM||d.dom)}}s.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:s}=Uh(Qg(n),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,s)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,n);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,n,r={}){let s=this.marks[e.type.name];return s&&Uh(Qg(r),s(e,n),null,e.attrs)}static renderSpec(e,n,r=null,s){return Uh(e,n,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ca(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=TS(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return TS(e.marks)}}function TS(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Qg(t){return t.document||window.document}const kS=new WeakMap;function YB(t){let e=kS.get(t);return e===void 0&&kS.set(t,e=XB(t)),e}function XB(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)n(r[s]);else for(let s in r)n(r[s])}return n(t),e}function Uh(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=YB(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(n=s.slice(0,o),s=s.slice(o+1));let a,l=n?t.createElementNS(n,s):t.createElement(s),u=e[1],d=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){d=2;for(let f in u)if(u[f]!=null){let p=f.indexOf(" ");p>0?l.setAttributeNS(f.slice(0,p),f.slice(p+1),u[f]):l.setAttribute(f,u[f])}}for(let f=d;f<e.length;f++){let p=e[f];if(p===0){if(f<e.length-1||f>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:m,contentDOM:g}=Uh(t,p,n,r);if(l.appendChild(m),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}const LA=65535,VA=Math.pow(2,16);function ZB(t,e){return t+e*VA}function NS(t){return t&LA}function e$(t){return(t-(t&LA))/VA}const FA=1,UA=2,zh=4,zA=8;class X0{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&zA)>0}get deletedBefore(){return(this.delInfo&(FA|zh))>0}get deletedAfter(){return(this.delInfo&(UA|zh))>0}get deletedAcross(){return(this.delInfo&zh)>0}}class Kn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Kn.empty)return Kn.empty}recover(e){let n=0,r=NS(e);if(!this.inverted)for(let s=0;s<r;s++)n+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+n+e$(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let u=this.ranges[a+i],d=this.ranges[a+o],f=l+u;if(e<=f){let p=u?e==l?-1:e==f?1:n:n,m=l+s+(p<0?0:d);if(r)return m;let g=e==(n<0?l:f)?null:ZB(a/3,e-l),x=e==l?UA:e==f?FA:zh;return(n<0?e!=l:e!=f)&&(x|=zA),new X0(m,x,g)}s+=d-u}return r?e+s:new X0(e+s,0,null)}touches(e,n){let r=0,s=NS(n),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let u=this.ranges[a+i],d=l+u;if(e<=d&&a==s*3)return!0;r+=this.ranges[a+o]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),u=this.ranges[s+n],d=this.ranges[s+r];e(a,a+u,l,l+d),i+=d-u}}invert(){return new Kn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Kn.empty:new Kn(e<0?[0,-e,0]:[0,0,e])}}Kn.empty=new Kn([]);class Xa{constructor(e=[],n,r=0,s=e.length){this.maps=e,this.mirror=n,this.from=r,this.to=s}slice(e=0,n=this.maps.length){return new Xa(this.maps,this.mirror,e,n)}copy(){return new Xa(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,n){this.to=this.maps.push(e),n!=null&&this.setMirror(this.maps.length-1,n)}appendMapping(e){for(let n=0,r=this.maps.length;n<e.maps.length;n++){let s=e.getMirror(n);this.appendMap(e.maps[n],s!=null&&s<n?r+s:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this.maps.length+e.maps.length;n>=0;n--){let s=e.getMirror(n);this.appendMap(e.maps[n].invert(),s!=null&&s>n?r-s-1:void 0)}}invert(){let e=new Xa;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this.maps[i],a=o.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this.maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new X0(e,s,null)}}const Jg=Object.create(null);class gn{getMap(){return Kn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Jg[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Jg)throw new RangeError("Duplicate use of step JSON ID "+e);return Jg[e]=n,n.prototype.jsonID=e,n}}class Tt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Tt(e,null)}static fail(e){return new Tt(null,e)}static fromReplace(e,n,r,s){try{return Tt.ok(e.replace(n,r,s))}catch(i){if(i instanceof Bf)return Tt.fail(i.message);throw i}}}function Fw(t,e,n){let r=[];for(let s=0;s<t.childCount;s++){let i=t.child(s);i.content.size&&(i=i.copy(Fw(i.content,e,i))),i.isInline&&(i=e(i,n,s)),r.push(i)}return K.fromArray(r)}class yi extends gn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new ee(Fw(n.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),n.openStart,n.openEnd);return Tt.fromReplace(e,this.from,this.to,i)}invert(){return new $r(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new yi(n.pos,r.pos,this.mark)}merge(e){return e instanceof yi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new yi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new yi(n.from,n.to,e.markFromJSON(n.mark))}}gn.jsonID("addMark",yi);class $r extends gn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new ee(Fw(n.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),n.openStart,n.openEnd);return Tt.fromReplace(e,this.from,this.to,r)}invert(){return new yi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new $r(n.pos,r.pos,this.mark)}merge(e){return e instanceof $r&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $r(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new $r(n.from,n.to,e.markFromJSON(n.mark))}}gn.jsonID("removeMark",$r);class xi extends gn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Tt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Tt.fromReplace(e,this.pos,this.pos+1,new ee(K.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let s=0;s<n.marks.length;s++)if(!n.marks[s].isInSet(r))return new xi(this.pos,n.marks[s]);return new xi(this.pos,this.mark)}}return new bl(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new xi(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new xi(n.pos,e.markFromJSON(n.mark))}}gn.jsonID("addNodeMark",xi);class bl extends gn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Tt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Tt.fromReplace(e,this.pos,this.pos+1,new ee(K.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new xi(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new bl(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new bl(n.pos,e.markFromJSON(n.mark))}}gn.jsonID("removeNodeMark",bl);class Pt extends gn{constructor(e,n,r,s=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=s}apply(e){return this.structure&&Z0(e,this.from,this.to)?Tt.fail("Structure replace would overwrite content"):Tt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Kn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Pt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Pt(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Pt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?ee.empty:new ee(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Pt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?ee.empty:new ee(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Pt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Pt(n.from,n.to,ee.fromJSON(e,n.slice),!!n.structure)}}gn.jsonID("replace",Pt);class Mt extends gn{constructor(e,n,r,s,i,o,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Z0(e,this.from,this.gapFrom)||Z0(e,this.gapTo,this.to)))return Tt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Tt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Tt.fromReplace(e,this.from,this.to,r):Tt.fail("Content does not fit in gap")}getMap(){return new Kn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Mt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||s<n.pos||i>r.pos?null:new Mt(n.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Mt(n.from,n.to,n.gapFrom,n.gapTo,ee.fromJSON(e,n.slice),n.insert,!!n.structure)}}gn.jsonID("replaceAround",Mt);function Z0(t,e,n){let r=t.resolve(e),s=n-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function t$(t,e,n,r){let s=[],i=[],o,a;t.doc.nodesBetween(e,n,(l,u,d)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&d.type.allowsMarkType(r.type)){let p=Math.max(u,e),m=Math.min(u+l.nodeSize,n),g=r.addToSet(f);for(let x=0;x<f.length;x++)f[x].isInSet(g)||(o&&o.to==p&&o.mark.eq(f[x])?o.to=m:s.push(o=new $r(p,m,f[x])));a&&a.to==p?a.to=m:i.push(a=new yi(p,m,r))}}),s.forEach(l=>t.step(l)),i.forEach(l=>t.step(l))}function n$(t,e,n,r){let s=[],i=0;t.doc.nodesBetween(e,n,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof Cm){let u=o.marks,d;for(;d=r.isInSet(u);)(l||(l=[])).push(d),u=d.removeFromSet(u)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let u=Math.min(a+o.nodeSize,n);for(let d=0;d<l.length;d++){let f=l[d],p;for(let m=0;m<s.length;m++){let g=s[m];g.step==i-1&&f.eq(s[m].style)&&(p=g)}p?(p.to=u,p.step=i):s.push({style:f,from:Math.max(a,e),to:u,step:i})}}}),s.forEach(o=>t.step(new $r(o.from,o.to,o.style)))}function Uw(t,e,n,r=n.contentMatch,s=!0){let i=t.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let u=i.child(l),d=a+u.nodeSize,f=r.matchType(u.type);if(!f)o.push(new Pt(a,d,ee.empty));else{r=f;for(let p=0;p<u.marks.length;p++)n.allowsMarkType(u.marks[p].type)||t.step(new $r(a,d,u.marks[p]));if(s&&u.isText&&n.whitespace!="pre"){let p,m=/\r?\n|\r/g,g;for(;p=m.exec(u.text);)g||(g=new ee(K.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),o.push(new Pt(a+p.index,a+p.index+p[0].length,g))}}a=d}if(!r.validEnd){let l=r.fillBefore(K.empty,!0);t.replace(a,a,new ee(l,0,0))}for(let l=o.length-1;l>=0;l--)t.step(o[l])}function r$(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Ul(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let s=t.$from.node(r),i=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&s.canReplace(i,o,n))return r;if(r==0||s.type.spec.isolating||!r$(s,i,o))break}return null}function s$(t,e,n){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,u=a,d=K.empty,f=0;for(let g=i,x=!1;g>n;g--)x||r.index(g)>0?(x=!0,d=K.from(r.node(g).copy(d)),f++):l--;let p=K.empty,m=0;for(let g=i,x=!1;g>n;g--)x||s.after(g+1)<s.end(g)?(x=!0,p=K.from(s.node(g).copy(p)),m++):u++;t.step(new Mt(l,u,o,a,new ee(d.append(p),f,m),d.size-f,!0))}function zw(t,e,n=null,r=t){let s=i$(t,e),i=s&&o$(r,e);return i?s.map(CS).concat({type:e,attrs:n}).concat(i.map(CS)):null}function CS(t){return{type:t,attrs:null}}function i$(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return n.canReplaceWith(r,s,o)?i:null}function o$(t,e){let{parent:n,startIndex:r,endIndex:s}=t,i=n.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let u=r;l&&u<s;u++)l=l.matchType(n.child(u).type);return!l||!l.validEnd?null:o}function a$(t,e,n){let r=K.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let a=n[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=K.from(n[o].type.create(n[o].attrs,r))}let s=e.start,i=e.end;t.step(new Mt(s,i,s,i,new ee(r,0,0),n.length,!0))}function l$(t,e,n,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=t.steps.length;t.doc.nodesBetween(e,n,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&c$(t.doc,t.mapping.slice(i).map(a),r)){let u=null;if(r.schema.linebreakReplacement){let m=r.whitespace=="pre",g=!!r.contentMatch.matchType(r.schema.linebreakReplacement);m&&!g?u=!1:!m&&g&&(u=!0)}u===!1&&$A(t,o,a,i),Uw(t,t.mapping.slice(i).map(a,1),r,void 0,u===null);let d=t.mapping.slice(i),f=d.map(a,1),p=d.map(a+o.nodeSize,1);return t.step(new Mt(f,p,f+1,p-1,new ee(K.from(r.create(l,null,o.marks)),0,0),1,!0)),u===!0&&BA(t,o,a,i),!1}})}function BA(t,e,n,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=t.mapping.slice(r).map(n+1+i+o.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function $A(t,e,n,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+i);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function c$(t,e,n){let r=t.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,n)}function u$(t,e,n,r,s){let i=t.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");n||(n=i.type);let o=n.create(r,null,s||i.marks);if(i.isLeaf)return t.replaceWith(e,e+i.nodeSize,o);if(!n.validContent(i.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Mt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new ee(K.from(o),0,0),1,!0))}function Cs(t,e,n=1,r){let s=t.resolve(e),i=s.depth-n,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let u=s.depth-1,d=n-2;u>i;u--,d--){let f=s.node(u),p=s.index(u);if(f.type.spec.isolating)return!1;let m=f.content.cutByIndex(p,f.childCount),g=r&&r[d+1];g&&(m=m.replaceChild(0,g.type.create(g.attrs)));let x=r&&r[d]||f;if(!f.canReplace(p+1,f.childCount)||!x.type.validContent(m))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function d$(t,e,n=1,r){let s=t.doc.resolve(e),i=K.empty,o=K.empty;for(let a=s.depth,l=s.depth-n,u=n-1;a>l;a--,u--){i=K.from(s.node(a).copy(i));let d=r&&r[u];o=K.from(d?d.type.create(d.attrs,o):s.node(a).copy(o))}t.step(new Pt(e,e,new ee(i.append(o),n,n),!0))}function eo(t,e){let n=t.resolve(e),r=n.index();return HA(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function h$(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?t.type.schema.nodes.text:i.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(i.marks))return!1}return n.validEnd}function HA(t,e){return!!(t&&e&&!t.isLeaf&&h$(t,e))}function Im(t,e,n=-1){let r=t.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):n>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&HA(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=n<0?r.before(s):r.after(s)}}function f$(t,e,n){let r=null,{linebreakReplacement:s}=t.doc.type.schema,i=t.doc.resolve(e-n),o=i.node().type;if(s&&o.inlineContent){let d=o.whitespace=="pre",f=!!o.contentMatch.matchType(s);d&&!f?r=!1:!d&&f&&(r=!0)}let a=t.steps.length;if(r===!1){let d=t.doc.resolve(e+n);$A(t,d.node(),d.before(),a)}o.inlineContent&&Uw(t,e+n-1,o,i.node().contentMatchAt(i.index()),r==null);let l=t.mapping.slice(a),u=l.map(e-n);if(t.step(new Pt(u,l.map(e+n,-1),ee.empty,!0)),r===!0){let d=t.doc.resolve(u);BA(t,d.node(),d.before(),t.steps.length)}return t}function p$(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,n))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,n))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function qA(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let s=n.content;for(let i=0;i<n.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(n.openStart==0&&n.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),u=r.node(o),d=!1;if(i==1)d=u.canReplace(l,l,s);else{let f=u.contentMatchAt(l).findWrapping(s.firstChild.type);d=f&&u.canReplaceWith(l,l,f[0])}if(d)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Am(t,e,n=e,r=ee.empty){if(e==n&&!r.size)return null;let s=t.resolve(e),i=t.resolve(n);return WA(s,i,r)?new Pt(e,n,r):new m$(s,i,r).fit()}function WA(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class m${constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=K.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=K.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new ee(i,o,a);return e>-1?new Mt(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new Pt(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=n.firstChild;if(n.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}n=i.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Yg(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:u}=this.frontier[a],d,f=null;if(n==1&&(o?u.matchType(o.type)||(f=u.fillBefore(K.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:f};if(n==2&&o&&(d=u.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:d};if(i&&u.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Yg(e,n);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new ee(e,n+1,Math.max(r,s.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,s=Yg(e,n);if(s.childCount<=1&&n>0){let i=e.size-n<=n+s.size;this.unplaced=new ee(Tc(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new ee(Tc(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:s,wrap:i}){for(;this.depth>n;)this.closeFrontierNode();if(i)for(let x=0;x<i.length;x++)this.openFrontierNode(i[x]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,u=0,d=[],{match:f,type:p}=this.frontier[n];if(s){for(let x=0;x<s.childCount;x++)d.push(s.child(x));f=f.matchFragment(s)}let m=a.size+e-(o.content.size-o.openEnd);for(;u<a.childCount;){let x=a.child(u),w=f.matchType(x.type);if(!w)break;u++,(u>1||l==0||x.content.size)&&(f=w,d.push(KA(x.mark(p.allowedMarks(x.marks)),u==1?l:0,u==a.childCount?m:-1)))}let g=u==a.childCount;g||(m=-1),this.placed=kc(this.placed,n,K.from(d)),this.frontier[n].match=f,g&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let x=0,w=a;x<m;x++){let v=w.lastChild;this.frontier.push({type:v.type,match:v.contentMatchAt(v.childCount)}),w=v.content}this.unplaced=g?e==0?ee.empty:new ee(Tc(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new ee(Tc(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Xg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:s}=this.frontier[n],i=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Xg(e,n,s,r,i);if(o){for(let a=n-1;a>=0;a--){let{match:l,type:u}=this.frontier[a],d=Xg(e,a,u,l,!0);if(!d||d.childCount)continue e}return{depth:n,fit:o,move:i?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=kc(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,n=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=kc(this.placed,this.depth,K.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(K.empty,!0);n.childCount&&(this.placed=kc(this.placed,this.frontier.length,n))}}function Tc(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Tc(t.firstChild.content,e-1,n)))}function kc(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(kc(t.lastChild.content,e-1,n)))}function Yg(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function KA(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,KA(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(K.empty,!0)))),t.copy(r)}function Xg(t,e,n,r,s){let i=t.node(e),o=s?t.indexAfter(e):t.index(e);if(o==i.childCount&&!n.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!g$(n,i.content,o)?a:null}function g$(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function y$(t){return t.spec.defining||t.spec.definingForContent}function x$(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let s=t.doc.resolve(e),i=t.doc.resolve(n);if(WA(s,i,r))return t.step(new Pt(e,n,r));let o=QA(s,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let p=s.depth,m=s.pos-1;p>0;p--,m--){let g=s.node(p).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;o.indexOf(p)>-1?a=p:s.before(p)==m&&o.splice(1,0,-p)}let l=o.indexOf(a),u=[],d=r.openStart;for(let p=r.content,m=0;;m++){let g=p.firstChild;if(u.push(g),m==r.openStart)break;p=g.content}for(let p=d-1;p>=0;p--){let m=u[p],g=y$(m.type);if(g&&!m.sameMarkup(s.node(Math.abs(a)-1)))d=p;else if(g||!m.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let m=(p+d+1)%(r.openStart+1),g=u[m];if(g)for(let x=0;x<o.length;x++){let w=o[(x+l)%o.length],v=!0;w<0&&(v=!1,w=-w);let _=s.node(w-1),E=s.index(w-1);if(_.canReplaceWith(E,E,g.type,g.marks))return t.replace(s.before(w),v?i.after(w):n,new ee(GA(r.content,0,r.openStart,m),m,r.openEnd))}}let f=t.steps.length;for(let p=o.length-1;p>=0&&(t.replace(e,n,r),!(t.steps.length>f));p--){let m=o[p];m<0||(e=s.before(m),n=i.after(m))}}function GA(t,e,n,r,s){if(e<n){let i=t.firstChild;t=t.replaceChild(0,i.copy(GA(i.content,e+1,n,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(t).append(t);t=o.append(i.matchFragment(o).fillBefore(K.empty,!0))}return t}function v$(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let s=p$(t.doc,e,r.type);s!=null&&(e=n=s)}t.replaceRange(e,n,new ee(K.from(r),0,0))}function w$(t,e,n){let r=t.doc.resolve(e),s=t.doc.resolve(n),i=QA(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return t.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&s.end(o)-n!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function QA(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let s=r;s>=0;s--){let i=t.start(s);if(i<t.pos-(t.depth-s)||e.end(s)>e.pos+(e.depth-s)||t.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==t.depth&&s==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&n.push(s)}return n}class Za extends gn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Tt.fail("No node at attribute step's position");let r=Object.create(null);for(let i in n.attrs)r[i]=n.attrs[i];r[this.attr]=this.value;let s=n.type.create(r,null,n.marks);return Tt.fromReplace(e,this.pos,this.pos+1,new ee(K.from(s),0,n.isLeaf?0:1))}getMap(){return Kn.empty}invert(e){return new Za(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Za(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Za(n.pos,n.attr,n.value)}}gn.jsonID("attr",Za);class Lu extends gn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Tt.ok(r)}getMap(){return Kn.empty}invert(e){return new Lu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Lu(n.attr,n.value)}}gn.jsonID("docAttr",Lu);let _l=class extends Error{};_l=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};_l.prototype=Object.create(Error.prototype);_l.prototype.constructor=_l;_l.prototype.name="TransformError";class JA{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Xa}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new _l(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=ee.empty){let s=Am(this.doc,e,n,r);return s&&this.step(s),this}replaceWith(e,n,r){return this.replace(e,n,new ee(K.from(r),0,0))}delete(e,n){return this.replace(e,n,ee.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return x$(this,e,n,r),this}replaceRangeWith(e,n,r){return v$(this,e,n,r),this}deleteRange(e,n){return w$(this,e,n),this}lift(e,n){return s$(this,e,n),this}join(e,n=1){return f$(this,e,n),this}wrap(e,n){return a$(this,e,n),this}setBlockType(e,n=e,r,s=null){return l$(this,e,n,r,s),this}setNodeMarkup(e,n,r=null,s){return u$(this,e,n,r,s),this}setNodeAttribute(e,n,r){return this.step(new Za(e,n,r)),this}setDocAttribute(e,n){return this.step(new Lu(e,n)),this}addNodeMark(e,n){return this.step(new xi(e,n)),this}removeNodeMark(e,n){if(!(n instanceof Fe)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new bl(e,n)),this}split(e,n=1,r){return d$(this,e,n,r),this}addMark(e,n,r){return t$(this,e,n,r),this}removeMark(e,n,r){return n$(this,e,n,r),this}clearIncompatible(e,n,r){return Uw(this,e,n,r),this}}const Zg=Object.create(null);class ve{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new b$(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=ee.empty){let r=n.content.lastChild,s=null;for(let a=0;a<n.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:u}=o[a],d=e.mapping.slice(i);e.replaceRange(d.map(l.pos),d.map(u.pos),a?ee.empty:n),a==0&&jS(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),u=l.map(o.pos),d=l.map(a.pos);i?e.deleteRange(u,d):(e.replaceRangeWith(u,d,n),jS(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let s=e.parent.inlineContent?new fe(e):_a(e.node(0),e.parent,e.pos,e.index(),n,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=n<0?_a(e.node(0),e.node(i),e.before(i+1),e.index(i),n,r):_a(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Zn(e.node(0))}static atStart(e){return _a(e,e,0,0,1)||new Zn(e)}static atEnd(e){return _a(e,e,e.content.size,e.childCount,-1)||new Zn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Zg[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Zg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Zg[e]=n,n.prototype.jsonID=e,n}getBookmark(){return fe.between(this.$anchor,this.$head).getBookmark()}}ve.prototype.visible=!0;class b${constructor(e,n){this.$from=e,this.$to=n}}let IS=!1;function AS(t){!IS&&!t.parent.inlineContent&&(IS=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class fe extends ve{constructor(e,n=e){AS(e),AS(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return ve.near(r);let s=e.resolve(n.map(this.anchor));return new fe(s.parent.inlineContent?s:r,r)}replace(e,n=ee.empty){if(super.replace(e,n),n==ee.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof fe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new jm(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new fe(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let s=e.resolve(n);return new this(s,r==n?s:e.resolve(r))}static between(e,n,r){let s=e.pos-n.pos;if((!r||s)&&(r=s>=0?1:-1),!n.parent.inlineContent){let i=ve.findFrom(n,r,!0)||ve.findFrom(n,-r,!0);if(i)n=i.$head;else return ve.near(n,r)}return e.parent.inlineContent||(s==0?e=n:(e=(ve.findFrom(e,-r,!0)||ve.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=s<0&&(e=n))),new fe(e,n)}}ve.jsonID("text",fe);class jm{constructor(e,n){this.anchor=e,this.head=n}map(e){return new jm(e.map(this.anchor),e.map(this.head))}resolve(e){return fe.between(e.resolve(this.anchor),e.resolve(this.head))}}class ue extends ve{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:s}=n.mapResult(this.anchor),i=e.resolve(s);return r?ve.near(i):new ue(i)}content(){return new ee(K.from(this.node),0,0)}eq(e){return e instanceof ue&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Bw(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ue(e.resolve(n.anchor))}static create(e,n){return new ue(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ue.prototype.visible=!1;ve.jsonID("node",ue);class Bw{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new jm(r,r):new Bw(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&ue.isSelectable(r)?new ue(n):ve.near(n)}}class Zn extends ve{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=ee.empty){if(n==ee.empty){e.delete(0,e.doc.content.size);let r=ve.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Zn(e)}map(e){return new Zn(e)}eq(e){return e instanceof Zn}getBookmark(){return _$}}ve.jsonID("all",Zn);const _$={map(){return this},resolve(t){return new Zn(t)}};function _a(t,e,n,r,s,i=!1){if(e.inlineContent)return fe.create(t,n);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&ue.isSelectable(a))return ue.create(t,n-(s<0?a.nodeSize:0))}else{let l=_a(t,a,n+s,s<0?a.childCount:0,s,i);if(l)return l}n+=a.nodeSize*s}return null}function jS(t,e,n){let r=t.steps.length-1;if(r<e)return;let s=t.steps[r];if(!(s instanceof Pt||s instanceof Mt))return;let i=t.mapping.maps[r],o;i.forEach((a,l,u,d)=>{o==null&&(o=d)}),t.setSelection(ve.near(t.doc.resolve(o),n))}const RS=1,PS=2,DS=4;class E$ extends JA{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|RS)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&RS)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=PS,this}ensureMarks(e){return Fe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&PS)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&-3,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Fe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let s=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(n);i=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,s.text(e,i)),this.selection.empty||this.setSelection(ve.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=DS,this}get scrolledIntoView(){return(this.updated&DS)>0}}function MS(t,e){return!e||!t?t:t.bind(e)}class Nc{constructor(e,n,r){this.name=e,this.init=MS(n.init,r),this.apply=MS(n.apply,r)}}const S$=[new Nc("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Nc("selection",{init(t,e){return t.selection||ve.atStart(e.doc)},apply(t){return t.selection}}),new Nc("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Nc("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class ey{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=S$.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Nc(r.key,r.spec.state,r))})}}class Fa{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,u=s?s[o].state:this,d=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,u,r);if(d&&r.filterTransaction(d,o)){if(d.setMeta("appendedTransaction",e),!s){s=[];for(let f=0;f<this.config.plugins.length;f++)s.push(f<o?{state:r,n:n.length}:{state:this,n:0})}n.push(d),r=r.applyInner(d),i=!0}s&&(s[o]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new Fa(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];n[i.name]=i.apply(e,this[i.name],this,n)}return n}get tr(){return new E$(this)}static create(e){let n=new ey(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Fa(n);for(let s=0;s<n.fields.length;s++)r[n.fields[s].name]=n.fields[s].init(e,r);return r}reconfigure(e){let n=new ey(this.schema,e.plugins),r=n.fields,s=new Fa(n);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(n[r]=i.toJSON.call(s,this[s.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new ey(e.schema,e.plugins),i=new Fa(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=Ri.fromJSON(e.schema,n.doc);else if(o.name=="selection")i.selection=ve.fromJSON(i.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(i.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],u=l.spec.state;if(l.key==o.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){i[o.name]=u.fromJSON.call(l,e,n[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function YA(t,e,n){for(let r in t){let s=t[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=YA(s,e,{})),n[r]=s}return n}class Ft{constructor(e){this.spec=e,this.props={},e.props&&YA(e.props,this,this.props),this.key=e.key?e.key.key:XA("plugin")}getState(e){return e[this.key]}}const ty=Object.create(null);function XA(t){return t in ty?t+"$"+ ++ty[t]:(ty[t]=0,t+"$")}class Fn{constructor(e="key"){this.key=XA(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Kt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Vu=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let ex=null;const fs=function(t,e,n){let r=ex||(ex=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},T$=function(){ex=null},Xo=function(t,e,n,r){return n&&(OS(t,e,n,r,-1)||OS(t,e,n,r,1))},k$=/^(img|br|input|textarea|hr)$/i;function OS(t,e,n,r,s){for(;;){if(t==n&&e==r)return!0;if(e==(s<0?0:dr(t))){let i=t.parentNode;if(!i||i.nodeType!=1||fd(t)||k$.test(t.nodeName)||t.contentEditable=="false")return!1;e=Kt(t)+(s<0?0:1),t=i}else if(t.nodeType==1){if(t=t.childNodes[e+(s<0?-1:0)],t.contentEditable=="false")return!1;e=s<0?dr(t):0}else return!1}}function dr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function N$(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=dr(t)}else if(t.parentNode&&!fd(t))e=Kt(t),t=t.parentNode;else return null}}function C$(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!fd(t))e=Kt(t)+1,t=t.parentNode;else return null}}function I$(t,e,n){for(let r=e==0,s=e==dr(t);r||s;){if(t==n)return!0;let i=Kt(t);if(t=t.parentNode,!t)return!1;r=r&&i==0,s=s&&i==dr(t)}}function fd(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Rm=function(t){return t.focusNode&&Xo(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function ho(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function A$(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function j$(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(dr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(dr(r.startContainer),r.startOffset)}}}const Zr=typeof navigator<"u"?navigator:null,LS=typeof document<"u"?document:null,to=Zr&&Zr.userAgent||"",tx=/Edge\/(\d+)/.exec(to),ZA=/MSIE \d/.exec(to),nx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(to),Vn=!!(ZA||nx||tx),Di=ZA?document.documentMode:nx?+nx[1]:tx?+tx[1]:0,Rr=!Vn&&/gecko\/(\d+)/i.test(to);Rr&&+(/Firefox\/(\d+)/.exec(to)||[0,0])[1];const rx=!Vn&&/Chrome\/(\d+)/.exec(to),hn=!!rx,ej=rx?+rx[1]:0,Sn=!Vn&&!!Zr&&/Apple Computer/.test(Zr.vendor),El=Sn&&(/Mobile\/\w+/.test(to)||!!Zr&&Zr.maxTouchPoints>2),ar=El||(Zr?/Mac/.test(Zr.platform):!1),R$=Zr?/Win/.test(Zr.platform):!1,bs=/Android \d/.test(to),pd=!!LS&&"webkitFontSmoothing"in LS.documentElement.style,P$=pd?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function D$(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function as(t,e){return typeof t=="number"?t:t[e]}function M$(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function VS(t,e,n){let r=t.someProp("scrollThreshold")||0,s=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument;for(let o=n||t.dom;o;o=Vu(o)){if(o.nodeType!=1)continue;let a=o,l=a==i.body,u=l?D$(i):M$(a),d=0,f=0;if(e.top<u.top+as(r,"top")?f=-(u.top-e.top+as(s,"top")):e.bottom>u.bottom-as(r,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+as(s,"top")-u.top:e.bottom-u.bottom+as(s,"bottom")),e.left<u.left+as(r,"left")?d=-(u.left-e.left+as(s,"left")):e.right>u.right-as(r,"right")&&(d=e.right-u.right+as(s,"right")),d||f)if(l)i.defaultView.scrollBy(d,f);else{let p=a.scrollLeft,m=a.scrollTop;f&&(a.scrollTop+=f),d&&(a.scrollLeft+=d);let g=a.scrollLeft-p,x=a.scrollTop-m;e={left:e.left-g,top:e.top-x,right:e.right-g,bottom:e.bottom-x}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function O$(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=t.root.elementFromPoint(i,o);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:tj(t.dom)}}function tj(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Vu(r));return e}function L$({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;nj(n,r==0?0:r-e)}function nj(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:s,left:i}=t[n];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let ya=null;function V$(t){if(t.setActive)return t.setActive();if(ya)return t.focus(ya);let e=tj(t);t.focus(ya==null?{get preventScroll(){return ya={preventScroll:!0},!0}}:void 0),ya||(ya=!1,nj(e,0))}function rj(t,e){let n,r=2e8,s,i=0,o=e.top,a=e.top,l,u;for(let d=t.firstChild,f=0;d;d=d.nextSibling,f++){let p;if(d.nodeType==1)p=d.getClientRects();else if(d.nodeType==3)p=fs(d).getClientRects();else continue;for(let m=0;m<p.length;m++){let g=p[m];if(g.top<=o&&g.bottom>=a){o=Math.max(g.bottom,o),a=Math.min(g.top,a);let x=g.left>e.left?g.left-e.left:g.right<e.left?e.left-g.right:0;if(x<r){n=d,r=x,s=x&&n.nodeType==3?{left:g.right<e.left?g.right:g.left,top:e.top}:e,d.nodeType==1&&x&&(i=f+(e.left>=(g.left+g.right)/2?1:0));continue}}else g.top>e.top&&!l&&g.left<=e.left&&g.right>=e.left&&(l=d,u={left:Math.max(g.left,Math.min(g.right,e.left)),top:g.top});!n&&(e.left>=g.right&&e.top>=g.top||e.left>=g.left&&e.top>=g.bottom)&&(i=f+1)}}return!n&&l&&(n=l,s=u,r=0),n&&n.nodeType==3?F$(n,s):!n||r&&n.nodeType==1?{node:t,offset:i}:rj(n,s)}function F$(t,e){let n=t.nodeValue.length,r=document.createRange();for(let s=0;s<n;s++){r.setEnd(t,s+1),r.setStart(t,s);let i=Js(r,1);if(i.top!=i.bottom&&$w(e,i))return{node:t,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}function $w(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function U$(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function z$(t,e,n){let{node:r,offset:s}=rj(e,n),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,s,i)}function B$(t,e,n,r){let s=-1;for(let i=e,o=!1;i!=t.dom;){let a=t.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:t.docView.posFromDOM(e,n,-1)}function sj(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=s;;){let o=t.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let u=a[l];if($w(e,u))return sj(o,e,u)}}if((i=(i+1)%r)==s)break}return t}function $$(t,e){let n=t.dom.ownerDocument,r,s=0,i=j$(n,e.left,e.top);i&&({node:r,offset:s}=i);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),a;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let u=t.dom.getBoundingClientRect();if(!$w(e,u)||(o=sj(t.dom,e,u),!o))return null}if(Sn)for(let u=o;r&&u;u=Vu(u))u.draggable&&(r=void 0);if(o=U$(o,e),r){if(Rr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let d=r.childNodes[s],f;d.nodeName=="IMG"&&(f=d.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&s++}let u;pd&&s&&r.nodeType==1&&(u=r.childNodes[s-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&s--,r==t.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=t.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=B$(t,r,s,e))}a==null&&(a=z$(t,o,e));let l=t.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function FS(t){return t.top<t.bottom||t.left<t.right}function Js(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(FS(r))return r}return Array.prototype.find.call(n,FS)||t.getBoundingClientRect()}const H$=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ij(t,e,n){let{node:r,offset:s,atom:i}=t.docView.domFromPos(e,n<0?-1:1),o=pd||Rr;if(r.nodeType==3)if(o&&(H$.test(r.nodeValue)||(n<0?!s:s==r.nodeValue.length))){let l=Js(fs(r,s,s),n);if(Rr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let u=Js(fs(r,s-1,s-1),-1);if(u.top==l.top){let d=Js(fs(r,s,s+1),-1);if(d.top!=l.top)return fc(d,d.left<u.left)}}return l}else{let l=s,u=s,d=n<0?1:-1;return n<0&&!s?(u++,d=-1):n>=0&&s==r.nodeValue.length?(l--,d=1):n<0?l--:u++,fc(Js(fs(r,l,u),d),d<0)}if(!t.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(n<0||s==dr(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return ny(l.getBoundingClientRect(),!1)}if(i==null&&s<dr(r)){let l=r.childNodes[s];if(l.nodeType==1)return ny(l.getBoundingClientRect(),!0)}return ny(r.getBoundingClientRect(),n>=0)}if(i==null&&s&&(n<0||s==dr(r))){let l=r.childNodes[s-1],u=l.nodeType==3?fs(l,dr(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return fc(Js(u,1),!1)}if(i==null&&s<dr(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?fs(l,0,o?0:1):l.nodeType==1?l:null:null;if(u)return fc(Js(u,-1),!0)}return fc(Js(r.nodeType==3?fs(r):r,-n),n>=0)}function fc(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function ny(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function oj(t,e,n){let r=t.state,s=t.root.activeElement;r!=e&&t.updateState(e),s!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),s!=t.dom&&s&&s.focus()}}function q$(t,e,n){let r=e.selection,s=n=="up"?r.$from:r.$to;return oj(t,e,()=>{let{node:i}=t.docView.domFromPos(s.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=ij(t,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=fs(a,0,a.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let d=l[u];if(d.bottom>d.top+1&&(n=="up"?o.top-d.top>(d.bottom-o.top)*2:d.bottom-o.bottom>(o.bottom-d.top)*2))return!1}}return!0})}const W$=/[\u0590-\u08ac]/;function K$(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=t.domSelection();return a?!W$.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?i:o:oj(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:d,anchorOffset:f}=t.domSelectionRange(),p=a.caretBidiLevel;a.modify("move",n,"character");let m=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:g,focusOffset:x}=t.domSelectionRange(),w=g&&!m.contains(g.nodeType==1?g:g.parentNode)||l==g&&u==x;try{a.collapse(d,f),l&&(l!=d||u!=f)&&a.extend&&a.extend(l,u)}catch{}return p!=null&&(a.caretBidiLevel=p),w}):r.pos==r.start()||r.pos==r.end()}let US=null,zS=null,BS=!1;function G$(t,e,n){return US==e&&zS==n?BS:(US=e,zS=n,BS=n=="up"||n=="down"?q$(t,e,n):K$(t,e,n))}const gr=0,$S=1,bo=2,es=3;class md{constructor(e,n,r,s){this.parent=e,this.children=n,this.dom=r,this.contentDOM=s,this.dirty=gr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let s=this.children[n];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=n>Kt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&n==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!n||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let s=this.children[n],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof lj){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,n);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof aj&&i.side>=0;r--);if(n<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&n&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,n):{node:this.contentDOM,offset:i?Kt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,n):{node:this.contentDOM,offset:i?Kt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],u=o+l.size;if(s==-1&&e<=u){let d=o+l.border;if(e>=d&&n<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,d);e=o;for(let f=a;f>0;f--){let p=this.children[f-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){s=Kt(p.dom)+1;break}e-=p.size}s==-1&&(s=0)}if(s>-1&&(u>n||a==this.children.length-1)){n=u;for(let d=a+1;d<this.children.length;d++){let f=this.children[d];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=Kt(f.dom);break}n+=f.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=u}return{node:this.contentDOM,from:e,to:n,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,s=!1){let i=Math.min(e,n),o=Math.max(e,n);for(let m=0,g=0;m<this.children.length;m++){let x=this.children[m],w=g+x.size;if(i>g&&o<w)return x.setSelection(e-g-x.border,n-g-x.border,r,s);g=w}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),u=r.root.getSelection(),d=r.domSelectionRange(),f=!1;if((Rr||Sn)&&e==n){let{node:m,offset:g}=a;if(m.nodeType==3){if(f=!!(g&&m.nodeValue[g-1]==`
`),f&&g==m.nodeValue.length)for(let x=m,w;x;x=x.parentNode){if(w=x.nextSibling){w.nodeName=="BR"&&(a=l={node:w.parentNode,offset:Kt(w)+1});break}let v=x.pmViewDesc;if(v&&v.node&&v.node.isBlock)break}}else{let x=m.childNodes[g-1];f=x&&(x.nodeName=="BR"||x.contentEditable=="false")}}if(Rr&&d.focusNode&&d.focusNode!=l.node&&d.focusNode.nodeType==1){let m=d.focusNode.childNodes[d.focusOffset];m&&m.contentEditable=="false"&&(s=!0)}if(!(s||f&&Sn)&&Xo(a.node,a.offset,d.anchorNode,d.anchorOffset)&&Xo(l.node,l.offset,d.focusNode,d.focusOffset))return;let p=!1;if((u.extend||e==n)&&!f){u.collapse(a.node,a.offset);try{e!=n&&u.extend(l.node,l.offset),p=!0}catch{}}if(!p){if(e>n){let g=a;a=l,l=g}let m=document.createRange();m.setEnd(l.node,l.offset),m.setStart(a.node,a.offset),u.removeAllRanges(),u.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let a=r+i.border,l=o-i.border;if(e>=a&&n<=l){this.dirty=e==r||n==o?bo:$S,e==a&&n==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=es:i.markDirty(e-a,n-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?bo:es}r=o}this.dirty=bo}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?bo:$S;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class aj extends md{constructor(e,n,r,s){let i,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!n.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,i=this}matchesWidget(e){return this.dirty==gr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Q$ extends md{constructor(e,n,r,s){super(e,[],n,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Zo extends md{constructor(e,n,r,s,i){super(e,[],r,s),this.mark=n,this.spec=i}static create(e,n,r,s){let i=s.nodeViews[n.type.name],o=i&&i(n,s,r);return(!o||!o.dom)&&(o=ca.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Zo(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&es||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=es&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=gr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=gr}}slice(e,n,r){let s=Zo.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;n<o&&(i=ix(i,n,o,r)),e>0&&(i=ix(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Mi extends md{constructor(e,n,r,s,i,o,a,l,u){super(e,[],i,o),this.node=n,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,n,r,s,i,o){let a=i.nodeViews[n.type.name],l,u=a&&a(n,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),d=u&&u.dom,f=u&&u.contentDOM;if(n.isText){if(!d)d=document.createTextNode(n.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:f}=ca.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!f&&!n.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),n.type.spec.draggable&&(d.draggable=!0));let p=d;return d=dj(d,r,n),u?l=new J$(e,n,r,s,d,f||null,p,u,i,o+1):n.isText?new Pm(e,n,r,s,d,p,i):new Mi(e,n,r,s,d,f||null,p,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>K.empty)}return e}matchesNode(e,n,r){return this.dirty==gr&&e.eq(this.node)&&Wf(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,s=n,i=e.composing?this.localCompositionInfo(e,n):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new X$(this,o&&o.node,e);t9(this.node,this.innerDeco,(u,d,f)=>{u.spec.marks?l.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!f&&l.syncToMarks(d==this.node.childCount?Fe.none:this.node.child(d).marks,r,e),l.placeWidget(u,e,s)},(u,d,f,p)=>{l.syncToMarks(u.marks,r,e);let m;l.findNodeMatch(u,d,f,p)||a&&e.state.selection.from>s&&e.state.selection.to<s+u.nodeSize&&(m=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(u,d,f,m,e)||l.updateNextNode(u,d,f,e,p,s)||l.addNode(u,d,f,e,s),s+=u.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==bo)&&(o&&this.protectLocalComposition(e,o),cj(this.contentDOM,this.children,e),El&&n9(this.dom))}localCompositionInfo(e,n){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof fe)||r<n||s>n+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=r9(this.node.content,o,r-n,s-n);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:s}){if(this.getDesc(n))return;let i=n;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new Q$(this,i,n,s);e.input.compositionNodes.push(o),this.children=ix(this.children,r,r+s.length,e,o)}update(e,n,r,s){return this.dirty==es||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,s),!0)}updateInner(e,n,r,s){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=gr}updateOuterDeco(e){if(Wf(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=uj(this.dom,this.nodeDOM,sx(this.outerDeco,this.node,n),sx(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function HS(t,e,n,r,s){dj(r,e,t);let i=new Mi(void 0,t,e,n,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Pm extends Mi{constructor(e,n,r,s,i,o,a){super(e,n,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,s){return this.dirty==es||this.dirty!=gr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=gr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=gr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let s=this.node.cut(e,n),i=document.createTextNode(s.text);return new Pm(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=es)}get domAtom(){return!1}isText(e){return this.node.text==e}}class lj extends md{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==gr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class J$ extends Mi{constructor(e,n,r,s,i,o,a,l,u,d){super(e,n,r,s,i,o,a,u,d),this.spec=l}update(e,n,r,s){if(this.dirty==es)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,n,r);return i&&this.updateInner(e,n,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,s){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function cj(t,e,n){let r=t.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==t){for(;a!=r;)r=qS(r),s=!0;r=r.nextSibling}else s=!0,t.insertBefore(a,r);if(o instanceof Zo){let l=r?r.previousSibling:t.lastChild;cj(o.contentDOM,o.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=qS(r),s=!0;s&&n.trackWrites==t&&(n.trackWrites=null)}const Qc=function(t){t&&(this.nodeName=t)};Qc.prototype=Object.create(null);const _o=[new Qc];function sx(t,e,n){if(t.length==0)return _o;let r=n?_o[0]:new Qc,s=[r];for(let i=0;i<t.length;i++){let o=t[i].type.attrs;if(o){o.nodeName&&s.push(r=new Qc(o.nodeName));for(let a in o){let l=o[a];l!=null&&(n&&s.length==1&&s.push(r=new Qc(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function uj(t,e,n,r){if(n==_o&&r==_o)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=n[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=t&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=_o[0]),s=l}Y$(s,a||_o[0],o)}return s}function Y$(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=n.class?n.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&t.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&t.classList.add(s[i]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)t.style.removeProperty(s[1])}n.style&&(t.style.cssText+=n.style)}}function dj(t,e,n){return uj(t,t,_o,sx(e,n,t.nodeType!=1))}function Wf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function qS(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class X${constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Z$(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=gr,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let u=this.top.children[l];if(u.matchesMark(e[i])&&!this.isLocked(u.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Zo.create(this.top,e[i],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,n,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let u=this.top.children[a];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,n,r,s,i){let o=this.top.children[s];return o.dirty==es&&o.dom==o.contentDOM&&(o.dirty=bo),o.update(e,n,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=n}}updateNextNode(e,n,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Mi){let u=this.preMatch.matched.get(l);if(u!=null&&u!=i)return!1;let d=l.dom,f,p=this.isLocked(d)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=es&&Wf(n,l.outerDeco));if(!p&&l.update(e,n,r,s))return this.destroyBetween(this.index,a),l.dom!=d&&(this.changed=!0),this.index++,!0;if(!p&&(f=this.recreateWrapper(l,e,n,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=bo,f.updateChildren(s,o+1),f.dirty=gr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,s,i,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Wf(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=Mi.create(this.top,n,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,n,r,s,i){let o=Mi.create(this.top,e,n,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new aj(this.top,e,n,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Zo;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Pm)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Sn||hn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new lj(this.top,[],r,null);n!=this.top?n.children.push(s):n.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Z$(t,e){let n=e,r=n.children.length,s=t.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let u=n.children[r-1];if(u instanceof Zo)n=u,r=u.children.length;else{a=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function e9(t,e){return t.type.side-e.type.side}function t9(t,e,n,r){let s=e.locals(t),i=0;if(s.length==0){for(let u=0;u<t.childCount;u++){let d=t.child(u);r(d,s,e.forChild(i,d),u),i+=d.nodeSize}return}let o=0,a=[],l=null;for(let u=0;;){let d,f;for(;o<s.length&&s[o].to==i;){let w=s[o++];w.widget&&(d?(f||(f=[d])).push(w):d=w)}if(d)if(f){f.sort(e9);for(let w=0;w<f.length;w++)n(f[w],u,!!l)}else n(d,u,!!l);let p,m;if(l)m=-1,p=l,l=null;else if(u<t.childCount)m=u,p=t.child(u++);else break;for(let w=0;w<a.length;w++)a[w].to<=i&&a.splice(w--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let g=i+p.nodeSize;if(p.isText){let w=g;o<s.length&&s[o].from<w&&(w=s[o].from);for(let v=0;v<a.length;v++)a[v].to<w&&(w=a[v].to);w<g&&(l=p.cut(w-i),p=p.cut(0,w-i),g=w,m=-1)}else for(;o<s.length&&s[o].to<g;)o++;let x=p.isInline&&!p.isLeaf?a.filter(w=>!w.inline):a.slice();r(p,x,e.forChild(i,p),m),i=g}}function n9(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function r9(t,e,n,r){for(let s=0,i=0;s<t.childCount&&i<=r;){let o=t.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<t.childCount;){let u=t.child(s++);if(i+=u.nodeSize,!u.isText)break;l+=u.text}if(i>=n){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let u=a<r?l.lastIndexOf(e,r-a-1):-1;if(u>=0&&u+e.length+a>=n)return a+u;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function ix(t,e,n,r,s){let i=[];for(let o=0,a=0;o<t.length;o++){let l=t[o],u=a,d=a+=l.size;u>=n||d<=e?i.push(l):(u<e&&i.push(l.slice(0,e-u,r)),s&&(i.push(s),s=void 0),d>n&&i.push(l.slice(n-u,l.size,r)))}return i}function Hw(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let s=t.docView.nearestDesc(n.focusNode),i=s&&s.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,u;if(Rm(n)){for(l=o;s&&!s.node;)s=s.parent;let f=s.node;if(s&&f.isAtom&&ue.isSelectable(f)&&s.parent&&!(f.isInline&&I$(n.focusNode,n.focusOffset,s.dom))){let p=s.posBefore;u=new ue(o==p?a:r.resolve(p))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let f=o,p=o;for(let m=0;m<n.rangeCount;m++){let g=n.getRangeAt(m);f=Math.min(f,t.docView.posFromDOM(g.startContainer,g.startOffset,1)),p=Math.max(p,t.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(f<0)return null;[l,o]=p==t.state.selection.anchor?[p,f]:[f,p],a=r.resolve(o)}else l=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(l<0)return null}let d=r.resolve(l);if(!u){let f=e=="pointer"||t.state.selection.head<a.pos&&!i?1:-1;u=qw(t,d,a,f)}return u}function hj(t){return t.editable?t.hasFocus():pj(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Is(t,e=!1){let n=t.state.selection;if(fj(t,n),!!hj(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&hn){let r=t.domSelectionRange(),s=t.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Xo(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)i9(t);else{let{anchor:r,head:s}=n,i,o;WS&&!(n instanceof fe)&&(n.$from.parent.inlineContent||(i=KS(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=KS(t,n.to))),t.docView.setSelection(r,s,t,e),WS&&(i&&GS(i),o&&GS(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&s9(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const WS=Sn||hn&&ej<63;function KS(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),s=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(Sn&&s&&s.contentEditable=="false")return ry(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return ry(s);if(i)return ry(i)}}function ry(t){return t.contentEditable="true",Sn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function GS(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function s9(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,s=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=s)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!hj(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function i9(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,s=r.nodeName=="IMG";s?n.setStart(r.parentNode,Kt(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!s&&!t.state.selection.visible&&Vn&&Di<=11&&(r.disabled=!0,r.disabled=!1)}function fj(t,e){if(e instanceof ue){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(QS(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else QS(t)}function QS(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function qw(t,e,n,r){return t.someProp("createSelectionBetween",s=>s(t,e,n))||fe.between(e,n,r)}function JS(t){return t.editable&&!t.hasFocus()?!1:pj(t)}function pj(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function o9(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Xo(e.node,e.offset,n.anchorNode,n.anchorOffset)}function ox(t,e){let{$anchor:n,$head:r}=t.selection,s=e>0?n.max(r):n.min(r),i=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return i&&ve.findFrom(i,e)}function ei(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function YS(t,e,n){let r=t.state.selection;if(r instanceof fe)if(n.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=t.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return ei(t,new fe(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let s=ox(t.state,e);return s&&s instanceof ue?ei(t,s):!1}else if(!(ar&&n.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=t.docView.descAt(a))&&!o.contentDOM?ue.isSelectable(i)?ei(t,new ue(e<0?t.state.doc.resolve(s.pos-i.nodeSize):s)):pd?ei(t,new fe(t.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ue&&r.node.isInline)return ei(t,new fe(e>0?r.$to:r.$from));{let s=ox(t.state,e);return s?ei(t,s):!1}}}function Kf(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Jc(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function xa(t,e){return e<0?a9(t):l9(t)}function a9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s,i,o=!1;for(Rr&&n.nodeType==1&&r<Kf(n)&&Jc(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(Jc(a,-1))s=n,i=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(mj(n))break;{let a=n.previousSibling;for(;a&&Jc(a,-1);)s=n.parentNode,i=Kt(a),a=a.previousSibling;if(a)n=a,r=Kf(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?ax(t,n,r):s&&ax(t,s,i)}function l9(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let s=Kf(n),i,o;for(;;)if(r<s){if(n.nodeType!=1)break;let a=n.childNodes[r];if(Jc(a,1))i=n,o=++r;else break}else{if(mj(n))break;{let a=n.nextSibling;for(;a&&Jc(a,1);)i=a.parentNode,o=Kt(a)+1,a=a.nextSibling;if(a)n=a,r=0,s=Kf(n);else{if(n=n.parentNode,n==t.dom)break;r=s=0}}}i&&ax(t,i,o)}function mj(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function c9(t,e){for(;t&&e==t.childNodes.length&&!fd(t);)e=Kt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function u9(t,e){for(;t&&!e&&!fd(t);)e=Kt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function ax(t,e,n){if(e.nodeType!=3){let i,o;(o=c9(e,n))?(e=o,n=0):(i=u9(e,n))&&(e=i,n=i.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Rm(r)){let i=document.createRange();i.setEnd(e,n),i.setStart(e,n),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:s}=t;setTimeout(()=>{t.state==s&&Is(t)},50)}function XS(t,e){let n=t.state.doc.resolve(e);if(!(hn||R$)&&n.parent.inlineContent){let s=t.coordsAtPos(e);if(e>n.start()){let i=t.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<n.end()){let i=t.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function ZS(t,e,n){let r=t.state.selection;if(r instanceof fe&&!r.empty||n.indexOf("s")>-1||ar&&n.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=ox(t.state,e);if(o&&o instanceof ue)return ei(t,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof Zn?ve.near(o,e):ve.findFrom(o,e);return a?ei(t,a):!1}return!1}function eT(t,e){if(!(t.state.selection instanceof fe))return!0;let{$head:n,$anchor:r,empty:s}=t.state.selection;if(!n.sameParent(r))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let o=t.state.tr;return e<0?o.delete(n.pos-i.nodeSize,n.pos):o.delete(n.pos,n.pos+i.nodeSize),t.dispatch(o),!0}return!1}function tT(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function d9(t){if(!Sn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;tT(t,r,"true"),setTimeout(()=>tT(t,r,"false"),20)}return!1}function h9(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function f9(t,e){let n=e.keyCode,r=h9(e);if(n==8||ar&&n==72&&r=="c")return eT(t,-1)||xa(t,-1);if(n==46&&!e.shiftKey||ar&&n==68&&r=="c")return eT(t,1)||xa(t,1);if(n==13||n==27)return!0;if(n==37||ar&&n==66&&r=="c"){let s=n==37?XS(t,t.state.selection.from)=="ltr"?-1:1:-1;return YS(t,s,r)||xa(t,s)}else if(n==39||ar&&n==70&&r=="c"){let s=n==39?XS(t,t.state.selection.from)=="ltr"?1:-1:1;return YS(t,s,r)||xa(t,s)}else{if(n==38||ar&&n==80&&r=="c")return ZS(t,-1,r)||xa(t,-1);if(n==40||ar&&n==78&&r=="c")return d9(t)||ZS(t,1,r)||xa(t,1);if(r==(ar?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function Ww(t,e){t.someProp("transformCopied",m=>{e=m(e,t)});let n=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;n.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=t.someProp("clipboardSerializer")||ca.fromSchema(t.state.schema),a=bj(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let u=l.firstChild,d,f=0;for(;u&&u.nodeType==1&&(d=wj[u.nodeName.toLowerCase()]);){for(let m=d.length-1;m>=0;m--){let g=a.createElement(d[m]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),f++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${s} ${i}${f?` -${f}`:""} ${JSON.stringify(n)}`);let p=t.someProp("clipboardTextSerializer",m=>m(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:p,slice:e}}function gj(t,e,n,r,s){let i=s.parent.type.spec.code,o,a;if(!n&&!e)return null;let l=e&&(r||i||!n);if(l){if(t.someProp("transformPastedText",p=>{e=p(e,i||r,t)}),i)return e?new ee(K.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):ee.empty;let f=t.someProp("clipboardTextParser",p=>p(e,s,r,t));if(f)a=f;else{let p=s.marks(),{schema:m}=t.state,g=ca.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(x=>{let w=o.appendChild(document.createElement("p"));x&&w.appendChild(g.serializeNode(m.text(x,p)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),o=y9(n),pd&&x9(o);let u=o&&o.querySelector("[data-pm-slice]"),d=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let f=+d[3];f>0;f--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||Pi.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||d),context:s,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!p9.test(p.parentNode.nodeName)?{ignore:!0}:null}})),d)a=v9(nT(a,+d[1],+d[2]),d[4]);else if(a=ee.maxOpen(m9(a.content,s),!0),a.openStart||a.openEnd){let f=0,p=0;for(let m=a.content.firstChild;f<a.openStart&&!m.type.spec.isolating;f++,m=m.firstChild);for(let m=a.content.lastChild;p<a.openEnd&&!m.type.spec.isolating;p++,m=m.lastChild);a=nT(a,f,p)}return t.someProp("transformPasted",f=>{a=f(a,t)}),a}const p9=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function m9(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let s=e.node(n).contentMatchAt(e.index(n)),i,o=[];if(t.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),u;if(!l)return o=null;if(u=o.length&&i.length&&xj(l,i,a,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=vj(o[o.length-1],i.length));let d=yj(a,l);o.push(d),s=s.matchType(d.type),i=l}}),o)return K.from(o)}return t}function yj(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,K.from(t));return t}function xj(t,e,n,r,s){if(s<t.length&&s<e.length&&t[s]==e[s]){let i=xj(t,e,n,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==t.length-1?n.type:t[s+1]))return r.copy(r.content.append(K.from(yj(n,t,s+1))))}}function vj(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,vj(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(K.empty,!0);return t.copy(n.append(r))}function lx(t,e,n,r,s,i){let o=e<0?t.firstChild:t.lastChild,a=o.content;return t.childCount>1&&(i=0),s<r-1&&(a=lx(a,e,n,r,s+1,i)),s>=n&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(K.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(a))}function nT(t,e,n){return e<t.openStart&&(t=new ee(lx(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new ee(lx(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const wj={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let rT=null;function bj(){return rT||(rT=document.implementation.createHTMLDocument("title"))}let sy=null;function g9(t){let e=window.trustedTypes;return e?(sy||(sy=e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),sy.createHTML(t)):t}function y9(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=bj().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),s;if((s=r&&wj[r[1].toLowerCase()])&&(t=s.map(i=>"<"+i+">").join("")+t+s.map(i=>"</"+i+">").reverse().join("")),n.innerHTML=g9(t),s)for(let i=0;i<s.length;i++)n=n.querySelector(s[i])||n;return n}function x9(t){let e=t.querySelectorAll(hn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function v9(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:s,openStart:i,openEnd:o}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=K.from(l.create(r[a+1],s)),i++,o++}return new ee(s,i,o)}const Tn={},kn={},w9={touchstart:!0,touchmove:!0};class b9{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function _9(t){for(let e in Tn){let n=Tn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{S9(t,r)&&!Kw(t,r)&&(t.editable||!(r.type in kn))&&n(t,r)},w9[e]?{passive:!0}:void 0)}Sn&&t.dom.addEventListener("input",()=>null),cx(t)}function vi(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function E9(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function cx(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Kw(t,r))})}function Kw(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function S9(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function T9(t,e){!Kw(t,e)&&Tn[e.type]&&(t.editable||!(e.type in kn))&&Tn[e.type](t,e)}kn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Ej(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(bs&&hn&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),El&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",s=>s(t,ho(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||f9(t,n)?n.preventDefault():vi(t,"key")};kn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};kn.keypress=(t,e)=>{let n=e;if(Ej(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ar&&n.metaKey)return;if(t.someProp("handleKeyPress",s=>s(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof fe)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(n.charCode);!/[\r\n]/.test(s)&&!t.someProp("handleTextInput",i=>i(t,r.$from.pos,r.$to.pos,s))&&t.dispatch(t.state.tr.insertText(s).scrollIntoView()),n.preventDefault()}};function Dm(t){return{left:t.clientX,top:t.clientY}}function k9(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Gw(t,e,n,r,s){if(r==-1)return!1;let i=t.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(t.someProp(e,a=>o>i.depth?a(t,n,i.nodeAfter,i.before(o),s,!0):a(t,n,i.node(o),i.before(o),s,!1)))return!0;return!1}function el(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function N9(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&ue.isSelectable(r)?(el(t,new ue(n)),!0):!1}function C9(t,e){if(e==-1)return!1;let n=t.state.selection,r,s;n instanceof ue&&(r=n.node);let i=t.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(ue.isSelectable(a)){r&&n.$from.depth>0&&o>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?s=i.before(n.$from.depth):s=i.before(o);break}}return s!=null?(el(t,ue.create(t.state.doc,s)),!0):!1}function I9(t,e,n,r,s){return Gw(t,"handleClickOn",e,n,r)||t.someProp("handleClick",i=>i(t,e,r))||(s?C9(t,n):N9(t,n))}function A9(t,e,n,r){return Gw(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",s=>s(t,e,r))}function j9(t,e,n,r){return Gw(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",s=>s(t,e,r))||R9(t,n,r)}function R9(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(el(t,fe.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)el(t,fe.create(r,a+1,a+1+o.content.size));else if(ue.isSelectable(o))el(t,ue.create(r,a));else continue;return!0}}function Qw(t){return Gf(t)}const _j=ar?"metaKey":"ctrlKey";Tn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Qw(t),s=Date.now(),i="singleClick";s-t.input.lastClick.time<500&&k9(n,t.input.lastClick)&&!n[_j]&&(t.input.lastClick.type=="singleClick"?i="doubleClick":t.input.lastClick.type=="doubleClick"&&(i="tripleClick")),t.input.lastClick={time:s,x:n.clientX,y:n.clientY,type:i};let o=t.posAtCoords(Dm(n));o&&(i=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new P9(t,o,n,!!r)):(i=="doubleClick"?A9:j9)(t,o.pos,o.inside,n)?n.preventDefault():vi(t,"pointer"))};class P9{constructor(e,n,r,s){this.view=e,this.pos=n,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[_j],this.allowDefault=r.shiftKey;let i,o;if(n.inside>-1)i=e.state.doc.nodeAt(n.inside),o=n.inside;else{let d=e.state.doc.resolve(n.pos);i=d.parent,o=d.depth?d.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:u}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||u instanceof ue&&u.from<=o&&u.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Rr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),vi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Is(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Dm(e))),this.updateAllowDefault(e),this.allowDefault||!n?vi(this.view,"pointer"):I9(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Sn&&this.mightDrag&&!this.mightDrag.node.isAtom||hn&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(el(this.view,ve.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):vi(this.view,"pointer")}move(e){this.updateAllowDefault(e),vi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Tn.touchstart=t=>{t.input.lastTouch=Date.now(),Qw(t),vi(t,"pointer")};Tn.touchmove=t=>{t.input.lastTouch=Date.now(),vi(t,"pointer")};Tn.contextmenu=t=>Qw(t);function Ej(t,e){return t.composing?!0:Sn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const D9=bs?5e3:-1;kn.compositionstart=kn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof fe&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Gf(t,!0),t.markCursor=null;else if(Gf(t,!e.selection.empty),Rr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=t.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}t.input.composing=!0}Sj(t,D9)};kn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Sj(t,20))};function Sj(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Gf(t),e))}function Tj(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=O9());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function M9(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=N$(e.focusNode,e.focusOffset),r=C$(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let s=r.pmViewDesc,i=t.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function O9(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Gf(t,e=!1){if(!(bs&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Tj(t),e||t.docView&&t.docView.dirty){let n=Hw(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!t.state.selection.empty?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function L9(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Fu=Vn&&Di<15||El&&P$<604;Tn.copy=kn.cut=(t,e)=>{let n=e,r=t.state.selection,s=n.type=="cut";if(r.empty)return;let i=Fu?null:n.clipboardData,o=r.content(),{dom:a,text:l}=Ww(t,o);i?(n.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):L9(t,a),s&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function V9(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function F9(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Uu(t,r.value,null,s,e):Uu(t,r.textContent,r.innerHTML,s,e)},50)}function Uu(t,e,n,r,s){let i=gj(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,s,i||ee.empty)))return!0;if(!i)return!1;let o=V9(i),a=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(i);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function kj(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}kn.paste=(t,e)=>{let n=e;if(t.composing&&!bs)return;let r=Fu?null:n.clipboardData,s=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Uu(t,kj(r),r.getData("text/html"),s,n)?n.preventDefault():F9(t,n)};class Nj{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const Cj=ar?"altKey":"ctrlKey";Tn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let s=t.state.selection,i=s.empty?null:t.posAtCoords(Dm(n)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof ue?s.to-1:s.to))){if(r&&r.mightDrag)o=ue.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(o=ue.create(t.state.doc,f.posBefore))}}let a=(o||t.state.selection).content(),{dom:l,text:u,slice:d}=Ww(t,a);(!n.dataTransfer.files.length||!hn||ej>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Fu?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Fu||n.dataTransfer.setData("text/plain",u),t.dragging=new Nj(d,!n[Cj],o)};Tn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};kn.dragover=kn.dragenter=(t,e)=>e.preventDefault();kn.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let s=t.posAtCoords(Dm(n));if(!s)return;let i=t.state.doc.resolve(s.pos),o=r&&r.slice;o?t.someProp("transformPasted",g=>{o=g(o,t)}):o=gj(t,kj(n.dataTransfer),Fu?null:n.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&!n[Cj]);if(t.someProp("handleDrop",g=>g(t,n,o||ee.empty,a))){n.preventDefault();return}if(!o)return;n.preventDefault();let l=o?qA(t.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let u=t.state.tr;if(a){let{node:g}=r;g?g.replace(u):u.deleteSelection()}let d=u.mapping.map(l),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=u.doc;if(f?u.replaceRangeWith(d,d,o.content.firstChild):u.replaceRange(d,d,o),u.doc.eq(p))return;let m=u.doc.resolve(d);if(f&&ue.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new ue(m));else{let g=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach((x,w,v,_)=>g=_),u.setSelection(qw(t,m,u.doc.resolve(g)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};Tn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Is(t)},20))};Tn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Tn.beforeinput=(t,e)=>{if(hn&&bs&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",i=>i(t,ho(8,"Backspace")))))return;let{$cursor:s}=t.state.selection;s&&s.pos>0&&t.dispatch(t.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let t in kn)Tn[t]=kn[t];function zu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Qf{constructor(e,n){this.toDOM=e,this.spec=n||Po,this.side=this.spec.side||0}map(e,n,r,s){let{pos:i,deleted:o}=e.mapResult(n.from+s,this.side<0?-1:1);return o?null:new Yn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Qf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&zu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Oi{constructor(e,n){this.attrs=e,this.spec=n||Po}map(e,n,r,s){let i=e.map(n.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Yn(i,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Oi&&zu(this.attrs,e.attrs)&&zu(this.spec,e.spec)}static is(e){return e.type instanceof Oi}destroy(){}}class Jw{constructor(e,n){this.attrs=e,this.spec=n||Po}map(e,n,r,s){let i=e.mapResult(n.from+s,1);if(i.deleted)return null;let o=e.mapResult(n.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Yn(i.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:s}=e.content.findIndex(n.from),i;return s==n.from&&!(i=e.child(r)).isText&&s+i.nodeSize==n.to}eq(e){return this==e||e instanceof Jw&&zu(this.attrs,e.attrs)&&zu(this.spec,e.spec)}destroy(){}}class Yn{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Yn(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Yn(e,e,new Qf(n,r))}static inline(e,n,r,s){return new Yn(e,n,new Oi(r,s))}static node(e,n,r,s){return new Yn(e,n,new Jw(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Oi}get widget(){return this.type instanceof Qf}}const Ea=[],Po={};class _t{constructor(e,n){this.local=e.length?e:Ea,this.children=n.length?n:Ea}static create(e,n){return n.length?Jf(n,e,0,Po):ln}find(e,n,r){let s=[];return this.findInner(e??0,n??1e9,s,0,r),s}findInner(e,n,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=n&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,n-a,r,s+a,i)}}map(e,n,r){return this==ln||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Po)}mapInner(e,n,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(n,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?U9(this.children,o||[],e,n,r,s,i):o?new _t(o.sort(Do),Ea):ln}add(e,n){return n.length?this==ln?_t.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let s,i=0;e.forEach((a,l)=>{let u=l+r,d;if(d=Aj(n,a,u)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,d,u+1):s.splice(i,0,l,l+a.nodeSize,Jf(d,a,u+1,Po)),i+=3}});let o=Ij(i?jj(n):n,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new _t(o.length?this.local.concat(o).sort(Do):this.local,s||this.children)}remove(e){return e.length==0||this==ln?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+n,l=r[i+1]+n;for(let d=0,f;d<e.length;d++)(f=e[d])&&f.from>a&&f.to<l&&(e[d]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let u=r[i+2].removeInner(o,a+1);u!=ln?r[i+2]=u:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,n)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new _t(s,r):ln}forChild(e,n){if(this==ln)return this;if(n.isLeaf)return _t.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof Oi){let u=Math.max(i,l.from)-i,d=Math.min(o,l.to)-i;u<d&&(s||(s=[])).push(l.copy(u,d))}}if(s){let a=new _t(s.sort(Do),Ea);return r?new di([a,r]):a}return r||ln}eq(e){if(this==e)return!0;if(!(e instanceof _t)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Yw(this.localsInner(e))}localsInner(e){if(this==ln)return Ea;if(e.inlineContent||!this.local.some(Oi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Oi||n.push(this.local[r]);return n}forEachSet(e){e(this)}}_t.empty=new _t([],[]);_t.removeOverlap=Yw;const ln=_t.empty;class di{constructor(e){this.members=e}map(e,n){const r=this.members.map(s=>s.map(e,n,Po));return di.from(r)}forChild(e,n){if(n.isLeaf)return _t.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,n);i!=ln&&(i instanceof di?r=r.concat(i.members):r.push(i))}return di.from(r)}eq(e){if(!(e instanceof di)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!n)n=i;else{r&&(n=n.slice(),r=!1);for(let o=0;o<i.length;o++)n.push(i[o])}}return n?Yw(r?n:n.sort(Do)):Ea}static from(e){switch(e.length){case 0:return ln;case 1:return e[0];default:return new di(e.every(n=>n instanceof _t)?e:e.reduce((n,r)=>n.concat(r instanceof _t?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function U9(t,e,n,r,s,i,o){let a=t.slice();for(let u=0,d=i;u<n.maps.length;u++){let f=0;n.maps[u].forEach((p,m,g,x)=>{let w=x-g-(m-p);for(let v=0;v<a.length;v+=3){let _=a[v+1];if(_<0||p>_+d-f)continue;let E=a[v]+d-f;m>=E?a[v+1]=p<=E?-2:-1:p>=d&&w&&(a[v]+=w,a[v+1]+=w)}f+=w}),d=n.maps[u].map(d,-1)}let l=!1;for(let u=0;u<a.length;u+=3)if(a[u+1]<0){if(a[u+1]==-2){l=!0,a[u+1]=-1;continue}let d=n.map(t[u]+i),f=d-s;if(f<0||f>=r.content.size){l=!0;continue}let p=n.map(t[u+1]+i,-1),m=p-s,{index:g,offset:x}=r.content.findIndex(f),w=r.maybeChild(g);if(w&&x==f&&x+w.nodeSize==m){let v=a[u+2].mapInner(n,w,d+1,t[u]+i+1,o);v!=ln?(a[u]=f,a[u+1]=m,a[u+2]=v):(a[u+1]=-2,l=!0)}else l=!0}if(l){let u=z9(a,t,e,n,s,i,o),d=Jf(u,r,0,o);e=d.local;for(let f=0;f<a.length;f+=3)a[f+1]<0&&(a.splice(f,3),f-=3);for(let f=0,p=0;f<d.children.length;f+=3){let m=d.children[f];for(;p<a.length&&a[p]<m;)p+=3;a.splice(p,0,d.children[f],d.children[f+1],d.children[f+2])}}return new _t(e.sort(Do),a)}function Ij(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(new Yn(s.from+e,s.to+e,s.type))}return n}function z9(t,e,n,r,s,i,o){function a(l,u){for(let d=0;d<l.local.length;d++){let f=l.local[d].map(r,s,u);f?n.push(f):o.onRemove&&o.onRemove(l.local[d].spec)}for(let d=0;d<l.children.length;d+=3)a(l.children[d+2],l.children[d]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+i+1);return n}function Aj(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,s=null;for(let i=0,o;i<t.length;i++)(o=t[i])&&o.from>n&&o.to<r&&((s||(s=[])).push(o),t[i]=null);return s}function jj(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Jf(t,e,n,r){let s=[],i=!1;e.forEach((a,l)=>{let u=Aj(t,a,l+n);if(u){i=!0;let d=Jf(u,a,n+l+1,r);d!=ln&&s.push(l,l+a.nodeSize,d)}});let o=Ij(i?jj(t):t,-n).sort(Do);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new _t(o,s):ln}function Do(t,e){return t.from-e.from||t.to-e.to}function Yw(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let s=n+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==t&&(e=t.slice()),e[s]=i.copy(i.from,r.to),sT(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),sT(e,s,r.copy(i.from,r.to)));break}}}return e}function sT(t,e,n){for(;e<t.length&&Do(n,t[e])>0;)e++;t.splice(e,0,n)}function iy(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=ln&&e.push(r)}),t.cursorWrapper&&e.push(_t.create(t.state.doc,[t.cursorWrapper.deco])),di.from(e)}const B9={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},$9=Vn&&Di<=11;class H9{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class q9{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new H9,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Vn&&Di<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),$9&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,B9)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(JS(this.view)){if(this.suppressingSelectionUpdates)return Is(this.view);if(Vn&&Di<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Xo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let i=e.focusNode;i;i=Vu(i))n.add(i);for(let i=e.anchorNode;i;i=Vu(i))if(n.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&JS(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let d=0;d<n.length;d++){let f=this.registerMutation(n[d],l);f&&(i=i<0?f.from:Math.min(f.from,i),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(a=!0))}if(Rr&&l.length){let d=l.filter(f=>f.nodeName=="BR");if(d.length==2){let[f,p]=d;f.parentNode&&f.parentNode.parentNode==p.parentNode?p.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let p of d){let m=p.parentNode;m&&m.nodeName=="LI"&&(!f||G9(e,f)!=m)&&p.remove()}}}let u=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Rm(r)&&(u=Hw(e))&&u.eq(ve.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Is(e),this.currentSelection.set(r)):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),W9(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Is(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let d=0;d<e.addedNodes.length;d++){let f=e.addedNodes[d];n.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Vn&&Di<=11&&e.addedNodes.length)for(let d=0;d<e.addedNodes.length;d++){let{previousSibling:f,nextSibling:p}=e.addedNodes[d];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(i=p)}let o=s&&s.parentNode==e.target?Kt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?Kt(i):e.target.childNodes.length,u=r.localPosFromDOM(e.target,l,1);return{from:a,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let iT=new WeakMap,oT=!1;function W9(t){if(!iT.has(t)&&(iT.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Rr,oT)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),oT=!0}}function aT(t,e){let n=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Xo(o.node,o.offset,s,i)&&([n,r,s,i]=[s,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:s,focusOffset:i}}function K9(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return aT(t,s)}let n;function r(s){s.preventDefault(),s.stopImmediatePropagation(),n=s.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?aT(t,n):null}function G9(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function Q9(t,e,n){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),u,d=l.anchorNode;if(d&&t.dom.contains(d.nodeType==1?d:d.parentNode)&&(u=[{node:d,offset:l.anchorOffset}],Rm(l)||u.push({node:l.focusNode,offset:l.focusOffset})),hn&&t.input.lastKeyCode===8)for(let w=i;w>s;w--){let v=r.childNodes[w-1],_=v.pmViewDesc;if(v.nodeName=="BR"&&!_){i=w;break}if(!_||_.size)break}let f=t.state.doc,p=t.someProp("domParser")||Pi.fromSchema(t.state.schema),m=f.resolve(o),g=null,x=p.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:J9,context:m});if(u&&u[0].pos!=null){let w=u[0].pos,v=u[1]&&u[1].pos;v==null&&(v=w),g={anchor:w+o,head:v+o}}return{doc:x,sel:g,from:o,to:a}}function J9(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Sn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Sn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Y9=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function X9(t,e,n,r,s){let i=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let C=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,j=Hw(t,C);if(j&&!t.state.selection.eq(j)){if(hn&&bs&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",R=>R(t,ho(13,"Enter"))))return;let D=t.state.tr.setSelection(j);C=="pointer"?D.setMeta("pointer",!0):C=="key"&&D.scrollIntoView(),i&&D.setMeta("composition",i),t.dispatch(D)}return}let o=t.state.doc.resolve(e),a=o.sharedDepth(n);e=o.before(a+1),n=t.state.doc.resolve(n).after(a+1);let l=t.state.selection,u=Q9(t,e,n),d=t.state.doc,f=d.slice(u.from,u.to),p,m;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(p=t.state.selection.to,m="end"):(p=t.state.selection.from,m="start"),t.input.lastKeyCode=null;let g=t7(f.content,u.doc.content,u.from,p,m);if(g&&t.input.domChangeCount++,(El&&t.input.lastIOSEnter>Date.now()-225||bs)&&s.some(C=>C.nodeType==1&&!Y9.test(C.nodeName))&&(!g||g.endA>=g.endB)&&t.someProp("handleKeyDown",C=>C(t,ho(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!g)if(r&&l instanceof fe&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let C=lT(t,t.state.doc,u.sel);if(C&&!C.eq(t.state.selection)){let j=t.state.tr.setSelection(C);i&&j.setMeta("composition",i),t.dispatch(j)}}return}t.state.selection.from<t.state.selection.to&&g.start==g.endB&&t.state.selection instanceof fe&&(g.start>t.state.selection.from&&g.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?g.start=t.state.selection.from:g.endA<t.state.selection.to&&g.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(g.endB+=t.state.selection.to-g.endA,g.endA=t.state.selection.to)),Vn&&Di<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>u.from&&u.doc.textBetween(g.start-u.from-1,g.start-u.from+1)=="  "&&(g.start--,g.endA--,g.endB--);let x=u.doc.resolveNoCache(g.start-u.from),w=u.doc.resolveNoCache(g.endB-u.from),v=d.resolve(g.start),_=x.sameParent(w)&&x.parent.inlineContent&&v.end()>=g.endA,E;if((El&&t.input.lastIOSEnter>Date.now()-225&&(!_||s.some(C=>C.nodeName=="DIV"||C.nodeName=="P"))||!_&&x.pos<u.doc.content.size&&!x.sameParent(w)&&(E=ve.findFrom(u.doc.resolve(x.pos+1),1,!0))&&E.head==w.pos)&&t.someProp("handleKeyDown",C=>C(t,ho(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>g.start&&e7(d,g.start,g.endA,x,w)&&t.someProp("handleKeyDown",C=>C(t,ho(8,"Backspace")))){bs&&hn&&t.domObserver.suppressSelectionUpdates();return}hn&&g.endB==g.start&&(t.input.lastChromeDelete=Date.now()),bs&&!_&&x.start()!=w.start()&&w.parentOffset==0&&x.depth==w.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==g.endA&&(g.endB-=2,w=u.doc.resolveNoCache(g.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(C){return C(t,ho(13,"Enter"))})},20));let A=g.start,P=g.endA,M,N,S;if(_){if(x.pos==w.pos)Vn&&Di<=11&&x.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Is(t),20)),M=t.state.tr.delete(A,P),N=d.resolve(g.start).marksAcross(d.resolve(g.endA));else if(g.endA==g.endB&&(S=Z9(x.parent.content.cut(x.parentOffset,w.parentOffset),v.parent.content.cut(v.parentOffset,g.endA-v.start()))))M=t.state.tr,S.type=="add"?M.addMark(A,P,S.mark):M.removeMark(A,P,S.mark);else if(x.parent.child(x.index()).isText&&x.index()==w.index()-(w.textOffset?0:1)){let C=x.parent.textBetween(x.parentOffset,w.parentOffset);if(t.someProp("handleTextInput",j=>j(t,A,P,C)))return;M=t.state.tr.insertText(C,A,P)}}if(M||(M=t.state.tr.replace(A,P,u.doc.slice(g.start-u.from,g.endB-u.from))),u.sel){let C=lT(t,M.doc,u.sel);C&&!(hn&&t.composing&&C.empty&&(g.start!=g.endB||t.input.lastChromeDelete<Date.now()-100)&&(C.head==A||C.head==M.mapping.map(P)-1)||Vn&&C.empty&&C.head==A)&&M.setSelection(C)}N&&M.ensureMarks(N),i&&M.setMeta("composition",i),t.dispatch(M.scrollIntoView())}function lT(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:qw(t,e.resolve(n.anchor),e.resolve(n.head))}function Z9(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,s=n,i=r,o,a,l;for(let d=0;d<r.length;d++)s=r[d].removeFromSet(s);for(let d=0;d<n.length;d++)i=n[d].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=d=>d.mark(a.addToSet(d.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=d=>d.mark(a.removeFromSet(d.marks));else return null;let u=[];for(let d=0;d<e.childCount;d++)u.push(l(e.child(d)));if(K.from(u).eq(t))return{mark:a,type:o}}function e7(t,e,n,r,s){if(n-e<=s.pos-r.pos||oy(r,!0,!1)<s.pos)return!1;let i=t.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&n==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=t.resolve(oy(i,!0,!0));return!o.parent.isTextblock||o.pos>n||oy(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function oy(t,e,n){let r=t.depth,s=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,s++,e=!1;if(n){let i=t.node(r).maybeChild(t.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function t7(t,e,n,r,s){let i=t.findDiffStart(e,n);if(i==null)return null;let{a:o,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&t.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&cT(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<t.size&&cT(t.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function cT(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class n7{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new b9,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(pT),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=hT(this),dT(this),this.nodeViews=fT(this),this.docView=HS(this.state.doc,uT(this),iy(this),this.dom,this),this.domObserver=new q9(this,(r,s,i,o)=>X9(this,r,s,i,o)),this.domObserver.start(),_9(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&cx(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(pT),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(Tj(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=n.plugins;if(a||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let m=fT(this);s7(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(a||n.handleDOMEvents!=this._props.handleDOMEvents)&&cx(this),this.editable=hT(this),dT(this);let l=iy(this),u=uT(this),d=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(e.doc,u,l);(f||!e.selection.eq(s.selection))&&(o=!0);let p=d=="preserve"&&o&&this.dom.style.overflowAnchor==null&&O$(this);if(o){this.domObserver.stop();let m=f&&(Vn||hn)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&r7(s.selection,e.selection);if(f){let g=hn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=M9(this)),(i||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=HS(e.doc,u,l,this.dom,this)),g&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&o9(this))?Is(this,m):(fj(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():p&&L$(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof ue){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&VS(this,n.getBoundingClientRect(),e)}else VS(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-n.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new Nj(e.slice,e.move,s<0?void 0:ue.create(this.state.doc,s))}someProp(e,n){let r=this._props&&this._props[e],s;if(r!=null&&(s=n?n(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=n?n(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=n?n(a):a))return s}}hasFocus(){if(Vn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&V$(this.dom),Is(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return $$(this,e)}coordsAtPos(e,n=1){return ij(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let s=this.docView.posFromDOM(e,n,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,n){return G$(this,n||this.state,e)}pasteHTML(e,n){return Uu(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Uu(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return Ww(this,e)}destroy(){this.docView&&(E9(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],iy(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,T$())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return T9(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Sn&&this.root.nodeType===11&&A$(this.dom.ownerDocument)==this.dom&&K9(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function uT(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[Yn.node(0,t.state.doc.content.size,e)]}function dT(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Yn.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function hT(t){return!t.someProp("editable",e=>e(t.state)===!1)}function r7(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function fT(t){let e=Object.create(null);function n(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function s7(t,e){let n=0,r=0;for(let s in t){if(t[s]!=e[s])return!0;n++}for(let s in e)r++;return n!=r}function pT(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Hi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Yf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},i7=typeof navigator<"u"&&/Mac/.test(navigator.platform),o7=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Gt=0;Gt<10;Gt++)Hi[48+Gt]=Hi[96+Gt]=String(Gt);for(var Gt=1;Gt<=24;Gt++)Hi[Gt+111]="F"+Gt;for(var Gt=65;Gt<=90;Gt++)Hi[Gt]=String.fromCharCode(Gt+32),Yf[Gt]=String.fromCharCode(Gt);for(var ay in Hi)Yf.hasOwnProperty(ay)||(Yf[ay]=Hi[ay]);function a7(t){var e=i7&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||o7&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Yf:Hi)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const l7=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function c7(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))l7?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function u7(t){let e=Object.create(null);for(let n in t)e[c7(n)]=t[n];return e}function ly(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function d7(t){return new Ft({props:{handleKeyDown:Rj(t)}})}function Rj(t){let e=u7(t);return function(n,r){let s=a7(r),i,o=e[ly(s,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[ly(s,r,!1)];if(a&&a(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||s.charCodeAt(0)>127)&&(i=Hi[r.keyCode])&&i!=s){let a=e[ly(i,r)];if(a&&a(n.state,n.dispatch,n))return!0}}return!1}}const Xw=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Pj(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Dj=(t,e,n)=>{let r=Pj(t,n);if(!r)return!1;let s=Zw(r);if(!s){let o=r.blockRange(),a=o&&Ul(o);return a==null?!1:(e&&e(t.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if($j(t,s,e,-1))return!0;if(r.parent.content.size==0&&(Sl(i,"end")||ue.isSelectable(i)))for(let o=r.depth;;o--){let a=Am(t.doc,r.before(o),r.after(o),ee.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=t.tr.step(a);l.setSelection(Sl(i,"end")?ve.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):ue.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},h7=(t,e,n)=>{let r=Pj(t,n);if(!r)return!1;let s=Zw(r);return s?Mj(t,s,e):!1},f7=(t,e,n)=>{let r=Lj(t,n);if(!r)return!1;let s=eb(r);return s?Mj(t,s,e):!1};function Mj(t,e,n){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let d=s.lastChild;if(!d)return!1;s=d}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let d=a.firstChild;if(!d)return!1;a=d}let u=Am(t.doc,i,l,ee.empty);if(!u||u.from!=i||u instanceof Pt&&u.slice.size>=l-i)return!1;if(n){let d=t.tr.step(u);d.setSelection(fe.create(d.doc,i)),n(d.scrollIntoView())}return!0}function Sl(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const Oj=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;i=Zw(r)}let o=i&&i.nodeBefore;return!o||!ue.isSelectable(o)?!1:(e&&e(t.tr.setSelection(ue.create(t.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function Zw(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Lj(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const Vj=(t,e,n)=>{let r=Lj(t,n);if(!r)return!1;let s=eb(r);if(!s)return!1;let i=s.nodeAfter;if($j(t,s,e,1))return!0;if(r.parent.content.size==0&&(Sl(i,"start")||ue.isSelectable(i))){let o=Am(t.doc,r.before(),r.after(),ee.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=t.tr.step(o);a.setSelection(Sl(i,"start")?ve.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):ue.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(t.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},Fj=(t,e,n)=>{let{$head:r,empty:s}=t.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;i=eb(r)}let o=i&&i.nodeAfter;return!o||!ue.isSelectable(o)?!1:(e&&e(t.tr.setSelection(ue.create(t.doc,i.pos)).scrollIntoView()),!0)};function eb(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const p7=(t,e)=>{let n=t.selection,r=n instanceof ue,s;if(r){if(n.node.isTextblock||!eo(t.doc,n.from))return!1;s=n.from}else if(s=Im(t.doc,n.from,-1),s==null)return!1;if(e){let i=t.tr.join(s);r&&i.setSelection(ue.create(i.doc,s-t.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},m7=(t,e)=>{let n=t.selection,r;if(n instanceof ue){if(n.node.isTextblock||!eo(t.doc,n.to))return!1;r=n.to}else if(r=Im(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},g7=(t,e)=>{let{$from:n,$to:r}=t.selection,s=n.blockRange(r),i=s&&Ul(s);return i==null?!1:(e&&e(t.tr.lift(s,i).scrollIntoView()),!0)},Uj=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function tb(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const y7=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let s=n.node(-1),i=n.indexAfter(-1),o=tb(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,o.createAndFill());l.setSelection(ve.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},zj=(t,e)=>{let n=t.selection,{$from:r,$to:s}=n;if(n instanceof Zn||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=tb(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=t.tr.insert(o,i.createAndFill());a.setSelection(fe.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},Bj=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(Cs(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let r=n.blockRange(),s=r&&Ul(r);return s==null?!1:(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)};function x7(t){return(e,n)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof ue&&e.selection.node.isBlock)return!r.parentOffset||!Cs(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,u=!1;for(let m=r.depth;;m--)if(r.node(m).isBlock){l=r.end(m)==r.pos+(r.depth-m),u=r.start(m)==r.pos-(r.depth-m),a=tb(r.node(m-1).contentMatchAt(r.indexAfter(m-1))),i.unshift(l&&a?{type:a}:null),o=m;break}else{if(m==1)return!1;i.unshift(null)}let d=e.tr;(e.selection instanceof fe||e.selection instanceof Zn)&&d.deleteSelection();let f=d.mapping.map(r.pos),p=Cs(d.doc,f,i.length,i);if(p||(i[0]=a?{type:a}:null,p=Cs(d.doc,f,i.length,i)),d.split(f,i.length,i),!l&&u&&r.node(o).type!=a){let m=d.mapping.map(r.before(o)),g=d.doc.resolve(m);a&&r.node(o-1).canReplaceWith(g.index(),g.index()+1,a)&&d.setNodeMarkup(d.mapping.map(r.before(o)),a)}return n&&n(d.scrollIntoView()),!0}}const v7=x7(),w7=(t,e)=>{let{$from:n,to:r}=t.selection,s,i=n.sharedDepth(r);return i==0?!1:(s=n.before(i),e&&e(t.tr.setSelection(ue.create(t.doc,s))),!0)};function b7(t,e,n){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||eo(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function $j(t,e,n,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&b7(t,e,n))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(n){let m=e.pos+i.nodeSize,g=K.empty;for(let v=o.length-1;v>=0;v--)g=K.from(o[v].create(null,g));g=K.from(s.copy(g));let x=t.tr.step(new Mt(e.pos-1,m,e.pos,m,new ee(g,1,0),o.length,!0)),w=x.doc.resolve(m+2*o.length);w.nodeAfter&&w.nodeAfter.type==s.type&&eo(x.doc,w.pos)&&x.join(w.pos),n(x.scrollIntoView())}return!0}let d=i.type.spec.isolating||r>0&&l?null:ve.findFrom(e,1),f=d&&d.$from.blockRange(d.$to),p=f&&Ul(f);if(p!=null&&p>=e.depth)return n&&n(t.tr.lift(f,p).scrollIntoView()),!0;if(u&&Sl(i,"start",!0)&&Sl(s,"end")){let m=s,g=[];for(;g.push(m),!m.isTextblock;)m=m.lastChild;let x=i,w=1;for(;!x.isTextblock;x=x.firstChild)w++;if(m.canReplace(m.childCount,m.childCount,x.content)){if(n){let v=K.empty;for(let E=g.length-1;E>=0;E--)v=K.from(g[E].copy(v));let _=t.tr.step(new Mt(e.pos-g.length,e.pos+i.nodeSize,e.pos+w,e.pos+i.nodeSize-w,new ee(v,g.length,0),0,!0));n(_.scrollIntoView())}return!0}}return!1}function Hj(t){return function(e,n){let r=e.selection,s=t<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(n&&n(e.tr.setSelection(fe.create(e.doc,t<0?s.start(i):s.end(i)))),!0):!1}}const _7=Hj(-1),E7=Hj(1);function S7(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i),a=o&&zw(o,t,e);return a?(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0):!1}}function mT(t,e=null){return function(n,r){let s=!1;for(let i=0;i<n.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=n.selection.ranges[i];n.doc.nodesBetween(o,a,(l,u)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)s=!0;else{let d=n.doc.resolve(u),f=d.index();s=d.parent.canReplaceWith(f,f+1,t)}})}if(!s)return!1;if(r){let i=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=n.selection.ranges[o];i.setBlockType(a,l,t,e)}r(i.scrollIntoView())}return!0}}function nb(...t){return function(e,n,r){for(let s=0;s<t.length;s++)if(t[s](e,n,r))return!0;return!1}}nb(Xw,Dj,Oj);nb(Xw,Vj,Fj);nb(Uj,zj,Bj,v7);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function T7(t,e=null){return function(n,r){let{$from:s,$to:i}=n.selection,o=s.blockRange(i);if(!o)return!1;let a=r?n.tr:null;return k7(a,o,t,e)?(r&&r(a.scrollIntoView()),!0):!1}}function k7(t,e,n,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new Hf(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Hf(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let a=zw(i,n,r,e);return a?(t&&N7(t,e,a,s,n),!0):!1}function N7(t,e,n,r,s){let i=K.empty;for(let d=n.length-1;d>=0;d--)i=K.from(n[d].type.create(n[d].attrs,i));t.step(new Mt(e.start-(r?2:0),e.end,e.start,e.end,new ee(i,0,0),n.length,!0));let o=0;for(let d=0;d<n.length;d++)n[d].type==s&&(o=d+1);let a=n.length-o,l=e.start+n.length-(r?2:0),u=e.parent;for(let d=e.startIndex,f=e.endIndex,p=!0;d<f;d++,p=!1)!p&&Cs(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=u.child(d).nodeSize;return t}function C7(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==t);return i?n?r.node(i.depth-1).type==t?I7(e,n,t,i):A7(e,n,i):!0:!1}}function I7(t,e,n,r){let s=t.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new Mt(i-1,o,i,o,new ee(K.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Hf(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=Ul(r);if(a==null)return!1;s.lift(r,a);let l=s.mapping.map(i,-1)-1;return eo(s.doc,l)&&s.join(l),e(s.scrollIntoView()),!0}function A7(t,e,n){let r=t.tr,s=n.parent;for(let m=n.end,g=n.endIndex-1,x=n.startIndex;g>x;g--)m-=s.child(g).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(n.start),o=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==s.childCount,u=i.node(-1),d=i.index(-1);if(!u.canReplace(d+(a?0:1),d+1,o.content.append(l?K.empty:K.from(s))))return!1;let f=i.pos,p=f+o.nodeSize;return r.step(new Mt(f-(a?1:0),p+(l?1:0),f+1,p-1,new ee((a?K.empty:K.from(s.copy(K.empty))).append(l?K.empty:K.from(s.copy(K.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function j7(t){return function(e,n){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,u=>u.childCount>0&&u.firstChild.type==t);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=t)return!1;if(n){let u=l.lastChild&&l.lastChild.type==a.type,d=K.from(u?t.create():null),f=new ee(K.from(t.create(null,K.from(a.type.create(null,d)))),u?3:1,0),p=i.start,m=i.end;n(e.tr.step(new Mt(p-(u?3:1),m,p,m,f,1,!0)).scrollIntoView())}return!0}}function Mm(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:i}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,i=n.storedMarks,n}}}class Om{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:s}=n,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...d)=>{const f=l(...d)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,u=e||i.tr,d=()=>(!l&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),a.every(p=>p===!0)),f={...Object.fromEntries(Object.entries(r).map(([p,m])=>[p,(...x)=>{const w=this.buildProps(u,n),v=m(...x)(w);return a.push(v),f}])),run:d};return f}createCan(e){const{rawCommands:n,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...d)=>u(...d)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,n=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:Mm({state:i,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,u])=>[l,(...d)=>u(...d)(a)]))}};return a}}class R7{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(s=>s!==n):delete this.callbacks[e]),this}once(e,n){const r=(...s)=>{this.off(e,r),n.apply(this,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function se(t,e,n){return t.config[e]===void 0&&t.parent?se(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?se(t.parent,e,n):null}):t.config[e]}function Lm(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function qj(t){const e=[],{nodeExtensions:n,markExtensions:r}=Lm(t),s=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=se(o,"addGlobalAttributes",a);if(!l)return;l().forEach(d=>{d.types.forEach(f=>{Object.entries(d.attributes).forEach(([p,m])=>{e.push({type:f,name:p,attribute:{...i,...m}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=se(o,"addAttributes",a);if(!l)return;const u=l();Object.entries(u).forEach(([d,f])=>{const p={...i,...f};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:o.name,name:d,attribute:p})})}),e}function Lt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function kt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],u=a.filter(d=>!l.includes(d));r[s]=[...l,...u].join(" ")}else if(s==="style"){const a=i?i.split(";").map(d=>d.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(d=>d.trim()).filter(Boolean):[],u=new Map;l.forEach(d=>{const[f,p]=d.split(":").map(m=>m.trim());u.set(f,p)}),a.forEach(d=>{const[f,p]=d.split(":").map(m=>m.trim());u.set(f,p)}),r[s]=Array.from(u.entries()).map(([d,f])=>`${d}: ${f}`).join("; ")}else r[s]=i}),r},{})}function ux(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>kt(n,r),{})}function Wj(t){return typeof t=="function"}function _e(t,e=void 0,...n){return Wj(t)?e?t.bind(e)(...n):t(...n):t}function P7(t={}){return Object.keys(t).length===0&&t.constructor===Object}function D7(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function gT(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):D7(n.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function yT(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&P7(n)?!1:n!=null))}function M7(t,e){var n;const r=qj(t),{nodeExtensions:s,markExtensions:i}=Lm(t),o=(n=s.find(u=>se(u,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(s.map(u=>{const d=r.filter(v=>v.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},p=t.reduce((v,_)=>{const E=se(_,"extendNodeSchema",f);return{...v,...E?E(u):{}}},{}),m=yT({...p,content:_e(se(u,"content",f)),marks:_e(se(u,"marks",f)),group:_e(se(u,"group",f)),inline:_e(se(u,"inline",f)),atom:_e(se(u,"atom",f)),selectable:_e(se(u,"selectable",f)),draggable:_e(se(u,"draggable",f)),code:_e(se(u,"code",f)),whitespace:_e(se(u,"whitespace",f)),linebreakReplacement:_e(se(u,"linebreakReplacement",f)),defining:_e(se(u,"defining",f)),isolating:_e(se(u,"isolating",f)),attrs:Object.fromEntries(d.map(v=>{var _;return[v.name,{default:(_=v==null?void 0:v.attribute)===null||_===void 0?void 0:_.default}]}))}),g=_e(se(u,"parseHTML",f));g&&(m.parseDOM=g.map(v=>gT(v,d)));const x=se(u,"renderHTML",f);x&&(m.toDOM=v=>x({node:v,HTMLAttributes:ux(v,d)}));const w=se(u,"renderText",f);return w&&(m.toText=w),[u.name,m]})),l=Object.fromEntries(i.map(u=>{const d=r.filter(w=>w.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},p=t.reduce((w,v)=>{const _=se(v,"extendMarkSchema",f);return{...w,..._?_(u):{}}},{}),m=yT({...p,inclusive:_e(se(u,"inclusive",f)),excludes:_e(se(u,"excludes",f)),group:_e(se(u,"group",f)),spanning:_e(se(u,"spanning",f)),code:_e(se(u,"code",f)),attrs:Object.fromEntries(d.map(w=>{var v;return[w.name,{default:(v=w==null?void 0:w.attribute)===null||v===void 0?void 0:v.default}]}))}),g=_e(se(u,"parseHTML",f));g&&(m.parseDOM=g.map(w=>gT(w,d)));const x=se(u,"renderHTML",f);return x&&(m.toDOM=w=>x({mark:w,HTMLAttributes:ux(w,d)})),[u.name,m]}));return new DA({topNode:o,nodes:a,marks:l})}function cy(t,e){return e.nodes[t]||e.marks[t]||null}function xT(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function rb(t,e){const n=ca.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}const O7=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,u;const d=((u=(l=s.type.spec).toText)===null||u===void 0?void 0:u.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?d:d.slice(0,Math.max(0,r-i))}),n};function sb(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Vm{constructor(e){this.find=e.find,this.handler=e.handler}}const L7=(t,e)=>{if(sb(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function oh(t){var e;const{editor:n,from:r,to:s,text:i,rules:o,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const u=l.state.doc.resolve(r);if(u.parent.type.spec.code||!((e=u.nodeBefore||u.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let d=!1;const f=O7(u)+i;return o.forEach(p=>{if(d)return;const m=L7(f,p.find);if(!m)return;const g=l.state.tr,x=Mm({state:l.state,transaction:g}),w={from:r-(m[0].length-i.length),to:s},{commands:v,chain:_,can:E}=new Om({editor:n,state:x});p.handler({state:x,range:w,match:m,commands:v,chain:_,can:E})===null||!g.steps.length||(g.setMeta(a,{transform:g,from:r,to:s,text:i}),l.dispatch(g),d=!0)}),d}function V7(t){const{editor:e,rules:n}=t,r=new Ft({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=rb(K.from(d),o.schema);const{from:f}=l,p=f+d.length;oh({editor:e,from:f,to:p,text:d,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return oh({editor:e,from:i,to:o,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&oh({editor:e,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?oh({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function F7(t){return Object.prototype.toString.call(t).slice(8,-1)}function ah(t){return F7(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Fm(t,e){const n={...t};return ah(t)&&ah(e)&&Object.keys(e).forEach(r=>{ah(e[r])&&ah(t[r])?n[r]=Fm(t[r],e[r]):n[r]=e[r]}),n}class Pr{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_e(se(this,"addOptions",{name:this.name}))),this.storage=_e(se(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Pr(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Fm(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Pr(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=_e(se(n,"addOptions",{name:n.name})),n.storage=_e(se(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const l=o.find(u=>(u==null?void 0:u.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}function U7(t){return typeof t=="number"}class z7{constructor(e){this.find=e.find,this.handler=e.handler}}const B7=(t,e,n)=>{if(sb(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=t,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function $7(t){const{editor:e,state:n,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=t,{commands:l,chain:u,can:d}=new Om({editor:e,state:n}),f=[];return n.doc.nodesBetween(r,s,(m,g)=>{if(!m.isTextblock||m.type.spec.code)return;const x=Math.max(r,g),w=Math.min(s,g+m.content.size),v=m.textBetween(x-g,w-g,void 0,"￼");B7(v,i.find,o).forEach(E=>{if(E.index===void 0)return;const A=x+E.index+1,P=A+E[0].length,M={from:n.tr.mapping.map(A),to:n.tr.mapping.map(P)},N=i.handler({state:n,range:M,match:E,commands:l,chain:u,can:d,pasteEvent:o,dropEvent:a});f.push(N)})}),f.every(m=>m!==null)}let lh=null;const H7=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function q7(t){const{editor:e,rules:n}=t;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:d,from:f,to:p,rule:m,pasteEvt:g})=>{const x=d.tr,w=Mm({state:d,transaction:x});if(!(!$7({editor:e,state:w,from:Math.max(f-1,0),to:p.b-1,rule:m,pasteEvent:g,dropEvent:a})||!x.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,x}};return n.map(d=>new Ft({view(f){const p=g=>{var x;r=!((x=f.dom.parentElement)===null||x===void 0)&&x.contains(g.target)?f.dom.parentElement:null,r&&(lh=e)},m=()=>{lh&&(lh=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(f,p)=>{if(i=r===f.dom.parentElement,a=p,!i){const m=lh;m&&setTimeout(()=>{const g=m.state.selection;g&&m.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(f,p)=>{var m;const g=(m=p.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return o=p,s=!!(g!=null&&g.includes("data-pm-slice")),!1}}},appendTransaction:(f,p,m)=>{const g=f[0],x=g.getMeta("uiEvent")==="paste"&&!s,w=g.getMeta("uiEvent")==="drop"&&!i,v=g.getMeta("applyPasteRules"),_=!!v;if(!x&&!w&&!_)return;if(_){let{text:P}=v;typeof P=="string"?P=P:P=rb(K.from(P),m.schema);const{from:M}=v,N=M+P.length,S=H7(P);return l({rule:d,state:m,from:M,to:{b:N},pasteEvt:S})}const E=p.doc.content.findDiffStart(m.doc.content),A=p.doc.content.findDiffEnd(m.doc.content);if(!(!U7(E)||!A||E===A.b))return l({rule:d,state:m,from:E,to:A,pasteEvt:o})}}))}function W7(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class Ua{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=Ua.resolve(e),this.schema=M7(this.extensions,n),this.setupExtensions()}static resolve(e){const n=Ua.sort(Ua.flatten(e)),r=W7(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=se(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=se(r,"priority")||100,o=se(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:cy(n.name,this.schema)},s=se(n,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,n=Ua.sort([...this.extensions].reverse()),r=[],s=[],i=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:cy(o.name,this.schema)},l=[],u=se(o,"addKeyboardShortcuts",a);let d={};if(o.type==="mark"&&se(o,"exitable",a)&&(d.ArrowRight=()=>Pr.handleExit({editor:e,mark:o})),u){const x=Object.fromEntries(Object.entries(u()).map(([w,v])=>[w,()=>v({editor:e})]));d={...d,...x}}const f=d7(d);l.push(f);const p=se(o,"addInputRules",a);xT(o,e.options.enableInputRules)&&p&&r.push(...p());const m=se(o,"addPasteRules",a);xT(o,e.options.enablePasteRules)&&m&&s.push(...m());const g=se(o,"addProseMirrorPlugins",a);if(g){const x=g();l.push(...x)}return l}).flat();return[V7({editor:e,rules:r}),...q7({editor:e,rules:s}),...i]}get attributes(){return qj(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Lm(this.extensions);return Object.fromEntries(n.filter(r=>!!se(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:Lt(r.name,this.schema)},o=se(r,"addNodeView",i);if(!o)return[];const a=(l,u,d,f,p)=>{const m=ux(l,s);return o()({node:l,view:u,getPos:d,decorations:f,innerDecorations:p,editor:e,extension:r,HTMLAttributes:m})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:cy(e.name,this.schema)};e.type==="mark"&&(!((n=_e(se(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const s=se(e,"onBeforeCreate",r),i=se(e,"onCreate",r),o=se(e,"onUpdate",r),a=se(e,"onSelectionUpdate",r),l=se(e,"onTransaction",r),u=se(e,"onFocus",r),d=se(e,"onBlur",r),f=se(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),d&&this.editor.on("blur",d),f&&this.editor.on("destroy",f)})}}class At{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_e(se(this,"addOptions",{name:this.name}))),this.storage=_e(se(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new At(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Fm(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new At({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=_e(se(n,"addOptions",{name:n.name})),n.storage=_e(se(n,"addStorage",{name:n.name,options:n.options})),n}}function Kj(t,e,n){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let a="";return t.nodesBetween(r,s,(l,u,d,f)=>{var p;l.isBlock&&u>r&&(a+=i);const m=o==null?void 0:o[l.type.name];if(m)return d&&(a+=m({node:l,pos:u,parent:d,index:f,range:e})),!1;l.isText&&(a+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(r,u)-u,s-u))}),a}function Gj(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const K7=At.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ft({key:new Fn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(d=>d.$from.pos)),a=Math.max(...i.map(d=>d.$to.pos)),l=Gj(n);return Kj(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),G7=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Q7=(t=!1)=>({commands:e})=>e.setContent("",t),J7=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:i,$to:o})=>{t.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:u,mapping:d}=e,f=u.resolve(d.map(l)),p=u.resolve(d.map(l+a.nodeSize)),m=f.blockRange(p);if(!m)return;const g=Ul(m);if(a.type.isTextblock){const{defaultType:x}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(m.start,x)}(g||g===0)&&e.lift(m,g)})}),!0},Y7=t=>e=>t(e),X7=()=>({state:t,dispatch:e})=>zj(t,e),Z7=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new fe(r.doc.resolve(o-1))),!0},e8=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);t.delete(a,l).scrollIntoView()}return!0}return!1},t8=t=>({tr:e,state:n,dispatch:r})=>{const s=Lt(t,n.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),u=i.after(o);e.delete(l,u).scrollIntoView()}return!0}return!1},n8=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},r8=()=>({state:t,dispatch:e})=>Xw(t,e),s8=()=>({commands:t})=>t.keyboardShortcut("Enter"),i8=()=>({state:t,dispatch:e})=>y7(t,e);function Xf(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:sb(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function Qj(t,e,n={}){return t.find(r=>r.type===e&&Xf(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function vT(t,e,n={}){return!!Qj(t,e,n)}function ib(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(d=>d.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(d=>d.type===e)||(n=n||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!Qj([...s.node.marks],e,n)))return;let o=s.index,a=t.start()+s.offset,l=o+1,u=a+s.node.nodeSize;for(;o>0&&vT([...t.parent.child(o-1).marks],e,n);)o-=1,a-=t.parent.child(o).nodeSize;for(;l<t.parent.childCount&&vT([...t.parent.child(l).marks],e,n);)u+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:u}}function no(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const o8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const i=no(t,r.schema),{doc:o,selection:a}=n,{$from:l,from:u,to:d}=a;if(s){const f=ib(l,i,e);if(f&&f.from<=u&&f.to>=d){const p=fe.create(o,f.from,f.to);n.setSelection(p)}}return!0},a8=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function Jj(t){return t instanceof fe}function Eo(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Yj(t,e=null){if(!e)return null;const n=ve.atStart(t),r=ve.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,i=r.to;return e==="all"?fe.create(t,Eo(0,s,i),Eo(t.content.size,s,i)):fe.create(t,Eo(e,s,i),Eo(e,s,i))}function l8(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function ob(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const c8=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(ob()||l8())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(i&&t===null&&!Jj(n.state.selection))return o(),!0;const a=Yj(s.doc,t)||n.state.selection,l=n.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},u8=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),d8=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Xj=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&Xj(r)}return t};function ch(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Xj(n)}function Zf(t,e,n){if(t instanceof Ri||t instanceof K)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return K.fromArray(t.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),Zf("",e,n)}if(s){if(n.errorOnInvalidContent){let o=!1,a="";const l=new DA({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,a=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?Pi.fromSchema(l).parseSlice(ch(t),n.parseOptions):Pi.fromSchema(l).parse(ch(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=Pi.fromSchema(e);return n.slice?i.parseSlice(ch(t),n.parseOptions).content:i.parse(ch(t),n.parseOptions)}return Zf("",e,n)}function h8(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof Pt||s instanceof Mt))return;const i=t.mapping.maps[r];let o=0;i.forEach((a,l,u,d)=>{o===0&&(o=d)}),t.setSelection(ve.near(t.doc.resolve(o),n))}const f8=t=>!("type"in t),p8=(t,e,n)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=Zf(e,i.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(g){return i.emit("contentError",{editor:i,error:g,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:u}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},d=!0,f=!0;if((f8(a)?a:[a]).forEach(g=>{g.check(),d=d?g.isText&&g.marks.length===0:!1,f=f?g.isBlock:!1}),l===u&&f){const{parent:g}=r.doc.resolve(l);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(l-=1,u+=1)}let m;if(d){if(Array.isArray(e))m=e.map(g=>g.text||"").join("");else if(e instanceof K){let g="";e.forEach(x=>{x.text&&(g+=x.text)}),m=g}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,l,u)}else m=a,r.replaceWith(l,u,m);n.updateSelection&&h8(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:m}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:m})}return!0},m8=()=>({state:t,dispatch:e})=>p7(t,e),g8=()=>({state:t,dispatch:e})=>m7(t,e),y8=()=>({state:t,dispatch:e})=>Dj(t,e),x8=()=>({state:t,dispatch:e})=>Vj(t,e),v8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Im(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},w8=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Im(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},b8=()=>({state:t,dispatch:e})=>h7(t,e),_8=()=>({state:t,dispatch:e})=>f7(t,e);function Zj(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function E8(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))ob()||Zj()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}const S8=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const i=E8(t).split(/-(?!$)/),o=i.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,a))});return l==null||l.steps.forEach(u=>{const d=u.map(r.mapping);d&&s&&r.maybeStep(d)}),!0};function Bu(t,e,n={}){const{from:r,to:s,empty:i}=t.selection,o=e?Lt(e,t.schema):null,a=[];t.doc.nodesBetween(r,s,(f,p)=>{if(f.isText)return;const m=Math.max(r,p),g=Math.min(s,p+f.nodeSize);a.push({node:f,from:m,to:g})});const l=s-r,u=a.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>Xf(f.node.attrs,n,{strict:!1}));return i?!!u.length:u.reduce((f,p)=>f+p.to-p.from,0)>=l}const T8=(t,e={})=>({state:n,dispatch:r})=>{const s=Lt(t,n.schema);return Bu(n,s,e)?g7(n,r):!1},k8=()=>({state:t,dispatch:e})=>Bj(t,e),N8=t=>({state:e,dispatch:n})=>{const r=Lt(t,e.schema);return C7(r)(e,n)},C8=()=>({state:t,dispatch:e})=>Uj(t,e);function Um(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function wT(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}const I8=(t,e)=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const a=Um(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(i=Lt(t,r.schema)),a==="mark"&&(o=no(t,r.schema)),s&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(u,d)=>{i&&i===u.type&&n.setNodeMarkup(d,void 0,wT(u.attrs,e)),o&&u.marks.length&&u.marks.forEach(f=>{o===f.type&&n.addMark(d,d+u.nodeSize,o.create(wT(f.attrs,e)))})})}),!0):!1},A8=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),j8=()=>({tr:t,dispatch:e})=>{if(e){const n=new Zn(t.doc);t.setSelection(n)}return!0},R8=()=>({state:t,dispatch:e})=>Oj(t,e),P8=()=>({state:t,dispatch:e})=>Fj(t,e),D8=()=>({state:t,dispatch:e})=>w7(t,e),M8=()=>({state:t,dispatch:e})=>E7(t,e),O8=()=>({state:t,dispatch:e})=>_7(t,e);function dx(t,e,n={},r={}){return Zf(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const L8=(t,e=!1,n={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,u;const{doc:d}=i;if(n.preserveWhitespace!=="full"){const f=dx(t,s.schema,n,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return o&&i.replaceWith(0,d.content.size,f).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:d.content.size},t,{parseOptions:n,errorOnInvalidContent:(u=r.errorOnInvalidContent)!==null&&u!==void 0?u:s.options.enableContentCheck})};function eR(t,e){const n=no(e,t.schema),{from:r,to:s,empty:i}=t.selection,o=[];i?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function V8(t,e){const n=new JA(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function F8(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function U8(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,i)=>{n(s)&&r.push({node:s,pos:i})}),r}function z8(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function ab(t){return e=>z8(e.$from,t)}function B8(t,e){const n={from:0,to:t.content.size};return Kj(t,n,e)}function $8(t,e){const n=Lt(e,t.schema),{from:r,to:s}=t.selection,i=[];t.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}function tR(t,e){const n=Um(typeof e=="string"?e:e.name,t.schema);return n==="node"?$8(t,e):n==="mark"?eR(t,e):{}}function H8(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function q8(t){const e=H8(t);return e.length===1?e:e.filter((n,r)=>!e.filter((i,o)=>o!==r).some(i=>n.oldRange.from>=i.oldRange.from&&n.oldRange.to<=i.oldRange.to&&n.newRange.from>=i.newRange.from&&n.newRange.to<=i.newRange.to))}function W8(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=n[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const u=e.slice(i).map(a,-1),d=e.slice(i).map(l),f=e.invert().map(u,-1),p=e.invert().map(d);r.push({oldRange:{from:f,to:p},newRange:{from:u,to:d}})})}),q8(r)}function lb(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const i=n.resolve(t),o=ib(i,s.type);o&&r.push({mark:s,...o})}):n.nodesBetween(t,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function Bh(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function hx(t,e,n={}){const{empty:r,ranges:s}=t.selection,i=e?no(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>i?i.name===f.type.name:!0).find(f=>Xf(f.attrs,n,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:f,$to:p})=>{const m=f.pos,g=p.pos;t.doc.nodesBetween(m,g,(x,w)=>{if(!x.isText&&!x.marks.length)return;const v=Math.max(m,w),_=Math.min(g,w+x.nodeSize),E=_-v;o+=E,a.push(...x.marks.map(A=>({mark:A,from:v,to:_})))})}),o===0)return!1;const l=a.filter(f=>i?i.name===f.mark.type.name:!0).filter(f=>Xf(f.mark.attrs,n,{strict:!1})).reduce((f,p)=>f+p.to-p.from,0),u=a.filter(f=>i?f.mark.type!==i&&f.mark.type.excludes(i):!0).reduce((f,p)=>f+p.to-p.from,0);return(l>0?l+u:l)>=o}function K8(t,e,n={}){if(!e)return Bu(t,null,n)||hx(t,null,n);const r=Um(e,t.schema);return r==="node"?Bu(t,e,n):r==="mark"?hx(t,e,n):!1}function bT(t,e){const{nodeExtensions:n}=Lm(e),r=n.find(o=>o.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=_e(se(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function zm(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(i=>{s!==!1&&(zm(i,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function G8(t){return t instanceof ue}function Q8(t,e,n){var r;const{selection:s}=e;let i=null;if(Jj(s)&&(i=s.$cursor),i){const a=(r=t.storedMarks)!==null&&r!==void 0?r:i.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let u=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(d,f,p)=>{if(u)return!1;if(d.isInline){const m=!p||p.type.allowsMarkType(n),g=!!n.isInSet(d.marks)||!d.marks.some(x=>x.type.excludes(n));u=m&&g}return!u}),u})}const J8=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:i}=n,{empty:o,ranges:a}=i,l=no(t,r.schema);if(s)if(o){const u=eR(r,l);n.addStoredMark(l.create({...u,...e}))}else a.forEach(u=>{const d=u.$from.pos,f=u.$to.pos;r.doc.nodesBetween(d,f,(p,m)=>{const g=Math.max(m,d),x=Math.min(m+p.nodeSize,f);p.marks.find(v=>v.type===l)?p.marks.forEach(v=>{l===v.type&&n.addMark(g,x,l.create({...v.attrs,...e}))}):n.addMark(g,x,l.create(e))})});return Q8(r,n,l)},Y8=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),X8=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const i=Lt(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>mT(i,{...o,...e})(n)?!0:a.clearNodes()).command(({state:a})=>mT(i,{...o,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Z8=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=Eo(t,0,r.content.size),i=ue.create(r,s);e.setSelection(i)}return!0},eH=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:i}=typeof t=="number"?{from:t,to:t}:t,o=fe.atStart(r).from,a=fe.atEnd(r).to,l=Eo(s,o,a),u=Eo(i,o,a),d=fe.create(r,l,u);e.setSelection(d)}return!0},tH=t=>({state:e,dispatch:n})=>{const r=Lt(t,e.schema);return j7(r)(e,n)};function _T(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e==null?void 0:e.includes(s.type.name));t.tr.ensureMarks(r)}}const nH=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,u=s.extensionManager.attributes,d=Bh(u,a.node().type.name,a.node().attrs);if(i instanceof ue&&i.node.isBlock)return!a.parentOffset||!Cs(o,a.pos)?!1:(r&&(t&&_T(n,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:F8(a.node(-1).contentMatchAt(a.indexAfter(-1)));let m=f&&p?[{type:p,attrs:d}]:void 0,g=Cs(e.doc,e.mapping.map(a.pos),1,m);if(!m&&!g&&Cs(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(g=!0,m=p?[{type:p,attrs:d}]:void 0),r){if(g&&(i instanceof fe&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,m),p&&!f&&!a.parentOffset&&a.parent.type!==p)){const x=e.mapping.map(a.before()),w=e.doc.resolve(x);a.node(-1).canReplaceWith(w.index(),w.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}t&&_T(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return g},rH=(t,e={})=>({tr:n,state:r,dispatch:s,editor:i})=>{var o;const a=Lt(t,r.schema),{$from:l,$to:u}=r.selection,d=r.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(u))return!1;const f=l.node(-1);if(f.type!==a)return!1;const p=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let v=K.empty;const _=l.index(-1)?1:l.index(-2)?2:3;for(let S=l.depth-_;S>=l.depth-3;S-=1)v=K.from(l.node(S).copy(v));const E=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,A={...Bh(p,l.node().type.name,l.node().attrs),...e},P=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(A))||void 0;v=v.append(K.from(a.createAndFill(null,P)||void 0));const M=l.before(l.depth-(_-1));n.replace(M,l.after(-E),new ee(v,4-_,0));let N=-1;n.doc.nodesBetween(M,n.doc.content.size,(S,C)=>{if(N>-1)return!1;S.isTextblock&&S.content.size===0&&(N=C+1)}),N>-1&&n.setSelection(fe.near(n.doc.resolve(N))),n.scrollIntoView()}return!0}const m=u.pos===l.end()?f.contentMatchAt(0).defaultType:null,g={...Bh(p,f.type.name,f.attrs),...e},x={...Bh(p,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,u.pos);const w=m?[{type:a,attrs:g},{type:m,attrs:x}]:[{type:a,attrs:g}];if(!Cs(n.doc,l.pos,2))return!1;if(s){const{selection:v,storedMarks:_}=r,{splittableMarks:E}=i.extensionManager,A=_||v.$to.parentOffset&&v.$from.marks();if(n.split(l.pos,2,w).scrollIntoView(),!A||!s)return!0;const P=A.filter(M=>E.includes(M.type.name));n.ensureMarks(P)}return!0},uy=(t,e)=>{const n=ab(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&eo(t.doc,n.pos)&&t.join(n.pos),!0},dy=(t,e)=>{const n=ab(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&eo(t.doc,r)&&t.join(r),!0},sH=(t,e,n,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:u,can:d})=>{const{extensions:f,splittableMarks:p}=s.extensionManager,m=Lt(t,o.schema),g=Lt(e,o.schema),{selection:x,storedMarks:w}=o,{$from:v,$to:_}=x,E=v.blockRange(_),A=w||x.$to.parentOffset&&x.$from.marks();if(!E)return!1;const P=ab(M=>bT(M.type.name,f))(x);if(E.depth>=1&&P&&E.depth-P.depth<=1){if(P.node.type===m)return u.liftListItem(g);if(bT(P.node.type.name,f)&&m.validContent(P.node.content)&&a)return l().command(()=>(i.setNodeMarkup(P.pos,m),!0)).command(()=>uy(i,m)).command(()=>dy(i,m)).run()}return!n||!A||!a?l().command(()=>d().wrapInList(m,r)?!0:u.clearNodes()).wrapInList(m,r).command(()=>uy(i,m)).command(()=>dy(i,m)).run():l().command(()=>{const M=d().wrapInList(m,r),N=A.filter(S=>p.includes(S.type.name));return i.ensureMarks(N),M?!0:u.clearNodes()}).wrapInList(m,r).command(()=>uy(i,m)).command(()=>dy(i,m)).run()},iH=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=n,o=no(t,r.schema);return hx(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},oH=(t,e,n={})=>({state:r,commands:s})=>{const i=Lt(t,r.schema),o=Lt(e,r.schema),a=Bu(r,i,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...n})},aH=(t,e={})=>({state:n,commands:r})=>{const s=Lt(t,n.schema);return Bu(n,s,e)?r.lift(s):r.wrapIn(s,e)},lH=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let i;if(s.spec.isInputRules&&(i=s.getState(t))){if(e){const o=t.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,t.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},cH=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(i=>{t.removeMark(i.$from.pos,i.$to.pos)}),!0},uH=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=n,l=no(t,r.schema),{$from:u,empty:d,ranges:f}=a;if(!s)return!0;if(d&&o){let{from:p,to:m}=a;const g=(i=u.marks().find(w=>w.type===l))===null||i===void 0?void 0:i.attrs,x=ib(u,l,g);x&&(p=x.from,m=x.to),n.removeMark(p,m,l)}else f.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},dH=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let i=null,o=null;const a=Um(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(i=Lt(t,r.schema)),a==="mark"&&(o=no(t,r.schema)),s&&n.selection.ranges.forEach(l=>{const u=l.$from.pos,d=l.$to.pos;let f,p,m,g;n.selection.empty?r.doc.nodesBetween(u,d,(x,w)=>{i&&i===x.type&&(m=Math.max(w,u),g=Math.min(w+x.nodeSize,d),f=w,p=x)}):r.doc.nodesBetween(u,d,(x,w)=>{w<u&&i&&i===x.type&&(m=Math.max(w,u),g=Math.min(w+x.nodeSize,d),f=w,p=x),w>=u&&w<=d&&(i&&i===x.type&&n.setNodeMarkup(w,void 0,{...x.attrs,...e}),o&&x.marks.length&&x.marks.forEach(v=>{if(o===v.type){const _=Math.max(w,u),E=Math.min(w+x.nodeSize,d);n.addMark(_,E,o.create({...v.attrs,...e}))}}))}),p&&(f!==void 0&&n.setNodeMarkup(f,void 0,{...p.attrs,...e}),o&&p.marks.length&&p.marks.forEach(x=>{o===x.type&&n.addMark(m,g,o.create({...x.attrs,...e}))}))}),!0):!1},hH=(t,e={})=>({state:n,dispatch:r})=>{const s=Lt(t,n.schema);return S7(s,e)(n,r)},fH=(t,e={})=>({state:n,dispatch:r})=>{const s=Lt(t,n.schema);return T7(s,e)(n,r)};var pH=Object.freeze({__proto__:null,blur:G7,clearContent:Q7,clearNodes:J7,command:Y7,createParagraphNear:X7,cut:Z7,deleteCurrentNode:e8,deleteNode:t8,deleteRange:n8,deleteSelection:r8,enter:s8,exitCode:i8,extendMarkRange:o8,first:a8,focus:c8,forEach:u8,insertContent:d8,insertContentAt:p8,joinBackward:y8,joinDown:g8,joinForward:x8,joinItemBackward:v8,joinItemForward:w8,joinTextblockBackward:b8,joinTextblockForward:_8,joinUp:m8,keyboardShortcut:S8,lift:T8,liftEmptyBlock:k8,liftListItem:N8,newlineInCode:C8,resetAttributes:I8,scrollIntoView:A8,selectAll:j8,selectNodeBackward:R8,selectNodeForward:P8,selectParentNode:D8,selectTextblockEnd:M8,selectTextblockStart:O8,setContent:L8,setMark:J8,setMeta:Y8,setNode:X8,setNodeSelection:Z8,setTextSelection:eH,sinkListItem:tH,splitBlock:nH,splitListItem:rH,toggleList:sH,toggleMark:iH,toggleNode:oH,toggleWrap:aH,undoInputRule:lH,unsetAllMarks:cH,unsetMark:uH,updateAttributes:dH,wrapIn:hH,wrapInList:fH});const mH=At.create({name:"commands",addCommands(){return{...pH}}}),gH=At.create({name:"drop",addProseMirrorPlugins(){return[new Ft({key:new Fn("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),yH=At.create({name:"editable",addProseMirrorPlugins(){return[new Ft({key:new Fn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),xH=At.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ft({key:new Fn("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),vH=At.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:u}=a,{empty:d,$anchor:f}=l,{pos:p,parent:m}=f,g=f.parent.isTextblock&&p>0?a.doc.resolve(p-1):f,x=g.parent.type.spec.isolating,w=f.pos-f.parentOffset,v=x&&g.parent.childCount===1?w===f.pos:ve.atStart(u).from===p;return!d||!m.type.isTextblock||m.textContent.length||!v||v&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ob()||Zj()?i:s},addProseMirrorPlugins(){return[new Ft({key:new Fn("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(x=>x.getMeta("composition")))return;const r=t.some(x=>x.docChanged)&&!e.doc.eq(n.doc),s=t.some(x=>x.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=e.selection,l=ve.atStart(e.doc).from,u=ve.atEnd(e.doc).to;if(i||!(o===l&&a===u)||!zm(n.doc))return;const p=n.tr,m=Mm({state:n,transaction:p}),{commands:g}=new Om({editor:this.editor,state:m});if(g.clearNodes(),!!p.steps.length)return p}})]}}),wH=At.create({name:"paste",addProseMirrorPlugins(){return[new Ft({key:new Fn("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),bH=At.create({name:"tabindex",addProseMirrorPlugins(){return[new Ft({key:new Fn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class fo{get name(){return this.node.type.name}constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new fo(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new fo(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new fo(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,o=this.pos+r+(i?0:1),a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new fo(a,this.editor,s,s?n:null);s&&(l.actualDepth=this.depth+1),e.push(new fo(a,this.editor,s,s?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const i=s.node.attrs,o=Object.keys(n);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==n[l])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(n);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>n[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const _H=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function EH(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}class SH extends R7{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:s})=>this.options.onDrop(n,r,s)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=EH(_H,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=Wj(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=n.filter(a=>!a.key.startsWith(o))}),n.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,n;const s=[...this.options.enableCoreExtensions?[yH,K7.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),mH,xH,vH,bH,gH,wH].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Ua(s,this)}createCommandManager(){this.commandManager=new Om({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=dx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),n=dx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=Yj(n,this.options.autofocus);this.view=new n7(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Fa.create({doc:n,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return tR(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,s=typeof e=="string"?n:e;return K8(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return rb(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return B8(this.state.doc,{blockSeparator:n,textSerializers:{...Gj(this.schema),...r}})}get isEmpty(){return zm(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new fo(n,this)}get $doc(){return this.$pos(0)}}function Tl(t){return new Vm({find:t.find,handler:({state:e,range:n,match:r})=>{const s=_e(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),u=n.from+a.indexOf(o),d=u+o.length;if(lb(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(x=>x===t.type&&x!==m.mark.type)).filter(m=>m.to>u).length)return null;d<n.to&&i.delete(d,n.to),u>n.from&&i.delete(n.from+l,u);const p=n.from+l+o.length;i.addMark(n.from+l,p,t.type.create(s||{})),i.removeStoredMark(t.type)}}})}function nR(t){return new Vm({find:t.find,handler:({state:e,range:n,match:r})=>{const s=_e(t.getAttributes,void 0,r)||{},{tr:i}=e,o=n.from;let a=n.to;const l=t.type.create(s);if(r[1]){const u=r[0].lastIndexOf(r[1]);let d=o+u;d>a?d=a:a=d+r[1].length;const f=r[0][r[0].length-1];i.insertText(f,o+r[0].length-1),i.replaceWith(d,a,l)}else if(r[0]){const u=t.type.isInline?o:o-1;i.insert(u,t.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function fx(t){return new Vm({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),i=_e(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,i)}})}function $u(t){return new Vm({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const i=_e(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),l=o.doc.resolve(n.from).blockRange(),u=l&&zw(l,t.type,i);if(!u)return null;if(o.wrap(l,u),t.keepMarks&&t.editor){const{selection:f,storedMarks:p}=e,{splittableMarks:m}=t.editor.extensionManager,g=p||f.$to.parentOffset&&f.$from.marks();if(g){const x=g.filter(w=>m.includes(w.type.name));o.ensureMarks(x)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(f,i).run()}const d=o.doc.resolve(n.from-1).nodeBefore;d&&d.type===t.type&&eo(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,d))&&o.join(n.from-1)}})}class Nn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_e(se(this,"addOptions",{name:this.name}))),this.storage=_e(se(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Nn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Fm(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Nn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=_e(se(n,"addOptions",{name:n.name})),n.storage=_e(se(n,"addStorage",{name:n.name,options:n.options})),n}}function ea(t){return new z7({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const i=_e(t.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let u=n.to;if(a){const d=l.search(/\S/),f=n.from+l.indexOf(a),p=f+a.length;if(lb(n.from,n.to,e.doc).filter(g=>g.mark.type.excluded.find(w=>w===t.type&&w!==g.mark.type)).filter(g=>g.to>f).length)return null;p<n.to&&o.delete(p,n.to),f>n.from&&o.delete(n.from+d,f),u=n.from+d+a.length,o.addMark(n.from+d,u,t.type.create(i||{})),o.removeStoredMark(t.type)}}})}function TH(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rR={exports:{}},hy={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ET;function kH(){if(ET)return hy;ET=1;var t=pt;function e(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,i=t.useLayoutEffect,o=t.useDebugValue;function a(f,p){var m=p(),g=r({inst:{value:m,getSnapshot:p}}),x=g[0].inst,w=g[1];return i(function(){x.value=m,x.getSnapshot=p,l(x)&&w({inst:x})},[f,m,p]),s(function(){return l(x)&&w({inst:x}),f(function(){l(x)&&w({inst:x})})},[f]),o(m),m}function l(f){var p=f.getSnapshot;f=f.value;try{var m=p();return!n(f,m)}catch{return!0}}function u(f,p){return p()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:a;return hy.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:d,hy}rR.exports=kH();var cb=rR.exports;const NH=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},CH=({contentComponent:t})=>{const e=cb.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return pt.createElement(pt.Fragment,null,Object.values(e))};function IH(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:YN.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}class AH extends pt.Component{constructor(e){var n;super(e),this.editorContentRef=pt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=IH(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return pt.createElement(pt.Fragment,null,pt.createElement("div",{ref:NH(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&pt.createElement(CH,{contentComponent:e.contentComponent}))}}const jH=T.forwardRef((t,e)=>{const n=pt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return pt.createElement(AH,{key:n,innerRef:e,...t})}),RH=pt.memo(jH);var PH=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(s of e.entries())if(!n.has(s[0]))return!1;for(s of e.entries())if(!t(s[1],n.get(s[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(s of e.entries())if(!n.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(e[s]!==n[s])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!(o==="_owner"&&e.$$typeof)&&!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},DH=TH(PH),sR={exports:{}},fy={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ST;function MH(){if(ST)return fy;ST=1;var t=pt,e=cb;function n(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,i=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return fy.useSyncExternalStoreWithSelector=function(u,d,f,p,m){var g=i(null);if(g.current===null){var x={hasValue:!1,value:null};g.current=x}else x=g.current;g=a(function(){function v(M){if(!_){if(_=!0,E=M,M=p(M),m!==void 0&&x.hasValue){var N=x.value;if(m(N,M))return A=N}return A=M}if(N=A,r(E,M))return N;var S=p(M);return m!==void 0&&m(N,S)?N:(E=M,A=S)}var _=!1,E,A,P=f===void 0?null:f;return[function(){return v(d())},P===null?void 0:function(){return v(P())}]},[d,f,p,m]);var w=s(u,g[0],g[1]);return o(function(){x.hasValue=!0,x.value=w},[w]),l(w),w},fy}sR.exports=MH();var OH=sR.exports;const LH=typeof window<"u"?T.useLayoutEffect:T.useEffect;class VH{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function FH(t){var e;const[n]=T.useState(()=>new VH(t.editor)),r=OH.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:DH);return LH(()=>n.watch(t.editor),[t.editor,n]),T.useDebugValue(r),r}const UH=!1,px=typeof window>"u",zH=px||!!(typeof window<"u"&&window.next);class ub{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?px||zH?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)===null||i===void 0?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)===null||i===void 0?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)===null||i===void 0?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)===null||i===void 0?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)===null||i===void 0?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)===null||i===void 0?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)===null||i===void 0?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)===null||i===void 0?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)===null||i===void 0?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)===null||i===void 0?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)===null||i===void 0?void 0:i.call(s,...r)}};return new SH(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,i)=>{var o;return s===((o=n.extensions)===null||o===void 0?void 0:o[i])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?ub.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function iR(t={},e=[]){const n=T.useRef(t);n.current=t;const[r]=T.useState(()=>new ub(n)),s=cb.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return T.useDebugValue(s),T.useEffect(r.onRender(e)),FH({editor:s,selector:({transactionNumber:i})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&i===0?0:i+1}),s}const BH=T.createContext({editor:null});BH.Consumer;const $H=T.createContext({onDragStart:void 0}),HH=()=>T.useContext($H);pt.forwardRef((t,e)=>{const{onDragStart:n}=HH(),r=t.as||"div";return pt.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const qH=/^\s*>\s$/,WH=Nn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[$u({find:qH,type:this.type})]}}),KH=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,GH=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,QH=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,JH=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,YH=Pr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Tl({find:KH,type:this.type}),Tl({find:QH,type:this.type})]},addPasteRules(){return[ea({find:GH,type:this.type}),ea({find:JH,type:this.type})]}}),XH="listItem",TT="textStyle",kT=/^\s*([-+*])\s$/,ZH=Nn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(XH,this.editor.getAttributes(TT)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=$u({find:kT,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=$u({find:kT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(TT),editor:this.editor})),[t]}}),eq=/(^|[^`])`([^`]+)`(?!`)/,tq=/(^|[^`])`([^`]+)`(?!`)/g,nq=Pr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Tl({find:eq,type:this.type})]},addPasteRules(){return[ea({find:tq,type:this.type})]}}),rq=/^```([a-z]+)?[\s\n]$/,sq=/^~~~([a-z]+)?[\s\n]$/,iq=Nn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,i=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",kt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:i}=n;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:u})=>(u.setSelection(ve.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[fx({find:rq,type:this.type,getAttributes:t=>({language:t[1]})}),fx({find:sq,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ft({key:new Fn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!n||!i)return!1;const{tr:o,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(fe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),oq=Nn.create({name:"doc",topNode:!0,content:"block+"});function aq(t={}){return new Ft({view(e){return new lq(e,t)}})}class lq{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let u=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(u){let d=u.getBoundingClientRect(),f=a?d.bottom:d.top;a&&l&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:d.left,right:d.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let s=this.editorView.dom.offsetParent;this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let i,o;if(!s||s==document.body&&getComputedStyle(s).position=="static")i=-pageXOffset,o=-pageYOffset;else{let a=s.getBoundingClientRect();i=a.left-s.scrollLeft,o=a.top-s.scrollTop}this.element.style.left=r.left-i+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,n,e):s;if(n&&!i){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=qA(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const cq=At.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[aq(this.options)]}});class ft extends ve{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return ft.valid(r)?new ft(r):ve.near(r)}content(){return ee.empty}eq(e){return e instanceof ft&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ft(e.resolve(n.pos))}getBookmark(){return new db(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!uq(e)||!dq(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let s=n.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&ft.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(n>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=n;let l=e.doc.resolve(s);if(ft.valid(l))return l}for(;;){let o=n>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!ue.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*n),r=!1;continue e}break}i=o,s+=n;let a=e.doc.resolve(s);if(ft.valid(a))return a}return null}}}ft.prototype.visible=!1;ft.findFrom=ft.findGapCursorFrom;ve.jsonID("gapcursor",ft);class db{constructor(e){this.pos=e}map(e){return new db(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return ft.valid(n)?new ft(n):ve.near(n)}}function uq(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function dq(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(n);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function hq(){return new Ft({props:{decorations:gq,createSelectionBetween(t,e,n){return e.pos==n.pos&&ft.valid(n)?new ft(n):null},handleClick:pq,handleKeyDown:fq,handleDOMEvents:{beforeinput:mq}}})}const fq=Rj({ArrowLeft:uh("horiz",-1),ArrowRight:uh("horiz",1),ArrowUp:uh("vert",-1),ArrowDown:uh("vert",1)});function uh(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof fe){if(!i.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let u=ft.findGapCursorFrom(a,e,l);return u?(s&&s(r.tr.setSelection(new ft(u))),!0):!1}}function pq(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!ft.valid(r))return!1;let s=t.posAtCoords({left:n.clientX,top:n.clientY});return s&&s.inside>-1&&ue.isSelectable(t.state.doc.nodeAt(s.inside))?!1:(t.dispatch(t.state.tr.setSelection(new ft(r))),!0)}function mq(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof ft))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let s=K.empty;for(let o=r.length-1;o>=0;o--)s=K.from(r[o].createAndFill(null,s));let i=t.state.tr.replace(n.pos,n.pos,new ee(s,0,0));return i.setSelection(fe.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function gq(t){if(!(t.selection instanceof ft))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",_t.create(t.doc,[Yn.widget(t.selection.head,e,{key:"gapcursor"})])}const yq=At.create({name:"gapCursor",addProseMirrorPlugins(){return[hq()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=_e(se(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),xq=Nn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",kt(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:i}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:d})=>{if(d&&l&&o){const f=l.filter(p=>a.includes(p.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),vq=Nn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,kt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>fx({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var ep=200,Ot=function(){};Ot.prototype.append=function(e){return e.length?(e=Ot.from(e),!this.length&&e||e.length<ep&&this.leafAppend(e)||this.length<ep&&e.leafPrepend(this)||this.appendInner(e)):this};Ot.prototype.prepend=function(e){return e.length?Ot.from(e).append(this):this};Ot.prototype.appendInner=function(e){return new wq(this,e)};Ot.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Ot.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Ot.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ot.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};Ot.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},n,r),s};Ot.from=function(e){return e instanceof Ot?e:e&&e.length?new oR(e):Ot.empty};var oR=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=ep)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=ep)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Ot);Ot.empty=new oR([]);var wq=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Ot);const bq=500;class Tr{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;n&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,u=[],d=[];return this.items.forEach((f,p)=>{if(!f.step){s||(s=this.remapping(r,p+1),i=s.maps.length),i--,d.push(f);return}if(s){d.push(new Lr(f.map));let m=f.step.map(s.slice(i)),g;m&&o.maybeStep(m).doc&&(g=o.mapping.maps[o.mapping.maps.length-1],u.push(new Lr(g,void 0,void 0,u.length+d.length))),i--,g&&s.appendMap(g,i)}else o.maybeStep(f.step);if(f.selection)return a=s?f.selection.map(s.slice(i)):f.selection,l=new Tr(this.items.slice(0,r).append(d.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,n,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let d=0;d<e.steps.length;d++){let f=e.steps[d].invert(e.docs[d]),p=new Lr(e.mapping.maps[d],f,n),m;(m=l&&l.merge(p))&&(p=m,d?i.pop():a=a.slice(0,a.length-1)),i.push(p),n&&(o++,n=void 0),s||(l=p)}let u=o-r.depth;return u>Eq&&(a=_q(a,u),o-=u),new Tr(a.append(i),o)}remapping(e,n){let r=new Xa;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new Tr(this.items.append(e.map(n=>new Lr(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-n),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(p=>{p.selection&&a--},s);let l=n;this.items.forEach(p=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let g=i.maps[m];if(p.step){let x=e.steps[m].invert(e.docs[m]),w=p.selection&&p.selection.map(i.slice(l+1,m));w&&a++,r.push(new Lr(g,x,w))}else r.push(new Lr(g))},s);let u=[];for(let p=n;p<o;p++)u.push(new Lr(i.maps[p]));let d=this.items.slice(0,s).append(u).append(r),f=new Tr(d,a);return f.emptyItemCount()>bq&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(n.slice(r)),u=l&&l.getMap();if(r--,u&&n.appendMap(u,r),l){let d=o.selection&&o.selection.map(n.slice(r));d&&i++;let f=new Lr(u.invert(),l,d),p,m=s.length-1;(p=s.length&&s[m].merge(f))?s[m]=p:s.push(f)}}else o.map&&r--},this.items.length,0),new Tr(Ot.from(s.reverse()),i)}}Tr.empty=new Tr(Ot.empty,0);function _q(t,e){let n;return t.forEach((r,s)=>{if(r.selection&&e--==0)return n=s,!1}),t.slice(n)}class Lr{constructor(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Lr(n.getMap().invert(),n,this.selection)}}}class ti{constructor(e,n,r,s,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const Eq=20;function Sq(t,e,n,r){let s=n.getMeta(Mo),i;if(s)return s.historyState;n.getMeta(Nq)&&(t=new ti(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(Mo))return o.getMeta(Mo).redo?new ti(t.done.addTransform(n,void 0,r,$h(e)),t.undone,NT(n.mapping.maps),t.prevTime,t.prevComposition):new ti(t.done,t.undone.addTransform(n,void 0,r,$h(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),l=t.prevTime==0||!o&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-r.newGroupDelay||!Tq(n,t.prevRanges)),u=o?py(t.prevRanges,n.mapping):NT(n.mapping.maps);return new ti(t.done.addTransform(n,l?e.selection.getBookmark():void 0,r,$h(e)),Tr.empty,u,n.time,a??t.prevComposition)}else return(i=n.getMeta("rebased"))?new ti(t.done.rebased(n,i),t.undone.rebased(n,i),py(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new ti(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),py(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function Tq(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(n=!0)}),n}function NT(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,s,i,o)=>e.push(i,o));return e}function py(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let s=e.map(t[r],1),i=e.map(t[r+1],-1);s<=i&&n.push(s,i)}return n}function kq(t,e,n){let r=$h(e),s=Mo.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new ti(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(Mo,{redo:n,historyState:l})}let my=!1,CT=null;function $h(t){let e=t.plugins;if(CT!=e){my=!1,CT=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){my=!0;break}}return my}const Mo=new Fn("history"),Nq=new Fn("closeHistory");function Cq(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ft({key:Mo,state:{init(){return new ti(Tr.empty,Tr.empty,null,0,-1)},apply(e,n,r){return Sq(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,s=r=="historyUndo"?lR:r=="historyRedo"?cR:null;return s?(n.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function aR(t,e){return(n,r)=>{let s=Mo.getState(n);if(!s||(t?s.undone:s.done).eventCount==0)return!1;if(r){let i=kq(s,n,t);i&&r(e?i.scrollIntoView():i)}return!0}}const lR=aR(!1,!0),cR=aR(!0,!0),Iq=At.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>lR(t,e),redo:()=>({state:t,dispatch:e})=>cR(t,e)}},addProseMirrorPlugins(){return[Cq(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Aq=Nn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",kt(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{selection:n}=e,{$from:r,$to:s}=n,i=t();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):G8(n)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:u}=o.selection,d=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(fe.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(ue.create(o.doc,u.pos)):o.setSelection(fe.create(o.doc,u.pos));else{const f=(l=u.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();f&&(o.insert(d,f),o.setSelection(fe.create(o.doc,d+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[nR({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),jq=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Rq=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Pq=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Dq=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Mq=Pr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Tl({find:jq,type:this.type}),Tl({find:Pq,type:this.type})]},addPasteRules(){return[ea({find:Rq,type:this.type}),ea({find:Dq,type:this.type})]}}),Oq=Nn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",kt(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Lq="listItem",IT="textStyle",AT=/^(\d+)\.\s$/,Vq=Nn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",kt(this.options.HTMLAttributes,n),0]:["ol",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Lq,this.editor.getAttributes(IT)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=$u({find:AT,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=$u({find:AT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(IT)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),Fq=Nn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Uq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,zq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Bq=Pr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Tl({find:Uq,type:this.type})]},addPasteRules(){return[ea({find:zq,type:this.type})]}}),$q=Nn.create({name:"text",group:"inline"}),uR=At.create({name:"starterKit",addExtensions(){var t,e,n,r,s,i,o,a,l,u,d,f,p,m,g,x,w,v;const _=[];return this.options.bold!==!1&&_.push(YH.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.blockquote!==!1&&_.push(WH.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&_.push(ZH.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&_.push(nq.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&_.push(iq.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&_.push(oq.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&_.push(cq.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&_.push(yq.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&_.push(xq.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&_.push(vq.configure((u=this.options)===null||u===void 0?void 0:u.heading)),this.options.history!==!1&&_.push(Iq.configure((d=this.options)===null||d===void 0?void 0:d.history)),this.options.horizontalRule!==!1&&_.push(Aq.configure((f=this.options)===null||f===void 0?void 0:f.horizontalRule)),this.options.italic!==!1&&_.push(Mq.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&_.push(Oq.configure((m=this.options)===null||m===void 0?void 0:m.listItem)),this.options.orderedList!==!1&&_.push(Vq.configure((g=this.options)===null||g===void 0?void 0:g.orderedList)),this.options.paragraph!==!1&&_.push(Fq.configure((x=this.options)===null||x===void 0?void 0:x.paragraph)),this.options.strike!==!1&&_.push(Bq.configure((w=this.options)===null||w===void 0?void 0:w.strike)),this.options.text!==!1&&_.push($q.configure((v=this.options)===null||v===void 0?void 0:v.text)),_}}),Hq="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster6d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",qq="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",kl=(t,e)=>{for(const n in e)t[n]=e[n];return t},mx="numeric",gx="ascii",yx="alpha",Yc="asciinumeric",Cc="alphanumeric",xx="domain",dR="emoji",Wq="scheme",Kq="slashscheme",gy="whitespace";function Gq(t,e){return t in e||(e[t]=[]),e[t]}function So(t,e,n){e[mx]&&(e[Yc]=!0,e[Cc]=!0),e[gx]&&(e[Yc]=!0,e[yx]=!0),e[Yc]&&(e[Cc]=!0),e[yx]&&(e[Cc]=!0),e[Cc]&&(e[xx]=!0),e[dR]&&(e[xx]=!0);for(const r in e){const s=Gq(r,n);s.indexOf(t)<0&&s.push(t)}}function Qq(t,e){const n={};for(const r in e)e[r].indexOf(t)>=0&&(n[r]=!0);return n}function Rn(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Rn.groups={};Rn.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(t))return i}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,n,r){for(let s=0;s<t.length;s++)this.tt(t[s],e,n,r)},tr(t,e,n,r){r=r||Rn.groups;let s;return e&&e.j?s=e:(s=new Rn(e),n&&r&&So(e,n,r)),this.jr.push([t,s]),s},ts(t,e,n,r){let s=this;const i=t.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(t[o]);return s.tt(t[i-1],e,n,r)},tt(t,e,n,r){r=r||Rn.groups;const s=this;if(e&&e.j)return s.j[t]=e,e;const i=e;let o,a=s.go(t);if(a?(o=new Rn,kl(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new Rn,i){if(r)if(o.t&&typeof o.t=="string"){const l=kl(Qq(o.t,r),n);So(i,l,r)}else n&&So(i,n,r);o.t=i}return s.j[t]=o,o}};const be=(t,e,n,r,s)=>t.ta(e,n,r,s),dt=(t,e,n,r,s)=>t.tr(e,n,r,s),jT=(t,e,n,r,s)=>t.ts(e,n,r,s),Q=(t,e,n,r,s)=>t.tt(e,n,r,s),us="WORD",vx="UWORD",hR="ASCIINUMERICAL",fR="ALPHANUMERICAL",Hu="LOCALHOST",wx="TLD",bx="UTLD",Hh="SCHEME",Sa="SLASH_SCHEME",hb="NUM",_x="WS",fb="NL",Xc="OPENBRACE",Zc="CLOSEBRACE",tp="OPENBRACKET",np="CLOSEBRACKET",rp="OPENPAREN",sp="CLOSEPAREN",ip="OPENANGLEBRACKET",op="CLOSEANGLEBRACKET",ap="FULLWIDTHLEFTPAREN",lp="FULLWIDTHRIGHTPAREN",cp="LEFTCORNERBRACKET",up="RIGHTCORNERBRACKET",dp="LEFTWHITECORNERBRACKET",hp="RIGHTWHITECORNERBRACKET",fp="FULLWIDTHLESSTHAN",pp="FULLWIDTHGREATERTHAN",mp="AMPERSAND",pb="APOSTROPHE",gp="ASTERISK",ni="AT",yp="BACKSLASH",xp="BACKTICK",vp="CARET",hi="COLON",mb="COMMA",wp="DOLLAR",Vr="DOT",bp="EQUALS",gb="EXCLAMATION",or="HYPHEN",eu="PERCENT",_p="PIPE",Ep="PLUS",Sp="POUND",tu="QUERY",yb="QUOTE",pR="FULLWIDTHMIDDLEDOT",xb="SEMI",Fr="SLASH",nu="TILDE",Tp="UNDERSCORE",mR="EMOJI",kp="SYM";var gR=Object.freeze({__proto__:null,WORD:us,UWORD:vx,ASCIINUMERICAL:hR,ALPHANUMERICAL:fR,LOCALHOST:Hu,TLD:wx,UTLD:bx,SCHEME:Hh,SLASH_SCHEME:Sa,NUM:hb,WS:_x,NL:fb,OPENBRACE:Xc,CLOSEBRACE:Zc,OPENBRACKET:tp,CLOSEBRACKET:np,OPENPAREN:rp,CLOSEPAREN:sp,OPENANGLEBRACKET:ip,CLOSEANGLEBRACKET:op,FULLWIDTHLEFTPAREN:ap,FULLWIDTHRIGHTPAREN:lp,LEFTCORNERBRACKET:cp,RIGHTCORNERBRACKET:up,LEFTWHITECORNERBRACKET:dp,RIGHTWHITECORNERBRACKET:hp,FULLWIDTHLESSTHAN:fp,FULLWIDTHGREATERTHAN:pp,AMPERSAND:mp,APOSTROPHE:pb,ASTERISK:gp,AT:ni,BACKSLASH:yp,BACKTICK:xp,CARET:vp,COLON:hi,COMMA:mb,DOLLAR:wp,DOT:Vr,EQUALS:bp,EXCLAMATION:gb,HYPHEN:or,PERCENT:eu,PIPE:_p,PLUS:Ep,POUND:Sp,QUERY:tu,QUOTE:yb,FULLWIDTHMIDDLEDOT:pR,SEMI:xb,SLASH:Fr,TILDE:nu,UNDERSCORE:Tp,EMOJI:mR,SYM:kp});const ls=/[a-z]/,pc=new RegExp("\\p{L}","u"),yy=new RegExp("\\p{Emoji}","u"),cs=/\d/,xy=/\s/,RT="\r",vy=`
`,Jq="️",Yq="‍",wy="￼";let dh=null,hh=null;function Xq(t=[]){const e={};Rn.groups=e;const n=new Rn;dh==null&&(dh=PT(Hq)),hh==null&&(hh=PT(qq)),Q(n,"'",pb),Q(n,"{",Xc),Q(n,"}",Zc),Q(n,"[",tp),Q(n,"]",np),Q(n,"(",rp),Q(n,")",sp),Q(n,"<",ip),Q(n,">",op),Q(n,"（",ap),Q(n,"）",lp),Q(n,"「",cp),Q(n,"」",up),Q(n,"『",dp),Q(n,"』",hp),Q(n,"＜",fp),Q(n,"＞",pp),Q(n,"&",mp),Q(n,"*",gp),Q(n,"@",ni),Q(n,"`",xp),Q(n,"^",vp),Q(n,":",hi),Q(n,",",mb),Q(n,"$",wp),Q(n,".",Vr),Q(n,"=",bp),Q(n,"!",gb),Q(n,"-",or),Q(n,"%",eu),Q(n,"|",_p),Q(n,"+",Ep),Q(n,"#",Sp),Q(n,"?",tu),Q(n,'"',yb),Q(n,"/",Fr),Q(n,";",xb),Q(n,"~",nu),Q(n,"_",Tp),Q(n,"\\",yp),Q(n,"・",pR);const r=dt(n,cs,hb,{[mx]:!0});dt(r,cs,r);const s=dt(r,ls,hR,{[Yc]:!0}),i=dt(r,pc,fR,{[Cc]:!0}),o=dt(n,ls,us,{[gx]:!0});dt(o,cs,s),dt(o,ls,o),dt(s,cs,s),dt(s,ls,s);const a=dt(n,pc,vx,{[yx]:!0});dt(a,ls),dt(a,cs,i),dt(a,pc,a),dt(i,cs,i),dt(i,ls),dt(i,pc,i);const l=Q(n,vy,fb,{[gy]:!0}),u=Q(n,RT,_x,{[gy]:!0}),d=dt(n,xy,_x,{[gy]:!0});Q(n,wy,d),Q(u,vy,l),Q(u,wy,d),dt(u,xy,d),Q(d,RT),Q(d,vy),dt(d,xy,d),Q(d,wy,d);const f=dt(n,yy,mR,{[dR]:!0});Q(f,"#"),dt(f,yy,f),Q(f,Jq,f);const p=Q(f,Yq);Q(p,"#"),dt(p,yy,f);const m=[[ls,o],[cs,s]],g=[[ls,null],[pc,a],[cs,i]];for(let x=0;x<dh.length;x++)Qs(n,dh[x],wx,us,m);for(let x=0;x<hh.length;x++)Qs(n,hh[x],bx,vx,g);So(wx,{tld:!0,ascii:!0},e),So(bx,{utld:!0,alpha:!0},e),Qs(n,"file",Hh,us,m),Qs(n,"mailto",Hh,us,m),Qs(n,"http",Sa,us,m),Qs(n,"https",Sa,us,m),Qs(n,"ftp",Sa,us,m),Qs(n,"ftps",Sa,us,m),So(Hh,{scheme:!0,ascii:!0},e),So(Sa,{slashscheme:!0,ascii:!0},e),t=t.sort((x,w)=>x[0]>w[0]?1:-1);for(let x=0;x<t.length;x++){const w=t[x][0],_=t[x][1]?{[Wq]:!0}:{[Kq]:!0};w.indexOf("-")>=0?_[xx]=!0:ls.test(w)?cs.test(w)?_[Yc]=!0:_[gx]=!0:_[mx]=!0,jT(n,w,w,_)}return jT(n,"localhost",Hu,{ascii:!0}),n.jd=new Rn(kp),{start:n,tokens:kl({groups:e},gR)}}function yR(t,e){const n=Zq(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=n.length,s=[];let i=0,o=0;for(;o<r;){let a=t,l=null,u=0,d=null,f=-1,p=-1;for(;o<r&&(l=a.go(n[o]));)a=l,a.accepts()?(f=0,p=0,d=a):f>=0&&(f+=n[o].length,p++),u+=n[o].length,i+=n[o].length,o++;i-=f,o-=p,u-=f,s.push({t:d.t,v:e.slice(i-u,i),s:i-u,e:i})}return s}function Zq(t){const e=[],n=t.length;let r=0;for(;r<n;){let s=t.charCodeAt(r),i,o=s<55296||s>56319||r+1===n||(i=t.charCodeAt(r+1))<56320||i>57343?t[r]:t.slice(r,r+2);e.push(o),r+=o.length}return e}function Qs(t,e,n,r,s){let i;const o=e.length;for(let a=0;a<o-1;a++){const l=e[a];t.j[l]?i=t.j[l]:(i=new Rn(r),i.jr=s.slice(),t.j[l]=i),t=i}return i=new Rn(n),i.jr=s.slice(),t.j[e[o-1]]=i,i}function PT(t){const e=[],n=[];let r=0,s="0123456789";for(;r<t.length;){let i=0;for(;s.indexOf(t[r+i])>=0;)i++;if(i>0){e.push(n.join(""));for(let o=parseInt(t.substring(r,r+i),10);o>0;o--)n.pop();r+=i}else n.push(t[r]),r++}return e}const qu={defaultProtocol:"http",events:null,format:DT,formatHref:DT,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function vb(t,e=null){let n=kl({},qu);t&&(n=kl(n,t instanceof vb?t.o:t));const r=n.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=s}vb.prototype={o:qu,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const r=e!=null;let s=this.o[t];return s&&(typeof s=="object"?(s=n.t in s?s[n.t]:qu[t],typeof s=="function"&&r&&(s=s(e,n))):typeof s=="function"&&r&&(s=s(e,n.t,n)),s)},getObj(t,e,n){let r=this.o[t];return typeof r=="function"&&e!=null&&(r=r(e,n.t,n)),r},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function DT(t){return t}function xR(t,e){this.t="token",this.v=t,this.tk=e}xR.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),r=t.get("format",e,this);return n&&r.length>n?r.substring(0,n)+"…":r},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=qu.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),r=t.get("formatHref",n,this),s=t.get("tagName",n,e),i=this.toFormattedString(t),o={},a=t.get("className",n,e),l=t.get("target",n,e),u=t.get("rel",n,e),d=t.getObj("attributes",n,e),f=t.getObj("events",n,e);return o.href=r,a&&(o.class=a),l&&(o.target=l),u&&(o.rel=u),d&&kl(o,d),{tagName:s,attributes:o,content:i,eventListeners:f}}};function Bm(t,e){class n extends xR{constructor(s,i){super(s,i),this.t=t}}for(const r in e)n.prototype[r]=e[r];return n.t=t,n}const MT=Bm("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),OT=Bm("text"),eW=Bm("nl"),fh=Bm("url",{isLink:!0,toHref(t=qu.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Hu&&t[1].t===hi}}),ir=t=>new Rn(t);function tW({groups:t}){const e=t.domain.concat([mp,gp,ni,yp,xp,vp,wp,bp,or,hb,eu,_p,Ep,Sp,Fr,kp,nu,Tp]),n=[hi,mb,Vr,gb,eu,tu,yb,xb,ip,op,Xc,Zc,np,tp,rp,sp,ap,lp,cp,up,dp,hp,fp,pp],r=[mp,pb,gp,yp,xp,vp,wp,bp,or,Xc,Zc,eu,_p,Ep,Sp,tu,Fr,kp,nu,Tp],s=ir(),i=Q(s,nu);be(i,r,i),be(i,t.domain,i);const o=ir(),a=ir(),l=ir();be(s,t.domain,o),be(s,t.scheme,a),be(s,t.slashscheme,l),be(o,r,i),be(o,t.domain,o);const u=Q(o,ni);Q(i,ni,u),Q(a,ni,u),Q(l,ni,u);const d=Q(i,Vr);be(d,r,i),be(d,t.domain,i);const f=ir();be(u,t.domain,f),be(f,t.domain,f);const p=Q(f,Vr);be(p,t.domain,f);const m=ir(MT);be(p,t.tld,m),be(p,t.utld,m),Q(u,Hu,m);const g=Q(f,or);Q(g,or,g),be(g,t.domain,f),be(m,t.domain,f),Q(m,Vr,p),Q(m,or,g);const x=Q(m,hi);be(x,t.numeric,MT);const w=Q(o,or),v=Q(o,Vr);Q(w,or,w),be(w,t.domain,o),be(v,r,i),be(v,t.domain,o);const _=ir(fh);be(v,t.tld,_),be(v,t.utld,_),be(_,t.domain,o),be(_,r,i),Q(_,Vr,v),Q(_,or,w),Q(_,ni,u);const E=Q(_,hi),A=ir(fh);be(E,t.numeric,A);const P=ir(fh),M=ir();be(P,e,P),be(P,n,M),be(M,e,P),be(M,n,M),Q(_,Fr,P),Q(A,Fr,P);const N=Q(a,hi),S=Q(l,hi),C=Q(S,Fr),j=Q(C,Fr);be(a,t.domain,o),Q(a,Vr,v),Q(a,or,w),be(l,t.domain,o),Q(l,Vr,v),Q(l,or,w),be(N,t.domain,P),Q(N,Fr,P),Q(N,tu,P),be(j,t.domain,P),be(j,e,P),Q(j,Fr,P);const D=[[Xc,Zc],[tp,np],[rp,sp],[ip,op],[ap,lp],[cp,up],[dp,hp],[fp,pp]];for(let R=0;R<D.length;R++){const[k,z]=D[R],O=Q(P,k);Q(M,k,O),Q(O,z,P);const W=ir(fh);be(O,e,W);const Z=ir();be(O,n),be(W,e,W),be(W,n,Z),be(Z,e,W),be(Z,n,Z),Q(W,z,P),Q(Z,z,P)}return Q(s,Hu,_),Q(s,fb,eW),{start:s,tokens:gR}}function nW(t,e,n){let r=n.length,s=0,i=[],o=[];for(;s<r;){let a=t,l=null,u=null,d=0,f=null,p=-1;for(;s<r&&!(l=a.go(n[s].t));)o.push(n[s++]);for(;s<r&&(u=l||a.go(n[s].t));)l=null,a=u,a.accepts()?(p=0,f=a):p>=0&&p++,s++,d++;if(p<0)s-=d,s<r&&(o.push(n[s]),s++);else{o.length>0&&(i.push(by(OT,e,o)),o=[]),s-=p,d-=p;const m=f.t,g=n.slice(s-d,s);i.push(by(m,e,g))}}return o.length>0&&i.push(by(OT,e,o)),i}function by(t,e,n){const r=n[0].s,s=n[n.length-1].e,i=e.slice(r,s);return new t(i,n)}const rW=typeof console<"u"&&console&&console.warn||(()=>{}),sW="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Ke={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function iW(){return Rn.groups={},Ke.scanner=null,Ke.parser=null,Ke.tokenQueue=[],Ke.pluginQueue=[],Ke.customSchemes=[],Ke.initialized=!1,Ke}function LT(t,e=!1){if(Ke.initialized&&rW(`linkifyjs: already initialized - will not register custom scheme "${t}" ${sW}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Ke.customSchemes.push([t,e])}function oW(){Ke.scanner=Xq(Ke.customSchemes);for(let t=0;t<Ke.tokenQueue.length;t++)Ke.tokenQueue[t][1]({scanner:Ke.scanner});Ke.parser=tW(Ke.scanner.tokens);for(let t=0;t<Ke.pluginQueue.length;t++)Ke.pluginQueue[t][1]({scanner:Ke.scanner,parser:Ke.parser});return Ke.initialized=!0,Ke}function wb(t){return Ke.initialized||oW(),nW(Ke.parser.start,t,yR(Ke.scanner.start,t))}wb.scan=yR;function vR(t,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const r=new vb(n),s=wb(t),i=[];for(let o=0;o<s.length;o++){const a=s[o];a.isLink&&(!e||a.t===e)&&r.check(a)&&i.push(a.toFormattedObject(r))}return i}function aW(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function lW(t){return new Ft({key:new Fn("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(u=>u.docChanged)&&!n.doc.eq(r.doc),i=e.some(u=>u.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,a=V8(n.doc,[...e]);if(W8(a).forEach(({newRange:u})=>{const d=U8(r.doc,u,m=>m.isTextblock);let f,p;if(d.length>1?(f=d[0],p=r.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ")):d.length&&r.doc.textBetween(u.from,u.to," "," ").endsWith(" ")&&(f=d[0],p=r.doc.textBetween(f.pos,u.to,void 0," ")),f&&p){const m=p.split(" ").filter(v=>v!=="");if(m.length<=0)return!1;const g=m[m.length-1],x=f.pos+p.lastIndexOf(g);if(!g)return!1;const w=wb(g).map(v=>v.toObject(t.defaultProtocol));if(!aW(w))return!1;w.filter(v=>v.isLink).map(v=>({...v,from:x+v.start+1,to:x+v.end+1})).filter(v=>r.schema.marks.code?!r.doc.rangeHasMark(v.from,v.to,r.schema.marks.code):!0).filter(v=>t.validate(v.value)).filter(v=>t.shouldAutoLink(v.value)).forEach(v=>{lb(v.from,v.to,r.doc).some(_=>_.mark.type===t.type)||o.addMark(v.from,v.to,t.type.create({href:v.href}))})}}),!!o.steps.length)return o}})}function cW(t){return new Ft({key:new Fn("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let o=r.target;const a=[];for(;o.nodeName!=="DIV";)a.push(o),o=o.parentNode;if(!a.find(p=>p.nodeName==="A"))return!1;const l=tR(e.state,t.type.name),u=r.target,d=(s=u==null?void 0:u.href)!==null&&s!==void 0?s:l.href,f=(i=u==null?void 0:u.target)!==null&&i!==void 0?i:l.target;return u&&d?(window.open(d,f),!0):!1}}})}function uW(t){return new Ft({key:new Fn("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{state:s}=e,{selection:i}=s,{empty:o}=i;if(o)return!1;let a="";r.content.forEach(u=>{a+=u.textContent});const l=vR(a,{defaultProtocol:t.defaultProtocol}).find(u=>u.isLink&&u.value===a);return!a||!l?!1:t.editor.commands.setMark(t.type,{href:l.href})}}})}const dW=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function ao(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace(dW,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const wR=Pr.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){LT(t);return}LT(t.scheme,t.optionalSlashes)})},onDestroy(){iW()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!ao(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!ao(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!ao(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",kt(this.options.HTMLAttributes,t),0]:["a",kt(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!ao(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!ao(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[ea({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=vR(t).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!ao(o,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(i=>e.push({text:i.value,data:{href:i.href},index:i.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(lW({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!ao(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(cW({type:this.type})),this.options.linkOnPaste&&t.push(uW({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}}),hW=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,bR=Nn.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",kt(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[nR({find:hW,type:this.type,getAttributes:t=>{const[,,e,n,r]=t;return{src:n,alt:e,title:r}}})]}}),_R=At.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ft({key:new Fn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!n)return null;const i=this.editor.isEmpty;return t.descendants((o,a)=>{const l=r>=a&&r<=a+o.nodeSize,u=!o.isLeaf&&zm(o);if((l||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];i&&d.push(this.options.emptyEditorClass);const f=Yn.node(a,a+o.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:a,hasAnchor:l}):this.options.placeholder});s.push(f)}return this.options.includeChildren}),_t.create(t,s)}}})]}}),ER=Pr.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),fW=t=>{if(!t.children.length)return;const e=t.querySelectorAll("span");e&&e.forEach(n=>{var r,s;const i=n.getAttribute("style"),o=(s=(r=n.parentElement)===null||r===void 0?void 0:r.closest("span"))===null||s===void 0?void 0:s.getAttribute("style");n.setAttribute("style",`${o};${i}`)})},SR=Pr.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!1}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&fW(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",kt(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(i=>!!i))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),TR=At.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;return(e=t.style.color)===null||e===void 0?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),kR=At.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).every(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).every(e=>e)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),pW=At.create({name:"lineNumber",addOptions(){return{width:32}},addNodeView(){return({node:t,editor:e,getPos:n})=>{const r=document.createElement("span");r.classList.add("line-number"),r.style.width=`${this.options.width}px`,r.style.userSelect="none";const s=()=>{if(typeof n=="boolean")return;const i=e.view.state.doc.resolve(n()).index(0)+1;r.innerText=i.toString()};return s(),{dom:r,update:s,selectNode:()=>{r.classList.add("selected")},deselectNode:()=>{r.classList.remove("selected")},destroy:()=>{}}}},addGlobalAttributes(){return[{types:["paragraph","heading","list_item","todo_item","code_block"],attributes:{lineNumber:{default:null,renderHTML:t=>({class:"line-number-container"}),parseHTML:t=>{var e;return{lineNumber:((e=t.firstChild)==null?void 0:e.textContent)??null}}}}}]}}),mW=({editor:t})=>t?c.jsxs("div",{className:"flex space-x-2 mb-2 p-2 border-b",children:[c.jsx("button",{onClick:()=>t.chain().focus().toggleBold().run(),className:t.isActive("bold")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Negrito",children:c.jsx(Yz,{size:16})}),c.jsx("button",{onClick:()=>t.chain().focus().toggleItalic().run(),className:t.isActive("italic")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Itálico",children:c.jsx(sB,{size:16})}),c.jsx("button",{onClick:()=>t.chain().focus().toggleUnderline().run(),className:t.isActive("underline")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Sublinhado",children:c.jsx("u",{children:"U"})}),c.jsx("button",{onClick:()=>t.chain().focus().toggleBulletList().run(),className:t.isActive("bulletList")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Lista não ordenada",children:c.jsx(gA,{size:16})}),c.jsx("button",{onClick:()=>t.chain().focus().toggleOrderedList().run(),className:t.isActive("orderedList")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Lista ordenada",children:c.jsx(oB,{size:16})}),c.jsx("button",{onClick:()=>{const e=window.prompt("URL");e&&t.chain().focus().setLink({href:e}).run()},className:t.isActive("link")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Inserir link",children:c.jsx(iB,{size:16})}),c.jsx("button",{onClick:()=>{const e=window.prompt("Image URL");e&&t.chain().focus().setImage({src:e}).run()},className:"bg-gray-100 hover:bg-gray-200",title:"Inserir imagem",children:c.jsx(km,{size:16})}),c.jsx("button",{onClick:()=>t.chain().focus().toggleCode().run(),className:t.isActive("code")?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Código",children:c.jsx(Xz,{size:16})}),c.jsx("button",{onClick:()=>t.chain().focus().setTextAlign("left").run(),className:t.isActive({textAlign:"left"})?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Alinhar à Esquerda",children:c.jsx(Kz,{size:16})}),c.jsx("button",{onClick:()=>t.chain().focus().setTextAlign("center").run(),className:t.isActive({textAlign:"center"})?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Centralizar",children:"C"}),c.jsx("button",{onClick:()=>t.chain().focus().setTextAlign("right").run(),className:t.isActive({textAlign:"right"})?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Alinhar à Direita",children:"R"}),c.jsx("button",{onClick:()=>t.chain().focus().setTextAlign("justify").run(),className:t.isActive({textAlign:"justify"})?"is-active bg-gray-300":"bg-gray-100 hover:bg-gray-200",title:"Justificar",children:"J"})]}):null,gW=({action:t,onComplete:e,onCancel:n,taskId:r,isOpen:s})=>{var j,D,R,k,z,O,W,Z,B,V,$,F;const[i,o]=T.useState(0),[a,l]=T.useState({}),[u,d]=T.useState(!1),[f,p]=T.useState(null),[m,g]=T.useState(null),{currentUser:x}=tn(),[w,v]=T.useState({}),_=T.useRef(null),E=iR({extensions:[uR,wR,bR,_R.configure({placeholder:"Digite o conteúdo aqui..."}),pW,ER,SR,TR,kR.configure({types:["heading","paragraph"]})],content:((R=(D=(j=t.data)==null?void 0:j.steps)==null?void 0:D[i])==null?void 0:R.data)||"",editable:!0,onUpdate:({editor:H})=>{l(X=>({...X,[i]:H.getHTML()}))}},[i,t.data]);T.useEffect(()=>{(async()=>{if(t.completedBy)try{const X=await vt.getUserById(t.completedBy);g({name:X.name,photoURL:X.profileImage})}catch(X){console.error("Error fetching user:",X),g({name:"Unknown User",photoURL:mr(null)})}})()},[t.completedBy]);const A=H=>{l(X=>({...X,[i]:H.target.value}))},P=H=>{l(X=>({...X,[i]:H.target.value}))},M=async H=>{const X=Array.from(H.target.files||[]);if(X.length!==0){d(!0),p(null);try{const ge=X.map(ae=>nt.uploadTaskAttachment(r,ae)),Ie=await Promise.all(ge);v(ae=>({...ae,[i]:[...ae[i]||[],...Ie]}))}catch(ge){p(ge.message||"Failed to upload file.")}finally{d(!1)}}},N=()=>{var H,X,ge,Ie,ae;if(i<(((X=(H=t.data)==null?void 0:H.steps)==null?void 0:X.length)??0)-1)o(i+1),E==null||E.commands.setContent(((ae=(Ie=(ge=t.data)==null?void 0:ge.steps)==null?void 0:Ie[i+1])==null?void 0:ae.data)||"");else{let oe={...a};t.type==="info"&&(oe={...oe,attachments:w[i]||[]}),e(t.id,oe)}},S=()=>{var H,X,ge;i>0&&(o(i-1),E==null||E.commands.setContent(((ge=(X=(H=t.data)==null?void 0:H.steps)==null?void 0:X[i-1])==null?void 0:ge.data)||""))};T.useEffect(()=>()=>{E==null||E.destroy()},[E]);const C=(k=t.data)!=null&&k.steps?t.data.steps[i]:null;return s?YN.createPortal(c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-4xl mx-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h2",{className:"text-xl font-semibold",children:[t.title," - Etapa ",i+1," de ",((O=(z=t.data)==null?void 0:z.steps)==null?void 0:O.length)||1]}),c.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsx("p",{className:"text-gray-600 text-sm mb-4",children:C==null?void 0:C.description}),f&&c.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:f}),c.jsx("div",{children:C?c.jsxs(c.Fragment,{children:[C.type==="text"&&c.jsx("input",{type:"text",placeholder:"Digite o texto...",value:a[i]||"",onChange:A,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),C.type==="long_text"&&c.jsx("textarea",{placeholder:"Digite o texto longo...",value:a[i]||"",onChange:H=>l(X=>({...X,[i]:H.target.value})),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 h-32 text-gray-900"}),C.type==="file_upload"&&c.jsxs("div",{children:[c.jsx("input",{type:"file",onChange:M,disabled:u,ref:_}),((W=a[i])==null?void 0:W.fileUrl)&&c.jsx("a",{href:a[i].fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Ver Arquivo"}),u&&c.jsx("span",{children:"Uploading..."})]}),C.type==="approval"&&c.jsx("div",{children:c.jsx("p",{children:"Aguardando aprovação..."})}),C.type==="date"&&c.jsx("input",{type:"date",value:a[i]||"",onChange:P,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300"}),C.type==="document"&&c.jsxs(c.Fragment,{children:[c.jsx(mW,{editor:E}),c.jsx("div",{className:"tiptap-editor-styles max-h-screen overflow-y-auto",children:c.jsx(RH,{editor:E})})]}),C.type==="info"&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold",children:C.infoTitle}),c.jsx("p",{className:"text-gray-600",children:C.infoDescription}),C.hasAttachments&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload de Arquivos"}),c.jsx("input",{type:"file",multiple:!0,onChange:M,disabled:u,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300"})]}),u&&c.jsx("p",{children:"Uploading..."}),w[i]&&w[i].length>0&&c.jsxs("div",{className:"mt-4",children:[c.jsx("h4",{className:"font-semibold",children:"Arquivos Enviados:"}),c.jsx("ul",{className:"mt-2",children:w[i].map((H,X)=>c.jsxs("li",{className:"flex items-center mb-2",children:[c.jsx(Fs,{className:"mr-2",size:16}),c.jsx("a",{href:H,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline mr-2",children:H.split("/").pop()}),c.jsx("a",{href:H,download:!0,className:"text-gray-600 hover:text-gray-800",children:c.jsx(Vf,{size:16})})]},X))})]}),((Z=C.data)==null?void 0:Z.fileURLs)&&C.data.fileURLs.length>0&&c.jsxs("div",{className:"mt-2",children:[c.jsx("h4",{className:"font-semibold",children:"Arquivos para Download:"}),c.jsx("ul",{className:"flex flex-wrap",children:C.data.fileURLs.map((H,X)=>c.jsx("li",{className:"mr-4",children:c.jsxs("a",{href:H,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center",children:[c.jsx(Fs,{className:"mr-1",size:16}),"Arquivo ",X+1,c.jsx(Vf,{className:"ml-1",size:14})]})},X))})]})]})]})]}):c.jsx("p",{children:"Nenhum dado para esta etapa."})}),t.completed&&m&&c.jsxs("div",{className:"mt-4 flex items-center",children:[c.jsx("img",{src:m.photoURL||mr(m.name),alt:m.name,className:"w-8 h-8 rounded-full mr-2"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Completado por ",m.name]})]}),c.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[c.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"Cancelar"}),i>0&&c.jsxs("button",{onClick:S,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:[c.jsx(aa,{size:16})," Anterior"]}),c.jsxs("button",{onClick:N,disabled:u,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:[u?"Uploading...":i===(((V=(B=t.data)==null?void 0:B.steps)==null?void 0:V.length)??1)-1?"Completar Ação":"Próximo",i<(((F=($=t.data)==null?void 0:$.steps)==null?void 0:F.length)??1)-1&&c.jsx(la,{size:16})]})]})]})}),document.body):null};var qh={linear:function(t,e,n,r){var s=n-e;return s*t/r+e},easeInQuad:function(t,e,n,r){var s=n-e;return s*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){var s=n-e;return-s*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){var s=n-e;return(t/=r/2)<1?s/2*t*t+e:-s/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){var s=n-e;return s*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){var s=n-e;return s*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){var s=n-e;return(t/=r/2)<1?s/2*t*t*t+e:s/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){var s=n-e;return s*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){var s=n-e;return-s*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){var s=n-e;return(t/=r/2)<1?s/2*t*t*t*t+e:-s/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){var s=n-e;return s*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){var s=n-e;return s*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){var s=n-e;return(t/=r/2)<1?s/2*t*t*t*t*t+e:s/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){var s=n-e;return-s*Math.cos(t/r*(Math.PI/2))+s+e},easeOutSine:function(t,e,n,r){var s=n-e;return s*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){var s=n-e;return-s/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){var s=n-e;return t==0?e:s*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){var s=n-e;return t==r?e+s:s*(-Math.pow(2,-10*t/r)+1)+e},easeInOutExpo:function(t,e,n,r){var s=n-e;return t===0?e:t===r?e+s:(t/=r/2)<1?s/2*Math.pow(2,10*(t-1))+e:s/2*(-Math.pow(2,-10*--t)+2)+e},easeInCirc:function(t,e,n,r){var s=n-e;return-s*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){var s=n-e;return s*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){var s=n-e;return(t/=r/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+e:s/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r){var s=n-e,i,o,a;return a=1.70158,o=0,i=s,t===0?e:(t/=r)===1?e+s:(o||(o=r*.3),i<Math.abs(s)?(i=s,a=o/4):a=o/(2*Math.PI)*Math.asin(s/i),-(i*Math.pow(2,10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/o))+e)},easeOutElastic:function(t,e,n,r){var s=n-e,i,o,a;return a=1.70158,o=0,i=s,t===0?e:(t/=r)===1?e+s:(o||(o=r*.3),i<Math.abs(s)?(i=s,a=o/4):a=o/(2*Math.PI)*Math.asin(s/i),i*Math.pow(2,-10*t)*Math.sin((t*r-a)*(2*Math.PI)/o)+s+e)},easeInOutElastic:function(t,e,n,r){var s=n-e,i,o,a;return a=1.70158,o=0,i=s,t===0?e:(t/=r/2)===2?e+s:(o||(o=r*(.3*1.5)),i<Math.abs(s)?(i=s,a=o/4):a=o/(2*Math.PI)*Math.asin(s/i),t<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/o))+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/o)*.5+s+e)},easeInBack:function(t,e,n,r,s){var i=n-e;return s===void 0&&(s=1.70158),i*(t/=r)*t*((s+1)*t-s)+e},easeOutBack:function(t,e,n,r,s){var i=n-e;return s===void 0&&(s=1.70158),i*((t=t/r-1)*t*((s+1)*t+s)+1)+e},easeInOutBack:function(t,e,n,r,s){var i=n-e;return s===void 0&&(s=1.70158),(t/=r/2)<1?i/2*(t*t*(((s*=1.525)+1)*t-s))+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e},easeInBounce:function(t,e,n,r){var s=n-e,i;return i=qh.easeOutBounce(r-t,0,s,r),s-i+e},easeOutBounce:function(t,e,n,r){var s=n-e;return(t/=r)<1/2.75?s*(7.5625*t*t)+e:t<2/2.75?s*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?s*(7.5625*(t-=2.25/2.75)*t+.9375)+e:s*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,r){var s=n-e,i;return t<r/2?(i=qh.easeInBounce(t*2,0,s,r),i*.5+e):(i=qh.easeOutBounce(t*2-r,0,s,r),i*.5+s*.5+e)}},yW=qh;function xW(t){return t*Math.PI/180}function Bn(t,e){return t+Math.random()*(e-t)}function vW(t,e){return Math.floor(t+Math.random()*(e-t+1))}var ru;(function(t){t[t.Circle=0]="Circle",t[t.Square=1]="Square",t[t.Strip=2]="Strip"})(ru||(ru={}));var ri;(function(t){t[t.Positive=1]="Positive",t[t.Negative=-1]="Negative"})(ri||(ri={}));class wW{constructor(e,n,r,s){this.getOptions=n;const{colors:i,initialVelocityX:o,initialVelocityY:a}=this.getOptions();this.context=e,this.x=r,this.y=s,this.w=Bn(5,20),this.h=Bn(5,20),this.radius=Bn(5,10),this.vx=typeof o=="number"?Bn(-o,o):Bn(o.min,o.max),this.vy=typeof a=="number"?Bn(-a,0):Bn(a.min,a.max),this.shape=vW(0,2),this.angle=xW(Bn(0,360)),this.angularSpin=Bn(-.2,.2),this.color=i[Math.floor(Math.random()*i.length)],this.rotateY=Bn(0,1),this.rotationDirection=Bn(0,1)?ri.Positive:ri.Negative}update(){const{gravity:e,wind:n,friction:r,opacity:s,drawShape:i}=this.getOptions();this.x+=this.vx,this.y+=this.vy,this.vy+=e,this.vx+=n,this.vx*=r,this.vy*=r,this.rotateY>=1&&this.rotationDirection===ri.Positive?this.rotationDirection=ri.Negative:this.rotateY<=-1&&this.rotationDirection===ri.Negative&&(this.rotationDirection=ri.Positive);const o=.1*this.rotationDirection;if(this.rotateY+=o,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=s,this.context.lineCap="round",this.context.lineWidth=2,i&&typeof i=="function")i.call(this,this.context);else switch(this.shape){case ru.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case ru.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case ru.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class bW{constructor(e,n){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenInitTime=Date.now(),this.particles=[],this.particlesGenerated=0,this.removeParticleAt=s=>{this.particles.splice(s,1)},this.getParticle=()=>{const s=Bn(this.x,this.w+this.x),i=Bn(this.y,this.h+this.y);return new wW(this.context,this.getOptions,s,i)},this.animate=()=>{const{canvas:s,context:i,particlesGenerated:o,lastNumberOfPieces:a}=this,{run:l,recycle:u,numberOfPieces:d,debug:f,tweenFunction:p,tweenDuration:m}=this.getOptions();if(!l)return!1;const g=this.particles.length,x=u?g:o,w=Date.now();if(x<d){a!==d&&(this.tweenInitTime=w,this.lastNumberOfPieces=d);const{tweenInitTime:v}=this,_=w-v>m?m:Math.max(0,w-v),E=p(_,x,d,m),A=Math.round(E-x);for(let P=0;P<A;P++)this.particles.push(this.getParticle());this.particlesGenerated+=A}return f&&(i.font="12px sans-serif",i.fillStyle="#333",i.textAlign="right",i.fillText(`Particles: ${g}`,s.width-10,s.height-20)),this.particles.forEach((v,_)=>{v.update(),(v.y>s.height||v.y<-100||v.x>s.width+100||v.x<-100)&&(u&&x<=d?this.particles[_]=this.getParticle():this.removeParticleAt(_))}),g>0||x<d},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.getOptions=n}}const bb={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:yW.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class _W{constructor(e,n){this.lastFrameTime=Date.now(),this.setOptionsWithDefaults=s=>{const i={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...i,...bb,...s},Object.assign(this,s.confettiSource)},this.update=()=>{const{options:{run:s,onConfettiComplete:i,frameRate:o},canvas:a,context:l}=this;if(o){const u=Date.now(),d=u-this.lastFrameTime;if(d<1e3/o){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=u-d%o}s&&(l.fillStyle="white",l.clearRect(0,0,a.width,a.height)),this.generator.animate()?this.rafId=requestAnimationFrame(this.update):(i&&typeof i=="function"&&this.generator.particlesGenerated>0&&i.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.generator=new bW(this.canvas,()=>this.options),this.options=n,this.update()}get options(){return this._options}set options(e){var s,i;const n=(s=this._options)==null?void 0:s.run,r=(i=this._options)==null?void 0:i.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&r===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&n===!1&&this.update()}}const EW=pt.createRef();class _b extends pt.Component{constructor(e){super(e),this.canvas=pt.createRef(),this.canvas=e.canvasRef||EW}componentDidMount(){if(this.canvas.current){const e=_y(this.props)[0];this.confetti=new _W(this.canvas.current,e)}}componentDidUpdate(){const e=_y(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,n]=_y(this.props),r={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...n.style};return c.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...n,style:r})}}_b.defaultProps={...bb};_b.displayName="ReactConfetti";function _y(t){const e={},n={},r={},s=[...Object.keys(bb),"confettiSource","drawShape","onConfettiComplete","frameRate"],i=["canvasRef"];for(const o in t){const a=t[o];s.includes(o)?e[o]=a:i.includes(o)?i[o]=a:r[o]=a}return[e,r,n]}const SW=pt.forwardRef((t,e)=>c.jsx(_b,{canvasRef:e,...t})),TW=`
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }
`,Ex=({attachment:t,color:e="text-gray-600"})=>{const n=()=>{switch(t.type){case"image":return c.jsx(km,{size:16,className:e});case"video":return c.jsx(Vw,{size:16,className:e});case"document":return c.jsx(Tm,{size:16,className:e});case"audio":return c.jsx(Lw,{size:16,className:e});default:return c.jsx(Fs,{size:16,className:e})}};return c.jsxs(c.Fragment,{children:[n(),c.jsx("a",{href:t.url,download:t.name,className:"ml-2 text-sm text-gray-700 hover:underline truncate flex-grow",style:{maxWidth:"150px"},children:t.name}),c.jsx("a",{href:t.url,download:t.name,className:"ml-2 px-2 py-1 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors flex items-center",children:c.jsx(Vf,{size:14})})]})},kW=()=>{var Z,B,V,$,F,H,X,ge,Ie;const{taskId:t}=Pl(),e=mn(),[n,r]=T.useState(null),[s,i]=T.useState(null),[o,a]=T.useState({}),[l,u]=T.useState(!0),[d,f]=T.useState(null),[p,m]=T.useState(null),[g,x]=T.useState(!1),[w,v]=T.useState(!1),[_,E]=T.useState(!1),{currentUser:A}=tn(),[P,M]=T.useState(!1);T.useEffect(()=>{(async()=>{u(!0),f(null);try{if(!t)throw new Error("O ID da tarefa é obrigatório.");const oe=await nt.getTaskById(t);r(oe);const Te=await Je.getProjectById(oe.projectId);i({name:Te.name});const we=[...oe.assignedTo,oe.createdBy],$e=Array.from(new Set(we)).filter(Boolean),ct=(await vt.fetchUsers({userIds:$e})).data.reduce((Ut,rs)=>(Ut[rs.id]={name:rs.name,profileImage:rs.profileImage},Ut),{});a(ct)}catch(oe){f(oe.message||"Falha ao carregar a tarefa.")}finally{u(!1)}})()},[t]);const N=async(ae,oe)=>{try{await nt.completeTaskAction(t,ae,oe);const Te=await nt.getTaskById(t);r({...Te}),m(null),M(!1)}catch(Te){console.error("Error completing action:",Te)}},S=async ae=>{try{await nt.uncompleteTaskAction(t,ae);const oe=await nt.getTaskById(t);r({...oe})}catch(oe){console.error("Error uncompleting action:",oe)}},C=async()=>{var ae;try{const oe=await nt.updateTask(t,{status:"waiting_approval"});r(oe),oe&&await Je.addSystemMessageToProjectChat(oe.projectId,{userId:"system",userName:"Sistema",content:`A tarefa "${oe.title}" foi enviada para aprovação por ${((ae=o[oe.assignedTo])==null?void 0:ae.name)||"Usuário Desconhecido"}.`,timestamp:Date.now(),messageType:"task_submission",quotedMessage:{userName:"Sistema",content:`Tarefa: ${oe.title} - [Ver Tarefa](/tasks/${oe.id})`}})}catch(oe){console.error("Error submitting for approval:",oe),f("Failed to submit the task for approval.")}},j=async()=>{var ae;try{const oe=await nt.updateTask(t,{status:"completed"});if(r(oe),x(!0),v(!0),setTimeout(()=>{x(!1),E(!0),setTimeout(()=>v(!1),1e3)},4e3),oe){const we=(await Je.getProjectMessages(oe.projectId)).find($e=>{var He;return $e.messageType==="task_submission"&&((He=$e.quotedMessage)==null?void 0:He.content.includes(`/tasks/${oe.id}`))});if(we){const $e=new Date(we.timestamp).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),He=new Date().toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),ct=`A tarefa "${oe.title}" foi enviada para aprovação por ${((ae=o[oe.assignedTo])==null?void 0:ae.name)||"Usuário Desconhecido"} no dia ${$e}, e aprovada por ${(A==null?void 0:A.displayName)||"Administrador"} no dia ${He}.`;await Je.addSystemMessageToProjectChat(oe.projectId,{userId:"system",userName:"Sistema",content:ct,timestamp:Date.now(),messageType:"task_approval",originalMessageId:we.id,quotedMessage:{userName:"Sistema",content:`Tarefa: ${oe.title} - [Ver Tarefa](/tasks/${oe.id})`}})}else console.warn("Could not find original submission message to update.")}}catch(oe){console.error("Error completing task:",oe),f("Failed to complete the task.")}},D=async()=>{try{await nt.updateTask(t,{status:"pending"});const ae=await nt.getTaskById(t);r(ae)}catch(ae){console.error("Error reverting task to pending:",ae),f("Failed to revert task to pending.")}};if(l)return c.jsx(Re,{role:(A==null?void 0:A.role)||"employee",isLoading:!0,children:c.jsx("div",{className:"flex items-center justify-center h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})});if(d)return c.jsx(Re,{role:(A==null?void 0:A.role)||"employee",children:c.jsxs("div",{className:"p-4 bg-red-100 text-red-700 border border-red-400 rounded flex items-center",children:[c.jsx(en,{className:"mr-2",size:20}),d]})});if(!n)return c.jsx(Re,{role:(A==null?void 0:A.role)||"employee",children:c.jsxs("div",{className:"p-4 bg-yellow-100 text-yellow-700 border border-yellow-400 rounded flex items-center",children:[c.jsx(en,{className:"mr-2",size:20}),"Tarefa não encontrada."]})});const R=((Z=n.actions)==null?void 0:Z.filter(ae=>ae.completed).length)??0,k=((B=n.actions)==null?void 0:B.length)??0,z=k>0?R/k*100:0,O=ae=>new Date(ae).toLocaleDateString("pt-BR"),W=((V=n.actions)==null?void 0:V.length)>0&&n.actions.every(ae=>ae.completed);return c.jsxs(Re,{role:(A==null?void 0:A.role)||"employee",children:[c.jsx("style",{children:TW}),c.jsxs("div",{className:"container mx-auto p-6",children:[w&&c.jsx(SW,{onConfettiComplete:()=>E(!1),className:_?"fade-out-confetti":""}),c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("button",{onClick:()=>e(-1),className:"text-gray-600 hover:text-blue-600",children:c.jsx(ks,{size:24})}),c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n.title}),c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${n.status==="completed"?"bg-green-100 text-green-800":n.status==="waiting_approval"?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800"} ${g?"animate-pulse":""}`,children:n.status==="completed"?"Concluída":n.status==="waiting_approval"?"Aguardando Aprovação":"Pendente"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data de Vencimento"}),c.jsx("p",{className:"text-gray-900",children:O(n.dueDate)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Responsável"}),c.jsx("div",{className:"flex items-center mt-1",children:n.assignedTo?c.jsxs("div",{className:"relative w-8 h-8 rounded-full overflow-hidden mr-2",children:[c.jsx("img",{src:(($=o[n.assignedTo])==null?void 0:$.profileImage)||mr(((F=o[n.assignedTo])==null?void 0:F.name)||null),alt:((H=o[n.assignedTo])==null?void 0:H.name)||"Usuário Desconhecido",className:"object-cover w-full h-full"}),c.jsx("span",{children:((X=o[n.assignedTo])==null?void 0:X.name)||"Usuário Desconhecido"})]}):c.jsx("span",{className:"text-gray-500",children:"Nenhum responsável atribuído"})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Projeto"}),c.jsx("p",{className:"text-gray-900",children:c.jsx(De,{to:`/admin/projects/${n.projectId}`,className:"text-blue-600 hover:underline",children:(s==null?void 0:s.name)||"Projeto Desconhecido"})})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:c.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${z.toFixed(0)}%`}})}),c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:["Progresso: ",z.toFixed(0),"%"]}),c.jsxs("span",{children:["Recompensa: ",n.coinsReward]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Descrição"}),c.jsx("p",{className:"text-gray-600",children:n.description})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Ações"}),c.jsxs("div",{className:"space-y-4",children:[(ge=n.actions)==null?void 0:ge.map(ae=>c.jsxs("div",{className:"border rounded-lg p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:ae.title}),ae.type==="info"&&c.jsxs(c.Fragment,{children:[c.jsx("h5",{className:"text-md font-semibold",children:ae.infoTitle}),c.jsx("p",{className:"text-gray-600",children:ae.infoDescription}),ae.hasAttachments&&c.jsx("p",{className:"text-sm text-gray-500",children:"Arquivos Obrigatórios"})]})]}),c.jsx("div",{children:n.status!=="waiting_approval"&&n.status!=="completed"&&c.jsx(c.Fragment,{children:ae.completed?c.jsx("button",{onClick:()=>S(ae.id),className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition",children:"Desfazer"}):c.jsx("button",{onClick:()=>{m(ae),M(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Completar"})})})]},ae.id)),((Ie=n.actions)==null?void 0:Ie.length)===0&&c.jsx("p",{className:"text-gray-500",children:"Nenhuma ação definida para esta tarefa."})]})]}),n.attachments&&n.attachments.length>0&&c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Anexos"}),c.jsx("div",{className:"flex gap-2",children:n.attachments.map((ae,oe)=>c.jsx(Ex,{attachment:{id:oe.toString(),name:ae.substring(ae.lastIndexOf("/")+1),url:ae,type:"other"}},oe))})]}),W&&n.status!=="waiting_approval"&&n.status!=="completed"&&c.jsxs("button",{onClick:C,className:"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center",children:[c.jsx(Xe,{className:"mr-2"}),"Enviar para Aprovação"]}),(A==null?void 0:A.role)==="admin"&&n.status==="waiting_approval"&&c.jsxs("button",{onClick:j,className:"w-full py-2 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition flex items-center justify-center",children:[c.jsx(Xe,{className:"mr-2"}),"Aprovar Tarefa (",n.coinsReward," Moedas)"]}),(A==null?void 0:A.role)==="admin"&&n.status==="waiting_approval"&&c.jsxs("button",{onClick:D,className:"w-full py-2 px-4 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition flex items-center justify-center mt-2",children:[c.jsx(tB,{className:"mr-2"}),"Voltar para Pendente"]}),p&&c.jsx(gW,{action:p,onComplete:N,onCancel:()=>{m(null),M(!1)},taskId:t,isOpen:P})]})]})]})};class NW{constructor(){zn(this,"db",Zi());zn(this,"templatesCollection",wn(this.db,"actionTemplates"))}async createActionTemplate(e){try{const n=ye(this.templatesCollection),r={id:n.id,...e,order:Date.now()};return await Vs(n,r),r}catch(n){throw console.error("Error creating action template:",n),n}}async getActionTemplateById(e){try{const n=ye(this.db,"actionTemplates",e),r=await st(n);return r.exists()?{id:r.id,...r.data()}:null}catch(n){throw console.error("Error getting action template:",n),n}}async updateActionTemplate(e,n){try{const r=ye(this.db,"actionTemplates",e);await Wt(r,n)}catch(r){throw console.error("Error updating action template:",r),r}}async deleteActionTemplate(e){try{const n=ye(this.db,"actionTemplates",e);await Sm(n)}catch(n){throw console.error("Error deleting action template:",n),n}}async fetchActionTemplates(){try{const e=it(this.templatesCollection,Fl("order","asc"));return(await Ts(e)).docs.map(r=>({id:r.id,...r.data()}))}catch(e){throw console.error("Error fetching action templates:",e),e}}async updateTemplateOrder(e){const n=q0(this.db);e.forEach((r,s)=>{const i=ye(this.db,"actionTemplates",r.id);n.update(i,{order:s})});try{await n.commit()}catch(r){throw console.error("Error updating template order:",r),r}}}const Hn=new NW,gd=({isOpen:t,onClose:e,onConfirm:n,itemName:r,warningMessage:s="Esta ação não pode ser desfeita."})=>{const[i,o]=T.useState(!1),[a,l]=T.useState(null),u=async()=>{o(!0),l(null);try{await n(),e()}catch(d){l(d.message||"Erro ao excluir o item")}finally{o(!1)}};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center text-red-600",children:[c.jsx(en,{className:"mr-2"}),"Confirmar Exclusão"]}),c.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("p",{className:"text-gray-700",children:["Tem certeza que deseja excluir ",c.jsx("strong",{children:r}),"?"]}),c.jsx("p",{className:"text-sm text-red-500",children:s}),a&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center",children:[c.jsx(en,{className:"mr-2"}),a]}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsx("button",{onClick:e,className:"w-full py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition",children:"Cancelar"}),c.jsx("button",{onClick:u,disabled:i,className:`w-full py-2 rounded-lg text-white transition flex items-center justify-center
                ${i?"bg-red-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:i?"Excluindo...":c.jsxs(c.Fragment,{children:[c.jsx(ns,{className:"mr-2"})," Excluir"]})})]})]})]})}):null},CW=t=>{switch(t){case"text":return c.jsx(hB,{size:16});case"long_text":return c.jsx(Tm,{size:16});case"file_upload":return c.jsx(Fs,{size:16});case"date":return c.jsx(gA,{size:16});case"document":return c.jsx(pA,{size:16});case"info":return c.jsx(mA,{size:16});default:return null}},IW=({isOpen:t,onClose:e,templates:n,onDelete:r,onReorder:s})=>{var p;const[i,o]=T.useState(!1),[a,l]=T.useState(null),[u,d]=T.useState(n);T.useEffect(()=>{d(n)},[n]);const f=(m,g)=>{const x=[...u],[w]=x.splice(m,1);x.splice(g,0,w),d(x),s(x)};return t?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96 max-h-[80vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Gerenciar Modelos"}),c.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:c.jsx(mB,{size:24})})]}),c.jsx("ul",{children:u.map((m,g)=>c.jsxs("li",{className:"flex items-center justify-between py-2 border-b last:border-b-0",children:[c.jsx("span",{children:m.title}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>f(g,g-1),disabled:g===0,className:"text-gray-500 hover:text-blue-600 disabled:opacity-50",title:"Mover para cima",children:c.jsx(Jz,{size:20})}),c.jsx("button",{onClick:()=>f(g,g+1),disabled:g===u.length-1,className:"text-gray-500 hover:text-blue-600 disabled:opacity-50",title:"Mover para baixo",children:c.jsx(Qz,{size:20})}),c.jsx("button",{onClick:()=>{l(m.id),o(!0)},className:"text-red-500 hover:text-red-700",title:"Excluir",children:c.jsx(ns,{size:20})})]})]},m.id))})]})}),c.jsx(gd,{isOpen:i,onClose:()=>{o(!1),l(null)},onConfirm:async()=>{a&&(await r(a),o(!1),l(null))},itemName:a&&((p=n.find(m=>m.id===a))==null?void 0:p.title)||"este modelo",warningMessage:"Esta ação não poderá ser desfeita."})]}):null},AW=()=>{var B;const[t,e]=T.useState(""),[n,r]=T.useState(1),[s,i]=T.useState(1),[o,a]=T.useState({}),[l,u]=T.useState(!1),[d,f]=T.useState(null),[p,m]=T.useState(!1),[g,x]=T.useState([]),[w,v]=T.useState(""),[_,E]=T.useState(!1),[A,P]=T.useState(null),[M,N]=T.useState(null),S=iR({extensions:[uR,wR,bR,_R.configure({placeholder:"Digite o conteúdo aqui..."}),ER,SR,TR,kR.configure({types:["heading","paragraph"]})],content:"",editable:!0,onUpdate:({editor:V})=>{}}),C=T.useCallback(async()=>{try{const V=await Hn.fetchActionTemplates();x(V)}catch(V){console.error("Error fetching templates:",V),f("Failed to load templates.")}},[]);T.useEffect(()=>{C()},[C]),T.useEffect(()=>{(async()=>{if(w)try{const $=await Hn.getActionTemplateById(w);if($){e($.title),N($.id);const F={};let H=1,X=[];for(const ge of $.elements)X.push(ge),(ge.type==="document"||ge.type==="approval")&&(F[H]=X,H++,X=[]);X.length>0&&(F[H]=X),a(F),r(Object.keys(F).length),i(1)}}catch($){console.error("Error loading template:",$),f("Failed to load the selected template.")}else e(""),a({}),r(1),i(1),N(null)})()},[w,S]);const j=V=>{a($=>{const F=$[s]||[];let H;return V==="info"?H={id:Date.now().toString(),type:V,title:"",completed:!1,description:"",infoTitle:"",infoDescription:"",hasAttachments:!1,data:{}}:H={id:Date.now().toString(),type:V,title:"",completed:!1,description:""},{...$,[s]:[...F,H]}})},D=V=>{a($=>{const H=($[s]||[]).filter(X=>X.id!==V);return{...$,[s]:H}})},R=(V,$,F)=>{a(H=>{const ge=(H[s]||[]).map(Ie=>Ie.id===V?{...Ie,[$]:F}:Ie);return{...H,[s]:ge}})},k=V=>{const $=parseInt(V.target.value,10);r(isNaN($)||$<1?1:$)},z=async V=>{V.preventDefault(),u(!0),f(null),m(!1);try{const $=[];for(let H=1;H<=n;H++)if(o[H]){const X=o[H].map(ge=>{const Ie={...ge,completed:!1};if(ge.type==="info"){const{completed:Te,completedAt:we,completedBy:$e,attachments:He,...ct}=Ie;return{...ct,completed:!1}}const{data:ae,...oe}=Ie;return ae===void 0?oe:Ie});$.push(...X)}const F={title:t,type:"custom",elements:$,order:Date.now()};if(A==="replace"&&M)await Hn.updateActionTemplate(M,F),m(!0);else{if((await Hn.fetchActionTemplates()).some(X=>X.title===t)){f("Já existe um modelo com este título. Por favor, escolha um título diferente."),u(!1);return}await Hn.createActionTemplate(F),m(!0),e(""),a({}),r(1),i(1),v("")}await C()}catch($){f($.message||"Falha ao criar modelo de ação")}finally{u(!1),P(null)}},O=async V=>{try{await Hn.deleteActionTemplate(V),await C()}catch($){console.error("Error deleting template:",$),f("Failed to delete the template.")}},W=async V=>{try{x(V),await Hn.updateTemplateOrder(V)}catch($){console.error("Error reordering templates:",$),f("Failed to reorder templates.")}};T.useEffect(()=>{a(V=>{const $={...V};for(let F=1;F<=n;F++)$[F]||($[F]=[]);return Object.keys($).forEach(F=>{const H=parseInt(F,10);H>n&&delete $[H]}),$}),s>n&&i(n)},[n]);const Z=()=>{var V;if(!t.trim())return!1;for(let $=1;$<=n;$++){const F=o[$]||[];for(const H of F)if(!H.title.trim()||!((V=H.description)!=null&&V.trim()))return!1}return!0};return c.jsxs(Re,{role:"admin",children:[c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:[c.jsx(cB,{className:"mr-3 text-blue-600"}),"Criar Modelo de Ação"]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("select",{value:w,onChange:V=>v(V.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Selecione um Modelo"}),g.map(V=>c.jsx("option",{value:V.id,children:V.title},V.id))]}),c.jsx("button",{onClick:()=>E(!0),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Gerenciar Modelos",children:c.jsx(Ns,{size:20})})]})]}),d&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[c.jsx("strong",{className:"font-bold",children:"Erro: "}),c.jsxs("span",{className:"block sm:inline",children:[" ",d]})]}),p&&c.jsxs("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[c.jsx("strong",{className:"font-bold",children:"Sucesso! "}),c.jsx("span",{className:"block sm:inline",children:" Modelo de ação criado."})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Título do Modelo"}),c.jsx("input",{type:"text",id:"title",value:t,onChange:V=>e(V.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{htmlFor:"numSteps",className:"block text-sm font-medium text-gray-700",children:"Número de Etapas"}),c.jsx("input",{type:"number",id:"numSteps",value:n,onChange:k,min:"1",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-4",children:c.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${s/n*100}%`}})}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold mb-2",children:["Etapa ",s," de ",n]}),c.jsx("div",{className:"space-y-2",children:(B=o[s])==null?void 0:B.map((V,$)=>c.jsxs("div",{className:"border rounded-md p-4 flex items-center",children:[c.jsx("span",{className:"mr-2 text-gray-600",children:CW(V.type)}),c.jsxs("div",{className:"flex-1 mr-2 space-y-2",children:[c.jsx("input",{type:"text",value:V.title,onChange:F=>R(V.id,"title",F.target.value),placeholder:"Título",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsx("textarea",{value:V.description||"",onChange:F=>R(V.id,"description",F.target.value),placeholder:"Descrição",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300  text-gray-900"}),V.type==="info"&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"text",value:V.infoTitle||"",onChange:F=>R(V.id,"infoTitle",F.target.value),placeholder:"Título das Informações Importantes",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsx("textarea",{value:V.infoDescription||"",onChange:F=>R(V.id,"infoDescription",F.target.value),placeholder:"Descrição das Informações Importantes",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:V.hasAttachments||!1,onChange:F=>R(V.id,"hasAttachments",F.target.checked),className:"mr-2"}),"Requer arquivos?"]})]})]}),c.jsx("button",{type:"button",onClick:()=>D(V.id),className:"text-red-500 hover:text-red-700",title:"Remover etapa",children:c.jsx(ns,{size:16})})]},V.id))}),c.jsxs("div",{className:"mt-4 flex space-x-2",children:[c.jsxs("button",{type:"button",onClick:()=>j("text"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Adicionar campo de texto curto",children:[c.jsx(ur,{className:"mr-1",size:16})," Texto"]}),c.jsxs("button",{type:"button",onClick:()=>j("long_text"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Adicionar campo de texto longo",children:[c.jsx(ur,{className:"mr-1",size:16})," Texto Longo"]}),c.jsxs("button",{type:"button",onClick:()=>j("file_upload"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Adicionar upload de arquivo",children:[c.jsx(ur,{className:"mr-1",size:16})," Arquivo"]}),c.jsxs("button",{type:"button",onClick:()=>j("date"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Adicionar seleção de data",children:[c.jsx(ur,{className:"mr-1",size:16})," Data"]}),c.jsxs("button",{type:"button",onClick:()=>j("document"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Adicionar editor de documento",children:[c.jsx(ur,{className:"mr-1",size:16})," Documento"]}),c.jsxs("button",{type:"button",onClick:()=>j("info"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",title:"Adicionar Informações Importantes",children:[c.jsx(ur,{className:"mr-1",size:16})," Informações"]})]})]}),c.jsxs("div",{className:"flex justify-between mt-6",children:[c.jsxs("button",{type:"button",onClick:()=>i(Math.max(1,s-1)),disabled:s===1,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50 flex items-center",children:[c.jsx(aa,{size:16,className:"mr-1"})," Anterior"]}),c.jsxs("button",{type:"button",onClick:()=>i(Math.min(n,s+1)),disabled:s===n,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50 flex items-center",children:["Próximo ",c.jsx(la,{size:16,className:"ml-1"})]})]})]}),c.jsx("div",{className:"mt-4",children:M?c.jsxs(c.Fragment,{children:[c.jsxs("button",{type:"button",onClick:()=>P("replace"),disabled:l||!Z(),className:"w-full px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 disabled:opacity-50 flex items-center justify-center mb-2",children:[l?"Salvando...":"Substituir Modelo Existente",c.jsx(Wc,{className:"ml-2"})]}),c.jsxs("button",{type:"button",onClick:()=>P("new"),disabled:l||!Z(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center",children:[l?"Salvando...":"Salvar como Novo Modelo",c.jsx(Wc,{className:"ml-2"})]})]}):c.jsxs("button",{type:"submit",onClick:z,disabled:l||!Z(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center",children:[l?"Salvando...":"Salvar Modelo",c.jsx(Wc,{className:"ml-2"})]})})]}),c.jsx(IW,{isOpen:_,onClose:()=>E(!1),templates:g,onDelete:O,onReorder:W}),A&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[c.jsx("p",{className:"mb-4",children:A==="replace"?"Tem certeza que deseja substituir o modelo existente?":"Criar um novo modelo com este título irá sobrescrever qualquer modelo existente com o mesmo nome. Deseja continuar?"}),c.jsxs("div",{className:"flex justify-end space-x-4",children:[c.jsx("button",{onClick:()=>P(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"Cancelar"}),c.jsx("button",{onClick:z,className:`px-4 py-2 text-white rounded ${A==="replace"?"bg-yellow-500 hover:bg-yellow-600":"bg-blue-600 hover:bg-blue-700"}`,children:A==="replace"?"Substituir":"Criar Novo"})]})]})})]})},jW=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState(null);T.useEffect(()=>{(async()=>{r(!0),i(null);try{const l=await Hn.fetchActionTemplates();e(l)}catch(l){i(l.message||"Failed to fetch action templates")}finally{r(!1)}})()},[]);const o=async a=>{if(window.confirm("Are you sure you want to delete this template?"))try{await Hn.deleteActionTemplate(a),e(l=>l.filter(u=>u.id!==a))}catch(l){console.error("Error deleting template:",l)}};return c.jsx(Re,{role:"admin",isLoading:n,children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Action Template Management"}),c.jsxs(De,{to:"/admin/action-templates/create",className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-blue-700 transition",children:[c.jsx(ur,{className:"mr-2"})," Create Template"]})]}),s&&c.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:s}),n?c.jsx("div",{children:"Loading..."}):t.length===0?c.jsx("div",{className:"bg-white rounded-xl shadow-md p-6",children:c.jsx("p",{className:"text-gray-500",children:"No action templates found."})}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(a=>c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:a.title}),c.jsxs("p",{className:"text-gray-600 mb-4",children:["Type: ",a.type]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(De,{to:`/admin/action-templates/edit/${a.id}`,className:"text-blue-500 hover:text-blue-700",children:c.jsx(Ao,{size:20})}),c.jsx("button",{onClick:()=>o(a.id),className:"text-red-500 hover:text-red-700",children:c.jsx(ns,{size:20})})]})]},a.id))})]})})},RW=({name:t,role:e,profileImage:n,coverPhoto:r,userId:s})=>{const i=T.useRef(null),[o,a]=T.useState(!1),[l,u]=T.useState(null),d=async f=>{var m;const p=(m=f.target.files)==null?void 0:m[0];if(p){if(!qn.isValidFileType(p,["image/jpeg","image/png"])){u("Invalid file type. Please upload a JPEG or PNG image.");return}if(!qn.isValidFileSize(p,5)){u("File is too large. Maximum size is 5MB.");return}a(!0),u(null);try{const g=yl(xl,`users/${s}/coverPhoto`);await ml(g,p);const x=await gl(g);await vt.updateUser(s,{coverImage:x})}catch(g){u(g.message||"Failed to upload cover photo.")}finally{a(!1)}}};return c.jsxs("div",{className:"relative w-full",children:[c.jsxs("div",{className:"w-full h-64 bg-cover bg-center rounded-t-xl",style:{backgroundImage:r.startsWith("linear-gradient")?r:`url(${r})`},children:[!r.startsWith("linear-gradient")&&c.jsx("div",{className:"absolute inset-0 bg-black opacity-30 rounded-t-xl"}),c.jsx("input",{type:"file",accept:"image/*",ref:i,onChange:d,className:"hidden"}),c.jsx("button",{onClick:()=>{var f;return(f=i.current)==null?void 0:f.click()},className:"absolute top-4 right-4 bg-white bg-opacity-75 text-gray-700 p-2 rounded-full hover:bg-opacity-100 transition-colors",title:"Change Cover Photo",children:c.jsx(Lf,{size:20})}),o&&c.jsx("div",{className:"absolute top-1/2 right-4 transform -translate-y-1/2",children:c.jsx(qc,{className:"animate-spin text-white",size:20})})]}),c.jsxs("div",{className:"relative px-4 pt-16 pb-4",children:[" ",c.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 -top-16",children:c.jsx("img",{src:n||"https://via.placeholder.com/150",alt:"Profile",className:"w-32 h-32 rounded-full border-4 border-white object-cover"})}),c.jsxs("div",{className:"text-center mt-4",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t}),c.jsx("p",{className:"text-gray-600 capitalize",children:e})]}),c.jsx("div",{className:"absolute top-4 right-4",children:c.jsx(De,{to:"/admin/settings",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-full transition-colors",children:c.jsx(Ns,{size:20})})}),l&&c.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-red-500 text-white px-4 py-2 rounded",children:l})]})]})},PW=()=>{const{userId:t}=Pl(),{currentUser:e}=tn(),n=mn(),[r,s]=T.useState(null),[i,o]=T.useState([]),[a,l]=T.useState([]),[u,d]=T.useState(!0),[f,p]=T.useState(null),[m,g]=T.useState({completedTasks:0,pendingTasks:0,totalProjects:0}),x="linear-gradient(to right, #4c51bf, #6a82fb)";return T.useEffect(()=>{(async()=>{d(!0),p(null);try{if(!t)throw new Error("User ID is required.");const v=await vt.getUserById(t);s(v);const _=await Je.fetchProjects(),E=await nt.fetchTasks(),A=_.data.filter(S=>S.managers.includes(t)||E.data.some(C=>C.projectId===S.id&&C.assignedTo===t));o(A);const P=await nt.fetchTasks({assignedTo:t});l(P.data);const M=P.data.filter(S=>S.status==="completed").length,N=P.data.filter(S=>S.status!=="completed").length;g({completedTasks:M,pendingTasks:N,totalProjects:A.length})}catch(v){p(v.message||"Failed to load user profile."),console.error("Error fetching user profile:",v)}finally{d(!1)}})()},[t]),u?c.jsx(Re,{role:(e==null?void 0:e.role)||"employee",isLoading:!0,children:c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}):f?c.jsx(Re,{role:(e==null?void 0:e.role)||"employee",children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"p-4 bg-red-100 text-red-700 border border-red-400 rounded flex items-center",children:[c.jsx(en,{className:"mr-2",size:20}),f]}),c.jsxs("button",{onClick:()=>n(-1),className:"mt-4 flex items-center text-blue-600 hover:text-blue-800",children:[c.jsx(ks,{size:16,className:"mr-1"})," Voltar"]})]})}):r?(e==null||e.uid,c.jsx(Re,{role:(e==null?void 0:e.role)||"employee",children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:()=>n(-1),className:"flex items-center text-gray-600 hover:text-blue-600 transition-colors",children:[c.jsx(ks,{size:20,className:"mr-1"})," Voltar"]})}),c.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[c.jsx(RW,{name:r.name,role:r.role,profileImage:r.profileImage||mr(r.name),coverPhoto:r.coverImage||x,userId:t||""}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg flex items-center",children:[c.jsx(vl,{className:"text-blue-500 mr-3",size:24}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:r.coins||0}),c.jsx("p",{className:"text-sm text-blue-600",children:"Moedas"})]})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg flex items-center",children:[c.jsx(Xe,{className:"text-green-500 mr-3",size:24}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-green-800",children:m.completedTasks}),c.jsx("p",{className:"text-sm text-green-600",children:"Tarefas Concluídas"})]})]}),c.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg flex items-center",children:[c.jsx($i,{className:"text-purple-500 mr-3",size:24}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-purple-800",children:m.totalProjects}),c.jsx("p",{className:"text-sm text-purple-600",children:"Projetos"})]})]})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4 border-b pb-2",children:"Informações"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Du,{className:"text-gray-500 mr-2",size:18}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Nome:"}),c.jsx("span",{className:"ml-2",children:r.name})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(Nm,{className:"text-gray-500 mr-2",size:18}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Email:"}),c.jsx("span",{className:"ml-2",children:r.email})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(Du,{className:"text-gray-500 mr-2",size:18}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Função:"}),c.jsx("span",{className:"ml-2 capitalize",children:r.role})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(K0,{className:"text-gray-500 mr-2",size:18}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Membro desde:"}),c.jsx("span",{className:"ml-2",children:r.createdAt?new Date(r.createdAt).toLocaleDateString():"N/A"})]})]}),r.bio&&c.jsxs("div",{className:"mt-4",children:[c.jsx("h3",{className:"text-gray-700 font-medium mb-2",children:"Bio:"}),c.jsx("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:r.bio})]})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-xl font-semibold mb-4 border-b pb-2",children:"Projetos"}),i.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(w=>c.jsxs(De,{to:`/admin/projects/${w.id}`,className:"block bg-white border rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsx("h3",{className:"font-medium text-blue-600 hover:text-blue-800 mb-2",children:w.name}),c.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:w.description}),c.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[c.jsx("span",{children:w.startDate?new Date(w.startDate).toLocaleDateString():"N/A"}),c.jsx("span",{className:"capitalize px-2 py-1 bg-gray-100 rounded-full",children:w.status})]})]},w.id))}):c.jsx("p",{className:"text-gray-500 text-center py-4 bg-gray-50 rounded-lg",children:"Não está participando de nenhum projeto."})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold mb-4 border-b pb-2",children:"Tarefas"}),a.length>0?c.jsx("div",{className:"space-y-3",children:a.map(w=>c.jsxs(De,{to:`/tasks/${w.id}`,className:"block bg-white border rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("h3",{className:"font-medium text-blue-600 hover:text-blue-800",children:w.title}),c.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${w.status==="completed"?"bg-green-100 text-green-800":w.status==="in_progress"?"bg-blue-100 text-blue-800":w.status==="waiting_approval"?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800"}`,children:w.status==="completed"?"Concluída":w.status==="in_progress"?"Em Andamento":w.status==="waiting_approval"?"Aguardando Aprovação":"Pendente"})]}),c.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 my-2",children:w.description}),c.jsxs("div",{className:"flex justify-between items-center text-xs",children:[c.jsxs("span",{className:"text-gray-500",children:["Vencimento: ",new Date(w.dueDate).toLocaleDateString()]}),c.jsxs("span",{className:"flex items-center text-yellow-600",children:[c.jsx(vl,{size:14,className:"mr-1"}),w.coinsReward||0," moedas"]})]})]},w.id))}):c.jsx("p",{className:"text-gray-500 text-center py-4 bg-gray-50 rounded-lg",children:"Nenhuma tarefa atribuída."})]})]})]})]})})):c.jsx(Re,{role:(e==null?void 0:e.role)||"employee",children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"p-4 bg-yellow-100 text-yellow-700 border border-yellow-400 rounded flex items-center",children:[c.jsx(en,{className:"mr-2",size:20}),"Usuário não encontrado."]}),c.jsxs("button",{onClick:()=>n(-1),className:"mt-4 flex items-center text-blue-600 hover:text-blue-800",children:[c.jsx(ks,{size:16,className:"mr-1"})," Voltar"]})]})})},ph=({icon:t,title:e,value:n,color:r})=>c.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-md flex items-center space-x-4 border border-${r.split("-")[1]}-100`,children:[c.jsx("div",{className:`p-3 rounded-full ${r} bg-opacity-20`,children:c.jsx(t,{className:`${r} w-6 h-6`})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:e}),c.jsx("h3",{className:"text-xl font-bold text-gray-800",children:n})]})]}),DW=({name:t,progress:e,color:n})=>c.jsxs("div",{className:"mb-2",children:[c.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[c.jsx("span",{children:t}),c.jsxs("span",{children:[e,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`${n} h-2 rounded-full`,style:{width:`${e}%`}})})]}),MW=({status:t})=>{const e={planning:"bg-yellow-100 text-yellow-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",paused:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800",archived:"bg-gray-400 text-white"},n={planning:"Planejamento",active:"Ativo",completed:"Concluído",paused:"Pausado",cancelled:"Cancelado",archived:"Arquivado"};return c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${e[t]}`,children:n[t]})},OW=t=>{if(!t.length)return 0;const e=t.filter(n=>n.status==="completed").length;return Math.round(e/t.length*100)},LW=()=>{const[t,e]=T.useState(!0),[n,r]=T.useState(0),[s,i]=T.useState(0),[o,a]=T.useState(0),[l,u]=T.useState(0),[d,f]=T.useState([]),[p,m]=T.useState(1),[g,x]=T.useState(1),[w,v]=T.useState([]),[_,E]=T.useState(null),[A,P]=T.useState([]),{currentUser:M}=tn();return T.useEffect(()=>{(async()=>{e(!0),E(null);try{const S=await Je.fetchProjects({limit:9,page:p,excludeStatus:"archived"}),C=S.data;f(C),x(S.totalPages),r(S.totalProjects);const j=await vt.fetchUsers();i(j.totalUsers);const D=await nt.fetchTasks({status:"completed"});a(D.totalTasks);const R=await nt.fetchTasks({status:"pending"});u(R.totalTasks);const k=await Ya.getRecentActivities();v(k);const z=C.map(async W=>{const Z=await nt.fetchTasks({projectId:W.id});return{project:W,tasks:Z.data}}),O=await Promise.all(z);P(O)}catch(S){E(S.message||"Erro ao buscar dados."),console.error("Error fetching data:",S)}finally{e(!1)}})()},[p,M]),c.jsx(Re,{role:"admin",isLoading:t,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Dashboard"}),_&&c.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:_}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsx(ph,{icon:$i,title:"Projetos",value:n,color:"text-blue-600"}),c.jsx(ph,{icon:Jo,title:"Usuários",value:s,color:"text-green-600"}),c.jsx(ph,{icon:Xe,title:"Tarefas Concluídas",value:o,color:"text-purple-600"}),c.jsx(ph,{icon:en,title:"Pendentes",value:l,color:"text-yellow-600"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(Dw,{className:"mr-2 text-blue-600"}),"Progresso dos Projetos"]}),c.jsx("div",{className:"space-y-4",children:A.map(({project:N,tasks:S})=>{const C=OW(S);return c.jsxs("div",{children:[c.jsx(DW,{name:N.name,progress:C,color:"bg-blue-500"}),c.jsx("div",{className:"flex justify-end",children:c.jsx(MW,{status:N.status})})]},N.id)})}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[c.jsxs("span",{className:"text-sm text-gray-600",children:[p," de ",g]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>m(N=>Math.max(1,N-1)),disabled:p===1,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center",children:[c.jsx(aa,{className:"mr-2"})," Anterior"]}),c.jsxs("button",{onClick:()=>m(N=>Math.min(g,N+1)),disabled:p===g,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center",children:["Próximo ",c.jsx(la,{className:"ml-2"})]})]})]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(Jo,{className:"mr-2 text-green-600"}),"Atividade Recente"]}),c.jsx("div",{className:"space-y-4",children:w.map((N,S)=>c.jsxs("div",{className:"flex justify-between items-center pb-2 border-b last:border-b-0",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-700 text-sm",children:N.userName}),c.jsxs("p",{className:"text-xs text-gray-500",children:[N.type==="project_created"&&`Criou o projeto ${N.projectName}`,N.type==="project_updated"&&`Atualizou o projeto ${N.projectName}`,N.type==="task_created"&&`Criou a tarefa ${N.taskName} no projeto ${N.projectName}`,N.type==="task_updated"&&`Atualizou a tarefa ${N.taskName} no projeto ${N.projectName}`,N.type==="task_completed"&&`Completou a tarefa ${N.taskName} no projeto ${N.projectName}`,N.type==="task_status_update"&&`Alterou o status da tarefa ${N.taskName} para ${N.newStatus}`]})]}),c.jsx("span",{className:"text-xs text-gray-400",children:new Date(N.timestamp).toLocaleTimeString()})]},S))})]})]})]})})})},VW=({isOpen:t,onClose:e,onUserCreated:n})=>{const[r,s]=T.useState({name:"",email:"",role:"employee",password:""}),[i,o]=T.useState({}),[a,l]=T.useState(!1),[u,d]=T.useState(null),[f,p]=T.useState(!1),m=()=>{const v={};return qn.isValidName(r.name)||(v.name="Nome inválido. Digite nome e sobrenome."),qn.isValidEmail(r.email)||(v.email="Email inválido."),["admin","manager","employee"].includes(r.role)||(v.role="Função inválida."),qn.isStrongPassword(r.password)||(v.password="Senha inválida. A senha deve ter pelo menos 8 caracteres, uma letra maiúscula, uma minúscula, um número e um caractere especial."),o(v),Object.keys(v).length===0},g=async v=>{if(v.preventDefault(),d(null),!!m()){l(!0);try{const _=await vt.createUser({name:r.name,email:r.email,role:r.role,status:"active"},r.password);n(_),e()}catch(_){d(_.message||"Erro ao criar usuário. Tente novamente.")}finally{l(!1)}}},x=v=>{const{name:_,value:E}=v.target;s(A=>({...A,[_]:E})),i[_]&&o(A=>{const P={...A};return delete P[_],P})},w=()=>{s({name:"",email:"",role:"employee",password:""}),o({}),d(null),e()};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[c.jsx(pB,{className:"mr-2 text-blue-600"}),"Criar Novo Usuário"]}),c.jsx("button",{onClick:w,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[u&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center",children:[c.jsx(en,{className:"mr-2"}),u]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),c.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:x,placeholder:"Digite nome e sobrenome",className:`w-full px-4 py-2 border rounded-lg focus:outline-none 
                ${i.name?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`}),i.name&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.name})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),c.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:x,placeholder:"usuario@empresa.com",className:`w-full px-4 py-2 border rounded-lg focus:outline-none 
                ${i.email?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`}),i.email&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.email})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:f?"text":"password",id:"password",name:"password",value:r.password,onChange:x,placeholder:"Senha",className:`w-full px-4 py-2 border rounded-lg focus:outline-none pr-10
                  ${i.password?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`}),c.jsx("button",{type:"button",onClick:()=>p(!f),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:f?c.jsx(fA,{size:20}):c.jsx(Va,{size:20})})]}),i.password&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.password}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"A senha deve ter pelo menos 8 caracteres, incluindo maiúsculas, minúsculas, números e caracteres especiais."})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"Função"}),c.jsxs("select",{id:"role",name:"role",value:r.role,onChange:x,className:`w-full px-4 py-2 border rounded-lg focus:outline-none 
                ${i.role?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`,children:[c.jsx("option",{value:"employee",children:"Funcionário"}),c.jsx("option",{value:"manager",children:"Gestor"}),c.jsx("option",{value:"admin",children:"Administrador"})]}),i.role&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.role})]}),c.jsx("div",{className:"pt-4",children:c.jsx("button",{type:"submit",disabled:a,className:`w-full py-2 rounded-lg text-white transition 
                ${a?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:a?c.jsxs("div",{className:"flex items-center justify-center",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Criando..."]}):"Criar Usuário"})})]})]})}):null},FW=({user:t,isOpen:e,onClose:n,onUserUpdated:r})=>{const[s,i]=T.useState({name:t.name,email:t.email,role:t.role,status:t.status}),[o,a]=T.useState({}),[l,u]=T.useState(!1),[d,f]=T.useState(null),[p,m]=T.useState(null),g=T.useRef(null);T.useEffect(()=>{e&&i({name:t.name,email:t.email,role:t.role,status:t.status}),a({}),f(null),m(null)},[t,e]);const x=()=>{const E={};qn.isValidName(s.name||"")||(E.name="Nome inválido. Digite nome e sobrenome."),qn.isValidEmail(s.email||"")||(E.email="Email inválido.");const A=["admin","manager","employee"];(!s.role||!A.includes(s.role))&&(E.role="Função inválida.");const P=["active","inactive","suspended"];return(!s.status||!P.includes(s.status))&&(E.status="Status inválido."),a(E),Object.keys(E).length===0},w=async E=>{if(E.preventDefault(),f(null),!!x()){u(!0);try{const A={name:s.name,email:s.email,role:s.role,status:s.status};Object.keys(A).forEach(M=>{A[M]===t[M]&&delete A[M]});const P=await vt.updateUser(t.id,A,p||void 0);r(P),n()}catch(A){f(A.message||"Erro ao atualizar usuário. Tente novamente.")}finally{u(!1)}}},v=E=>{const{name:A,value:P}=E.target;i(M=>({...M,[A]:P})),o[A]&&a(M=>{const N={...M};return delete N[A],N})},_=E=>{E.target.files&&E.target.files.length>0&&m(E.target.files[0])};return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[c.jsx(fB,{className:"mr-2 text-blue-600"}),"Editar Usuário"]}),c.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[d&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center",children:[c.jsx(en,{className:"mr-2"}),d]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),c.jsx("input",{type:"text",id:"name",name:"name",value:s.name||"",onChange:v,placeholder:"Digite nome e sobrenome",className:`w-full px-4 py-2 border rounded-lg focus:outline-none
                ${o.name?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`}),o.name&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.name})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),c.jsx("input",{type:"email",id:"email",name:"email",value:s.email||"",onChange:v,placeholder:"usuario@empresa.com",className:`w-full px-4 py-2 border rounded-lg focus:outline-none
                ${o.email?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`}),o.email&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.email})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"Função"}),c.jsxs("select",{id:"role",name:"role",value:s.role||"",onChange:v,className:`w-full px-4 py-2 border rounded-lg focus:outline-none
                ${o.role?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`,children:[c.jsx("option",{value:"employee",children:"Funcionário"}),c.jsx("option",{value:"manager",children:"Gestor"}),c.jsx("option",{value:"admin",children:"Administrador"})]}),o.role&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.role})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),c.jsxs("select",{id:"status",name:"status",value:s.status||"",onChange:v,className:`w-full px-4 py-2 border rounded-lg focus:outline-none
                ${o.status?"border-red-500 focus:ring-red-500":"focus:ring-2 focus:ring-blue-500"}`,children:[c.jsx("option",{value:"active",children:"Ativo"}),c.jsx("option",{value:"inactive",children:"Inativo"}),c.jsx("option",{value:"suspended",children:"Suspenso"})]}),o.status&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.status})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto de Perfil"}),c.jsx("input",{type:"file",accept:"image/*",onChange:_,ref:g,className:"hidden"}),c.jsxs("button",{type:"button",onClick:()=>{var E;return(E=g.current)==null?void 0:E.click()},className:"flex items-center px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition",children:[c.jsx(Lf,{className:"mr-2"}),p?p.name:"Selecionar Imagem"]})]}),c.jsxs("div",{className:"pt-4 flex space-x-4",children:[c.jsx("button",{type:"button",onClick:n,className:"w-full py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition",children:"Cancelar"}),c.jsx("button",{type:"submit",disabled:l,className:`w-full py-2 rounded-lg text-white transition
                ${l?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:l?"Atualizando...":"Atualizar Usuário"})]})]})]})}):null};function Eb(t,e){const[n,r]=T.useState(t);return T.useEffect(()=>{const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t,e]),n}const UW=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState({}),[o,a]=T.useState(""),l=Eb(o,500),[u,d]=T.useState(1),[f,p]=T.useState(1),m=10,[g,x]=T.useState(!1),[w,v]=T.useState(null),[_,E]=T.useState(!1),[A,P]=T.useState(!1),M=T.useCallback(async()=>{try{r(!0);const k=await vt.fetchUsers({role:s.role,status:s.status,limit:m,page:u,searchTerm:l});e(k.data),p(k.totalPages)}catch(k){console.error("Erro ao buscar usuários:",k)}finally{r(!1)}},[s.role,s.status,u,m,l]);T.useEffect(()=>{M()},[M]);const N=async()=>{if(w)try{await vt.deleteUser(w.id),e(k=>k.filter(z=>z.id!==w.id)),v(null),P(!1)}catch(k){console.error("Erro ao excluir usuário:",k)}},S=k=>{v(k),E(!0)},C=k=>{v(k),P(!0)},j=k=>{e(z=>[k,...z])},D=k=>{e(z=>z.map(O=>O.id===k.id?k:O))},R=({role:k})=>{const z={admin:"bg-red-100 text-red-800",manager:"bg-blue-100 text-blue-800",employee:"bg-green-100 text-green-800"};return c.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${z[k]}`,children:k.charAt(0).toUpperCase()+k.slice(1)})};return c.jsx(Re,{role:"admin",isLoading:n,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:"Gerenciamento de Usuários"}),c.jsx("p",{className:"text-gray-500 text-sm",children:"Gerencie e acompanhe todos os usuários do sistema."})]}),c.jsxs("button",{onClick:()=>x(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-blue-700 transition",children:[c.jsx(ur,{className:"mr-2"})," Adicionar Usuário"]})]}),c.jsxs("div",{className:"md:flex md:space-x-4 mb-6",children:[c.jsxs("div",{className:"relative flex-grow mb-4 md:mb-0",children:[c.jsx("input",{type:"text",placeholder:"Buscar usuários...",value:o,onChange:k=>a(k.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx(wl,{className:"absolute left-3 top-3 text-gray-400",size:20})]}),c.jsxs("select",{value:s.role||"",onChange:k=>i({...s,role:k.target.value}),className:"w-full md:w-auto px-4 py-2 border rounded-lg mb-4 md:mb-0",children:[c.jsx("option",{value:"",children:"Todos os Cargos"}),c.jsx("option",{value:"admin",children:"Administradores"}),c.jsx("option",{value:"manager",children:"Gestores"}),c.jsx("option",{value:"employee",children:"Funcionários"})]}),c.jsxs("select",{value:s.status||"",onChange:k=>i({...s,status:k.target.value}),className:"w-full md:w-auto px-4 py-2 border rounded-lg",children:[c.jsx("option",{value:"",children:"Todos os Status"}),c.jsx("option",{value:"active",children:"Ativos"}),c.jsx("option",{value:"inactive",children:"Inativos"}),c.jsx("option",{value:"suspended",children:"Suspensos"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.length===0?c.jsx("div",{className:"text-center py-4 col-span-full",children:"Nenhum usuário encontrado"}):t.map(k=>c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition group",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("img",{src:k.profileImage||mr(k.name),alt:`Foto de ${k.name}`,className:"w-10 h-10 rounded-full object-cover mr-4"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:k.name}),c.jsx("p",{className:"text-gray-600 text-sm",children:k.email})]})]}),c.jsxs("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>S(k),className:"text-blue-500 hover:text-blue-700",children:c.jsx(Ao,{size:20})}),c.jsx("button",{onClick:()=>C(k),className:"text-red-500 hover:text-red-700",children:c.jsx(ns,{size:20})})]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(R,{role:k.role}),c.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${k.status==="active"?"bg-green-100 text-green-800":k.status==="inactive"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:k.status==="active"?"Ativo":k.status==="inactive"?"Inativo":"Suspenso"})]})]},k.id))}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[c.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",u," de ",f]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>d(k=>Math.max(1,k-1)),disabled:u===1,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center",children:[c.jsx(aa,{className:"mr-2"})," Anterior"]}),c.jsxs("button",{onClick:()=>d(k=>Math.min(f,k+1)),disabled:u===f,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center",children:["Próximo ",c.jsx(la,{className:"ml-2"})]})]})]}),c.jsx(VW,{isOpen:g,onClose:()=>x(!1),onUserCreated:j}),w&&c.jsxs(c.Fragment,{children:[c.jsx(FW,{user:w,isOpen:_,onClose:()=>E(!1),onUserUpdated:D}),c.jsx(gd,{isOpen:A,onClose:()=>P(!1),onConfirm:N,itemName:w.name,warningMessage:"A exclusão de um usuário removerá permanentemente todas as suas informações do sistema."})]})]})})})},zW=({isOpen:t,onClose:e,onProjectCreated:n})=>{const[r,s]=T.useState({name:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:"",status:"planning",managers:[]}),[i,o]=T.useState([]),[a,l]=T.useState(!1),[u,d]=T.useState(!1),[f,p]=T.useState(null),[m,g]=T.useState(1),[x,w]=T.useState({});T.useEffect(()=>{t&&(async()=>{l(!0),p(null);try{const N=(await vt.fetchUsers({role:"manager"})).data.map(S=>({id:S.id,name:S.name}));o(N)}catch(M){console.error("Error fetching managers:",M),p(M.message||"Failed to load managers.")}finally{l(!1)}})()},[t]),T.useEffect(()=>{t||(s({name:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:"",status:"planning",managers:[]}),g(1),p(null),w({}))},[t]);const v=P=>{const{name:M,value:N}=P.target;s(S=>({...S,[M]:N})),x[M]&&w(S=>{const C={...S};return delete C[M],C})},_=()=>{const P={};return r.name.trim()||(P.name="Project name is required"),r.description.trim()||(P.description="Description is required"),w(P),Object.keys(P).length===0},E=()=>{const P={};return r.startDate||(P.startDate="Start date is required"),r.managers.length===0&&(P.managers="At least one manager is required"),w(P),Object.keys(P).length===0},A=async P=>{if(P.preventDefault(),!!E()){d(!0),p(null);try{const M=await Je.createProject({...r,startDate:new Date(r.startDate).getTime(),endDate:r.endDate?new Date(r.endDate).getTime():void 0,managers:r.managers,createdBy:"",messages:[],commentTabs:[]});n(M),e()}catch(M){p(M.message||"Erro ao criar projeto")}finally{d(!1)}}};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[c.jsx($i,{className:"mr-2 text-blue-600"}),"Criar Novo Projeto (Step ",m,"/2)"]}),c.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsxs("form",{onSubmit:A,className:"p-6 space-y-4",children:[f?c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center",children:[c.jsx(en,{className:"mr-2"}),f]}):null,m===1&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Projeto"}),c.jsx("input",{type:"text",name:"name",value:r.name,onChange:v,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${x.name?"border-red-500":"focus:ring-blue-500"}`}),x.name&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),c.jsx("textarea",{name:"description",value:r.description,onChange:v,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 h-24 ${x.description?"border-red-500":"focus:ring-blue-500"}`}),x.description&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.description})]}),c.jsx("button",{type:"button",onClick:()=>{_()&&g(2)},className:"w-full py-2 rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition",children:"Next"})]}),m===2&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Início"}),c.jsx("input",{type:"date",name:"startDate",value:r.startDate,onChange:v,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${x.startDate?"border-red-500":"focus:ring-blue-500"}`}),x.startDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.startDate})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Término (opcional)"}),c.jsx("input",{type:"date",name:"endDate",value:r.endDate,onChange:v,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),c.jsxs("select",{name:"status",value:r.status,onChange:v,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"planning",children:"Planejamento"}),c.jsx("option",{value:"active",children:"Ativo"}),c.jsx("option",{value:"paused",children:"Pausado"}),c.jsx("option",{value:"completed",children:"Concluído"}),c.jsx("option",{value:"cancelled",children:"Cancelado"}),c.jsx("option",{value:"archived",children:"Arquivado"})," "]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gestores"}),c.jsx("select",{multiple:!0,name:"managers",value:r.managers,onChange:P=>{const M=Array.from(P.target.selectedOptions,N=>N.value);s(N=>({...N,managers:M}))},className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 h-24 ${x.managers?"border-red-500":"focus:ring-blue-500"}`,disabled:a,children:a?c.jsx("option",{children:"Loading..."}):i.length>0?i.map(P=>c.jsx("option",{value:P.id,children:P.name},P.id)):c.jsx("option",{disabled:!0,children:"No managers found"})}),x.managers&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.managers})]}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsx("button",{type:"button",onClick:()=>g(1),className:"w-full py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition",children:"Back"}),c.jsx("button",{type:"submit",disabled:u,className:`w-full py-2 rounded-lg text-white transition 
                    ${u?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:u?"Criando...":"Criar Projeto"})]})]})]})]})}):null},BW=({project:t,isOpen:e,onClose:n,onProjectUpdated:r})=>{const[s,i]=T.useState({name:t.name,description:t.description,startDate:t.startDate&&t.startDate>0?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate&&t.endDate>0?new Date(t.endDate).toISOString().split("T")[0]:"",status:t.status,managers:t.managers}),[o,a]=T.useState([]),[l,u]=T.useState(!1),[d,f]=T.useState(!1),[p,m]=T.useState(null),[g,x]=T.useState(1),[w,v]=T.useState({});T.useEffect(()=>{e&&(async()=>{u(!0),m(null);try{const S=(await vt.fetchUsers({role:"manager"})).data.map(C=>({id:C.id,name:C.name}));a(S)}catch(N){console.error("Erro ao buscar gestores:",N),m(N.message||"Failed to load managers.")}finally{u(!1)}})()},[e]),T.useEffect(()=>{i({name:t.name,description:t.description,startDate:t.startDate&&t.startDate>0?new Date(t.startDate).toISOString().split("T")[0]:"",endDate:t.endDate&&t.endDate>0?new Date(t.endDate).toISOString().split("T")[0]:"",status:t.status,managers:t.managers}),m(null),x(1),v({})},[t,e]);const _=M=>{const{name:N,value:S}=M.target;i(C=>({...C,[N]:S})),w[N]&&v(C=>{const j={...C};return delete j[N],j})},E=()=>{const M={};return s.name.trim()||(M.name="Project name is required"),s.description.trim()||(M.description="Description is required"),v(M),Object.keys(M).length===0},A=()=>{const M={};return s.startDate||(M.startDate="Start date is required"),s.managers.length===0&&(M.managers="At least one manager is required"),v(M),Object.keys(M).length===0},P=async M=>{if(M.preventDefault(),!!A()){f(!0),m(null);try{const N={name:s.name,description:s.description,startDate:s.startDate?new Date(s.startDate).getTime():void 0,endDate:s.endDate?new Date(s.endDate).getTime():void 0,status:s.status,managers:s.managers};await Je.updateProject(t.id,N),r({...t,...N}),n()}catch(N){m(N.message||"Erro ao atualizar projeto")}finally{f(!1)}}};return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[c.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[c.jsx($i,{className:"mr-2 text-blue-600"}),"Editar Projeto (Step ",g,"/2)"]}),c.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsxs("form",{onSubmit:P,className:"p-6 space-y-4",children:[p?c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center",children:[c.jsx(en,{className:"mr-2"}),p]}):null,g===1&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Projeto"}),c.jsx("input",{type:"text",name:"name",value:s.name,onChange:_,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${w.name?"border-red-500":"focus:ring-blue-500"}`}),w.name&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),c.jsx("textarea",{name:"description",value:s.description,onChange:_,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 h-24 ${w.description?"border-red-500":"focus:ring-blue-500"}`}),w.description&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.description})]}),c.jsx("button",{type:"button",onClick:()=>{E()&&x(2)},className:"w-full py-2 rounded-lg text-white bg-blue-600 hover:bg-blue-700 transition",children:"Next"})]}),g===2&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Início"}),c.jsx("input",{type:"date",name:"startDate",value:s.startDate,onChange:_,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${w.startDate?"border-red-500":"focus:ring-blue-500"}`}),w.startDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.startDate})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Término (opcional)"}),c.jsx("input",{type:"date",name:"endDate",value:s.endDate,onChange:_,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),c.jsxs("select",{name:"status",value:s.status,onChange:_,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"planning",children:"Planejamento"}),c.jsx("option",{value:"active",children:"Ativo"}),c.jsx("option",{value:"paused",children:"Pausado"}),c.jsx("option",{value:"completed",children:"Concluído"}),c.jsx("option",{value:"cancelled",children:"Cancelado"}),c.jsx("option",{value:"archived",children:"Arquivado"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gestores"}),c.jsx("select",{multiple:!0,name:"managers",value:s.managers,onChange:M=>{const N=Array.from(M.target.selectedOptions,S=>S.value);i(S=>({...S,managers:N}))},className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 h-24 ${w.managers?"border-red-500":"focus:ring-blue-500"}`,disabled:l,children:l?c.jsx("option",{children:"Loading..."}):o.length>0?o.map(M=>c.jsx("option",{value:M.id,children:M.name},M.id)):c.jsx("option",{disabled:!0,children:"No managers found"})}),w.managers&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:w.managers})]}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsx("button",{type:"button",onClick:()=>x(1),className:"w-full py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition",children:"Back"}),c.jsx("button",{type:"submit",disabled:d,className:`w-full py-2 rounded-lg text-white transition 
                    ${d?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:d?"Atualizando...":"Atualizar Projeto"})]})]})]})]})}):null},$W=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState({}),[o,a]=T.useState(""),l=Eb(o,500),[u,d]=T.useState(1),[f,p]=T.useState(1),m=9,[g,x]=T.useState(!1),[w,v]=T.useState(null),[_,E]=T.useState(!1),[A,P]=T.useState(!1),M=T.useCallback(async()=>{try{r(!0);const O={limit:m,page:u};s.status?O.status=s.status:O.excludeStatus="archived";const W=await Je.fetchProjects(O);e(W.data),p(W.totalPages)}catch(O){console.error("Erro ao buscar projetos:",O)}finally{r(!1)}},[s.status,u,m]);T.useEffect(()=>{M()},[s,u,l,M]);const N=async()=>{if(w)try{await Je.deleteProject(w.id),e(O=>O.filter(W=>W.id!==w.id)),v(null),P(!1)}catch(O){console.error("Erro ao excluir projeto:",O)}},S=O=>{v(O),E(!0)},C=O=>{v(O),P(!0)},j=O=>{e(W=>[O,...W])},D=O=>{e(W=>W.map(Z=>Z.id===O.id?O:Z))},R=async O=>{try{await Je.archiveProject(O),M()}catch(W){console.error("Error archiving project:",W)}},k=async O=>{try{await Je.unarchiveProject(O),M()}catch(W){console.error("Error unarchiving project:",W)}},z=({status:O})=>{const W={planning:"bg-yellow-100 text-yellow-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",paused:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800",archived:"bg-gray-400 text-white"},Z={planning:"Planejamento",active:"Ativo",completed:"Concluído",paused:"Pausado",cancelled:"Cancelado",archived:"Arquivado"};return c.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${W[O]}`,children:Z[O]})};return c.jsx(Re,{role:"admin",isLoading:n,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Gerenciamento de Projetos"}),c.jsx("p",{className:"text-gray-500 text-sm",children:"Gerencie e acompanhe todos os projetos do sistema."})]}),c.jsxs("button",{onClick:()=>x(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-blue-700 transition",children:[c.jsx(ur,{className:"mr-2"})," Adicionar Projeto"]})]}),c.jsxs("div",{className:"md:flex md:space-x-4 mb-6",children:[c.jsxs("div",{className:"relative flex-grow mb-4 md:mb-0",children:[c.jsx("input",{type:"text",placeholder:"Buscar projetos...",value:o,onChange:O=>a(O.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx(wl,{className:"absolute left-3 top-3 text-gray-400",size:20})]}),c.jsxs("select",{value:s.status||"",onChange:O=>i({...s,status:O.target.value}),className:"w-full md:w-auto px-4 py-2 border rounded-lg",children:[c.jsx("option",{value:"",children:"Todos os Status"}),c.jsx("option",{value:"planning",children:"Planejamento"}),c.jsx("option",{value:"active",children:"Ativos"}),c.jsx("option",{value:"completed",children:"Concluídos"}),c.jsx("option",{value:"paused",children:"Pausados"}),c.jsx("option",{value:"cancelled",children:"Cancelados"}),c.jsx("option",{value:"archived",children:"Arquivados"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.length===0?c.jsx("div",{className:"text-center py-4 col-span-full",children:"Nenhum projeto encontrado"}):t.filter(O=>O.name.toLowerCase().includes(l.toLowerCase())||O.description.toLowerCase().includes(l.toLowerCase())).map(O=>c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition group",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800 group-hover:text-blue-600 transition",children:c.jsx(De,{to:`/admin/projects/${O.id}`,children:O.name})}),c.jsxs("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[O.status==="archived"?c.jsx("button",{onClick:()=>k(O.id),className:"text-green-500 hover:text-green-700",title:"Desarquivar",children:c.jsx(rB,{size:20})}):c.jsx("button",{onClick:()=>R(O.id),className:"text-yellow-500 hover:text-yellow-700",title:"Arquivar",children:c.jsx(Gz,{size:20})}),c.jsx("button",{onClick:()=>S(O),className:"text-blue-500 hover:text-blue-700",children:c.jsx(Ao,{size:20})}),c.jsx("button",{onClick:()=>C(O),className:"text-red-500 hover:text-red-700",children:c.jsx(ns,{size:20})})]})]}),c.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2",children:O.description}),c.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Início: ",new Date(O.startDate).toLocaleDateString(),O.endDate&&c.jsxs(c.Fragment,{children:[c.jsx("br",{}),"Fim: ",new Date(O.endDate).toLocaleDateString()]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx(z,{status:O.status})})]},O.id))}),c.jsxs("div",{className:"flex justify-between items-center mt-4",children:[c.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",u," de ",f]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>d(O=>Math.max(1,O-1)),disabled:u===1,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center",children:[c.jsx(aa,{className:"mr-2"})," Anterior"]}),c.jsxs("button",{onClick:()=>d(O=>Math.min(f,O+1)),disabled:u===f,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center",children:["Próximo ",c.jsx(la,{className:"ml-2"})]})]})]}),c.jsx(zW,{isOpen:g,onClose:()=>x(!1),onProjectCreated:j}),w&&c.jsxs(c.Fragment,{children:[c.jsx(BW,{project:w,isOpen:_,onClose:()=>E(!1),onProjectUpdated:D}),c.jsx(gd,{isOpen:A,onClose:()=>P(!1),onConfirm:N,itemName:w.name,warningMessage:"A exclusão de um projeto removerá permanentemente todas as suas informações do sistema."})]})]})})})},HW=({attachment:t})=>{const e=()=>{switch(t.type){case"image":return c.jsx(km,{size:48,className:"text-blue-500"});case"video":return c.jsx(Vw,{size:48,className:"text-red-500"});case"document":return c.jsx(Tm,{size:48,className:"text-green-500"});case"audio":return c.jsx(Lw,{size:48,className:"text-purple-500"});default:return c.jsx(Fs,{size:48,className:"text-gray-500"})}};return c.jsxs("div",{className:"flex flex-col items-center w-48 p-4 bg-white rounded-lg shadow-md border border-gray-100 hover:shadow-lg transition-shadow",children:[e(),c.jsx("a",{href:t.url,download:t.name,className:"mt-2 text-sm text-gray-700 hover:underline truncate text-center w-full",title:t.name,children:t.name}),c.jsxs("a",{href:t.url,download:t.name,className:"mt-2 px-4 py-1 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors flex items-center",children:[c.jsx(Vf,{size:14,className:"mr-1"})," Download"]})]})},qW=()=>{var A,P,M,N,S,C,j,D;const{projectId:t}=Pl(),e=mn(),{currentUser:n}=tn(),[r,s]=T.useState(!0),[i,o]=T.useState(null),[a,l]=T.useState(null),[u,d]=T.useState([]),[f,p]=T.useState({}),[m,g]=T.useState([]),[x,w]=T.useState({pending:[],in_progress:[],waiting_approval:[],completed:[]});T.useEffect(()=>{(async()=>{try{if(!t)throw new Error("Project ID is required");s(!0),o(null);const k=await Je.getProjectById(t),z=await nt.fetchTasks({projectId:t}),W=(await vt.fetchUsers()).data.reduce(($,F)=>($[F.id]={name:F.name,profileImage:F.profileImage},$),{}),B=(await Je.getProjectMessages(t)).reduce(($,F)=>F.attachments&&F.attachments.length>0?$.concat(F.attachments):$,[]),V=z.data.reduce(($,F)=>{const H=F.status;return $[H]||($[H]=[]),$[H].push(F),$},{});l(k),d(z.data),p(W),g(B),w(V)}catch(k){console.error("Error loading project data:",k),o(k.message||"Failed to load project details")}finally{s(!1)}})()},[t]);const v=()=>n?!!(n.role==="admin"||n.role==="manager"&&(a!=null&&a.managers.includes(n.uid))):!1,_=()=>{if(!u.length)return 0;const R=u.filter(k=>k.status==="completed").length;return Math.round(R/u.length*100)};if(r)return c.jsx(Re,{role:"admin",isLoading:!0,children:c.jsx("div",{className:"flex items-center justify-center h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})});if(i)return c.jsx(Re,{role:"admin",isLoading:!1,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[c.jsx(Pw,{className:"mr-2"}),i]})})});if(!v())return c.jsx(Re,{role:"admin",isLoading:!1,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[c.jsx("strong",{className:"font-bold",children:"Acesso Negado: "}),c.jsx("span",{className:"block sm:inline",children:"Você não tem permissão para visualizar este projeto"})]})})});if(!a)return c.jsx(Re,{role:"admin",isLoading:!1,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative",role:"alert",children:[c.jsx("strong",{className:"font-bold",children:"Aviso: "}),c.jsx("span",{className:"block sm:inline",children:"Projeto não encontrado"})]})})});const E=({status:R})=>{const k={planning:"bg-yellow-100 text-yellow-800",active:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",paused:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800",archived:"bg-gray-400 text-white"},z={planning:"Planejamento",active:"Ativo",completed:"Concluído",paused:"Pausado",cancelled:"Cancelado",archived:"Arquivado"};return c.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${k[R]}`,children:z[R]})};return c.jsx(Re,{role:"admin",isLoading:!1,children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("button",{onClick:()=>e("/admin/projects"),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[c.jsx(ks,{className:"mr-2"})," Voltar para Projetos"]}),c.jsxs("button",{onClick:()=>e(`/admin/projects/${a.id}/chat`),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[c.jsx(yA,{className:"mr-2",size:20}),"Chat do Projeto"]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.name}),c.jsx("p",{className:"text-gray-600 mt-2",children:a.description})]}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsx(E,{status:a.status})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(K0,{className:"text-blue-500"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Data de Início"}),c.jsx("p",{className:"font-medium",children:new Date(a.startDate).toLocaleDateString()})]})]}),a.endDate&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(K0,{className:"text-red-500"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Data de Término"}),c.jsx("p",{className:"font-medium",children:new Date(a.endDate).toLocaleDateString()})]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500 block mb-2",children:"Gestores"}),c.jsx("div",{className:"flex items-center mt-1",children:a.managers.map(R=>{var z;const k=f[R];return c.jsxs("div",{className:"relative w-8 h-8 rounded-full overflow-hidden mr-2 group",children:[c.jsx("img",{src:(k==null?void 0:k.profileImage)||mr((k==null?void 0:k.name)||null),alt:(k==null?void 0:k.name)||"Unknown Manager",className:"object-cover w-full h-full"}),c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-opacity"}),c.jsx("span",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs text-center py-0.5 opacity-0 group-hover:opacity-100 transition-opacity truncate",children:((z=k==null?void 0:k.name)==null?void 0:z.split(" ")[0])||"Unknown"})]},R)})})]})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Progresso do Projeto"}),c.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[_(),"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:c.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-500",style:{width:`${_()}%`}})})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[c.jsx(Xe,{className:"mr-2 text-blue-600"})," Tarefas do Projeto"]}),c.jsxs(De,{to:`/admin/projects/${t}/create-task`,className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-blue-700 transition",children:[c.jsx(ur,{className:"mr-2"})," Criar Tarefa"]})]}),u.length===0?c.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:[c.jsx(Xe,{className:"mx-auto h-12 w-12 text-gray-400"}),c.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Nenhuma tarefa encontrada"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Comece criando uma nova tarefa para este projeto."})]}):c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsxs("h3",{className:"font-medium text-gray-700 mb-3 flex items-center",children:[c.jsx(Qo,{className:"mr-2 text-yellow-500",size:18}),"Pendentes (",((A=x.pending)==null?void 0:A.length)||0,")"]}),c.jsxs("div",{className:"space-y-3",children:[(P=x.pending)==null?void 0:P.map(R=>c.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"font-medium text-blue-600 hover:text-blue-800 transition-colors",children:R.title}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Ver Detalhes",children:c.jsx(Va,{size:16})}),c.jsx(De,{to:`/admin/projects/${t}/edit-task/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Editar Tarefa",children:c.jsx(Ao,{size:16})})]})]}),c.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 mb-2",children:R.description}),c.jsxs("div",{className:"flex justify-between items-center text-xs",children:[c.jsx("span",{className:"text-gray-500",children:new Date(R.dueDate).toLocaleDateString()}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-600 font-medium mr-1",children:R.coinsReward}),c.jsx("span",{children:"🪙"})]})]})]},R.id)),(!x.pending||x.pending.length===0)&&c.jsx("p",{className:"text-center text-gray-500 text-sm py-2",children:"Nenhuma tarefa pendente"})]})]}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsxs("h3",{className:"font-medium text-gray-700 mb-3 flex items-center",children:[c.jsx(Dw,{className:"mr-2 text-blue-500",size:18}),"Em Andamento (",((M=x.in_progress)==null?void 0:M.length)||0,")"]}),c.jsxs("div",{className:"space-y-3",children:[(N=x.in_progress)==null?void 0:N.map(R=>c.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"font-medium text-blue-600 hover:text-blue-800 transition-colors",children:R.title}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Ver Detalhes",children:c.jsx(Va,{size:16})}),c.jsx(De,{to:`/admin/projects/${t}/edit-task/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Editar Tarefa",children:c.jsx(Ao,{size:16})})]})]}),c.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 mb-2",children:R.description}),c.jsxs("div",{className:"flex justify-between items-center text-xs",children:[c.jsx("span",{className:"text-gray-500",children:new Date(R.dueDate).toLocaleDateString()}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-600 font-medium mr-1",children:R.coinsReward}),c.jsx("span",{children:"🪙"})]})]})]},R.id)),(!x.in_progress||x.in_progress.length===0)&&c.jsx("p",{className:"text-center text-gray-500 text-sm py-2",children:"Nenhuma tarefa em andamento"})]})]}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsxs("h3",{className:"font-medium text-gray-700 mb-3 flex items-center",children:[c.jsx(Qo,{className:"mr-2 text-purple-500",size:18}),"Aguardando Aprovação (",((S=x.waiting_approval)==null?void 0:S.length)||0,")"]}),c.jsxs("div",{className:"space-y-3",children:[(C=x.waiting_approval)==null?void 0:C.map(R=>c.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"font-medium text-blue-600 hover:text-blue-800 transition-colors",children:R.title}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Ver Detalhes",children:c.jsx(Va,{size:16})}),c.jsx(De,{to:`/admin/projects/${t}/edit-task/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Editar Tarefa",children:c.jsx(Ao,{size:16})})]})]}),c.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 mb-2",children:R.description}),c.jsxs("div",{className:"flex justify-between items-center text-xs",children:[c.jsx("span",{className:"text-gray-500",children:new Date(R.dueDate).toLocaleDateString()}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-600 font-medium mr-1",children:R.coinsReward}),c.jsx("span",{children:"🪙"})]})]})]},R.id)),(!x.waiting_approval||x.waiting_approval.length===0)&&c.jsx("p",{className:"text-center text-gray-500 text-sm py-2",children:"Nenhuma tarefa aguardando aprovação"})]})]}),c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[c.jsxs("h3",{className:"font-medium text-gray-700 mb-3 flex items-center",children:[c.jsx(Xe,{className:"mr-2 text-green-500",size:18}),"Concluídas (",((j=x.completed)==null?void 0:j.length)||0,")"]}),c.jsxs("div",{className:"space-y-3",children:[(D=x.completed)==null?void 0:D.map(R=>c.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx(De,{to:`/tasks/${R.id}`,className:"font-medium text-blue-600 hover:text-blue-800 transition-colors",children:R.title}),c.jsx("div",{className:"flex space-x-1",children:c.jsx(De,{to:`/tasks/${R.id}`,className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Ver Detalhes",children:c.jsx(Va,{size:16})})})]}),c.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 mb-2",children:R.description}),c.jsxs("div",{className:"flex justify-between items-center text-xs",children:[c.jsx("span",{className:"text-gray-500",children:new Date(R.dueDate).toLocaleDateString()}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-600 font-medium mr-1",children:R.coinsReward}),c.jsx("span",{children:"🪙"})]})]})]},R.id)),(!x.completed||x.completed.length===0)&&c.jsx("p",{className:"text-center text-gray-500 text-sm py-2",children:"Nenhuma tarefa concluída"})]})]})]})]}),m.length>0&&c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(Fs,{className:"mr-2 text-blue-600"})," Arquivos do Projeto"]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:m.map((R,k)=>c.jsx(HW,{attachment:R},k))})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(Jo,{className:"mr-2 text-blue-600"})," Equipe do Projeto"]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[a.managers.map(R=>{const k=f[R];return c.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200",children:[c.jsx("img",{src:(k==null?void 0:k.profileImage)||mr(k==null?void 0:k.name),alt:(k==null?void 0:k.name)||"Unknown Manager",className:"w-10 h-10 rounded-full mr-3 object-cover"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-800",children:(k==null?void 0:k.name)||"Unknown Manager"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Gestor"})]})]},R)}),u.map(R=>R.assignedTo).filter((R,k,z)=>R&&!a.managers.includes(R)&&z.indexOf(R)===k).map(R=>{const k=f[R];return c.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg border border-gray-200",children:[c.jsx("img",{src:(k==null?void 0:k.profileImage)||mr(k==null?void 0:k.name),alt:(k==null?void 0:k.name)||"Unknown User",className:"w-10 h-10 rounded-full mr-3 object-cover"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-800",children:(k==null?void 0:k.name)||"Unknown User"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Membro"})]})]},R)})]})]})]})})},WW=({message:t,onDelete:e,onQuote:n,isFirstMessage:r,users:s})=>{const{currentUser:i}=tn(),o=t.userId===(i==null?void 0:i.uid),a=t.userId==="system",l=s?s[t.userId]:null;return c.jsxs("div",{className:`group flex items-start gap-3 mb-4 ${o?"flex-row-reverse":""} ${r?"mt-4":""}`,children:[!a&&c.jsx("img",{src:(l==null?void 0:l.photoURL)||mr((l==null?void 0:l.name)||t.userName||""),alt:t.userName,className:"w-10 h-10 rounded-full object-cover"}),c.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg shadow ${o?"bg-blue-600 text-white rounded-br-none":a?"bg-gray-200 text-gray-800 rounded-bl-none":"bg-white text-gray-700 rounded-bl-none"}`,children:[!o&&!a&&c.jsx("div",{className:"text-sm font-medium text-gray-600",children:t.userName}),t.quotedMessage&&c.jsxs("div",{className:"mb-2 p-2 bg-gray-100 rounded-lg text-sm",children:[c.jsx("div",{className:"font-semibold text-gray-700",children:t.quotedMessage.userName}),t.quotedMessage.content.includes("[Ver Tarefa]")?c.jsx("div",{className:"text-gray-600",children:t.quotedMessage.content.split("[Ver Tarefa]").map((u,d)=>{var f;if(d===1){const p=(f=u.match(/\(([^)]+)\)/))==null?void 0:f[1];return c.jsxs(pt.Fragment,{children:[c.jsx(De,{to:p||"#",className:"text-blue-600 hover:underline",children:"[Ver Tarefa]"}),u.replace(/\([^)]+\)/,"")," "]},d)}return u})}):c.jsx("div",{className:"text-gray-600",children:t.quotedMessage.content}),t.quotedMessage.attachments&&t.quotedMessage.attachments.length>0&&c.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:t.quotedMessage.attachments.map(u=>c.jsx(Ex,{attachment:u,color:"text-blue-600"},u.id))})]}),c.jsx("div",{children:t.content}),t.attachments&&t.attachments.length>0&&c.jsx("div",{className:"mt-2 bg-gray-100 rounded-lg p-2",children:c.jsx("div",{className:"flex flex-col gap-1",children:t.attachments.map(u=>c.jsx("div",{className:"flex items-center",children:c.jsx(Ex,{attachment:u,color:"text-blue-600"})},u.id))})}),c.jsx("div",{className:`text-xs mt-1 ${o?"text-blue-200":"text-gray-500"}`,children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),c.jsxs("div",{className:"flex flex-col items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[o&&c.jsx("button",{onClick:()=>e(t.id),className:"p-1 text-gray-500 hover:text-red-600",children:c.jsx(ns,{size:16})}),!a&&c.jsx("button",{onClick:()=>n({userName:t.userName,content:t.content,attachments:t.attachments}),className:"p-1 text-gray-500 hover:text-blue-600",children:c.jsx(eB,{size:16})})]})]})},KW=({managers:t,onClose:e})=>c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96 max-h-[80vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Gestores do Projeto"}),c.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:c.jsx(Wn,{size:24})})]}),c.jsx("ul",{className:"space-y-3",children:t.map(n=>c.jsxs("li",{className:"flex items-center p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[c.jsx("img",{src:n.profileImage||mr(n.name),alt:n.name,className:"w-10 h-10 rounded-full object-cover mr-3"}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-800 font-medium",children:n.name}),c.jsx("p",{className:"text-xs text-gray-500",children:"Gestor"})]})]},n.id))})]})}),GW=()=>{var $l,ua;const{projectId:t}=Pl(),e=mn(),{currentUser:n}=tn(),r=T.useRef(null),s=T.useRef(null),i=T.useRef(null),o=T.useRef(null),a=T.useRef(null),[l,u]=T.useState(!0),[d,f]=T.useState(null),[p,m]=T.useState(null),[g,x]=T.useState([]),[w,v]=T.useState(""),[_,E]=T.useState([]),[A,P]=T.useState(0),[M,N]=T.useState({}),[S,C]=T.useState(!1),[j,D]=T.useState(null),[R,k]=T.useState(null),[z,O]=T.useState(!1),[W,Z]=T.useState([]),[B,V]=T.useState(!1),[$,F]=T.useState(!1),[H,X]=T.useState(""),[ge,Ie]=T.useState(!1),[ae,oe]=T.useState([]),Te=()=>O(!0),we=()=>O(!1);T.useEffect(()=>{(async()=>{try{if(!t)throw new Error("Project ID is required");u(!0),f(null);const xe=await Je.getProjectById(t);m(xe);const Ue=await Je.getProjectMessages(t);x(Ue),oe(Ue);const sr=(await vt.fetchUsers()).data.reduce((Ze,et)=>(Ze[et.id]={name:et.name,photoURL:et.profileImage},Ze),{});if(N(sr),xe&&xe.managers){const Ze=await Promise.all(xe.managers.map(et=>vt.getUserById(et)));Z(Ze)}}catch(xe){console.error("Error loading project data:",xe),f(xe.message||"Failed to load project details")}finally{u(!1)}})()},[t]),T.useEffect(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[ae]),T.useEffect(()=>{if(!H.trim()){oe(g);return}const le=g.filter(xe=>xe.content.toLowerCase().includes(H.toLowerCase())||xe.userName.toLowerCase().includes(H.toLowerCase()));oe(le)},[H,g]);const $e=le=>{const xe=Array.from(le.target.files||[]);E(Ue=>[...Ue,...xe])},He=le=>{r.current&&(r.current.accept=le,r.current.click()),F(!1)},ct=async le=>{const xe=yl(xl,`projects/${t}/chat/${Date.now()}_${le.name}`),Ue=ml(xe,le);return new Promise((An,sr)=>{Ue.then(async Ze=>{const et=await gl(Ze.ref),da=$s=>$s.type.startsWith("image/")?"image":$s.type.startsWith("video/")?"video":$s.type.startsWith("audio/")?"audio":$s.type.includes("document")||$s.type.includes("pdf")?"document":"other";An({id:Date.now().toString(),name:le.name,url:et,type:da(le),size:le.size})}).catch(sr)})},Ut=async()=>{var le;if(!(!w.trim()&&_.length===0)){u(!0),f(null);try{P(0);let xe=[];if(_.length>0){const An=_.map(sr=>ct(sr));xe=await Promise.all(An)}const Ue={id:Date.now().toString(),userId:n.uid,userName:n.displayName||((le=M[n.uid])==null?void 0:le.name)||"Usuário",content:w,timestamp:Date.now(),attachments:xe,quotedMessage:R?{userName:R.userName,content:R.content,attachments:R.attachments}:void 0,messageType:"general"};await Je.addProjectMessage(t,Ue),x(An=>[...An,Ue]),oe(An=>[...An,Ue]),v(""),E([]),P(0),k(null)}catch(xe){f(xe.message||"Failed to send message")}finally{u(!1)}}},rs=async()=>{if(j)try{const le=g.filter(xe=>xe.id!==j);x(le),oe(le.filter(xe=>!H.trim()||xe.content.toLowerCase().includes(H.toLowerCase())||xe.userName.toLowerCase().includes(H.toLowerCase()))),await Je.updateProject(t,{messages:le})}catch(le){console.error("Error deleting message:",le),f("Failed to delete message.")}finally{C(!1),D(null)}},zl=le=>{var xe;v(Ue=>Ue+le),V(!1),(xe=i.current)==null||xe.focus()};if(T.useEffect(()=>{const le=new ResizeObserver(()=>{if(s.current&&o.current&&a.current){const xe=o.current.offsetHeight,Ue=a.current.offsetHeight,sr=window.innerHeight-xe-Ue;s.current.style.height=`${sr}px`,s.current.scrollTop=s.current.scrollHeight}});return s.current&&le.observe(s.current),()=>{s.current&&le.unobserve(s.current)}},[]),T.useEffect(()=>{const le=xe=>{xe.key==="Enter"&&(xe.ctrlKey||xe.metaKey)&&Ut(),xe.key==="Escape"&&R&&k(null)};return window.addEventListener("keydown",le),()=>window.removeEventListener("keydown",le)},[w,_,R]),l&&!p)return c.jsx(Re,{role:"admin",children:c.jsx("div",{className:"flex items-center justify-center h-screen",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})});if(d)return c.jsx(Re,{role:(n==null?void 0:n.role)||"employee",children:c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:[c.jsx("strong",{className:"font-bold",children:"Erro: "}),c.jsx("span",{className:"block sm:inline",children:d})]})})});const Bl=5,$m=W.slice(0,Bl),yd=W.length-Bl;return c.jsxs(Re,{role:(n==null?void 0:n.role)||"employee",children:[c.jsxs("div",{className:"flex flex-col h-screen",children:[c.jsxs("div",{ref:o,className:"bg-white shadow-md p-4 flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("button",{onClick:()=>e(`/admin/projects/${t}`),className:"text-gray-600 hover:text-gray-900 transition-colors",children:c.jsx(ks,{size:24})}),c.jsx("h1",{className:"text-xl font-semibold text-gray-900 text-center flex-grow",children:p==null?void 0:p.name}),c.jsx("div",{className:"relative",children:c.jsx("button",{onClick:()=>Ie(!ge),className:"text-gray-600 hover:text-blue-600 transition-colors",children:c.jsx(wl,{size:20})})})]}),ge&&c.jsxs("div",{className:"mt-2 relative",children:[c.jsx("input",{type:"text",value:H,onChange:le=>X(le.target.value),placeholder:"Buscar mensagens...",className:"w-full px-4 py-2 pr-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),H&&c.jsx("button",{onClick:()=>X(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c.jsx(Wn,{size:16})})]}),c.jsxs("div",{className:"flex items-center justify-center mt-2 cursor-pointer",onClick:Te,children:[$m.map(le=>c.jsxs("div",{className:"relative group",children:[c.jsx("img",{src:le.profileImage||mr(le.name),alt:le.name,className:"w-8 h-8 rounded-full object-cover border-2 border-white ml-[-0.5rem]"}),c.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 text-white text-xs text-center py-0.5 opacity-0 group-hover:opacity-100 transition-opacity rounded-b-full truncate",children:le.name.split(" ")[0]})]},le.id)),yd>0&&c.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-300 text-gray-700 flex items-center justify-center ml-[-0.5rem]",children:["+",yd]})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4",ref:s,children:ae.length===0?c.jsx("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:H?c.jsxs(c.Fragment,{children:[c.jsx(wl,{size:48,className:"mb-2 text-gray-400"}),c.jsxs("p",{children:['Nenhuma mensagem encontrada para "',H,'"']})]}):c.jsxs(c.Fragment,{children:[c.jsx(yA,{size:48,className:"mb-2 text-gray-400"}),c.jsx("p",{children:"Nenhuma mensagem ainda. Seja o primeiro a enviar!"})]})}):ae.map((le,xe)=>c.jsx(WW,{message:le,onDelete:Ue=>{D(Ue),C(!0)},onQuote:Ue=>k({id:"",userId:"",timestamp:0,userName:Ue.userName,content:Ue.content,attachments:Ue.attachments}),isFirstMessage:xe===0,users:M},le.id))}),c.jsxs("div",{ref:a,className:"bg-white p-4 shadow-md flex-shrink-0 sticky bottom-0",children:[R&&c.jsxs("div",{className:"mb-4 p-3 bg-gray-100 rounded-lg flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1 pr-4",children:[c.jsxs("div",{className:"font-semibold text-gray-700 flex items-center",children:[c.jsx("span",{className:"w-1 h-full bg-blue-500 mr-2"}),"Respondendo a ",R.userName]}),c.jsx("div",{className:"text-gray-600 line-clamp-1",children:R.content})]}),c.jsx("button",{onClick:()=>k(null),className:"text-gray-500 hover:text-red-500 transition-colors",children:c.jsx(Wn,{size:16})})]}),_.length>0&&c.jsxs("div",{className:"flex flex-wrap gap-2 mb-4 p-2 bg-gray-50 rounded-lg border border-gray-200",children:[_.map((le,xe)=>c.jsxs("div",{className:"flex items-center space-x-2 bg-white rounded-lg px-3 py-2 border border-gray-200",children:[c.jsx(Fs,{size:16,className:"text-gray-500"}),c.jsx("span",{className:"text-sm text-gray-700 truncate",style:{maxWidth:"150px"},children:le.name}),c.jsx("button",{onClick:()=>E(Ue=>Ue.filter((An,sr)=>sr!==xe)),className:"text-gray-400 hover:text-red-500 transition-colors",children:c.jsx(Wn,{size:14})})]},xe)),_.length>1&&c.jsx("button",{onClick:()=>E([]),className:"text-xs text-red-500 hover:text-red-700 transition-colors ml-2",children:"Remover todos"})]}),A>0&&A<100&&c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${A}%`}})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("button",{type:"button",onClick:()=>F(!$),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-gray-100 rounded-full transition-colors",title:"Anexar arquivo",children:c.jsx(lB,{size:20})}),$&&c.jsxs("div",{className:"fixed transform -translate-x-1/2 bg-white rounded-lg shadow-lg border p-2 w-64 z-30",style:{bottom:`${($l=a.current)!=null&&$l.offsetHeight?a.current.offsetHeight+10:70}px`,left:"50%",maxWidth:"calc(100vw - 20px)"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b",children:[c.jsx("h3",{className:"text-sm font-medium",children:"Tipo de Arquivo"}),c.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:c.jsx(Wn,{size:16})})]}),c.jsx("div",{className:"space-y-1",children:[{type:"image/*",label:"Imagem",icon:c.jsx(km,{size:20,className:"text-blue-500"})},{type:"video/*",label:"Vídeo",icon:c.jsx(Vw,{size:20,className:"text-red-500"})},{type:"audio/*",label:"Áudio",icon:c.jsx(Lw,{size:20,className:"text-purple-500"})},{type:"application/pdf",label:"PDF",icon:c.jsx(Tm,{size:20,className:"text-orange-500"})},{type:"*/*",label:"Qualquer arquivo",icon:c.jsx(Fs,{size:20,className:"text-gray-500"})}].map(le=>c.jsxs("button",{onClick:()=>{He(le.type),F(!1)},className:"w-full flex items-center p-2 hover:bg-gray-100 rounded text-left transition-colors",children:[le.icon,c.jsx("span",{className:"ml-2",children:le.label})]},le.type))})]}),c.jsx("input",{ref:r,type:"file",multiple:!0,onChange:$e,className:"hidden"})]}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{type:"button",onClick:()=>V(!B),className:"p-2 text-gray-500 hover:text-yellow-500 hover:bg-gray-100 rounded-full transition-colors",title:"Inserir emoji",children:c.jsx(uB,{size:20})}),B&&c.jsxs("div",{className:"fixed transform -translate-x-1/2 bg-white rounded-lg shadow-lg border p-2 w-64 z-30",style:{bottom:`${(ua=a.current)!=null&&ua.offsetHeight?a.current.offsetHeight+10:70}px`,left:"50%",maxWidth:"calc(100vw - 20px)"},children:[c.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b",children:[c.jsx("h3",{className:"text-sm font-medium",children:"Emojis"}),c.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:c.jsx(Wn,{size:16})})]}),c.jsx("div",{className:"grid grid-cols-5 gap-2",children:["😀","😂","😊","❤️","👍","🎉","🔥","⭐","✅","🚀","🤔","👏","🙏","💯","🌟"].map(le=>c.jsx("button",{onClick:()=>{zl(le),V(!1)},className:"text-xl hover:bg-gray-100 p-1 rounded transition-colors",children:le},le))})]})]}),c.jsx("div",{className:"flex-1 relative",children:c.jsx("textarea",{value:w,onChange:le=>v(le.target.value),placeholder:"Digite sua mensagem...",className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",style:{maxHeight:"120px",minHeight:"42px"},rows:Math.min(5,Math.max(1,w.split(`
`).length)),onKeyPress:le=>{le.key==="Enter"&&!le.shiftKey&&(le.preventDefault(),Ut())},ref:i})}),c.jsx("button",{onClick:Ut,disabled:!w.trim()&&_.length===0||l,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c.jsx(xA,{size:20})})]})]})]}),c.jsx(gd,{isOpen:S,onClose:()=>C(!1),onConfirm:rs,itemName:"esta mensagem",warningMessage:"Esta ação não poderá ser desfeita."}),z&&c.jsx(KW,{managers:W,onClose:we})]})},QW=()=>{const[t,e]=T.useState(!0),[n,r]=T.useState(null),[s,i]=T.useState([]),[o,a]=T.useState([]),[l,u]=T.useState({}),[d,f]=T.useState(null),[p,m]=T.useState(!1),[g,x]=T.useState(""),[w,v]=T.useState(""),[_,E]=T.useState(""),A=Eb(_,500),[P,M]=T.useState({}),[N,S]=T.useState(1),[C,j]=T.useState(1),D=9,[R,k]=T.useState(""),z=mn(),O=T.useCallback(async()=>{try{const F=await Je.fetchProjects({excludeStatus:"archived"});a(F.data.map(H=>({id:H.id,name:H.name})))}catch(F){console.error("Erro ao buscar projetos:",F),r("Erro ao buscar projetos.")}},[]);T.useEffect(()=>{O()},[O]);const W=T.useCallback(async()=>{try{e(!0),r(null);const[F,H]=await Promise.all([vt.fetchUsers(),nt.fetchTasks({projectId:g||void 0,status:w||void 0,limit:D,page:N})]),X=F.data.reduce((ge,Ie)=>(ge[Ie.id]=Ie.name,ge),{});u(X),i(H.data),j(H.totalPages)}catch(F){console.error("Erro ao carregar dados:",F),r(F.message||"Falha ao carregar dados")}finally{e(!1)}},[g,w,N,D,e,r,a,u,i,j]);T.useEffect(()=>{W()},[W,A]);const Z=s.filter(F=>_===""||F.title.toLowerCase().includes(A.toLowerCase())||F.description.toLowerCase().includes(A.toLowerCase())),B=({status:F})=>{const H={pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",waiting_approval:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800",blocked:"bg-red-100 text-red-800"},X={pending:"Pendente",in_progress:"Em Andamento",waiting_approval:"Aguardando Aprovação",completed:"Concluída",blocked:"Bloqueada"};return c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H[F]}`,children:X[F]})},V=async()=>{if(d)try{await nt.deleteTask(d.id),i(F=>F.filter(H=>H.id!==d.id)),m(!1),f(null)}catch(F){r(F.message||"Erro ao excluir tarefa")}},$=()=>{R&&z(`/admin/projects/${R}/create-task`)};return c.jsx(Re,{role:"admin",isLoading:t,children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciamento de Tarefas"}),c.jsx("p",{className:"text-gray-500 text-sm",children:"Gerencie e acompanhe todas as tarefas do sistema"})]}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("select",{value:R,onChange:F=>k(F.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Selecione um Projeto"}),o.map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))]}),c.jsxs("button",{onClick:$,disabled:!R,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition shadow-md disabled:opacity-50",children:[c.jsx(ur,{className:"mr-2"})," Nova Tarefa"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(wl,{className:"text-gray-400"})}),c.jsx("input",{type:"text",placeholder:"Buscar tarefas...",value:_,onChange:F=>E(F.target.value),className:"w-full pl-10 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("select",{value:g,onChange:F=>x(F.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Todos os Projetos"}),o.map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))]}),c.jsxs("select",{value:w,onChange:F=>v(F.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Todos os Status"}),c.jsx("option",{value:"pending",children:"Pendente"}),c.jsx("option",{value:"in_progress",children:"Em Andamento"}),c.jsx("option",{value:"waiting_approval",children:"Aguardando Aprovação"}),c.jsx("option",{value:"completed",children:"Concluída"}),c.jsx("option",{value:"blocked",children:"Bloqueada"})]})]}),n&&c.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:n}),Z.length===0?c.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-md",children:[c.jsx("div",{className:"flex justify-center mb-4",children:c.jsx(Xe,{className:"h-12 w-12 text-gray-400"})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma tarefa encontrada"}),c.jsx("p",{className:"text-gray-500",children:"Tente ajustar os filtros ou criar uma nova tarefa."})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6",children:Z.map(F=>{const H=o.find(ge=>ge.id===F.projectId),X=l[F.assignedTo]||"N/A";return c.jsx("div",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300 group",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-800 group-hover:text-blue-600 transition",children:[c.jsx(De,{to:`/tasks/${F.id}`,children:F.title})," "]}),c.jsxs("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx(De,{to:`/admin/projects/${F.projectId}/edit-task/${F.id}`,children:c.jsx("button",{className:"text-blue-500 hover:text-blue-700",children:c.jsx(Ao,{size:20})})}),c.jsx("button",{onClick:()=>{f(F),m(!0)},className:"text-red-500 hover:text-red-700",children:c.jsx(ns,{size:20})})]})]}),c.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2",children:F.description}),c.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Projeto: ",H?H.name:"N/A"]}),c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Jo,{className:"text-gray-500",size:16}),c.jsxs("span",{className:"text-gray-600 text-sm truncate max-w-[150px]",children:[X," "]})]}),c.jsx(B,{status:F.status})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Qo,{className:"text-gray-500",size:16}),c.jsx("span",{className:"text-gray-600 text-sm",children:new Date(F.dueDate).toLocaleDateString()})]}),c.jsxs("span",{className:"text-sm text-yellow-600 font-medium flex items-center",children:[c.jsx("span",{className:"mr-1",children:"🪙"}),F.coinsReward]})]})]})},F.id)})}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",N," de ",C]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>S(F=>Math.max(1,F-1)),disabled:N===1,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center hover:bg-gray-100 transition",children:[c.jsx(aa,{className:"mr-2"})," Anterior"]}),c.jsxs("button",{onClick:()=>S(F=>Math.min(C,F+1)),disabled:N===C,className:"px-4 py-2 border rounded-lg disabled:opacity-50 flex items-center hover:bg-gray-100 transition",children:["Próximo ",c.jsx(la,{className:"ml-2"})]})]})]})]}),c.jsx(gd,{isOpen:p,onClose:()=>{m(!1),f(null)},onConfirm:V,itemName:d?d.title:"",warningMessage:"A exclusão de uma tarefa removerá permanentemente todas as suas informações do sistema."})]})})},JW=()=>{const[t,e]=T.useState(!0),[n,r]=T.useState({taskCompletionBase:10,complexityMultiplier:1.5,monthlyBonus:50}),[s,i]=T.useState({emailNotifications:!0,pushNotifications:!1,weeklyReports:!0}),[o,a]=T.useState({twoFactorAuth:!1,passwordResetFrequency:90}),l=mn();T.useEffect(()=>{const f=setTimeout(()=>{e(!1)},500);return()=>clearTimeout(f)},[]);const u=({title:f,icon:p,children:m})=>c.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 space-y-4",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx(p,{className:"mr-3 text-blue-600",size:24}),c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:f})]}),m]}),d=({label:f,children:p})=>c.jsxs("div",{className:"flex justify-between items-center py-3 border-b last:border-b-0",children:[c.jsx("span",{className:"text-gray-700",children:f}),p]});return c.jsx(Re,{role:"admin",isLoading:t,children:c.jsx("div",{className:"container mx-auto p-6",children:c.jsxs("div",{className:"space-y-8",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:[c.jsx(Ns,{className:"mr-4 text-blue-600"})," Configurações"]}),c.jsxs("button",{onClick:()=>l("/profile"),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg flex items-center transition",children:[c.jsx(Du,{className:"mr-2"})," Ver Perfil"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[c.jsxs(u,{title:"Sistema de Recompensas",icon:Zz,children:[c.jsx(d,{label:"Base por Tarefa",children:c.jsx("input",{type:"number",value:n.taskCompletionBase,onChange:f=>r({...n,taskCompletionBase:Number(f.target.value)}),className:"w-24 px-2 py-1 border rounded-lg text-right"})}),c.jsx(d,{label:"Multiplicador de Complexidade",children:c.jsx("input",{type:"number",step:"0.1",value:n.complexityMultiplier,onChange:f=>r({...n,complexityMultiplier:Number(f.target.value)}),className:"w-24 px-2 py-1 border rounded-lg text-right"})}),c.jsx(d,{label:"Bônus Mensal",children:c.jsx("input",{type:"number",value:n.monthlyBonus,onChange:f=>r({...n,monthlyBonus:Number(f.target.value)}),className:"w-24 px-2 py-1 border rounded-lg text-right"})})]}),c.jsxs(u,{title:"Notificações",icon:wo,children:[c.jsx(d,{label:"Notificações por Email",children:c.jsxs("label",{className:"switch",children:[c.jsx("input",{type:"checkbox",checked:s.emailNotifications,onChange:f=>i({...s,emailNotifications:f.target.checked})}),c.jsx("span",{className:"slider round"})]})}),c.jsx(d,{label:"Notificações Push",children:c.jsxs("label",{className:"switch",children:[c.jsx("input",{type:"checkbox",checked:s.pushNotifications,onChange:f=>i({...s,pushNotifications:f.target.checked})}),c.jsx("span",{className:"slider round"})]})}),c.jsx(d,{label:"Relatórios Semanais",children:c.jsxs("label",{className:"switch",children:[c.jsx("input",{type:"checkbox",checked:s.weeklyReports,onChange:f=>i({...s,weeklyReports:f.target.checked})}),c.jsx("span",{className:"slider round"})]})})]}),c.jsxs(u,{title:"Segurança",icon:Ff,children:[c.jsx(d,{label:"Autenticação de Dois Fatores",children:c.jsxs("label",{className:"switch",children:[c.jsx("input",{type:"checkbox",checked:o.twoFactorAuth,onChange:f=>a({...o,twoFactorAuth:f.target.checked})}),c.jsx("span",{className:"slider round"})]})}),c.jsx(d,{label:"Redefinição de Senha (dias)",children:c.jsx("input",{type:"number",value:o.passwordResetFrequency,onChange:f=>a({...o,passwordResetFrequency:Number(f.target.value)}),className:"w-24 px-2 py-1 border rounded-lg text-right"})})]})]}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg flex items-center hover:bg-blue-700 transition",children:[c.jsx(Wc,{className:"mr-2"})," Salvar Alterações"]})})]})})})};function Np(t){if(t===null||typeof t!="object")return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t)){const n=[];for(const r of t)n.push(Np(r));return n}const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Np(t[n]));return e}const YW=()=>{const{projectId:t}=Pl(),e=mn(),{currentUser:n}=tn(),[r,s]=T.useState({title:"",description:"",projectId:t||"",assignedTo:"",priority:"medium",startDate:new Date().toISOString().split("T")[0],dueDate:new Date().toISOString().split("T")[0],difficultyLevel:5,actions:[]}),[i,o]=T.useState(!1),[a,l]=T.useState(null),[u,d]=T.useState({}),[f,p]=T.useState([]),[m,g]=T.useState(0),[x,w]=T.useState([]),[v,_]=T.useState(""),[E,A]=T.useState(""),[P,M]=T.useState({});T.useEffect(()=>{t&&(s(O=>({...O,projectId:t})),Je.getProjectById(t).then(O=>A(O.name)).catch(O=>{console.error("Error fetching project name:",O),l("Failed to fetch project name.")}))},[t]),T.useEffect(()=>{(async()=>{try{const[W,Z,B]=await Promise.all([vt.fetchUsers(),Uf.getSettings(),Hn.fetchActionTemplates()]);p(W.data.map(V=>({id:V.id,name:V.name}))),g(Math.round(Z.taskCompletionBase*r.difficultyLevel*Z.complexityMultiplier)),w(B.map(V=>({id:V.id,title:V.title})))}catch{l("Falha ao carregar dados")}})()},[r.difficultyLevel]);const N=()=>{const O={};return r.title.trim()||(O.title="Título é obrigatório"),r.description.trim()||(O.description="Descrição é obrigatória"),r.assignedTo||(O.assignedTo="Um responsável é obrigatório"),r.startDate||(O.startDate="Data de início é obrigatória"),r.dueDate||(O.dueDate="Data de vencimento é obrigatória"),d(O),Object.keys(O).length===0},S=O=>{const{name:W,value:Z}=O.target;s(B=>({...B,[W]:Z})),u[W]&&d(B=>{const V={...B};return delete V[W],V})},C=async()=>{if(v)try{const O=await Hn.getActionTemplateById(v);if(!O)return;const W={id:Date.now().toString()+Math.random().toString(36).substring(7),title:O.title,type:"document",completed:!1,description:O.elements.map(Z=>Z.description).join(" "),data:{steps:Np(O.elements)}};s(Z=>({...Z,actions:[...Z.actions,W]}))}catch(O){console.error("Error adding action from template:",O),l("Failed to add action from template.")}},j=O=>{let W={id:Date.now().toString()+Math.random().toString(36).substring(7),type:O,title:"Informações Importantes",completed:!1,description:""};W={...W,infoTitle:"",infoDescription:"",hasAttachments:!1,data:{}},s(Z=>({...Z,actions:[...Z.actions,W]}))},D=(O,W,Z)=>{s(B=>({...B,actions:B.actions.map(V=>V.id===O?{...V,[W]:Z}:V)}))},R=(O,W)=>{const Z=Array.from(W.target.files||[]);M(B=>({...B,[O]:Z}))},k=O=>{s(W=>({...W,actions:W.actions.filter(Z=>Z.id!==O)})),M(W=>{const Z={...W};return delete Z[O],Z})},z=async O=>{if(O.preventDefault(),!!N()){o(!0),l(null);try{const W=[...r.actions];for(let V=0;V<W.length;V++){const $=W[V];if($.type==="info"&&$.hasAttachments&&P[$.id]){const F="temp_"+Date.now().toString(),H=P[$.id].map(ge=>nt.uploadTaskAttachment(F,ge)),X=await Promise.all(H);W[V]={...$,data:{...$.data,fileURLs:X}}}}const Z={title:r.title,description:r.description,projectId:r.projectId,assignedTo:r.assignedTo,priority:r.priority,startDate:new Date(r.startDate).getTime(),dueDate:new Date(r.dueDate).getTime(),status:"pending",difficultyLevel:r.difficultyLevel,coinsReward:m,actions:W,createdBy:(n==null?void 0:n.uid)||"",subtasks:[],comments:[],attachments:[]},B=await nt.createTask(Z);console.log("Task created successfully:",B),e(`/admin/projects/${t}`)}catch(W){console.error("Error creating task:",W),l(W.message||"Failed to create task")}finally{o(!1)}}};return c.jsx(Re,{role:(n==null?void 0:n.role)||"admin",children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("button",{onClick:()=>e(-1),className:"text-gray-600 hover:text-blue-600",children:c.jsx(ks,{size:24})}),c.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:[c.jsx(Xe,{className:"mr-3 text-blue-600"}),"Criar Nova Tarefa para ",E]}),c.jsx("div",{})]}),a&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center mb-4",children:[c.jsx(en,{className:"mr-2"}),a]}),c.jsxs("form",{onSubmit:z,className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título"}),c.jsx("input",{type:"text",name:"title",value:r.title,onChange:S,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${u.title?"border-red-500":"focus:ring-blue-500"}`}),u.title&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.title})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),c.jsx("textarea",{name:"description",value:r.description,onChange:S,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 h-24 ${u.description?"border-red-500":"focus:ring-blue-500"}`}),u.description&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.description})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsável"}),c.jsxs("select",{name:"assignedTo",value:r.assignedTo,onChange:S,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${u.assignedTo?"border-red-500":"focus:ring-blue-500"}`,children:[c.jsx("option",{value:"",children:"Selecione um responsável"}),f.map(O=>c.jsx("option",{value:O.id,children:O.name},O.id))]}),u.assignedTo&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.assignedTo})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nível de Dificuldade (1-10)"}),c.jsx("div",{className:"flex space-x-2",children:[1,2,3,4,5,6,7,8,9,10].map(O=>c.jsx("button",{type:"button",onClick:()=>s(W=>({...W,difficultyLevel:O})),className:`px-3 py-1 rounded-full text-sm ${r.difficultyLevel===O?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:O},O))})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Início"}),c.jsx("input",{type:"date",name:"startDate",value:r.startDate,onChange:S,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${u.startDate?"border-red-500":"focus:ring-blue-500"}`}),u.startDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.startDate})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Vencimento"}),c.jsx("input",{type:"date",name:"dueDate",value:r.dueDate,onChange:S,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${u.dueDate?"border-red-500":"focus:ring-blue-500"}`}),u.dueDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.dueDate})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adicionar Ação de um Modelo"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("select",{value:v,onChange:O=>_(O.target.value),className:"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Selecione um Modelo"}),x.map(O=>c.jsx("option",{value:O.id,children:O.title},O.id))]}),c.jsx("button",{type:"button",onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:!v,children:"Adicionar"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ações"}),c.jsx("div",{className:"space-y-2",children:r.actions.map(O=>c.jsxs("div",{className:"border rounded-lg p-4 flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-medium text-gray-900",children:O.title}),c.jsx("button",{type:"button",onClick:()=>k(O.id),className:"text-red-500 hover:text-red-700",title:"Remover ação",children:c.jsx(ns,{size:16})})]}),O.type==="info"&&c.jsxs("div",{className:"space-y-2 mt-2",children:[c.jsx("input",{type:"text",value:O.infoTitle||"",onChange:W=>D(O.id,"infoTitle",W.target.value),placeholder:"Título das Informações",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsx("textarea",{value:O.infoDescription||"",onChange:W=>D(O.id,"infoDescription",W.target.value),placeholder:"Descrição das Informações",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:O.hasAttachments||!1,onChange:W=>D(O.id,"hasAttachments",W.target.checked),className:"mr-2"}),"Requer arquivos?"]}),O.hasAttachments&&c.jsxs("div",{className:"mt-2",children:[c.jsx("input",{type:"file",multiple:!0,onChange:W=>R(O.id,W),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),P[O.id]&&P[O.id].length>0&&c.jsxs("div",{className:"mt-2",children:[c.jsx("h4",{className:"font-semibold",children:"Arquivos Carregados:"}),c.jsx("ul",{children:P[O.id].map((W,Z)=>c.jsxs("li",{className:"flex items-center",children:[c.jsx(Fs,{size:16,className:"mr-1"}),W.name]},Z))})]})]})]})]},O.id))}),c.jsxs("button",{type:"button",onClick:()=>j("info"),className:"mt-2 px-3 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",children:[c.jsx(ur,{size:16,className:"mr-1"})," Adicionar Informações Importantes"]})]}),c.jsx("button",{type:"submit",disabled:i,className:`w-full py-2 rounded-lg text-white transition ${i?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:i?"Criando...":"Criar Tarefa"})]})]})})},XW=()=>{const{projectId:t,taskId:e}=Pl(),n=mn(),{currentUser:r}=tn(),[s,i]=T.useState({title:"",description:"",projectId:t||"",assignedTo:"",priority:"medium",dueDate:new Date().toISOString().split("T")[0],difficultyLevel:5,actions:[]}),[o,a]=T.useState(!1),[l,u]=T.useState(null),[d,f]=T.useState({}),[p,m]=T.useState([]),[g,x]=T.useState(0),[w,v]=T.useState([]),[_,E]=T.useState(""),[A,P]=T.useState(""),[M,N]=T.useState(!0);T.useEffect(()=>{t&&Je.getProjectById(t).then(z=>P(z.name)).catch(z=>{console.error("Error fetching project name:",z),u("Failed to fetch project name.")})},[t]),T.useEffect(()=>{e&&(async()=>{try{N(!0),u(null);const[O,W,Z,B]=await Promise.all([vt.fetchUsers(),Uf.getSettings(),Hn.fetchActionTemplates(),nt.getTaskById(e)]);m(O.data.map(V=>({id:V.id,name:V.name}))),x(Math.round(W.taskCompletionBase*s.difficultyLevel*W.complexityMultiplier)),v(Z.map(V=>({id:V.id,title:V.title}))),B&&i({title:B.title,description:B.description,projectId:B.projectId,assignedTo:B.assignedTo,priority:B.priority,dueDate:new Date(B.dueDate).toISOString().split("T")[0],difficultyLevel:B.difficultyLevel||5,actions:B.actions||[]})}catch(O){u(O.message||"Falha ao carregar dados")}finally{N(!1)}})()},[e,s.difficultyLevel,t]);const S=()=>{const z={};return s.title.trim()||(z.title="Title is required"),s.description.trim()||(z.description="Description is required"),s.projectId||(z.projectId="Project is required"),s.assignedTo||(z.assignedTo="At least one assignee is required"),s.dueDate||(z.dueDate="Due date is required"),f(z),Object.keys(z).length===0},C=z=>{const{name:O,value:W}=z.target;i(Z=>({...Z,[O]:W})),d[O]&&f(Z=>{const B={...Z};return delete B[O],B})},j=async()=>{if(_)try{const z=await Hn.getActionTemplateById(_);if(!z)return;const O={id:Date.now().toString()+Math.random().toString(36).substring(7),title:z.title,type:"document",completed:!1,description:z.elements.map(W=>W.description).join(" "),data:{steps:Np(z.elements)}};i(W=>({...W,actions:[...W.actions,O]}))}catch(z){console.error("Error adding action from template:",z),u("Failed to add action from template.")}},D=z=>{let O={id:Date.now().toString()+Math.random().toString(36).substring(7),type:z,title:"",completed:!1};O={...O,infoTitle:"",infoDescription:"",hasAttachments:!1,data:{}},i(W=>({...W,actions:[...W.actions,O]}))},R=(z,O,W)=>{i(Z=>({...Z,actions:Z.actions.map(B=>B.id===z?{...B,[O]:W}:B)}))},k=async z=>{if(z.preventDefault(),!!S()){a(!0),u(null);try{if(!e){u("Task ID is missing.");return}const O={...s,dueDate:new Date(s.dueDate).getTime(),coinsReward:g};await nt.updateTask(e,O),n(`/admin/projects/${t}`)}catch(O){u(O.message||"Failed to update task")}finally{a(!1)}}};return c.jsx(Re,{role:(r==null?void 0:r.role)||"employee",children:c.jsxs("div",{className:"container mx-auto p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("button",{onClick:()=>n(-1),className:"text-gray-600 hover:text-blue-600",children:c.jsx(ks,{size:24})}),c.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800 flex items-center",children:[c.jsx(Xe,{className:"mr-3 text-blue-600"}),"Editar Tarefa de ",A]}),c.jsx("div",{})]}),l&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative flex items-center",children:[c.jsx(en,{className:"mr-2"}),l]}),c.jsxs("form",{onSubmit:k,className:"bg-white p-6 rounded-lg shadow-md space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),c.jsx("input",{type:"text",name:"title",value:s.title,onChange:C,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${d.title?"border-red-500":"focus:ring-blue-500"}`}),d.title&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.title})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),c.jsx("textarea",{name:"description",value:s.description,onChange:C,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 h-24 ${d.description?"border-red-500":"focus:ring-blue-500"}`}),d.description&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.description})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsável"}),c.jsxs("select",{name:"assignedTo",value:s.assignedTo,onChange:C,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${d.assignedTo?"border-red-500":"focus:ring-blue-500"}`,children:[c.jsx("option",{value:"",children:"Selecione um responsável"}),p.map(z=>c.jsx("option",{value:z.id,children:z.name},z.id))]}),d.assignedTo&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.assignedTo})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level (2-9)"}),c.jsx("div",{className:"flex space-x-2",children:[2,3,4,5,6,7,8,9].map(z=>c.jsx("button",{type:"button",onClick:()=>i(O=>({...O,difficultyLevel:z})),className:`px-3 py-1 rounded-full text-sm ${s.difficultyLevel===z?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:z},z))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Vencimento"}),c.jsx("input",{type:"date",name:"dueDate",value:s.dueDate,onChange:C,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 ${d.dueDate?"border-red-500":"focus:ring-blue-500"}`}),d.dueDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:d.dueDate})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Action from Template"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("select",{value:_,onChange:z=>E(z.target.value),className:"flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select Template"}),w.map(z=>c.jsx("option",{value:z.id,children:z.title},z.id))]}),c.jsx("button",{type:"button",onClick:j,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:!_,children:"Add"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adicionar Ação Manualmente"}),c.jsx("div",{className:"flex space-x-2",children:c.jsxs("button",{type:"button",onClick:()=>D("info"),className:"px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700 hover:bg-gray-300",children:[c.jsx(mA,{size:16,className:"mr-1"})," Informações Importantes"]})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Actions"}),c.jsx("div",{className:"space-y-2",children:s.actions.map(z=>c.jsxs("div",{className:"border rounded-lg p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:z.title}),z.type==="info"&&z.infoTitle&&c.jsx("span",{className:"block text-sm text-gray-600",children:z.infoTitle})]}),z.type==="info"&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"text",value:z.infoTitle||"",onChange:O=>R(z.id,"infoTitle",O.target.value),placeholder:"Título das Informações",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsx("textarea",{value:z.infoDescription||"",onChange:O=>R(z.id,"infoDescription",O.target.value),placeholder:"Descrição das Informações",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring focus:border-blue-300 text-gray-900"}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:z.hasAttachments||!1,onChange:O=>R(z.id,"hasAttachments",O.target.checked),className:"mr-2"}),"Requer arquivos?"]})]})]},z.id))})]}),c.jsx("button",{type:"submit",disabled:o,className:`w-full py-2 rounded-lg text-white transition ${o?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:o?"Updating...":"Update Task"})]})]})})},mh=({icon:t,title:e,value:n,color:r})=>c.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md flex items-center space-x-4 animate-fade-in",children:[c.jsx("div",{className:`p-3 rounded-full ${r} bg-opacity-10`,children:c.jsx(t,{className:`${r} w-6 h-6`})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:e}),c.jsx("h3",{className:"text-xl font-bold text-gray-800",children:n})]})]}),ZW=()=>{const[t,e]=T.useState(!0),[n,r]=T.useState([]),[s,i]=T.useState([]),[o,a]=T.useState(null);T.useEffect(()=>{(async()=>{e(!0),a(null);try{const f=(await Je.fetchProjects()).data.map(g=>({id:g.id,name:g.name,totalTasks:10,completedTasks:5,team:g.managers}));r(f);const m=(await nt.fetchTasks()).data.map(g=>({id:g.id,title:g.title,project:g.projectId,status:g.status,dueDate:new Date(g.dueDate).toLocaleDateString()}));i(m)}catch(d){a(d.message||"Failed to fetch data."),console.error("Error fetching data:",d)}finally{e(!1)}})()},[]);const l=({status:u})=>{const d={pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",waiting_approval:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800"},f={pending:"Pendente",in_progress:"Em Andamento",waiting_approval:"Aguardando",completed:"Concluída"};return c.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d[u]}`,children:f[u]})};return c.jsx(Re,{role:"manager",isLoading:t,children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Dashboard do Gestor"}),o&&c.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg",children:o}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsx(mh,{icon:Dw,title:"Projetos Ativos",value:n.length,color:"text-blue-600"}),c.jsx(mh,{icon:Xe,title:"Tarefas Concluídas",value:s.filter(u=>u.status==="completed").length,color:"text-green-600"}),c.jsx(mh,{icon:Qo,title:"Tarefas Pendentes",value:s.filter(u=>u.status==="pending").length,color:"text-yellow-600"}),c.jsx(mh,{icon:en,title:"Aguardando",value:s.filter(u=>u.status==="waiting_approval").length,color:"text-purple-600"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(Jo,{className:"mr-2 text-blue-600"}),"Meus Projetos"]}),n.map(u=>c.jsxs("div",{className:"mb-4 pb-4 border-b last:border-b-0",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("h3",{className:"font-medium text-gray-800",children:u.name}),c.jsxs("span",{className:"text-sm text-gray-600",children:[u.completedTasks,"/",u.totalTasks]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${u.completedTasks/u.totalTasks*100}%`}})}),c.jsx("div",{className:"mt-2 flex space-x-2",children:u.team.map((d,f)=>c.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full",children:d},f))})]},u.id))]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(Qo,{className:"mr-2 text-green-600"}),"Tarefas Recentes"]}),s.map(u=>c.jsxs("div",{className:"mb-4 pb-4 border-b last:border-b-0 flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium text-gray-800 text-sm",children:u.title}),c.jsx("p",{className:"text-xs text-gray-500",children:u.project})]}),c.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[c.jsx(l,{status:u.status}),c.jsx("span",{className:"text-xs text-gray-500",children:u.dueDate})]})]},u.id))]})]})]})})},gh=({icon:t,title:e,value:n,color:r})=>c.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md flex items-center space-x-4 animate-fade-in",children:[c.jsx("div",{className:`p-3 rounded-full ${r} bg-opacity-10`,children:c.jsx(t,{className:`${r} w-6 h-6`})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-500",children:e}),c.jsx("h3",{className:"text-xl font-bold text-gray-800",children:n})]})]}),eK=()=>{const[t,e]=T.useState(!0),[n]=T.useState([{id:"1",title:"Desenvolver Componente UI",project:"Novo Produto",status:"in_progress",dueDate:"15/03/2024",coinReward:50},{id:"2",title:"Relatório de Marketing",project:"Marketing Digital",status:"waiting_approval",dueDate:"28/02/2024",coinReward:30}]),[r]=T.useState([{id:"1",description:"Tarefa: Desenvolver Protótipo",coins:75,date:"20/02/2024"},{id:"2",description:"Bônus de Desempenho",coins:100,date:"01/02/2024"}]);T.useEffect(()=>{const i=setTimeout(()=>{e(!1)},750);return()=>clearTimeout(i)},[]);const s=({status:i})=>{const o={pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",waiting_approval:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800"},a={pending:"Pendente",in_progress:"Em Andamento",waiting_approval:"Aguardando",completed:"Concluída"};return c.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o[i]}`,children:a[i]})};return c.jsx(Re,{role:"employee",isLoading:t,children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Meu Painel"}),c.jsxs("div",{className:"flex items-center space-x-2 bg-yellow-100 px-3 py-1 rounded-lg",children:[c.jsx(vl,{className:"text-yellow-600 w-5 h-5"}),c.jsx("span",{className:"font-semibold text-yellow-800 text-sm",children:"225 Moedas"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsx(gh,{icon:mS,title:"Tarefas Ativas",value:"2",color:"text-blue-600"}),c.jsx(gh,{icon:Xe,title:"Concluídas",value:"15",color:"text-green-600"}),c.jsx(gh,{icon:Qo,title:"Pendentes",value:"5",color:"text-yellow-600"}),c.jsx(gh,{icon:dB,title:"Moedas Ganhas",value:"175",color:"text-purple-600"})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(mS,{className:"mr-2 text-blue-600"}),"Minhas Tarefas"]}),n.map(i=>c.jsxs("div",{className:"mb-4 pb-4 border-b last:border-b-0 flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium text-gray-800 text-sm",children:i.title}),c.jsx("p",{className:"text-xs text-gray-500",children:i.project})]}),c.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[c.jsx(s,{status:i.status}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-xs text-gray-500",children:i.dueDate}),c.jsxs("span",{className:"text-yellow-600 font-semibold text-xs",children:[i.coinReward," 🪙"]})]})]})]},i.id))]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[c.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[c.jsx(vl,{className:"mr-2 text-yellow-600"}),"Histórico de Recompensas"]}),r.map(i=>c.jsxs("div",{className:"mb-4 pb-4 border-b last:border-b-0 flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium text-gray-800 text-sm",children:i.description}),c.jsx("p",{className:"text-xs text-gray-500",children:i.date})]}),c.jsxs("span",{className:"text-yellow-600 font-semibold text-sm",children:["+",i.coins," 🪙"]})]},i.id))]})]})]})})},tK=()=>c.jsx(Hz,{children:c.jsx($z,{children:c.jsx(kO,{children:c.jsxs(vO,{children:[c.jsx(tt,{path:"/login",element:c.jsx(vB,{})}),c.jsx(tt,{path:"/forgot-password",element:c.jsx(wB,{})}),c.jsx(tt,{path:"/unauthorized",element:c.jsx(EB,{})}),c.jsx(tt,{path:"/profile",element:c.jsx(Bt,{children:c.jsx(_B,{})})}),c.jsx(tt,{path:"/profile/:userId",element:c.jsx(Bt,{children:c.jsx(PW,{})})}),c.jsx(tt,{path:"/notifications",element:c.jsx(Bt,{children:c.jsx(TB,{})})}),c.jsx(tt,{path:"/tasks/:taskId",element:c.jsx(Bt,{children:c.jsx(kW,{})})}),c.jsx(tt,{path:"/admin/dashboard",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx(LW,{})})}),c.jsx(tt,{path:"/admin/user-management",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx(UW,{})})}),c.jsx(tt,{path:"/admin/projects",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx($W,{})})}),c.jsx(tt,{path:"/admin/projects/:projectId",element:c.jsx(Bt,{allowedRoles:["admin","manager"],children:c.jsx(qW,{})})}),c.jsx(tt,{path:"/admin/projects/:projectId/chat",element:c.jsx(Bt,{allowedRoles:["admin","manager"],children:c.jsx(GW,{})})}),c.jsx(tt,{path:"/admin/projects/:projectId/create-task",element:c.jsx(Bt,{allowedRoles:["admin","manager"],children:c.jsx(YW,{})})}),c.jsx(tt,{path:"/admin/projects/:projectId/edit-task/:taskId",element:c.jsx(Bt,{allowedRoles:["admin","manager"],children:c.jsx(XW,{})})}),c.jsx(tt,{path:"/admin/tasks",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx(QW,{})})}),c.jsx(tt,{path:"/admin/settings",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx(JW,{})})}),c.jsx(tt,{path:"/admin/action-templates/create",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx(AW,{})})}),c.jsx(tt,{path:"/admin/action-templates",element:c.jsx(Bt,{allowedRoles:["admin"],children:c.jsx(jW,{})})}),c.jsx(tt,{path:"/manager/dashboard",element:c.jsx(Bt,{allowedRoles:["manager"],children:c.jsx(ZW,{})})}),c.jsx(tt,{path:"/employee/dashboard",element:c.jsx(Bt,{allowedRoles:["employee"],children:c.jsx(eK,{})})}),c.jsx(tt,{path:"/",element:c.jsx(g0,{to:"/login",replace:!0})}),c.jsx(tt,{path:"*",element:c.jsx("div",{children:"Página não encontrada"})})]})})})}),nK=ML(tK);XN(document.getElementById("root")).render(c.jsx(T.StrictMode,{children:c.jsx(nK,{})}));
//# sourceMappingURL=index-4KPNaHgg.js.map
